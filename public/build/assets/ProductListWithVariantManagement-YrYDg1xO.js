import{d as A,r as s,V as F,D as K,c as P,b as l,f as o,av as _,o as x,e as r,a0 as c,s as i,X as g,t as d,g as H}from"./main-BDjA8ZE0.js";import{f as R}from"./formatters-BD6tdLx_.js";import W from"./VariantManagementDialog-BAsvyuUZ.js";import{V as j,b as G}from"./VCard-Af9i-cHC.js";import{V as O}from"./VCardText-pusdEz6_.js";import{V as X,a as C}from"./VRow-B_tm1uSD.js";import{V as q}from"./VTextField-BQMuFhOa.js";import{V as h}from"./VSelect-CqUH4kv5.js";import{V as J}from"./VDataTable-BxIs7bLB.js";import{V}from"./VTooltip-Ds7TpE81.js";import{V as Q}from"./VSwitch-DvQ6AnPY.js";import{V as S}from"./VChip-DmPw7oBU.js";import{V as Y}from"./VAvatar-BJUFvcQH.js";import{V as Z}from"./VImg-DavVY8Sw.js";import{_ as tt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VariantFormDialog.vue_vue_type_script_setup_true_lang-1r2W_LME.js";import"./VDialog-kKqt15qI.js";import"./VOverlay-DpeqFwNJ.js";import"./forwardRefs-B931MWyl.js";import"./VDivider-CNJRCtTw.js";import"./VForm-D-6FADkt.js";import"./VAlert-BUxPj0YW.js";import"./VSpacer-P6zft6lJ.js";/* empty css              */import"./VariantCompositionDialog-BMlI44YI.js";import"./helpers-B-vn2Qqf.js";import"./DeleteConfirmationDialog-DIkwJ7SA.js";import"./VAutocomplete-X1kKS8Y9.js";import"./filter-BTEElEgT.js";import"./VList-BUBOvLR6.js";import"./VMenu-BN6MK1Ni.js";import"./VCheckboxBtn-Ml9VaORK.js";import"./VTable-CQyojuSP.js";const et={class:"product-list"},at={class:"font-weight-medium"},ot={class:"text-caption text-medium-emphasis"},lt={key:1,class:"text-medium-emphasis"},it={class:"text-end"},st={class:"font-weight-medium"},rt={class:"text-caption text-medium-emphasis"},nt={class:"d-flex gap-1"},dt=A({__name:"ProductListWithVariantManagement",setup(ut){const y=s(!1),m=s(""),p=s(null),v=s(null),u=s([]),k=s([]),f=s(!1),b=s(null),T=[{title:"Gambar",key:"image",sortable:!1,width:"80px"},{title:"Produk",key:"name",sortable:!0},{title:"Kategori",key:"category",sortable:!1},{title:"Variant",key:"variants_count",sortable:!0,align:"center"},{title:"Total Stok",key:"total_stock",sortable:!0,align:"end"},{title:"Status",key:"is_active",sortable:!1,align:"center"},{title:"Aksi",key:"actions",sortable:!1,align:"center",width:"200px"}],$=[{title:"Aktif",value:!0},{title:"Nonaktif",value:!1}],z=F(()=>{let a=[...u.value];if(m.value){const t=m.value.toLowerCase();a=a.filter(e=>e.name.toLowerCase().includes(t)||e.code.toLowerCase().includes(t))}return p.value&&(a=a.filter(t=>{var e;return((e=t.category)==null?void 0:e.id)===p.value})),v.value!==null&&(a=a.filter(t=>t.is_active===v.value)),a}),D=a=>R(a),w=async()=>{y.value=!0;try{const a=await _.get("/api/products",{params:{per_page:-1,with:"category,variants"}});u.value=a.data.data||a.data}catch(a){console.error("Error loading products:",a),u.value=[]}finally{y.value=!1}},E=async()=>{var a;try{const t=await _.get("/api/categories",{params:{per_page:-1,status:!0}});k.value=((a=t.data.data)==null?void 0:a.map(e=>({title:e.name,value:e.id})))||[]}catch(t){console.error("Error loading categories:",t),k.value=[]}},L=a=>{console.log("View product:",a)},M=a=>{console.log("Edit product:",a)},U=async a=>{if(confirm(`Hapus produk "${a.name}"?`))try{await _.delete(`/api/products/${a.id}`);const t=u.value.findIndex(e=>e.id===a.id);t>-1&&u.value.splice(t,1),console.log("Product deleted successfully")}catch(t){console.error("Error deleting product:",t)}},B=async a=>{try{await _.put(`/api/products/${a.id}`,{is_active:a.is_active}),console.log("Product status updated")}catch(t){console.error("Error updating product status:",t),a.is_active=!a.is_active}},I=a=>{b.value=a,f.value=!0},N=()=>{f.value=!1,w(),console.log("Variants saved successfully")};return K(()=>{w(),E()}),(a,t)=>(x(),P("div",et,[l(j,null,{default:o(()=>[l(G,{class:"d-flex justify-between align-center"},{default:o(()=>[t[5]||(t[5]=r("span",{class:"text-h5"},"Daftar Produk",-1)),l(c,{color:"primary","prepend-icon":"mdi-plus"},{default:o(()=>t[4]||(t[4]=[i(" Tambah Produk ")])),_:1,__:[4]})]),_:1,__:[5]}),l(O,null,{default:o(()=>[l(X,{class:"mb-4"},{default:o(()=>[l(C,{cols:"12",md:"6"},{default:o(()=>[l(q,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),label:"Cari Produk","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"","hide-details":""},null,8,["modelValue"])]),_:1}),l(C,{cols:"12",md:"3"},{default:o(()=>[l(h,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=e=>p.value=e),items:k.value,label:"Kategori",variant:"outlined",density:"compact",clearable:"","hide-details":""},null,8,["modelValue","items"])]),_:1}),l(C,{cols:"12",md:"3"},{default:o(()=>[l(h,{modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=e=>v.value=e),items:$,label:"Status",variant:"outlined",density:"compact",clearable:"","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),l(J,{headers:T,items:z.value,loading:y.value,class:"elevation-0","item-value":"id"},{"item.image":o(({item:e})=>[l(Y,{size:"48",class:"my-2"},{default:o(()=>[l(Z,{src:e.image_url||"/images/default-product.png"},null,8,["src"])]),_:2},1024)]),"item.name":o(({item:e})=>[r("div",null,[r("div",at,d(e.name),1),r("div",ot,d(e.code),1)])]),"item.category":o(({item:e})=>[e.category?(x(),H(S,{key:0,color:"info",size:"small",variant:"tonal"},{default:o(()=>[i(d(e.category.name),1)]),_:2},1024)):(x(),P("span",lt,"-"))]),"item.variants_count":o(({item:e})=>[l(S,{color:e.variants_count>0?"success":"warning",size:"small",variant:"elevated"},{default:o(()=>[i(d(e.variants_count)+" Variant ",1)]),_:2},1032,["color"])]),"item.total_stock":o(({item:e})=>[r("div",it,[r("div",st,d(e.total_stock||0),1),r("div",rt,d(D(e.total_stock_value||0)),1)])]),"item.is_active":o(({item:e})=>[l(Q,{modelValue:e.is_active,"onUpdate:modelValue":n=>e.is_active=n,color:"success",density:"compact","hide-details":"",onChange:n=>B(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),"item.actions":o(({item:e})=>[r("div",nt,[l(c,{icon:"mdi-package-variant",size:"small",variant:"text",color:"primary",onClick:n=>I(e)},{default:o(()=>[l(g,null,{default:o(()=>t[6]||(t[6]=[i("mdi-package-variant")])),_:1,__:[6]}),l(V,{activator:"parent"},{default:o(()=>t[7]||(t[7]=[i("Kelola Variant")])),_:1,__:[7]})]),_:2},1032,["onClick"]),l(c,{icon:"mdi-eye",size:"small",variant:"text",color:"info",onClick:n=>L(e)},{default:o(()=>[l(g,null,{default:o(()=>t[8]||(t[8]=[i("mdi-eye")])),_:1,__:[8]}),l(V,{activator:"parent"},{default:o(()=>t[9]||(t[9]=[i("Lihat Detail")])),_:1,__:[9]})]),_:2},1032,["onClick"]),l(c,{icon:"mdi-pencil",size:"small",variant:"text",color:"secondary",onClick:n=>M(e)},{default:o(()=>[l(g,null,{default:o(()=>t[10]||(t[10]=[i("mdi-pencil")])),_:1,__:[10]}),l(V,{activator:"parent"},{default:o(()=>t[11]||(t[11]=[i("Edit Produk")])),_:1,__:[11]})]),_:2},1032,["onClick"]),l(c,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:n=>U(e)},{default:o(()=>[l(g,null,{default:o(()=>t[12]||(t[12]=[i("mdi-delete")])),_:1,__:[12]}),l(V,{activator:"parent"},{default:o(()=>t[13]||(t[13]=[i("Hapus Produk")])),_:1,__:[13]})]),_:2},1032,["onClick"])])]),_:1},8,["items","loading"])]),_:1})]),_:1}),l(W,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=e=>f.value=e),product:b.value,onSave:N},null,8,["modelValue","product"])]))}}),Wt=tt(dt,[["__scopeId","data-v-0833fccd"]]);export{Wt as default};
