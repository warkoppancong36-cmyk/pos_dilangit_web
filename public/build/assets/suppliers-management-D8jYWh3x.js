import{D as ze}from"./DeleteConfirmationDialog-Bu1_yV53.js";import{d as pe,V as A,r as f,w as ve,g as C,f as t,a5 as w,m as s,b as e,l as R,e as r,X as D,t as k,a0 as J,$ as Le,s as P,o as v,b8 as Me,c as $,az as Re,F as Ke,i as Be,ay as X,ax as ke,D as Ie}from"./main-CBieGgt2.js";import{V as je}from"./VDialog-05PAAxpz.js";import{b as Oe,c as Ge,V as j}from"./VCard-DNMkVA9Y.js";import{V as Ve}from"./VDivider-4cT9G7xT.js";import{V as O}from"./VCardText-DH5Ygolj.js";import{V as We}from"./VForm-HvkzlCA2.js";import{V as he,a as y}from"./VRow-rILDZYkB.js";import{V as T}from"./VTextField-BcAeW67M.js";import{V as $e}from"./VSelect-BqpkGD1S.js";import{V as xe}from"./VTextarea-CA-1XBS9.js";import{V as He}from"./VSpacer-BqlpQUeG.js";import{V as Xe}from"./VSnackbar-B-zU94df.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ie}from"./VChip-CUvmn3GD.js";import{V as ee}from"./VAvatar-SRbocHam.js";import{V as te}from"./VSkeletonLoader-C_MBGnCj.js";import{V as qe}from"./VDataTableServer-Oddferc4.js";import{V as Se}from"./VTooltip-tvH_v-PA.js";import{V as we}from"./VAlert-BxPkO_hf.js";import"./VOverlay-BPIdux_c.js";import"./forwardRefs-B931MWyl.js";import"./VImg-BRSac059.js";/* empty css              */import"./VList-DFzv6ALg.js";import"./VMenu-PaxLP6h7.js";import"./VCheckboxBtn-NWxqozbZ.js";import"./VDataTable-CP1flFCv.js";import"./VTable-CMKDRTDG.js";import"./filter-C5QUR2us.js";const Je={class:"d-flex align-center justify-space-between"},Qe={class:"d-flex align-center gap-2"},Ye={class:"text-h6 text-white"},Ze={class:"text-h6 mb-4 d-flex align-center gap-2"},et={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},tt={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},at={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},lt={class:"d-flex align-center"},st={class:"text-subtitle-1"},ot=pe({__name:"SupplierDialog",props:{modelValue:{type:Boolean},supplier:{},loading:{type:Boolean},errorMessage:{},useDialogError:{type:Boolean}},emits:["update:modelValue","save","clear-error","close"],setup(F,{emit:u}){const o=F,h=u,V=A({get:()=>o.modelValue,set:n=>h("update:modelValue",n)}),x=f(""),p=f(""),b=f(""),E=f(""),U=f(""),S=f(""),c=f(""),m=f(""),a=f(""),_=f(""),B=f(""),K=f(""),N=f(""),z=f(""),L=f("active"),G=A(()=>({code:x.value,name:p.value,email:b.value,phone:E.value,address:U.value,city:S.value,province:c.value,postal_code:m.value,contact_person:a.value,tax_number:_.value,bank_name:B.value,bank_account:K.value,bank_account_name:N.value,notes:z.value,status:L.value}));ve(G,n=>{},{deep:!0});const Q=f(!1),W=f(),H={code:[n=>!!n||"Kode supplier wajib diisi",n=>n&&n.length>=2||"Kode supplier minimal 2 karakter",n=>n&&n.length<=20||"Kode supplier maksimal 20 karakter"],name:[n=>!!n||"Nama supplier wajib diisi",n=>n&&n.length>=2||"Nama supplier minimal 2 karakter",n=>n&&n.length<=100||"Nama supplier maksimal 100 karakter"],email:[n=>n?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)||"Format email tidak valid":!0],phone:[n=>n?/^[\d\s\-\+\(\)]+$/.test(n)||"Format nomor telepon tidak valid":!0],postal_code:[n=>n?/^\d{5}$/.test(n)||"Kode pos harus 5 digit":!0]},re=[{title:"Aktif",value:"active"},{title:"Nonaktif",value:"inactive"}],Y=A(()=>!!o.supplier),ue=A(()=>Y.value?"Edit Supplier":"Tambah Supplier"),de=A(()=>Y.value?"Update":"Simpan"),ae=A(()=>o.errorMessage||null),le=()=>{x.value="",p.value="",b.value="",E.value="",U.value="",S.value="",c.value="",m.value="",a.value="",_.value="",B.value="",K.value="",N.value="",z.value="",L.value="active",Me(()=>{var n;(n=W.value)==null||n.resetValidation()})};ve(()=>o.supplier,n=>{n?(x.value=n.code,p.value=n.name,b.value=n.email||"",E.value=n.phone||"",U.value=n.address||"",S.value=n.city||"",c.value=n.province||"",m.value=n.postal_code||"",a.value=n.contact_person||"",_.value=n.tax_number||"",B.value=n.bank_name||"",K.value=n.bank_account||"",N.value=n.bank_account_name||"",z.value=n.notes||"",L.value=n.status):le()},{immediate:!0}),ve(V,n=>{n||le()});const se=async()=>{var i;const{valid:n}=await((i=W.value)==null?void 0:i.validate());if(n){const d={...G.value};h("save",d)}},oe=()=>{V.value=!1,h("close")};return(n,i)=>(v(),C(je,{modelValue:s(V),"onUpdate:modelValue":i[18]||(i[18]=d=>w(V)?V.value=d:null),"max-width":"900px",persistent:"",scrollable:""},{default:t(()=>[e(j,{class:"supplier-dialog coffee-dialog"},{default:t(()=>[e(Oe,{class:"pa-6 pb-4 coffee-header"},{default:t(()=>[r("div",Je,[r("div",Qe,[e(D,{icon:s(Y)?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),r("span",Ye,k(s(ue)),1)]),e(J,{icon:"tabler-x",variant:"text",color:"white",size:"small",onClick:oe})])]),_:1}),e(Ve),e(O,{class:"pa-6"},{default:t(()=>[e(We,{ref_key:"formRef",ref:W,modelValue:s(Q),"onUpdate:modelValue":i[15]||(i[15]=d=>w(Q)?Q.value=d:null),onSubmit:Le(se,["prevent"])},{default:t(()=>[e(he,null,{default:t(()=>[e(y,{cols:"12"},{default:t(()=>[r("h6",Ze,[e(D,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),i[19]||(i[19]=P(" Informasi Dasar "))])]),_:1}),e(y,{cols:"12",md:"4"},{default:t(()=>[e(T,{modelValue:s(x),"onUpdate:modelValue":i[0]||(i[0]=d=>w(x)?x.value=d:null),label:"Kode Supplier *",rules:H.code,disabled:s(Y),placeholder:"Masukkan kode supplier",variant:"outlined"},null,8,["modelValue","rules","disabled"])]),_:1}),e(y,{cols:"12",md:"8"},{default:t(()=>[e(T,{modelValue:s(p),"onUpdate:modelValue":i[1]||(i[1]=d=>w(p)?p.value=d:null),label:"Nama Supplier *",rules:H.name,placeholder:"Masukkan nama supplier",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(T,{modelValue:s(b),"onUpdate:modelValue":i[2]||(i[2]=d=>w(b)?b.value=d:null),label:"Email",rules:H.email,placeholder:"supplier@email.com",type:"email",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(T,{modelValue:s(E),"onUpdate:modelValue":i[3]||(i[3]=d=>w(E)?E.value=d:null),label:"Nomor Telepon",rules:H.phone,placeholder:"08123456789",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12",md:"8"},{default:t(()=>[e(T,{modelValue:s(a),"onUpdate:modelValue":i[4]||(i[4]=d=>w(a)?a.value=d:null),label:"Nama Kontak",placeholder:"Nama person in charge",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:t(()=>[e($e,{modelValue:s(L),"onUpdate:modelValue":i[5]||(i[5]=d=>w(L)?L.value=d:null),label:"Status *",items:re,"item-title":"title","item-value":"value",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[r("h6",et,[e(D,{icon:"tabler-map-pin",size:"20",class:"coffee-icon"}),i[20]||(i[20]=P(" Informasi Alamat "))])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(xe,{modelValue:s(U),"onUpdate:modelValue":i[6]||(i[6]=d=>w(U)?U.value=d:null),label:"Alamat",placeholder:"Masukkan alamat lengkap",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:t(()=>[e(T,{modelValue:s(S),"onUpdate:modelValue":i[7]||(i[7]=d=>w(S)?S.value=d:null),label:"Kota",placeholder:"Nama kota",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:t(()=>[e(T,{modelValue:s(c),"onUpdate:modelValue":i[8]||(i[8]=d=>w(c)?c.value=d:null),label:"Provinsi",placeholder:"Nama provinsi",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:t(()=>[e(T,{modelValue:s(m),"onUpdate:modelValue":i[9]||(i[9]=d=>w(m)?m.value=d:null),label:"Kode Pos",rules:H.postal_code,placeholder:"12345",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[r("h6",tt,[e(D,{icon:"tabler-credit-card",size:"20",class:"coffee-icon"}),i[21]||(i[21]=P(" Informasi Keuangan "))])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(T,{modelValue:s(_),"onUpdate:modelValue":i[10]||(i[10]=d=>w(_)?_.value=d:null),label:"NPWP",placeholder:"Nomor NPWP",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(T,{modelValue:s(B),"onUpdate:modelValue":i[11]||(i[11]=d=>w(B)?B.value=d:null),label:"Nama Bank",placeholder:"Nama bank",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(T,{modelValue:s(K),"onUpdate:modelValue":i[12]||(i[12]=d=>w(K)?K.value=d:null),label:"Nomor Rekening",placeholder:"Nomor rekening bank",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(T,{modelValue:s(N),"onUpdate:modelValue":i[13]||(i[13]=d=>w(N)?N.value=d:null),label:"Nama Pemilik Rekening",placeholder:"Nama pemilik rekening",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[r("h6",at,[e(D,{icon:"tabler-notes",size:"20",class:"coffee-icon"}),i[22]||(i[22]=P(" Informasi Tambahan "))])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(xe,{modelValue:s(z),"onUpdate:modelValue":i[14]||(i[14]=d=>w(z)?z.value=d:null),label:"Catatan",placeholder:"Catatan tambahan tentang supplier",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(Ve),e(Ge,{class:"pa-6"},{default:t(()=>[e(He),e(J,{color:"secondary",variant:"outlined",class:"coffee-secondary",onClick:oe},{default:t(()=>i[23]||(i[23]=[P(" Batal ")])),_:1,__:[23]}),e(J,{color:"primary",class:"coffee-primary",loading:n.loading,disabled:!s(Q),onClick:se},{default:t(()=>[P(k(s(de)),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),n.useDialogError?R("",!0):(v(),C(Xe,{key:0,"model-value":!!s(ae),"onUpdate:modelValue":i[17]||(i[17]=d=>!d&&n.$emit("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500",class:"coffee-error"},{actions:t(()=>[e(J,{icon:"tabler-x",size:"small",variant:"text",onClick:i[16]||(i[16]=d=>n.$emit("clear-error"))})]),default:t(()=>[r("div",lt,[e(D,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),r("div",null,[i[24]||(i[24]=r("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),r("div",st,k(s(ae)),1)])])]),_:1},8,["model-value"]))]),_:1},8,["modelValue"]))}}),nt=Ce(ot,[["__scopeId","data-v-ac306eff"]]),it={class:"d-flex gap-2"},rt={key:0,class:"mt-4"},ut={class:"d-flex align-center gap-2 flex-wrap"},dt=pe({__name:"SupplierSearchFilters",props:{filters:{},loading:{type:Boolean,default:!1}},emits:["update:filters","search","reset"],setup(F,{emit:u}){let o=null;const h=(m,a=500)=>{o&&clearTimeout(o),o=setTimeout(m,a)},V=F,x=u,p=f({...V.filters});ve(()=>V.filters,m=>{p.value={...m}},{deep:!0});const b=(m,a)=>{p.value[m]=a,m!=="search"?x("update:filters",{...p.value}):h(()=>{x("update:filters",{...p.value})})},E=()=>{x("search")},U=()=>{const m={search:"",status:void 0,city:"",province:""};p.value={...m},x("update:filters",m),x("reset")},S=[{title:"Semua Status",value:void 0},{title:"Aktif",value:"active"},{title:"Nonaktif",value:"inactive"}],c=A(()=>!!(p.value.search||p.value.status||p.value.city||p.value.province));return(m,a)=>(v(),C(j,null,{default:t(()=>[e(O,null,{default:t(()=>[e(he,null,{default:t(()=>[e(y,{cols:"12",md:"4"},{default:t(()=>[e(T,{modelValue:p.value.search,"onUpdate:modelValue":[a[0]||(a[0]=_=>p.value.search=_),a[1]||(a[1]=_=>b("search",_))],placeholder:"Cari nama, kode, atau email supplier...","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined",onKeydown:Re(E,["enter"])},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:t(()=>[e($e,{modelValue:p.value.status,"onUpdate:modelValue":[a[2]||(a[2]=_=>p.value.status=_),a[3]||(a[3]=_=>b("status",_))],items:S,"item-title":"title","item-value":"value",placeholder:"Status",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:t(()=>[e(T,{modelValue:p.value.city,"onUpdate:modelValue":[a[4]||(a[4]=_=>p.value.city=_),a[5]||(a[5]=_=>b("city",_))],placeholder:"Kota",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:t(()=>[e(T,{modelValue:p.value.province,"onUpdate:modelValue":[a[6]||(a[6]=_=>p.value.province=_),a[7]||(a[7]=_=>b("province",_))],placeholder:"Provinsi",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:t(()=>[r("div",it,[e(J,{color:"primary",loading:m.loading,onClick:E},{default:t(()=>[e(D,{icon:"tabler-search"}),a[12]||(a[12]=P(" Cari "))]),_:1,__:[12]},8,["loading"]),c.value?(v(),C(J,{key:0,variant:"outlined",color:"secondary",onClick:U},{default:t(()=>[e(D,{icon:"tabler-x"}),a[13]||(a[13]=P(" Reset "))]),_:1,__:[13]})):R("",!0)])]),_:1})]),_:1}),c.value?(v(),$("div",rt,[r("div",ut,[a[14]||(a[14]=r("span",{class:"text-caption text-medium-emphasis"},"Filter aktif:",-1)),p.value.search?(v(),C(ie,{key:0,size:"small",closable:"","onClick:close":a[8]||(a[8]=_=>b("search",""))},{default:t(()=>[P(" Pencarian: "+k(p.value.search),1)]),_:1})):R("",!0),p.value.status?(v(),C(ie,{key:1,size:"small",closable:"","onClick:close":a[9]||(a[9]=_=>b("status",void 0))},{default:t(()=>[P(" Status: "+k(p.value.status==="active"?"Aktif":"Nonaktif"),1)]),_:1})):R("",!0),p.value.city?(v(),C(ie,{key:2,size:"small",closable:"","onClick:close":a[10]||(a[10]=_=>b("city",""))},{default:t(()=>[P(" Kota: "+k(p.value.city),1)]),_:1})):R("",!0),p.value.province?(v(),C(ie,{key:3,size:"small",closable:"","onClick:close":a[11]||(a[11]=_=>b("province",""))},{default:t(()=>[P(" Provinsi: "+k(p.value.province),1)]),_:1})):R("",!0)])])):R("",!0)]),_:1})]),_:1}))}}),ct={class:"d-flex align-center"},pt={class:"text-h6 font-weight-semibold"},mt={key:1},vt={class:"d-flex align-center"},ft={class:"text-h6 font-weight-semibold"},gt={key:1},ht={class:"d-flex align-center"},_t={class:"text-h6 font-weight-semibold"},bt={key:1},yt={class:"d-flex align-center"},kt={class:"text-h6 font-weight-semibold"},Vt={key:1},xt={class:"d-flex align-center"},St={class:"text-h6 font-weight-semibold"},wt={key:1},$t={class:"d-flex align-center"},Ct={class:"text-h6 font-weight-semibold"},Pt={key:1},Et=pe({__name:"SupplierStatsCards",props:{stats:{},loading:{type:Boolean,default:!1}},setup(F){return(u,o)=>(v(),C(he,null,{default:t(()=>[e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(j,null,{default:t(()=>[e(O,null,{default:t(()=>[r("div",ct,[e(ee,{color:"primary",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-building-store"})]),_:1}),r("div",null,[o[0]||(o[0]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Supplier",-1)),r("h6",pt,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",mt,k(u.stats.total_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(j,null,{default:t(()=>[e(O,null,{default:t(()=>[r("div",vt,[e(ee,{color:"success",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-check"})]),_:1}),r("div",null,[o[1]||(o[1]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Supplier Aktif",-1)),r("h6",ft,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",gt,k(u.stats.active_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(j,null,{default:t(()=>[e(O,null,{default:t(()=>[r("div",ht,[e(ee,{color:"info",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-shopping-cart"})]),_:1}),r("div",null,[o[2]||(o[2]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Dengan Pembelian",-1)),r("h6",_t,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",bt,k(u.stats.suppliers_with_purchases.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(j,null,{default:t(()=>[e(O,null,{default:t(()=>[r("div",yt,[e(ee,{color:"warning",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-map-pin"})]),_:1}),r("div",null,[o[3]||(o[3]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Kota",-1)),r("h6",kt,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",Vt,k(u.stats.total_cities.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(j,null,{default:t(()=>[e(O,null,{default:t(()=>[r("div",xt,[e(ee,{color:"error",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-x"})]),_:1}),r("div",null,[o[4]||(o[4]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Supplier Nonaktif",-1)),r("h6",St,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",wt,k(u.stats.inactive_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(j,null,{default:t(()=>[e(O,null,{default:t(()=>[r("div",$t,[e(ee,{color:"secondary",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-map"})]),_:1}),r("div",null,[o[5]||(o[5]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Provinsi",-1)),r("h6",Ct,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",Pt,k(u.stats.total_provinces.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ut={class:"font-weight-medium"},Dt={class:"d-flex align-center"},Ft={class:"text-sm font-weight-medium"},Nt={class:"font-weight-medium"},At={key:0,class:"text-caption text-medium-emphasis"},Tt=["href"],zt={key:1,class:"text-medium-emphasis"},Lt=["href"],Mt={key:1,class:"text-medium-emphasis"},Rt={key:0},Kt={key:0,class:"font-weight-medium"},Bt={key:1,class:"text-caption text-medium-emphasis"},It={key:1,class:"text-medium-emphasis"},jt={class:"d-flex gap-1"},Ot={class:"text-center py-8"},Gt=pe({__name:"SupplierTable",props:{suppliers:{},loading:{type:Boolean,default:!1},totalItems:{default:0},page:{default:1},itemsPerPage:{default:10}},emits:["edit","delete","update:page","update:itemsPerPage","sort"],setup(F,{emit:u}){const o=u,h=[{title:"Kode",key:"code",sortable:!0},{title:"Nama",key:"name",sortable:!0},{title:"Email",key:"email",sortable:!0},{title:"Telepon",key:"phone",sortable:!1},{title:"Kota",key:"city",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Aksi",key:"actions",sortable:!1,align:"center"}],V=c=>c==="active"?"success":"error",x=c=>c==="active"?"Aktif":"Nonaktif",p=c=>{o("edit",c)},b=c=>{o("delete",c)},E=c=>{o("update:page",c)},U=c=>{o("update:itemsPerPage",c)},S=c=>{if(c&&c.length>0){const m=c[0],a=m.order==="desc"?"-":"";o("sort",`${a}${m.key}`)}};return(c,m)=>(v(),C(j,null,{default:t(()=>[e(O,{class:"pa-0"},{default:t(()=>[e(qe,{page:c.page,"items-per-page":c.itemsPerPage,headers:h,items:c.suppliers,"items-length":c.totalItems,loading:c.loading,"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],"loading-text":"Memuat data supplier...","no-data-text":"Tidak ada data supplier","items-per-page-text":"Supplier per halaman:","page-text":"{0}-{1} dari {2}",class:"text-no-wrap","onUpdate:page":E,"onUpdate:itemsPerPage":U,"onUpdate:sortBy":S},{"item.code":t(({item:a})=>[r("div",Ut,k(a.code),1)]),"item.name":t(({item:a})=>[r("div",Dt,[e(ee,{size:"32",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[r("span",Ft,k(a.name.charAt(0).toUpperCase()),1)]),_:2},1024),r("div",null,[r("div",Nt,k(a.name),1),a.contact_person?(v(),$("div",At,k(a.contact_person),1)):R("",!0)])])]),"item.email":t(({item:a})=>[a.email?(v(),$("a",{key:0,href:`mailto:${a.email}`,class:"text-decoration-none"},k(a.email),9,Tt)):(v(),$("span",zt,"-"))]),"item.phone":t(({item:a})=>[a.phone?(v(),$("a",{key:0,href:`tel:${a.phone}`,class:"text-decoration-none"},k(a.phone),9,Lt)):(v(),$("span",Mt,"-"))]),"item.city":t(({item:a})=>[a.city||a.province?(v(),$("div",Rt,[a.city?(v(),$("div",Kt,k(a.city),1)):R("",!0),a.province?(v(),$("div",Bt,k(a.province),1)):R("",!0)])):(v(),$("span",It,"-"))]),"item.status":t(({item:a})=>[e(ie,{color:V(a.status),variant:"tonal",size:"small"},{default:t(()=>[P(k(x(a.status)),1)]),_:2},1032,["color"])]),"item.actions":t(({item:a})=>[r("div",jt,[e(J,{icon:"",size:"small",color:"primary",variant:"text",onClick:_=>p(a)},{default:t(()=>[e(D,{icon:"tabler-edit"}),e(Se,{activator:"parent",location:"top"},{default:t(()=>m[0]||(m[0]=[P(" Edit Supplier ")])),_:1,__:[0]})]),_:2},1032,["onClick"]),e(J,{icon:"",size:"small",color:"error",variant:"text",onClick:_=>b(a)},{default:t(()=>[e(D,{icon:"tabler-trash"}),e(Se,{activator:"parent",location:"top"},{default:t(()=>m[1]||(m[1]=[P(" Hapus Supplier ")])),_:1,__:[1]})]),_:2},1032,["onClick"])])]),loading:t(()=>[(v(),$(Ke,null,Be(5,a=>e(te,{key:a,type:"table-row",class:"border-b"})),64))]),"no-data":t(()=>[r("div",Ot,[e(D,{icon:"tabler-building-store",size:"48",class:"text-medium-emphasis mb-4"}),m[2]||(m[2]=r("div",{class:"text-h6 mb-2"},"Tidak ada data supplier",-1)),m[3]||(m[3]=r("p",{class:"text-medium-emphasis mb-0"}," Silakan tambah supplier baru atau ubah filter pencarian ",-1))])]),_:1},8,["page","items-per-page","items","items-length","loading"])]),_:1})]),_:1}))}}),q="/api/suppliers";class I{static async getAll(u={}){var o;try{const h=new URLSearchParams;Object.entries(u).forEach(([p,b])=>{b!=null&&b!==""&&h.append(p,String(b))});const V=`${q}?${h.toString()}`;return(await X.get(V)).data}catch(h){throw console.error("SuppliersApi.getAll error:",h),((o=h.response)==null?void 0:o.data)||{success:!1,message:"Failed to fetch suppliers"}}}static async getById(u){var o;try{return(await X.get(`${q}/${u}`)).data}catch(h){throw((o=h.response)==null?void 0:o.data)||{success:!1,message:"Failed to fetch supplier"}}}static async create(u){var o;try{return(await X.post(q,u)).data}catch(h){throw((o=h.response)==null?void 0:o.data)||{success:!1,message:"Failed to create supplier"}}}static async update(u,o){var h;try{return(await X.put(`${q}/${u}`,o)).data}catch(V){throw((h=V.response)==null?void 0:h.data)||{success:!1,message:"Failed to update supplier"}}}static async delete(u){var o;try{return(await X.delete(`${q}/${u}`)).data}catch(h){throw((o=h.response)==null?void 0:o.data)||{success:!1,message:"Failed to delete supplier"}}}static async toggleActive(u){var o;try{return(await X.put(`${q}/${u}/toggle-active`)).data}catch(h){throw((o=h.response)==null?void 0:o.data)||{success:!1,message:"Failed to toggle supplier status"}}}static async getStats(){var u;try{return(await X.get(`${q}/stats`)).data}catch(o){throw((u=o.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch supplier statistics"}}}static async getCities(){var u;try{return(await X.get(`${q}/cities`)).data}catch(o){throw((u=o.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch cities"}}}static async getProvinces(){var u;try{return(await X.get(`${q}/provinces`)).data}catch(o){throw((u=o.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch provinces"}}}static validateEmail(u){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)?{valid:!0}:{valid:!1,error:"Please enter a valid email address"}}static validatePhone(u){return/^[\+]?[\d\s\-\(\)]{7,20}$/.test(u)?{valid:!0}:{valid:!1,error:"Please enter a valid phone number"}}static validateCode(u){return u.length<3?{valid:!1,error:"Supplier code must be at least 3 characters"}:u.length>50?{valid:!1,error:"Supplier code must not exceed 50 characters"}:{valid:!0}}}const Wt=()=>{const F=f([]),u=f([]),o=f([]),h=f(!1),V=f(!1),x=f(!1),p=f({}),b=f({total_suppliers:0,active_suppliers:0,inactive_suppliers:0,suppliers_with_purchases:0,total_cities:0,total_provinces:0}),E=f(!1),U=f(!1),S=f(!1),c=f(null),m=f([]),a=f(1),_=f(0),B=f(15),K=ke({search:"",status:void 0,city:"",province:"",sort_by:"created_at",sort_order:"desc"}),N=f(""),z=f(""),L=f(""),G=ke({name:"",code:"",contact_person:"",phone:"",email:"",address:"",city:"",province:"",postal_code:"",tax_number:"",bank_name:"",bank_account:"",bank_account_name:"",status:"active",notes:""}),Q=[l=>!!l||"Nama supplier wajib diisi",l=>l.length>=2||"Nama supplier minimal 2 karakter",l=>l.length<=255||"Nama supplier maksimal 255 karakter"],W=[l=>{if(!l)return!0;const g=I.validateCode(l);return g.valid||g.error}],H=[l=>{if(!l)return!0;const g=I.validateEmail(l);return g.valid||g.error}],re=[l=>{if(!l)return!0;const g=I.validatePhone(l);return g.valid||g.error}],Y=A(()=>!0),ue=A(()=>!0),de=A(()=>b.value.active_suppliers),ae=A(()=>b.value.inactive_suppliers),le=A(()=>b.value.suppliers_with_purchases),se=A(()=>b.value.total_cities),oe=A(()=>b.value.total_provinces),n=A(()=>m.value.length>0),i=A(()=>F.value.length),d=async()=>{try{h.value=!0,N.value="";const l={...K,page:a.value,per_page:B.value};Object.keys(l).forEach(ne=>{(l[ne]===""||l[ne]==="all")&&delete l[ne]});const g=await I.getAll(l);if(g.success)F.value=g.data,g.pagination&&(_.value=g.pagination.total,a.value=g.pagination.current_page);else throw new Error(g.message)}catch(l){console.error("Error fetching suppliers:",l),N.value=l.message||"Gagal mengambil data supplier",F.value=[]}finally{h.value=!1}},fe=async()=>{try{const l=await I.getCities();l.success&&(u.value=l.data)}catch(l){console.error("Error fetching cities:",l)}},ge=async()=>{try{const l=await I.getProvinces();l.success&&(o.value=l.data)}catch(l){console.error("Error fetching provinces:",l)}},ce=async()=>{try{const l=await I.getStats();l.success&&(b.value=l.data)}catch(l){console.error("Error fetching stats:",l)}},M=async l=>{try{V.value=!0,L.value="";let g;if(S.value&&c.value?g=await I.update(c.value.id_supplier,l):g=await I.create(l),g.success)z.value=g.message||"Supplier saved successfully",_e(),await d(),await ce();else throw new Error(g.message)}catch(g){console.error("Error saving supplier:",g),L.value=g.errors||g.message}finally{V.value=!1}},me=async()=>{if(c.value)try{x.value=!0;const l=await I.delete(c.value.id_supplier);if(l.success)z.value=l.message,U.value=!1,await d(),await ce();else throw new Error(l.message)}catch(l){console.error("Error deleting supplier:",l),N.value=l.message||"Gagal menghapus supplier"}finally{x.value=!1}},Z=async l=>{try{p.value[l.id_supplier]=!0;const g=await I.toggleActive(l.id_supplier);if(g.success){const ne=F.value.findIndex(Te=>Te.id_supplier===l.id_supplier);ne!==-1&&(F.value[ne]=g.data),await ce()}else throw new Error(g.message)}catch(g){console.error("Error toggling active status:",g),N.value=g.message||"Gagal mengubah status supplier"}finally{p.value[l.id]=!1}},Pe=()=>{S.value=!1,c.value=null,be(),E.value=!0},Ee=l=>{S.value=!0,c.value=l,De(l),E.value=!0},Ue=l=>{c.value=l,U.value=!0},_e=()=>{E.value=!1,L.value="",be()},be=()=>{Object.assign(G,{name:"",code:"",contact_person:"",phone:"",email:"",address:"",city:"",province:"",postal_code:"",tax_number:"",payment_terms:null,active:!0,notes:""})},De=l=>{Object.assign(G,{name:l.name,code:l.code||"",contact_person:l.contact_person||"",phone:l.phone||"",email:l.email||"",address:l.address||"",city:l.city||"",province:l.province||"",postal_code:l.postal_code||"",tax_number:l.tax_number||"",bank_name:l.bank_name||"",bank_account:l.bank_account||"",bank_account_name:l.bank_account_name||"",status:l.status,notes:l.notes||""})},Fe=()=>{L.value=""},Ne=l=>{a.value=l,d()},Ae=()=>{a.value=1,d()},ye=()=>{a.value=1,d()};return{suppliersList:F,cities:u,provinces:o,loading:h,saveLoading:V,deleteLoading:x,toggleLoading:p,stats:b,dialog:E,deleteDialog:U,editMode:S,selectedSupplier:c,selectedSuppliers:m,currentPage:a,totalItems:_,itemsPerPage:B,filters:K,errorMessage:N,successMessage:z,modalErrorMessage:L,formData:G,nameRules:Q,codeRules:W,emailRules:H,phoneRules:re,canCreateEdit:Y,canDelete:ue,totalActiveSuppliers:de,totalInactiveSuppliers:ae,totalSuppliersWithPurchases:le,totalCities:se,totalProvinces:oe,hasSelectedSuppliers:n,filteredSuppliersCount:i,fetchSuppliersList:d,fetchCities:fe,fetchProvinces:ge,fetchStats:ce,saveSupplier:M,deleteSupplier:me,toggleActiveStatus:Z,openCreateDialog:Pe,openEditDialog:Ee,openDeleteDialog:Ue,closeDialog:_e,clearModalError:Fe,onPageChange:Ne,onSearch:Ae,onFilterChange:ye,handleFiltersUpdate:l=>{Object.assign(K,l),ye()},onSortChange:()=>{a.value=1,d()},resetFilters:()=>{Object.assign(K,{search:"",active:"all",city:"",province:"",sort_by:"created_at",sort_order:"desc"}),a.value=1,d()},toggleSupplierSelection:l=>{const g=m.value.indexOf(l);g>-1?m.value.splice(g,1):m.value.push(l)},selectAllSuppliers:()=>{m.value.length===F.value.length?m.value=[]:m.value=F.value.map(l=>l.id)}}},Ht={class:"supplier-management"},Xt={class:"d-flex justify-space-between align-center mb-6"},qt={class:"d-flex gap-3 align-center"},Jt={key:0,class:"d-flex gap-2"},Qt=pe({__name:"suppliers-management",setup(F){const{suppliersList:u,cities:o,provinces:h,loading:V,saveLoading:x,deleteLoading:p,toggleLoading:b,stats:E,dialog:U,deleteDialog:S,selectedSupplier:c,selectedSuppliers:m,currentPage:a,totalItems:_,itemsPerPage:B,filters:K,errorMessage:N,successMessage:z,modalErrorMessage:L,canCreateEdit:G,hasSelectedSuppliers:Q,fetchSuppliersList:W,fetchCities:H,fetchProvinces:re,fetchStats:Y,saveSupplier:ue,deleteSupplier:de,toggleActiveStatus:ae,openCreateDialog:le,openEditDialog:se,openDeleteDialog:oe,closeDialog:n,clearModalError:i,onPageChange:d,handleFiltersUpdate:fe}=Wt(),ge=async()=>{await de()};return Ie(()=>{W(),H(),re(),Y()}),(ce,M)=>{var me;return v(),$("div",Ht,[r("div",Xt,[M[5]||(M[5]=r("div",null,[r("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Supplier"),r("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola data supplier dan vendor untuk coffee shop Anda")],-1)),r("div",qt,[s(Q)?(v(),$("div",Jt,[e(ie,{color:"primary",size:"small"},{default:t(()=>[P(k(s(m).length)+" dipilih ",1)]),_:1})])):R("",!0),s(G)?(v(),C(J,{key:1,color:"primary",variant:"elevated","prepend-icon":"tabler-plus",onClick:s(le)},{default:t(()=>M[4]||(M[4]=[P(" Tambah Supplier ")])),_:1,__:[4]},8,["onClick"])):R("",!0)])]),e(Et,{stats:s(E),loading:s(V),class:"mb-6"},null,8,["stats","loading"]),e(dt,{filters:s(K),cities:s(o),provinces:s(h),loading:s(V),"onUpdate:filters":s(fe),onSearch:s(W),onReset:s(W),class:"mb-6"},null,8,["filters","cities","provinces","loading","onUpdate:filters","onSearch","onReset"]),s(z)?(v(),C(we,{key:0,type:"success",variant:"tonal",closable:"",class:"mb-4","onClick:close":M[0]||(M[0]=Z=>z.value="")},{default:t(()=>[P(k(s(z)),1)]),_:1})):R("",!0),s(N)?(v(),C(we,{key:1,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":M[1]||(M[1]=Z=>N.value="")},{default:t(()=>[P(k(s(N)),1)]),_:1})):R("",!0),e(j,null,{default:t(()=>[e(O,{class:"pa-0"},{default:t(()=>[e(Gt,{suppliers:s(u),loading:s(V),"toggle-loading":s(b),"current-page":s(a),"total-items":s(_),"items-per-page":s(B),"selected-suppliers":s(m),"can-create-edit":s(G),onEdit:s(se),onDelete:s(oe),onToggleActive:s(ae),onPageChange:s(d)},null,8,["suppliers","loading","toggle-loading","current-page","total-items","items-per-page","selected-suppliers","can-create-edit","onEdit","onDelete","onToggleActive","onPageChange"])]),_:1})]),_:1}),e(nt,{modelValue:s(U),"onUpdate:modelValue":M[2]||(M[2]=Z=>w(U)?U.value=Z:null),supplier:s(c),loading:s(x),"error-message":s(L),onSave:s(ue),onClose:s(n),onClearError:s(i)},null,8,["modelValue","supplier","loading","error-message","onSave","onClose","onClearError"]),e(ze,{modelValue:s(S),"onUpdate:modelValue":M[3]||(M[3]=Z=>w(S)?S.value=Z:null),loading:s(p),"item-name":(me=s(c))==null?void 0:me.name,"item-type":"supplier",onConfirm:ge},null,8,["modelValue","loading","item-name"])])}}}),Na=Ce(Qt,[["__scopeId","data-v-db136099"]]);export{Na as default};
