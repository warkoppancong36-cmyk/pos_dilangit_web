import{au as fe,d as Dt,r as v,V as ae,w as Mt,g as V,f as o,b as t,s as i,X as I,t as u,l as x,c as J,at as oe,e as n,aw as ut,a1 as S,o as g,_ as Ct,ay as Vt,aX as $t,D as Rt,m as a,a3 as ze,F as jt,i as Lt,p as Ge,a0 as Xe,a5 as zt,az as nt,as as Bt}from"./main-6xlu64eg.js";import{V as Se}from"./VDialog-BcsqGSY-.js";import{b as pe,c as De,V as O}from"./VCard-Cp_HoDs6.js";import{V as X}from"./VDivider-BUbZT-W8.js";import{V as H}from"./VCardText-CvGRcQkk.js";import{V as Et,a as Ft}from"./VDataTable-CaNnZB5T.js";import{V as U}from"./VChip-RntlqYYJ.js";import{V as Ve}from"./VSpacer-COEtdWUf.js";import{I as Nt}from"./ItemsApi--rB5J0O-.js";import{u as Ot}from"./useApi-AreEltAQ.js";import{V as ge,a as z}from"./VRow-DkH9SmyI.js";import{V as de}from"./VTextField-Bi6EgPZJ.js";import{V as rt}from"./VSelect-BYzrQuOv.js";import{V as qt}from"./VDataTableServer-BEZS_lKM.js";import{V as Je}from"./VTooltip-vXJDMM00.js";import{V as We}from"./VForm-HgiE4rtv.js";import{V as it}from"./VTextarea-RkNRGUxe.js";import{V as Tt}from"./VAvatar-CMiEZhFT.js";import"./VOverlay-CH5fMdgO.js";import"./forwardRefs-B931MWyl.js";import"./VImg-B2Kluknj.js";import"./VCheckboxBtn-fEpLGgvk.js";import"./VTable-nBYgBm-v.js";import"./filter-Bv_F0Bql.js";/* empty css              */import"./VList-4CqWsaE9.js";import"./VMenu-CcEC639u.js";const me="/api/inventory";class se{static async getAll(c){var p;try{return(await fe.get(me,{params:c})).data}catch(_){throw((p=_.response)==null?void 0:p.data)||this.handleError(_)}}static async getById(c){var p;try{return(await fe.get(`${me}/${c}`)).data}catch(_){throw((p=_.response)==null?void 0:p.data)||this.handleError(_)}}static async getStats(){var c;try{return(await fe.get(`${me}/stats`)).data}catch(p){throw((c=p.response)==null?void 0:c.data)||this.handleError(p)}}static async getLowStockAlerts(){var c;try{return(await fe.get(`${me}/low-stock-alerts`)).data}catch(p){throw((c=p.response)==null?void 0:c.data)||this.handleError(p)}}static async updateStock(c,p){var _;try{return(await fe.post(`${me}/${c}/update-stock`,p)).data}catch(D){throw((_=D.response)==null?void 0:_.data)||this.handleError(D)}}static async bulkUpdateStock(c){var p;try{return(await fe.post(`${me}/bulk-update-stock`,c)).data}catch(_){throw((p=_.response)==null?void 0:p.data)||this.handleError(_)}}static async setReorderLevel(c,p){var _;try{return(await fe.post(`${me}/${c}/reorder-level`,p)).data}catch(D){throw((_=D.response)==null?void 0:_.data)||this.handleError(D)}}static async getMovements(c){var p;try{const _=c!=null&&c.id_inventory?`${me}/${c.id_inventory}/movements`:`${me}/movements`;return(await fe.get(_,{params:c})).data}catch(_){throw((p=_.response)==null?void 0:p.data)||this.handleError(_)}}static async recordMovement(c){var p;try{return(await fe.post(`${me}/movement`,c)).data}catch(_){throw((p=_.response)==null?void 0:p.data)||this.handleError(_)}}static handleError(c){var p,_;return c.response?{message:((p=c.response.data)==null?void 0:p.message)||"Terjadi kesalahan pada server",success:!1,errors:(_=c.response.data)==null?void 0:_.errors}:c.request?{message:"Tidak dapat terhubung ke server",success:!1}:{message:c.message||"Terjadi kesalahan yang tidak diketahui",success:!1}}static formatError(c){return c.errors?Object.values(c.errors).flat().join(", "):c.message||"Terjadi kesalahan yang tidak diketahui"}static isValidationError(c){return c.errors&&typeof c.errors=="object"}static getFieldError(c,p){return c.errors&&c.errors[p]?Array.isArray(c.errors[p])?c.errors[p][0]:c.errors[p]:null}static getMovementTypes(){return[{value:"stock_in",label:"Stock Masuk",color:"success"},{value:"stock_out",label:"Stock Keluar",color:"warning"},{value:"adjustment",label:"Penyesuaian",color:"info"},{value:"transfer",label:"Transfer",color:"primary"},{value:"return",label:"Retur",color:"success"},{value:"damaged",label:"Rusak",color:"error"},{value:"expired",label:"Kadaluarsa",color:"error"}]}static getStockStatusOptions(){return[{value:"all",label:"Semua Status"},{value:"in_stock",label:"Tersedia"},{value:"low_stock",label:"Stok Menipis"},{value:"out_of_stock",label:"Habis"},{value:"overstock",label:"Stok Berlebih"}]}}const Kt={key:1,class:"text-center py-8"},Ht={class:"font-weight-medium"},Gt={class:"text-medium-emphasis"},Xt={class:"text-center"},Jt={class:"text-center font-weight-medium"},Wt={class:"text-center font-weight-bold text-primary"},Yt={class:"text-end"},Qt={class:"text-end font-weight-medium text-success"},Zt={class:"max-width-200"},ea={class:"font-weight-medium"},ta={key:0,class:"text-medium-emphasis"},aa={key:1,class:"d-block text-caption"},oa={key:2,class:"text-info d-block"},sa={class:"text-center py-8"},la=Dt({__name:"InventoryMovementsDialog",props:{modelValue:{type:Boolean},inventoryId:{},inventoryName:{}},emits:["update:modelValue"],setup(ne,{emit:c}){const p=ne,_=c,D=v([]),Y=v(!1),G=v(""),B=ae({get:()=>p.modelValue,set:y=>_("update:modelValue",y)}),ee=async()=>{var y,b,l,M;if(p.inventoryId)try{Y.value=!0,G.value="";const T=await se.getMovements({id_inventory:parseInt(p.inventoryId),page:1,per_page:50});T.data&&Array.isArray(T.data)?D.value=T.data:T.data&&((y=T==null?void 0:T.data)!=null&&y.data)&&Array.isArray((b=T==null?void 0:T.data)==null?void 0:b.data)?D.value=T.data.data:D.value=[]}catch(T){console.error("Error fetching movements:",T),G.value=((M=(l=T.response)==null?void 0:l.data)==null?void 0:M.message)||"Gagal memuat riwayat pergerakan"}finally{Y.value=!1}},le=y=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(y),Q=y=>({in:"success",out:"error",stock_in:"success",stock_out:"error",adjustment:"warning",transfer:"info",return:"secondary"})[y]||"primary",Z=y=>({in:"Stock Masuk",out:"Stock Keluar",stock_in:"Stock Masuk",stock_out:"Stock Keluar",adjustment:"Penyesuaian",transfer:"Transfer",return:"Retur"})[y]||y,$=y=>({in:"tabler-plus",out:"tabler-minus",stock_in:"tabler-plus",stock_out:"tabler-minus",adjustment:"tabler-edit",transfer:"tabler-arrows-exchange",return:"tabler-arrow-back"})[y]||"tabler-package";return Mt(B,y=>{y&&p.inventoryId?ee():(D.value=[],G.value="")}),(y,b)=>(g(),V(Se,{modelValue:B.value,"onUpdate:modelValue":b[1]||(b[1]=l=>B.value=l),"max-width":"900px",scrollable:""},{default:o(()=>[t(O,null,{default:o(()=>[t(pe,{class:"d-flex align-center"},{default:o(()=>[t(I,{icon:"tabler-history",class:"me-2"}),i(" Riwayat Pergerakan - "+u(y.inventoryName),1)]),_:1}),t(X),t(H,{class:"pa-0"},{default:o(()=>[G.value?(g(),V(oe,{key:0,type:"error",variant:"tonal",class:"ma-4"},{default:o(()=>[i(u(G.value),1)]),_:1})):x("",!0),Y.value?(g(),J("div",Kt,[t(ut,{indeterminate:"",color:"primary",size:"40"}),b[2]||(b[2]=n("div",{class:"mt-4 text-medium-emphasis"}," Memuat riwayat pergerakan... ",-1))])):(g(),V(Et,{key:2,headers:[{title:"Tanggal",key:"created_at",sortable:!1},{title:"Jenis",key:"movement_type",sortable:!1},{title:"Kuantitas",key:"quantity",sortable:!1},{title:"Stok Sebelum",key:"stock_before",sortable:!1},{title:"Stok Sesudah",key:"stock_after",sortable:!1},{title:"Harga/Unit",key:"unit_cost",sortable:!1},{title:"Total Nilai",key:"total_cost",sortable:!1},{title:"Catatan",key:"notes",sortable:!1}],items:D.value,loading:Y.value,class:"text-no-wrap","items-per-page":"15",height:"500","fixed-header":""},{"item.created_at":o(({item:l})=>[n("div",null,[n("div",Ht,u(new Date(l.created_at).toLocaleDateString("id-ID")),1),n("small",Gt,u(new Date(l.created_at).toLocaleTimeString("id-ID")),1)])]),"item.movement_type":o(({item:l})=>[t(U,{color:Q(l.movement_type),variant:"tonal",size:"small","prepend-icon":$(l.movement_type)},{default:o(()=>[i(u(Z(l.movement_type)),1)]),_:2},1032,["color","prepend-icon"])]),"item.quantity":o(({item:l})=>[n("div",Xt,[t(U,{color:l.movement_type==="in"||l.movement_type==="stock_in"?"success":"error",variant:"outlined",size:"small"},{default:o(()=>[i(u(l.movement_type==="in"||l.movement_type==="stock_in"?"+":"-")+u(Math.abs(l.quantity)),1)]),_:2},1032,["color"])])]),"item.stock_before":o(({item:l})=>[n("div",Jt,u(l.stock_before),1)]),"item.stock_after":o(({item:l})=>[n("div",Wt,u(l.stock_after),1)]),"item.unit_cost":o(({item:l})=>[n("div",Yt,u(l.unit_cost?le(l.unit_cost):"-"),1)]),"item.total_cost":o(({item:l})=>[n("div",Qt,u(l.total_cost?le(l.total_cost):"-"),1)]),"item.notes":o(({item:l})=>[n("div",Zt,[n("div",ea,u(l.notes||"-"),1),l.reference_type&&l.reference_id?(g(),J("small",ta," Ref: "+u(l.reference_type)+"-"+u(l.reference_id),1)):x("",!0),l.batch_number?(g(),J("small",aa," Batch: "+u(l.batch_number),1)):x("",!0),l.user?(g(),J("small",oa," oleh: "+u(l.user.name),1)):x("",!0)])]),"no-data":o(()=>[n("div",sa,[t(I,{icon:"tabler-history-off",size:"48",class:"text-medium-emphasis mb-4"}),b[3]||(b[3]=n("div",{class:"text-h6 text-medium-emphasis mb-2"}," Belum ada riwayat pergerakan ",-1)),b[4]||(b[4]=n("div",{class:"text-body-2 text-medium-emphasis"}," Riwayat akan muncul setelah ada pergerakan stok ",-1))])]),_:1},8,["items","loading"]))]),_:1}),t(X),t(De,{class:"pa-4"},{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:b[0]||(b[0]=l=>B.value=!1)},{default:o(()=>b[5]||(b[5]=[i(" Tutup ")])),_:1,__:[5]}),t(S,{color:"primary","prepend-icon":"tabler-refresh",onClick:ee},{default:o(()=>b[6]||(b[6]=[i(" Refresh ")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),na=Ct(la,[["__scopeId","data-v-ca0277a4"]]),ra=()=>{const ne=v([]),c=v(!1),p=v(!1),_=v({total_items:0,low_stock_items:0,out_of_stock_items:0,overstock_items:0,total_stock_value:0,total_stock_quantity:0,total_reserved_stock:0,items_need_restock:0}),D=v([]),Y=v(!1),G=v([]),B=v(!1),ee=v(!1),le=v(!1),Q=v(!1),Z=v(!1),$=v(null),y=v([]),b=v(1),l=v(0),M=v(15),T=v({search:"",stock_status:"all",category_id:void 0,supplier_id:void 0,station:"all",sort_by:"current_stock",sort_order:"asc"}),re=v(""),F=v(""),q=v(""),ye=v({movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:void 0,notes:""}),be=v({reorder_level:0,max_stock_level:0}),ie=ae(()=>y.value.length>0),Me=ae(()=>_.value.total_stock_value),_e=ae(()=>_.value.low_stock_items),he=ae(()=>_.value.out_of_stock_items),ue=ae(()=>Math.ceil(l.value/M.value)),Ce=ae(()=>b.value<ue.value),Ee=ae(()=>b.value>1),Pe=ae(()=>({currentPage:b.value,totalPages:ue.value,totalItems:l.value,itemsPerPage:M.value,hasNext:Ce.value,hasPrev:Ee.value})),Be=[r=>r>0||"Kuantitas harus lebih dari 0",r=>Number.isInteger(r)||"Kuantitas harus berupa bilangan bulat"],Fe=[r=>!!r||"Alasan wajib diisi",r=>r&&r.length>=3||"Alasan minimal 3 karakter"],Ne=[r=>!r||r>=0||"Harga harus lebih dari atau sama dengan 0"],f=[{title:"Stock Masuk",value:"stock_in",color:"success"},{title:"Stock Keluar",value:"stock_out",color:"warning"},{title:"Penyesuaian",value:"adjustment",color:"info"},{title:"Transfer",value:"transfer",color:"primary"},{title:"Retur",value:"return",color:"success"}],K=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Menipis",value:"low_stock"},{title:"Habis",value:"out_of_stock"},{title:"Stok Berlebih",value:"overstock"}],C=async()=>{c.value=!0,re.value="";try{const r={...T.value,page:b.value,per_page:M.value};Object.keys(r).forEach(ve=>{const Ue=r[ve];(Ue===""||Ue===void 0||Ue===null||Ue==="all")&&delete r[ve]});const L=await se.getAll(r);if(L.success)ne.value=L.data.data||[],l.value=L.data.total||0,L.data.current_page&&(b.value=L.data.current_page);else throw new Error(L.message||"Gagal mengambil data inventory")}catch(r){console.error("Error fetching inventory:",r),re.value=se.formatError(r)||"Gagal mengambil data inventory",ne.value=[],l.value=0}finally{c.value=!1}},Oe=async()=>{try{const r=await se.getStats();r.success&&(_.value=r.data)}catch(r){console.error("Error fetching inventory stats:",r)}},xe=async()=>{B.value=!0;try{const r=await se.getLowStockAlerts();r.success&&(G.value=r.data.data||[])}catch(r){console.error("Error fetching low stock alerts:",r),G.value=[]}finally{B.value=!1}},Te=async r=>{Y.value=!0;try{const L=await se.getMovements({id_inventory:r,page:1,per_page:20});L.success&&(D.value=L.data)}catch(L){console.error("Error fetching movements:",L)}finally{Y.value=!1}},Ye=async()=>{if($.value){p.value=!0,q.value="";try{const r=await se.updateStock($.value.id_inventory,ye.value);if(r.success)F.value="Stock berhasil diperbarui",Ie(),await C(),await Oe(),await xe();else throw new Error(r.message||"Gagal memperbarui stock")}catch(r){console.error("Error updating stock:",r),q.value=se.formatError(r)||"Gagal memperbarui stock"}finally{p.value=!1}}},Ae=async()=>{if($.value){p.value=!0,q.value="";try{const r=await se.setReorderLevel($.value.id_inventory,be.value);if(r.success)F.value="Reorder level berhasil diperbarui",te(),await C();else throw new Error(r.message||"Gagal memperbarui reorder level")}catch(r){console.error("Error setting reorder level:",r),q.value=se.formatError(r)||"Gagal memperbarui reorder level"}finally{p.value=!1}}},$e=r=>{$.value=r,ye.value={movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:r.average_cost||void 0,notes:""},q.value="",ee.value=!0},Qe=r=>{$.value=r,be.value={reorder_level:r.reorder_level||0,max_stock_level:r.max_stock_level||0},q.value="",Z.value=!0},Re=r=>{$.value=r,Te(r.id_inventory),Q.value=!0},Ie=()=>{ee.value=!1,setTimeout(()=>{$.value=null,q.value=""},300)},te=()=>{Z.value=!1,setTimeout(()=>{$.value=null,q.value=""},300)};return{inventoryList:ne,loading:c,saveLoading:p,stats:_,movementsList:D,movementsLoading:Y,lowStockItems:G,alertsLoading:B,stockUpdateDialog:ee,bulkUpdateDialog:le,movementsDialog:Q,reorderDialog:Z,selectedInventory:$,selectedItems:y,currentPage:b,totalItems:l,itemsPerPage:M,filters:T,errorMessage:re,successMessage:F,modalErrorMessage:q,stockUpdateForm:ye,reorderForm:be,hasSelectedItems:ie,totalStockValue:Me,lowStockCount:_e,outOfStockCount:he,quantityRules:Be,reasonRules:Fe,costRules:Ne,movementTypeOptions:f,stockStatusOptions:K,fetchInventoryList:C,fetchStats:Oe,fetchLowStockAlerts:xe,fetchMovements:Te,updateStock:Ye,setReorderLevel:Ae,openStockUpdateDialog:$e,openReorderDialog:Qe,openMovementsDialog:Re,closeStockUpdateDialog:Ie,closeReorderDialog:te,closeMovementsDialog:()=>{Q.value=!1,setTimeout(()=>{$.value=null,D.value=[]},300)},clearModalError:()=>{q.value=""},onPageChange:r=>{r!==b.value&&(b.value=r,C())},onItemsPerPageChange:r=>{r!==M.value&&(M.value=r,b.value=1,C())},handleFiltersUpdate:r=>{T.value={...T.value,...r},b.value=1,C()},formatCurrency:r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),getStockStatusColor:r=>r.current_stock===0?"error":r.is_low_stock?"warning":"success",getStockStatusText:r=>r.current_stock===0?"Habis":r.reorder_level>0&&r.current_stock<=r.reorder_level?"Menipis":r.max_stock_level&&r.current_stock>r.max_stock_level?"Berlebih":"Tersedia",getMovementTypeColor:r=>({stock_in:"success",stock_out:"warning",adjustment:"info",transfer:"primary",return:"success",damaged:"error",expired:"error"})[r]||"grey",totalPages:ue,hasNextPage:Ce,hasPrevPage:Ee,paginationInfo:Pe}};function ia(ne){const c=v([]),p=v([]),_=v(!1),D=v(!1),Y=v({total_items:0,total_value:0,low_stock_items:0,out_of_stock_items:0,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}),G=v(1),B=v(0),ee=v(10),le=Vt({search:"",stock_status:"all",movement_type:"",date_from:"",date_to:"",item_id:void 0}),Q=v(!1),Z=v(!1),$=v(null),y=Vt({item_id:0,type:"in",quantity:0,notes:"",cost_per_unit:0}),b=v(""),l=v(""),M=v(""),T=ae(()=>!0),re=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],F=[{title:"Masuk",value:"in",color:"success",icon:"tabler-plus"},{title:"Keluar",value:"out",color:"error",icon:"tabler-minus"},{title:"Penyesuaian",value:"adjustment",color:"warning",icon:"tabler-adjustments"}],q=[{title:"Pembelian",value:"purchase"},{title:"Penjualan",value:"sale"},{title:"Produksi",value:"production"},{title:"Penyesuaian",value:"adjustment"},{title:"Kerusakan",value:"waste"}],ye=f=>f.current_stock<=0?{status:"out_of_stock",color:"error",text:"Habis",icon:"tabler-x"}:f.current_stock<=f.minimum_stock?{status:"low_stock",color:"warning",text:"Rendah",icon:"tabler-alert-triangle"}:{status:"in_stock",color:"success",text:"Tersedia",icon:"tabler-check"},be=f=>!f.maximum_stock||f.maximum_stock<=0?100:Math.round(f.current_stock/f.maximum_stock*100),ie=async()=>{_.value=!0;try{await new Promise(f=>setTimeout(f,1e3)),c.value=await Nt.getAll(),B.value=c.value.length,l.value=""}catch{b.value="Gagal memuat data items"}finally{_.value=!1}},Me=async f=>{_.value=!0;try{const K=await se.getMovements({id_inventory:f,page:G.value,per_page:ee.value});p.value=K.data.map(C=>({id:C.id_movement,item_id:C.id_inventory,type:C.movement_type,quantity:C.quantity,unit:"pcs",reference_id:C.reference_number?parseInt(C.reference_number):void 0,reference_type:C.reason,notes:C.notes,cost_per_unit:C.cost_per_unit,total_cost:C.total_cost,created_by:C.created_by,created_at:C.created_at,creator:C.user})),B.value=K.total}catch(K){console.error("Failed to fetch stock movements:",K),p.value=[]}finally{_.value=!1}},_e=async()=>{try{await ie();const f=c.value;Y.value={total_items:f.length,total_value:f.reduce((K,C)=>K+C.current_stock*C.cost_per_unit,0),low_stock_items:f.filter(K=>K.current_stock<=K.minimum_stock&&K.current_stock>0).length,out_of_stock_items:f.filter(K=>K.current_stock<=0).length,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}}catch(f){console.error("Failed to fetch stats:",f)}},he=async()=>{D.value=!0,M.value="";try{const f=await se.recordMovement({item_id:y.item_id,movement_type:y.type,quantity:y.quantity,notes:y.notes,cost_per_unit:y.cost_per_unit});if(f.success)l.value=`Stock ${y.type==="in"?"masuk":y.type==="out"?"keluar":"disesuaikan"} berhasil dicatat`,Pe(),await ie(),await _e(),ne&&ne();else throw new Error(f.message||"Gagal mencatat pergerakan stok")}catch(f){M.value=f.message||"Gagal mencatat pergerakan stok"}finally{D.value=!1}},ue=f=>{$.value=f,Object.assign(y,{item_id:f.id_item,type:"in",quantity:0,notes:"",cost_per_unit:f.cost_per_unit}),Q.value=!0},Ce=f=>{$.value=f,Object.assign(y,{item_id:f.id_item,type:"out",quantity:0,notes:"",cost_per_unit:f.cost_per_unit}),Q.value=!0},Ee=f=>{$.value=f,Object.assign(y,{item_id:f.id_item,type:"adjustment",quantity:f.current_stock,notes:"",cost_per_unit:f.cost_per_unit}),Z.value=!0},Pe=()=>{Q.value=!1,Z.value=!1,M.value="",$.value=null};return{itemsList:c,stockMovements:p,loading:_,saveLoading:D,stats:Y,currentPage:G,totalItems:B,itemsPerPage:ee,filters:le,movementDialog:Q,adjustmentDialog:Z,selectedItem:$,movementFormData:y,errorMessage:b,successMessage:l,modalErrorMessage:M,canManageStock:T,stockStatusOptions:re,movementTypeOptions:F,referenceTypeOptions:q,getStockStatus:ye,getStockPercentage:be,fetchItems:ie,fetchStockMovements:Me,fetchStats:_e,recordStockMovement:he,openStockInDialog:ue,openStockOutDialog:Ce,openAdjustmentDialog:Ee,closeMovementDialog:Pe,clearModalError:()=>{M.value=""},onPageChange:f=>{G.value=f,ie()},handleFiltersUpdate:f=>{Object.assign(le,f),G.value=1,ie()}}}const ua={class:"inventory-management"},ca={class:"d-flex justify-space-between align-center mb-6"},da={class:"d-flex gap-3 align-center"},ma={class:"d-flex align-center justify-space-between"},pa={class:"text-h4 font-weight-bold text-primary"},_a={class:"d-flex align-center justify-space-between"},va={class:"text-h4 font-weight-bold text-warning"},ka={class:"d-flex align-center justify-space-between"},fa={class:"text-h4 font-weight-bold text-error"},ga={class:"d-flex align-center justify-space-between"},ya={class:"text-h4 font-weight-bold text-success"},ba={class:"d-flex align-center justify-space-between"},ha={class:"d-flex align-center gap-3"},xa={class:"d-flex gap-2"},wa={class:"d-flex flex-wrap gap-2"},Sa={class:"d-flex align-center gap-2"},Va={class:"text-caption"},Ta={class:"table-container"},Da={class:"d-flex align-center"},Ma={class:"font-weight-medium"},Ca={class:"d-flex flex-column"},Ea={class:"text-primary font-weight-medium"},Pa={class:"text-medium-emphasis"},Ia={class:"text-center"},Ua={class:"text-h6 font-weight-bold"},Aa={key:0,class:"text-warning"},$a={class:"text-center"},Ra={class:"d-flex flex-column gap-1"},ja={key:2,class:"text-caption text-medium-emphasis"},La={class:"text-center"},za={class:"text-end"},Ba={class:"text-end font-weight-medium text-success"},Fa={class:"d-flex align-center gap-1"},Na={class:"text-center py-12"},Oa={class:"text-h5 text-medium-emphasis mb-2"},qa={class:"text-body-1 text-medium-emphasis mb-4"},Ka={key:0},Ha={key:0},Ga={key:1},Xa={key:2},Ja={key:1},Wa={class:"d-flex justify-center gap-3"},Ya={class:"text-center py-8"},Qa={class:"d-flex align-center gap-2"},Za={class:"d-flex align-center gap-3"},eo={class:"font-weight-bold"},to={class:"text-caption"},ao={class:"text-caption"},oo={class:"d-flex gap-3 justify-end"},so={class:"d-flex align-center gap-2"},lo={class:"text-white"},no={class:"d-flex align-center gap-3"},ro={class:"font-weight-bold"},io={class:"text-caption"},uo={class:"d-flex align-center gap-2"},co={key:0,class:"text-center py-8"},mo={key:1},po={class:"text-body-2"},_o={class:"d-flex align-center gap-2"},vo={class:"text-body-2 font-weight-medium"},ko={class:"text-caption text-medium-emphasis"},fo={class:"text-end font-weight-medium text-success"},go={class:"text-center py-8"},yo={key:0,class:"d-flex justify-center mt-4"},bo={class:"mb-4"},ho={class:"d-flex flex-column gap-2"},xo={class:"mb-4"},wo={class:"d-flex flex-column gap-2"},So=Dt({__name:"inventory-management",setup(ne){const{xs:c}=$t(),p=()=>{_e(),he(),ue()},{inventoryList:_,loading:D,saveLoading:Y,stats:G,lowStockItems:B,stockUpdateDialog:ee,reorderDialog:le,movementsDialog:Q,selectedInventory:Z,currentPage:$,totalItems:y,itemsPerPage:b,filters:l,errorMessage:M,successMessage:T,modalErrorMessage:re,stockUpdateForm:F,reorderForm:q,totalStockValue:ye,lowStockCount:be,outOfStockCount:ie,stockStatusOptions:Me,fetchInventoryList:_e,fetchStats:he,fetchLowStockAlerts:ue,updateStock:Ce,setReorderLevel:Ee,openStockUpdateDialog:Pe,openReorderDialog:Be,openMovementsDialog:Fe,closeStockUpdateDialog:Ne,closeReorderDialog:f,clearModalError:K,onPageChange:C,onItemsPerPageChange:Oe,handleFiltersUpdate:xe,formatCurrency:Te,getStockStatusColor:Ye,getStockStatusText:Ae}=ra(),{recordStockMovement:$e,openAdjustmentDialog:Qe,movementDialog:Re,adjustmentDialog:Ie,selectedItem:te,movementFormData:N,saveLoading:Ze,closeMovementDialog:je,successMessage:qe,modalErrorMessage:et,clearModalError:ct}=ia(p),dt=d=>d.item?{id_item:d.item.id_item,item_code:d.item.item_code,name:d.item.name,description:d.item.description||"",unit:d.item.unit,cost_per_unit:parseFloat(d.item.cost_per_unit),current_stock:d.current_stock,minimum_stock:d.reorder_level||0,active:!0,storage_location:d.item.storage_location||"",expiry_date:d.item.expiry_date||null,properties:d.item.properties||null,created_by:d.item.created_by||null,updated_by:d.item.updated_by||null,created_at:d.item.created_at,updated_at:d.item.updated_at,deleted_at:d.item.deleted_at||null}:null,mt=d=>{const e=dt(d);e&&Qe(e)},pt=ae(()=>G.value);ae(()=>_.value),ae(()=>D.value);const r=()=>{switch(l.value.station){case"kitchen":return"Menampilkan item yang hanya tersedia di Kitchen";case"bar":return"Menampilkan item yang hanya tersedia di Bar";case"both":return"Menampilkan item yang tersedia di Kitchen & Bar";case"all":default:return"Menampilkan item dari semua station"}};Rt(()=>{_e(),he(),ue()});const L=v(!1),ve=v(!1),Ue=()=>{ve.value=!0},Ke=()=>{ve.value=!1},_t=()=>{var A;console.log("🔍 === AUTH STATUS CHECK ===");const d=nt("accessToken").value,e=localStorage.getItem("token"),w=localStorage.getItem("auth_token"),E=localStorage.getItem("accessToken");console.log("🍪 Cookie accessToken:",d?`Found (${d.substring(0,20)}...)`:"Not found"),console.log("💾 localStorage token:",e?`Found (${e.substring(0,20)}...)`:"Not found"),console.log("💾 localStorage auth_token:",w?`Found (${w.substring(0,20)}...)`:"Not found"),console.log("💾 localStorage accessToken:",E?`Found (${E.substring(0,20)}...)`:"Not found");try{const P=Bt();console.log("🏪 Auth Store isLoggedIn:",P.isLoggedIn),console.log("🏪 Auth Store user:",((A=P.user)==null?void 0:A.name)||"No user"),console.log("🏪 Auth Store token:",P.token?`Found (${P.token.substring(0,20)}...)`:"Not found")}catch(P){console.log("🏪 Auth Store not available:",P)}return console.log("========================="),{cookieToken:d,localToken:e,authToken:w,accessToken:E}},tt=()=>{try{const d=_t(),e=nt("accessToken").value;if(console.log("🔍 Checking cookie token:",e?"Token found in cookie":"No token in cookie"),e)return console.log("✅ Using cookie token (first 20 chars):",e.substring(0,20)+"..."),e;console.log("🔍 Checking localStorage methods...");const w=localStorage.getItem("token")||localStorage.getItem("auth_token")||localStorage.getItem("accessToken");return w?console.log("✅ Using localStorage token (first 20 chars):",w.substring(0,20)+"..."):console.log("❌ No token found in any storage"),w||null}catch(d){console.warn("❌ Error getting auth token:",d);const e=localStorage.getItem("token")||localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||null;return console.log("🔄 Fallback token result:",e?"Found fallback token":"No fallback token"),e}},Pt=async()=>{var d,e,w,E;try{console.log("🚀 Starting fetchAllInventoryForExport...");const A=new URLSearchParams({per_page:"999999",page:"1",search:l.value.search||"",stock_status:l.value.stock_status||"all",station:l.value.station||"all"});console.log("📝 Request params:",A.toString());try{console.log("🔄 Attempting to fetch with useApi composable...");const{data:P}=await Ot(`/inventory?${A}`).get().json();if(P.value&&P.value.success){console.log("✅ Successfully fetched with useApi:",((d=P.value.data.data)==null?void 0:d.length)||0,"items");const k=(P.value.data.data||[]).filter((m,j,R)=>j===R.findIndex(W=>W.id_inventory===m.id_inventory));return console.log("🔍 After deduplication:",k.length,"unique items"),k}else throw console.log("❌ useApi response not successful:",P.value),new Error(((e=P.value)==null?void 0:e.message)||"useApi failed")}catch(P){console.warn("❌ useApi failed, trying manual fetch:",P);const s=tt();console.log("🔐 Token for manual fetch:",s?`Token available (${s.substring(0,20)}...)`:"No token");const k={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...s&&{Authorization:`Bearer ${s}`}};console.log("📋 Request headers:",{...k,Authorization:k.Authorization?k.Authorization.substring(0,30)+"...":"Not set"});const m=await fetch(`/api/inventory?${A}`,{method:"GET",headers:k});if(console.log("📊 Response status:",m.status,m.statusText),console.log("📋 Response headers:",Object.fromEntries(m.headers.entries())),!m.ok){const R=await m.text();console.error("❌ Manual fetch API Error Response:",R),console.error("📊 Error details - Status:",m.status,"StatusText:",m.statusText);try{const W=JSON.parse(R);console.error("📋 Parsed error JSON:",W)}catch{console.error("📋 Error response is not JSON:",R)}throw new Error(`HTTP ${m.status}: ${m.statusText}`)}const j=await m.json();if(console.log("✅ Manual fetch successful response:",{success:j.success,dataLength:((E=(w=j.data)==null?void 0:w.data)==null?void 0:E.length)||0,message:j.message}),j.success){const R=j.data.data||[],W=R.filter((we,ce,h)=>ce===h.findIndex(ke=>ke.id_inventory===we.id_inventory));return console.log("✅ Successfully fetched with manual fetch:",R.length,"items"),console.log("🔍 After deduplication:",W.length,"unique items"),W}else throw console.error("❌ Manual fetch response not successful:",j),new Error(j.message||"Failed to fetch inventory data")}}catch(A){throw console.error("💥 Fetch all inventory error:",A),new Error("Gagal mengambil data inventory lengkap: "+(A instanceof Error?A.message:"Unknown error"))}},at=v(!1),ot=v([]),st=v(!1),Le=v(1),He=v(10),lt=v(0),vt=async()=>{try{L.value=!0;const d=await Pt();console.log("📊 Exporting",d.length,"inventory items to Excel");const e=await zt(()=>import("./xlsx-CfQreh1U.js"),[]),w=d.length,E=d.filter(h=>h.current_stock<=h.reorder_level).length,A=d.filter(h=>h.current_stock===0).length,P=d.reduce((h,ke)=>h+(ke.current_stock||0)*(ke.average_cost||0),0),s=d.map((h,ke)=>{var gt,yt,bt,ht,xt,wt,St;return{No:ke+1,"Produk/Variant":((gt=h.item)==null?void 0:gt.name)||((yt=h.product)==null?void 0:yt.name)||"Unknown Item",SKU:((bt=h.item)==null?void 0:bt.item_code)||((ht=h.product)==null?void 0:ht.sku)||"-",Unit:((xt=h.item)==null?void 0:xt.unit)||"pcs","Stok Saat Ini":h.current_stock||0,"Stok Tersedia":h.available_stock||0,"Stok Minimum":h.reorder_level||0,Status:Ae(h),Kitchen:(wt=h.item)!=null&&wt.available_in_kitchen?"Ya":"Tidak",Bar:(St=h.item)!=null&&St.available_in_bar?"Ya":"Tidak","Harga Rata-rata":h.average_cost||0,"Nilai Stok":(h.current_stock||0)*(h.average_cost||0),Dibuat:h.created_at?new Date(h.created_at).toLocaleDateString("id-ID"):"-",Diperbarui:h.updated_at?new Date(h.updated_at).toLocaleDateString("id-ID"):"-"}}),k=e.utils.book_new(),m=[];if(l.value.search&&m.push(`Pencarian: "${l.value.search}"`),l.value.stock_status&&l.value.stock_status!=="all"&&m.push(`Status: ${l.value.stock_status}`),l.value.station&&l.value.station!=="all"){const h={kitchen:"Kitchen Only",bar:"Bar Only",both:"Kitchen & Bar"};m.push(`Station: ${h[l.value.station]||l.value.station}`)}const j=[["LAPORAN INVENTORY MANAGEMENT"],["Tanggal Export:",new Date().toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})],["Total Items:",w],["Total Nilai Stok:",`Rp ${P.toLocaleString("id-ID")}`],["Items Low Stock:",E],["Items Out of Stock:",A],["Filter Diterapkan:",m.length>0?m.join(", "):"Semua Data"],[]],R=e.utils.aoa_to_sheet(j);e.utils.sheet_add_json(R,s,{origin:"A9"});const W=[{wch:5},{wch:35},{wch:15},{wch:8},{wch:12},{wch:12},{wch:12},{wch:15},{wch:8},{wch:8},{wch:15},{wch:15},{wch:12},{wch:12}];R["!cols"]=W,e.utils.book_append_sheet(k,R,"Inventory Report");const ce=`inventory-report-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;e.writeFile(k,ce),console.log("✅ Excel file generated successfully:",ce);try{await It(d,{total_items:w,total_stock_value:P,low_stock_count:E,out_of_stock_count:A}),T.value=`Laporan berhasil di-export ke Excel dengan ${w} item lengkap dan data berhasil diupload ke server!`}catch(h){console.error("Upload error:",h),T.value=`Laporan berhasil di-export ke Excel dengan ${w} item lengkap, tetapi gagal upload data ke server: `+(h instanceof Error?h.message:"Unknown error")}}catch(d){console.error("Export error:",d),M.value="Gagal mengexport laporan: "+(d instanceof Error?d.message:"Unknown error")}finally{L.value=!1}},It=async(d,e)=>{try{const w=d||_.value,E=e||{total_items:y.value,total_stock_value:ye.value||0,low_stock_count:be.value,out_of_stock_count:ie.value},A={inventory_data:w.map(m=>{var j,R,W,we,ce,h,ke;return{id_inventory:m.id_inventory,id_product:m.id_product,id_item:m.id_item,current_stock:m.current_stock||0,available_stock:m.available_stock||0,reserved_stock:m.reserved_stock||0,reorder_level:m.reorder_level||0,max_stock_level:m.max_stock_level||null,average_cost:m.average_cost||0,product_name:((j=m.product)==null?void 0:j.name)||((R=m.item)==null?void 0:R.name)||"Unknown",product_sku:((W=m.product)==null?void 0:W.sku)||((we=m.item)==null?void 0:we.item_code)||null,unit:((ce=m.item)==null?void 0:ce.unit)||"pcs",category:((ke=(h=m.product)==null?void 0:h.category)==null?void 0:ke.name)||null,status:Ae(m),stock_value:(m.current_stock||0)*(m.average_cost||0),created_at:m.created_at,updated_at:m.updated_at}}),summary:{total_items:E.total_items,total_stock_value:E.total_stock_value,low_stock_count:E.low_stock_count,out_of_stock_count:E.out_of_stock_count,export_timestamp:new Date().toISOString(),filters_applied:{search:l.value.search||null,stock_status:l.value.stock_status!=="all"?l.value.stock_status:null}}},P=tt(),s=await fetch("/api/inventory/upload-data",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...P&&{Authorization:`Bearer ${P}`}},body:JSON.stringify(A)});if(!s.ok){const m=await s.json();throw new Error(m.message||`HTTP ${s.status}: ${s.statusText}`)}const k=await s.json();return console.log("Upload result:",k),k}catch(w){throw console.error("Upload inventory data error:",w),w}},kt=async()=>{var d;try{st.value=!0;const e=tt(),w=await fetch(`/api/inventory/upload-history?page=${Le.value}&per_page=${He.value}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...e&&{Authorization:`Bearer ${e}`}}});if(!w.ok)throw new Error(`HTTP ${w.status}: ${w.statusText}`);const E=await w.json();if(E.success)ot.value=E.data||[],lt.value=((d=E.pagination)==null?void 0:d.total)||0;else throw new Error(E.message||"Failed to fetch upload history")}catch(e){console.error("Fetch upload history error:",e),M.value="Gagal mengambil riwayat upload: "+(e instanceof Error?e.message:"Unknown error")}finally{st.value=!1}},Ut=d=>{Le.value=d,kt()},ft=()=>{at.value=!1,ot.value=[],Le.value=1},At=async()=>{try{console.log("🚀 Testing login to get fresh token...");const d=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({login:"admin",password:"password123"})});console.log("📊 Login Response Status:",d.status,d.statusText);const e=await d.json();if(console.log("📋 Login Response Data:",e),e.success&&e.data.token){const w=e.data.token;console.log("✅ Login successful! Token:",w.substring(0,30)+"..."),localStorage.setItem("token",w),console.log("💾 Token saved to localStorage");const E=nt("accessToken",{default:()=>"",secure:!0,sameSite:"strict",maxAge:3600*24*7});E.value=w,console.log("🍪 Token saved to cookie"),T.value="Login berhasil! Token telah diperbarui. Silakan coba export lagi.",console.log("🌐 Testing API call with new token...");const A=await fetch("/api/inventory?per_page=1",{headers:{Authorization:"Bearer "+w,Accept:"application/json"}});console.log("📊 Test API Response Status:",A.status,A.statusText),A.ok?console.log("✅ New token works! You can now try the export function."):(console.log("❌ New token still doesn't work"),M.value="Token baru tidak bekerja. Mungkin ada masalah dengan server.")}else console.log("❌ Login failed:",e.message),M.value="Login gagal: "+(e.message||"Unknown error")}catch(d){console.log("💥 Login error:",d),M.value="Error saat login: "+(d instanceof Error?d.message:"Unknown error")}};return Mt(y,(d,e)=>{},{immediate:!0}),(d,e)=>{var w,E,A,P;return g(),J("div",ua,[n("div",ca,[e[40]||(e[40]=n("div",null,[n("h1",{class:"text-h4 font-weight-bold inventory-title"}," Kelola Inventory "),n("p",{class:"text-body-1 text-medium-emphasis inventory-subtitle"}," Kelola stok barang dan pergerakan inventory ")],-1)),n("div",da,[t(S,{color:"info","prepend-icon":"tabler-bug",variant:"outlined",size:"small",onClick:_t},{default:o(()=>e[37]||(e[37]=[i(" Check Auth ")])),_:1,__:[37]}),t(S,{color:"warning","prepend-icon":"tabler-login",variant:"outlined",size:"small",onClick:At},{default:o(()=>e[38]||(e[38]=[i(" Test Login ")])),_:1,__:[38]}),t(S,{color:"primary","prepend-icon":"tabler-refresh",variant:"outlined",onClick:p},{default:o(()=>e[39]||(e[39]=[i(" Refresh Data ")])),_:1,__:[39]})])]),a(M)?(g(),V(oe,{key:0,type:"error",variant:"outlined",class:"mb-4",text:a(M),closable:"","onClick:close":e[0]||(e[0]=s=>M.value="")},null,8,["text"])):x("",!0),a(T)?(g(),V(oe,{key:1,type:"success",variant:"outlined",class:"mb-4",text:a(T),closable:"","onClick:close":e[1]||(e[1]=s=>T.value="")},null,8,["text"])):x("",!0),a(qe)?(g(),V(oe,{key:2,type:"success",variant:"outlined",class:"mb-4",text:a(qe),closable:"","onClick:close":e[2]||(e[2]=s=>qe.value="")},null,8,["text"])):x("",!0),t(ge,{class:"mb-6"},{default:o(()=>[t(z,{cols:"12",md:"3"},{default:o(()=>[t(O,{class:"stats-card"},{default:o(()=>[t(H,null,{default:o(()=>[n("div",ma,[n("div",null,[n("div",pa,u(pt.value.total_items||0),1),e[41]||(e[41]=n("div",{class:"text-caption text-medium-emphasis"}," Total Produk ",-1))]),t(I,{icon:"tabler-package",size:"48",class:"text-primary opacity-50"})])]),_:1})]),_:1})]),_:1}),t(z,{cols:"12",md:"3"},{default:o(()=>[t(O,{class:"stats-card"},{default:o(()=>[t(H,null,{default:o(()=>[n("div",_a,[n("div",null,[n("div",va,u(a(be)||0),1),e[42]||(e[42]=n("div",{class:"text-caption text-medium-emphasis"}," Stok Menipis ",-1))]),t(I,{icon:"tabler-alert-triangle",size:"48",class:"text-warning opacity-50"})])]),_:1})]),_:1})]),_:1}),t(z,{cols:"12",md:"3"},{default:o(()=>[t(O,{class:"stats-card"},{default:o(()=>[t(H,null,{default:o(()=>[n("div",ka,[n("div",null,[n("div",fa,u(a(ie)||0),1),e[43]||(e[43]=n("div",{class:"text-caption text-medium-emphasis"}," Stok Habis ",-1))]),t(I,{icon:"tabler-x-circle",size:"48",class:"text-error opacity-50"})])]),_:1})]),_:1})]),_:1}),t(z,{cols:"12",md:"3"},{default:o(()=>[t(O,{class:"stats-card"},{default:o(()=>[t(H,null,{default:o(()=>[n("div",ga,[n("div",null,[n("div",ya,u(a(Te)(a(ye)||0)),1),e[44]||(e[44]=n("div",{class:"text-caption text-medium-emphasis"}," Nilai Stok ",-1))]),t(I,{icon:"tabler-currency-dollar",size:"48",class:"text-success opacity-50"})])]),_:1})]),_:1})]),_:1})]),_:1}),t(O,{class:"mb-6 info-card",color:"info",variant:"tonal"},{default:o(()=>[t(H,null,{default:o(()=>[n("div",ba,[n("div",ha,[t(I,{icon:"tabler-info-circle",size:"32",class:"text-info"}),e[45]||(e[45]=n("div",null,[n("div",{class:"text-subtitle-1 font-weight-medium text-info"}," Sistem Stock Movement Otomatis "),n("div",{class:"text-body-2 text-medium-emphasis"},[i(" Stok akan bertambah otomatis saat purchasing dan berkurang saat penjualan POS. Gunakan tombol "),n("strong",null,"Penyesuaian"),i(" untuk koreksi manual jika diperlukan. ")])],-1))]),n("div",xa,[t(U,{color:"success",variant:"tonal",size:"small"},{default:o(()=>[t(I,{icon:"tabler-shopping-cart",class:"me-1"}),e[46]||(e[46]=i(" Purchase → Stok + "))]),_:1,__:[46]}),t(U,{color:"error",variant:"tonal",size:"small"},{default:o(()=>[t(I,{icon:"tabler-cash",class:"me-1"}),e[47]||(e[47]=i(" POS Sale → Stok - "))]),_:1,__:[47]})])])]),_:1})]),_:1}),a(B).length>0?(g(),V(O,{key:3,class:"mb-6 low-stock-alert"},{default:o(()=>[t(pe,{class:"d-flex align-center"},{default:o(()=>[t(I,{icon:"tabler-alert-triangle",class:"text-warning me-2"}),i(" Peringatan Stok Menipis ("+u(a(B).length)+" produk) ",1)]),_:1}),t(H,null,{default:o(()=>[n("div",wa,[(g(!0),J(jt,null,Lt(a(B).slice(0,10),s=>(g(),V(U,{key:s.id_inventory,color:"warning",variant:"outlined",size:"small"},{default:o(()=>{var k;return[i(u((k=s.product)==null?void 0:k.name)+" ("+u(s.current_stock)+"/"+u(s.reorder_level)+") ",1)]}),_:2},1024))),128)),a(B).length>10?(g(),V(U,{key:0,color:"warning",variant:"tonal",size:"small"},{default:o(()=>[i(" +"+u(a(B).length-10)+" lainnya ",1)]),_:1})):x("",!0)])]),_:1})]),_:1})):x("",!0),!a(D)&&a(_).length===0&&!a(M)&&!a(l).search&&a(l).stock_status==="all"?(g(),V(O,{key:4,class:"mb-6"},{default:o(()=>[t(H,{class:"text-center py-6"},{default:o(()=>[t(I,{icon:"tabler-info-circle",size:"48",class:"text-info mb-3"}),e[48]||(e[48]=n("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),e[49]||(e[49]=n("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[48,49]})]),_:1})):x("",!0),t(O,{class:"mb-6"},{default:o(()=>[t(H,null,{default:o(()=>[a(l).station!=="all"?(g(),V(oe,{key:0,type:"info",variant:"tonal",class:"mb-4",density:"compact"},{text:o(()=>[n("div",Sa,[t(I,{icon:"tabler-info-circle",size:"16"}),n("span",Va,u(r()),1)])]),_:1})):x("",!0),t(ge,null,{default:o(()=>[t(z,{cols:"12",md:"3"},{default:o(()=>[t(de,{modelValue:a(l).search,"onUpdate:modelValue":[e[3]||(e[3]=s=>a(l).search=s),e[4]||(e[4]=s=>a(xe)({search:s}))],label:"Cari inventory produk...",placeholder:"Nama produk, SKU, atau variant","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(z,{cols:"12",md:"3"},{default:o(()=>[t(rt,{modelValue:a(l).stock_status,"onUpdate:modelValue":[e[5]||(e[5]=s=>a(l).stock_status=s),e[6]||(e[6]=s=>a(xe)({stock_status:s||"all"}))],items:a(Me),label:"Status Stok",variant:"outlined",clearable:""},null,8,["modelValue","items"])]),_:1}),t(z,{cols:"12",md:"3"},{default:o(()=>[t(rt,{modelValue:a(l).station,"onUpdate:modelValue":[e[7]||(e[7]=s=>a(l).station=s),e[8]||(e[8]=s=>a(xe)({station:s}))],items:[{title:"Semua station",value:"all"},{title:"Kitchen Only",value:"kitchen"},{title:"Bar Only",value:"bar"},{title:"Kitchen & Bar",value:"both"}],label:"Station",variant:"outlined",density:"compact","prepend-inner-icon":"tabler-building-store","hide-details":""},null,8,["modelValue"])]),_:1}),t(z,{cols:"12",md:"3",class:"d-flex align-center gap-2"},{default:o(()=>[t(S,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:e[9]||(e[9]=s=>{a(_e)(),a(he)(),a(ue)()})},{default:o(()=>e[50]||(e[50]=[i(" Refresh ")])),_:1,__:[50]}),a(l).search||a(l).stock_status!=="all"||a(l).station!=="all"?(g(),V(S,{key:0,variant:"outlined",color:"warning","prepend-icon":"tabler-filter-off",onClick:e[10]||(e[10]=s=>a(xe)({search:"",stock_status:"all",station:"all"}))},{default:o(()=>e[51]||(e[51]=[i(" Clear ")])),_:1,__:[51]})):x("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),!a(D)&&a(_).length===0&&!a(M)&&!a(l).search&&a(l).stock_status==="all"?(g(),V(O,{key:5,class:"mb-6"},{default:o(()=>[t(H,{class:"text-center py-6"},{default:o(()=>[t(I,{icon:"tabler-package-off",size:"48",class:"text-disabled mb-3"}),e[52]||(e[52]=n("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),e[53]||(e[53]=n("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[52,53]})]),_:1})):x("",!0),t(O,{class:"products-inventory-table"},{default:o(()=>[t(pe,{class:"d-flex align-center gap-2 coffee-header"},{default:o(()=>[t(I,{icon:"tabler-package",class:"text-white"}),e[55]||(e[55]=n("span",{class:"text-white"},"Inventory Produk",-1)),t(Ve),t(S,{color:"success",variant:"elevated","prepend-icon":"tabler-file-spreadsheet",loading:L.value,onClick:Ue},{default:o(()=>e[54]||(e[54]=[i(" Export Excel ")])),_:1,__:[54]},8,["loading"]),t(U,{color:"black",size:"small",variant:"tonal"},{default:o(()=>[i(u(a(y))+" Produk ",1)]),_:1})]),_:1,__:[55]}),t(X),n("div",Ta,[t(qt,{headers:[{title:"Produk/Variant",key:"item_name",sortable:!1,width:"280px"},{title:"Stok Saat Ini",key:"current_stock",sortable:!1,width:"120px"},{title:"Stok Tersedia",key:"available_stock",sortable:!1,width:"120px"},{title:"Status",key:"status",sortable:!1,width:"120px"},{title:"Station",key:"station_availability",sortable:!1,width:"150px"},{title:"Reorder Level",key:"reorder_level",sortable:!1,width:"120px"},{title:"Harga Rata-rata",key:"average_cost",sortable:!1,width:"150px"},{title:"Nilai Stok",key:"stock_value",sortable:!1,width:"150px"},{title:"Aksi",key:"actions",sortable:!1,width:"200px",fixed:!0}],items:a(_),loading:a(D),"items-length":a(y),"items-per-page":a(b),page:a($),"items-per-page-options":[10,15,25,50,100],"items-per-page-text":"Items per page:","page-text":"{0}-{1} of {2}","no-data-text":"Tidak ada data inventory",class:"text-no-wrap fixed-actions-table",id:"inventory-table","fixed-header":"",height:"500px","onUpdate:page":a(C),"onUpdate:itemsPerPage":a(Oe)},{"item.item_name":o(({item:s})=>{var k,m,j,R,W,we,ce;return[n("div",Da,[n("div",null,[n("div",Ma,u(((k=s.item)==null?void 0:k.name)||((m=s.product)==null?void 0:m.name)||"Unknown Item"),1),n("div",Ca,[n("small",Ea," SKU: "+u(((j=s.item)==null?void 0:j.item_code)||((R=s.product)==null?void 0:R.sku)||"-"),1),n("small",Pa,u(((W=s.item)==null?void 0:W.description)||((ce=(we=s.product)==null?void 0:we.category)==null?void 0:ce.name)||"-"),1)])])])]}),"item.sku":o(({item:s})=>[t(U,{variant:"outlined",size:"small",color:"primary"},{default:o(()=>{var k,m;return[i(u(((k=s.item)==null?void 0:k.item_code)||((m=s.product)==null?void 0:m.sku)||"N/A"),1)]}),_:2},1024)]),"item.current_stock":o(({item:s})=>[n("div",Ia,[n("div",Ua,u(s.current_stock),1),s.reserved_stock>0?(g(),J("small",Aa," ("+u(s.reserved_stock)+" reserved) ",1)):x("",!0)])]),"item.available_stock":o(({item:s})=>[n("div",$a,[t(U,{color:s.available_stock>0?"success":"error",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.available_stock),1)]),_:2},1032,["color"])])]),"item.status":o(({item:s})=>[t(U,{color:a(Ye)(s),variant:"tonal",size:"small"},{default:o(()=>[i(u(a(Ae)(s)),1)]),_:2},1032,["color"])]),"item.station_availability":o(({item:s})=>{var k,m,j,R;return[n("div",Ra,[(k=s.item)!=null&&k.available_in_kitchen?(g(),V(U,{key:0,color:"warning",variant:"tonal",size:"x-small","prepend-icon":"tabler-chef-hat"},{default:o(()=>e[56]||(e[56]=[i(" Kitchen ")])),_:1,__:[56]})):x("",!0),(m=s.item)!=null&&m.available_in_bar?(g(),V(U,{key:1,color:"info",variant:"tonal",size:"x-small","prepend-icon":"tabler-glass-cocktail"},{default:o(()=>e[57]||(e[57]=[i(" Bar ")])),_:1,__:[57]})):x("",!0),!((j=s.item)!=null&&j.available_in_kitchen)&&!((R=s.item)!=null&&R.available_in_bar)?(g(),J("span",ja," Tidak tersedia ")):x("",!0)])]}),"item.reorder_level":o(({item:s})=>[n("div",La,u(s.reorder_level||"-"),1)]),"item.average_cost":o(({item:s})=>[n("div",za,u(a(Te)(s.average_cost)),1)]),"item.stock_value":o(({item:s})=>[n("div",Ba,u(a(Te)(s.current_stock*s.average_cost)),1)]),"item.actions":o(({item:s})=>[n("div",Fa,[t(Je,{text:"Penyesuaian Stok"},{activator:o(({props:k})=>[t(S,Ge(k,{icon:"tabler-adjustments",color:"warning",variant:"text",size:"small",disabled:!s.item,onClick:m=>mt(s)}),null,16,["disabled","onClick"])]),_:2},1024),t(Je,{text:"Update Stok"},{activator:o(({props:k})=>[t(S,Ge(k,{icon:"tabler-edit",color:"primary",variant:"text",size:"small",onClick:m=>a(Pe)(s)}),null,16,["onClick"])]),_:2},1024),t(Je,{text:"Set Reorder Level"},{activator:o(({props:k})=>[t(S,Ge(k,{icon:"tabler-settings",color:"info",variant:"text",size:"small",onClick:m=>a(Be)(s)}),null,16,["onClick"])]),_:2},1024),t(Je,{text:"Lihat Riwayat"},{activator:o(({props:k})=>[t(S,Ge(k,{icon:"tabler-history",color:"secondary",variant:"text",size:"small",onClick:m=>a(Fe)(s)}),null,16,["onClick"])]),_:2},1024)])]),"no-data":o(()=>{var s;return[n("div",Na,[t(I,{icon:a(l).search||a(l).stock_status!=="all"?"tabler-search-off":"tabler-package-off",size:"64",class:"text-medium-emphasis mb-4"},null,8,["icon"]),n("div",Oa,u(a(l).search||a(l).stock_status!=="all"?"Tidak Ada Hasil Pencarian":"Belum Ada Data Inventory"),1),n("div",qa,[a(l).search||a(l).stock_status!=="all"?(g(),J("span",Ka,[a(l).search?(g(),J("span",Ha,[e[58]||(e[58]=i(' Tidak ditemukan inventory dengan kata kunci "')),n("strong",null,u(a(l).search),1),e[59]||(e[59]=i('" '))])):x("",!0),a(l).search&&a(l).stock_status!=="all"?(g(),J("span",Ga," dan ")):x("",!0),a(l).stock_status!=="all"?(g(),J("span",Xa,[e[60]||(e[60]=i(' status stok "')),n("strong",null,u(((s=a(Me).find(k=>k.value===a(l).stock_status))==null?void 0:s.title)||a(l).stock_status),1),e[61]||(e[61]=i('" '))])):x("",!0),e[62]||(e[62]=n("br",null,null,-1)),e[63]||(e[63]=i("Coba kata kunci yang berbeda atau hapus filter. "))])):(g(),J("span",Ja,e[64]||(e[64]=[i(" Data inventory akan muncul setelah produk dan variant dibuat."),n("br",null,null,-1),i(" Silakan buat produk terlebih dahulu di menu "),n("strong",null,"Kelola Produk",-1),i(". ")])))]),n("div",Wa,[a(l).search||a(l).stock_status!=="all"?(g(),V(S,{key:0,color:"warning",variant:"outlined","prepend-icon":"tabler-filter-off",onClick:e[11]||(e[11]=k=>a(xe)({search:"",stock_status:"all"}))},{default:o(()=>e[65]||(e[65]=[i(" Hapus Filter ")])),_:1,__:[65]})):(g(),V(S,{key:1,color:"primary","prepend-icon":"tabler-plus",to:"/products-management"},{default:o(()=>e[66]||(e[66]=[i(" Buat Produk Baru ")])),_:1,__:[66]})),t(S,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:e[12]||(e[12]=k=>{a(_e)(),a(he)(),a(ue)()})},{default:o(()=>e[67]||(e[67]=[i(" Refresh Data ")])),_:1,__:[67]})])])]}),loading:o(()=>[n("div",Ya,[t(ut,{indeterminate:"",color:"primary",size:"40"}),e[68]||(e[68]=n("div",{class:"mt-4 text-medium-emphasis"}," Memuat data inventory... ",-1))])]),_:1},8,["items","loading","items-length","items-per-page","page","onUpdate:page","onUpdate:itemsPerPage"])])]),_:1}),t(Se,{modelValue:a(ee),"onUpdate:modelValue":e[19]||(e[19]=s=>ze(ee)?ee.value=s:null),"max-width":"800px",fullscreen:a(c),persistent:"",class:"stock-dialog"},{default:o(()=>[t(O,null,{default:o(()=>[t(pe,null,{default:o(()=>{var s,k;return[i(" Update Stok - "+u((k=(s=a(Z))==null?void 0:s.product)==null?void 0:k.name),1)]}),_:1}),t(X),t(We,{onSubmit:Xe(a(Ce),["prevent"])},{default:o(()=>[t(H,null,{default:o(()=>[a(re)?(g(),V(oe,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":a(K)},{default:o(()=>[i(u(a(re)),1)]),_:1},8,["onClick:close"])):x("",!0),t(ge,null,{default:o(()=>[t(z,{cols:"12",md:"6"},{default:o(()=>[t(rt,{modelValue:a(F).movement_type,"onUpdate:modelValue":e[13]||(e[13]=s=>a(F).movement_type=s),label:"Jenis Pergerakan *",items:[{title:"Stock Masuk",value:"stock_in"},{title:"Stock Keluar",value:"stock_out"},{title:"Penyesuaian",value:"adjustment"},{title:"Transfer",value:"transfer"},{title:"Retur",value:"return"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),t(z,{cols:"12",md:"6"},{default:o(()=>[t(de,{modelValue:a(F).quantity,"onUpdate:modelValue":e[14]||(e[14]=s=>a(F).quantity=s),modelModifiers:{number:!0},label:"Kuantitas *",type:"number",min:"1",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ge,null,{default:o(()=>[t(z,{cols:"12"},{default:o(()=>[t(de,{modelValue:a(F).reason,"onUpdate:modelValue":e[15]||(e[15]=s=>a(F).reason=s),label:"Alasan *",placeholder:"Contoh: Pembelian dari supplier, Penjualan, dll",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ge,null,{default:o(()=>[t(z,{cols:"12",md:"6"},{default:o(()=>[t(de,{modelValue:a(F).reference_number,"onUpdate:modelValue":e[16]||(e[16]=s=>a(F).reference_number=s),label:"Nomor Referensi",placeholder:"PO-001, SO-001, dll",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(z,{cols:"12",md:"6"},{default:o(()=>[t(de,{modelValue:a(F).cost_per_unit,"onUpdate:modelValue":e[17]||(e[17]=s=>a(F).cost_per_unit=s),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",min:"0",step:"0.01",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ge,null,{default:o(()=>[t(z,{cols:"12"},{default:o(()=>[t(it,{modelValue:a(F).notes,"onUpdate:modelValue":e[18]||(e[18]=s=>a(F).notes=s),label:"Catatan",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(X),t(De,{class:"pa-4"},{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:a(Ne)},{default:o(()=>e[69]||(e[69]=[i(" Batal ")])),_:1,__:[69]},8,["onClick"]),t(S,{type:"submit",color:"primary",loading:a(Y)},{default:o(()=>e[70]||(e[70]=[i(" Update Stok ")])),_:1,__:[70]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:a(le),"onUpdate:modelValue":e[22]||(e[22]=s=>ze(le)?le.value=s:null),"max-width":"600px",fullscreen:a(c),persistent:"",class:"stock-dialog"},{default:o(()=>[t(O,null,{default:o(()=>[t(pe,null,{default:o(()=>{var s,k;return[i(" Set Reorder Level - "+u((k=(s=a(Z))==null?void 0:s.product)==null?void 0:k.name),1)]}),_:1}),t(X),t(We,{onSubmit:Xe(a(Ee),["prevent"])},{default:o(()=>[t(H,null,{default:o(()=>[a(re)?(g(),V(oe,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":a(K)},{default:o(()=>[i(u(a(re)),1)]),_:1},8,["onClick:close"])):x("",!0),t(ge,null,{default:o(()=>[t(z,{cols:"12"},{default:o(()=>[t(de,{modelValue:a(q).reorder_level,"onUpdate:modelValue":e[20]||(e[20]=s=>a(q).reorder_level=s),modelModifiers:{number:!0},label:"Reorder Level *",type:"number",min:"0",hint:"Stok minimum sebelum perlu restock","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ge,null,{default:o(()=>[t(z,{cols:"12"},{default:o(()=>[t(de,{modelValue:a(q).max_stock_level,"onUpdate:modelValue":e[21]||(e[21]=s=>a(q).max_stock_level=s),modelModifiers:{number:!0},label:"Max Stock Level",type:"number",min:"0",hint:"Stok maksimum yang diizinkan","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(X),t(De,{class:"pa-4"},{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:a(f)},{default:o(()=>e[71]||(e[71]=[i(" Batal ")])),_:1,__:[71]},8,["onClick"]),t(S,{type:"submit",color:"primary",loading:a(Y)},{default:o(()=>e[72]||(e[72]=[i(" Simpan ")])),_:1,__:[72]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(na,{modelValue:a(Q),"onUpdate:modelValue":e[23]||(e[23]=s=>ze(Q)?Q.value=s:null),"inventory-id":(E=(w=a(Z))==null?void 0:w.id_inventory)==null?void 0:E.toString(),"inventory-name":(P=(A=a(Z))==null?void 0:A.item)==null?void 0:P.name},null,8,["modelValue","inventory-id","inventory-name"]),t(Se,{modelValue:a(Ie),"onUpdate:modelValue":e[26]||(e[26]=s=>ze(Ie)?Ie.value=s:null),"max-width":"600px",fullscreen:a(c),persistent:"",class:"stock-dialog"},{default:o(()=>[t(O,{class:"stock-movement-dialog coffee-dialog"},{default:o(()=>[t(pe,{class:"d-flex align-center justify-space-between coffee-header"},{default:o(()=>[n("div",Qa,[t(I,{icon:"tabler-adjustments",class:"text-white"}),e[73]||(e[73]=n("span",{class:"text-white"}," Penyesuaian Stok ",-1))]),t(S,{icon:"tabler-x",variant:"text",color:"white",onClick:a(je)},null,8,["onClick"])]),_:1}),t(X),t(H,{class:"pa-6"},{default:o(()=>[t(We,{onSubmit:Xe(a($e),["prevent"])},{default:o(()=>{var s;return[a(te)?(g(),V(oe,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:o(()=>[n("div",Za,[t(I,{icon:"tabler-package"}),n("div",null,[n("div",eo,u(a(te).name),1),n("div",to,u(a(te).item_code),1),n("div",ao,"Stok Saat Ini: "+u(a(te).current_stock)+" "+u(a(te).unit),1)])])]),_:1})):x("",!0),a(et)?(g(),V(oe,{key:1,type:"error",variant:"outlined",class:"mb-4",text:a(et),closable:"","onClick:close":a(ct)},null,8,["text","onClick:close"])):x("",!0),t(de,{modelValue:a(N).quantity,"onUpdate:modelValue":e[24]||(e[24]=k=>a(N).quantity=k),modelModifiers:{number:!0},label:"Stok Baru",type:"number",min:"0",step:"0.001",variant:"outlined",suffix:(s=a(te))==null?void 0:s.unit,class:"mb-4",required:""},null,8,["modelValue","suffix"]),t(it,{modelValue:a(N).notes,"onUpdate:modelValue":e[25]||(e[25]=k=>a(N).notes=k),label:"Catatan (opsional)",variant:"outlined",rows:"3",class:"mb-4"},null,8,["modelValue"]),n("div",oo,[t(S,{variant:"outlined",onClick:a(je)},{default:o(()=>e[74]||(e[74]=[i(" Batal ")])),_:1,__:[74]},8,["onClick"]),t(S,{type:"submit",color:"primary",class:"coffee-primary",loading:a(Ze)},{default:o(()=>e[75]||(e[75]=[i(" Simpan Penyesuaian ")])),_:1,__:[75]},8,["loading"])])]}),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:a(Re),"onUpdate:modelValue":e[30]||(e[30]=s=>ze(Re)?Re.value=s:null),"max-width":"800px",fullscreen:a(c),persistent:"",class:"stock-dialog"},{default:o(()=>[t(O,{class:"stock-movement-dialog coffee-dialog"},{default:o(()=>[t(pe,{class:"d-flex align-center justify-space-between coffee-header"},{default:o(()=>[n("div",so,[t(I,{icon:a(N).type==="in"?"tabler-plus":"tabler-minus",class:"text-white"},null,8,["icon"]),n("span",lo,u(a(N).type==="in"?"Stok Masuk":a(N).type==="out"?"Stok Keluar":"Penyesuaian Stok"),1)]),t(S,{icon:"tabler-x",variant:"text",color:"white",onClick:a(je)},null,8,["onClick"])]),_:1}),t(X),t(H,{class:"pa-6"},{default:o(()=>[t(We,{onSubmit:Xe(a($e),["prevent"])},{default:o(()=>[a(te)?(g(),V(oe,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:o(()=>[n("div",no,[t(Tt,{color:"primary",size:"40",variant:"tonal"},{default:o(()=>[t(I,{icon:"tabler-package"})]),_:1}),n("div",null,[n("div",ro,u(a(te).name),1),n("div",io," Stok saat ini: "+u(a(te).current_stock)+" "+u(a(te).unit),1)])])]),_:1})):x("",!0),t(ge,null,{default:o(()=>[t(z,{cols:"12",md:"6"},{default:o(()=>[t(de,{modelValue:a(N).quantity,"onUpdate:modelValue":e[27]||(e[27]=s=>a(N).quantity=s),modelModifiers:{number:!0},label:`Jumlah ${a(N).type==="in"?"Masuk":a(N).type==="out"?"Keluar":"Akhir"}`,type:"number",variant:"outlined",required:"",min:a(N).type==="adjustment"?0:1,rules:[s=>s>0||"Jumlah harus lebih dari 0"]},null,8,["modelValue","label","min","rules"])]),_:1}),t(z,{cols:"12",md:"6"},{default:o(()=>[t(de,{modelValue:a(N).cost_per_unit,"onUpdate:modelValue":e[28]||(e[28]=s=>a(N).cost_per_unit=s),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",variant:"outlined",prefix:"Rp",readonly:a(N).type!=="in"},null,8,["modelValue","readonly"])]),_:1}),t(z,{cols:"12"},{default:o(()=>[t(it,{modelValue:a(N).notes,"onUpdate:modelValue":e[29]||(e[29]=s=>a(N).notes=s),label:"Catatan",placeholder:"Masukkan catatan untuk pergerakan stok...",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),t(X),t(De,{class:"pa-6"},{default:o(()=>[t(Ve),t(S,{variant:"outlined",class:"coffee-secondary",onClick:a(je)},{default:o(()=>e[76]||(e[76]=[i(" Batal ")])),_:1,__:[76]},8,["onClick"]),t(S,{color:"primary",class:"coffee-primary",loading:a(Ze),onClick:a($e)},{default:o(()=>e[77]||(e[77]=[i(" Simpan ")])),_:1,__:[77]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:at.value,"onUpdate:modelValue":e[32]||(e[32]=s=>at.value=s),"max-width":"1200px",fullscreen:a(c),persistent:"",class:"upload-history-dialog"},{default:o(()=>[t(O,null,{default:o(()=>[t(pe,{class:"d-flex align-center justify-space-between coffee-header"},{default:o(()=>[n("div",uo,[t(I,{icon:"tabler-history",class:"text-white"}),e[78]||(e[78]=n("span",{class:"text-white"},"Riwayat Upload Data Inventory",-1))]),t(S,{icon:"tabler-x",variant:"text",color:"white",onClick:ft})]),_:1}),t(X),t(H,{class:"pa-6"},{default:o(()=>[st.value?(g(),J("div",co,[t(ut,{indeterminate:"",color:"primary",size:"40"}),e[79]||(e[79]=n("div",{class:"mt-4 text-medium-emphasis"}," Memuat riwayat upload... ",-1))])):(g(),J("div",mo,[t(Et,{headers:[{title:"Tanggal Upload",key:"created_at",sortable:!1},{title:"User",key:"user_name",sortable:!1},{title:"Total Items",key:"total_items_processed",sortable:!1},{title:"Berhasil Update",key:"total_items_updated",sortable:!1},{title:"Dilewati",key:"total_items_skipped",sortable:!1},{title:"Total Nilai Stok",key:"total_stock_value",sortable:!1},{title:"Status",key:"upload_status",sortable:!1}],items:ot.value,"items-per-page":He.value,class:"elevation-1"},{"item.created_at":o(({item:s})=>[n("div",po,u(new Date(s.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})),1)]),"item.user_name":o(({item:s})=>[n("div",_o,[t(Tt,{size:"32",color:"primary",variant:"tonal"},{default:o(()=>[t(I,{icon:"tabler-user"})]),_:1}),n("div",null,[n("div",vo,u(s.user_name||"Unknown User"),1),n("div",ko,u(s.user_email||"-"),1)])])]),"item.total_items_processed":o(({item:s})=>[t(U,{color:"info",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.total_items_processed),1)]),_:2},1024)]),"item.total_items_updated":o(({item:s})=>[t(U,{color:"success",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.total_items_updated),1)]),_:2},1024)]),"item.total_items_skipped":o(({item:s})=>[t(U,{color:s.total_items_skipped>0?"warning":"success",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.total_items_skipped),1)]),_:2},1032,["color"])]),"item.total_stock_value":o(({item:s})=>[n("div",fo,u(a(Te)(s.total_stock_value||0)),1)]),"item.upload_status":o(({item:s})=>[t(U,{color:s.upload_status==="success"?"success":s.upload_status==="failed"?"error":"warning",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.upload_status==="success"?"Berhasil":s.upload_status==="failed"?"Gagal":"Sebagian"),1)]),_:2},1032,["color"])]),"no-data":o(()=>[n("div",go,[t(I,{icon:"tabler-database-off",size:"64",class:"text-medium-emphasis mb-4"}),e[80]||(e[80]=n("div",{class:"text-h6 text-medium-emphasis mb-2"}," Belum Ada Riwayat Upload ",-1)),e[81]||(e[81]=n("div",{class:"text-body-2 text-medium-emphasis"}," Riwayat upload akan muncul setelah Anda melakukan export data inventory. ",-1))])]),_:1},8,["items","items-per-page"]),lt.value>He.value?(g(),J("div",yo,[t(Ft,{modelValue:Le.value,"onUpdate:modelValue":[e[31]||(e[31]=s=>Le.value=s),Ut],length:Math.ceil(lt.value/He.value),"total-visible":7},null,8,["modelValue","length"])])):x("",!0)]))]),_:1}),t(X),t(De,{class:"pa-4"},{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:ft},{default:o(()=>e[82]||(e[82]=[i(" Tutup ")])),_:1,__:[82]}),t(S,{color:"primary","prepend-icon":"tabler-refresh",onClick:kt},{default:o(()=>e[83]||(e[83]=[i(" Refresh ")])),_:1,__:[83]})]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:ve.value,"onUpdate:modelValue":e[34]||(e[34]=s=>ve.value=s),"max-width":"500",persistent:""},{default:o(()=>[t(O,null,{default:o(()=>[t(pe,{class:"d-flex align-center gap-2"},{default:o(()=>[t(I,{icon:"tabler-file-spreadsheet",color:"success"}),e[84]||(e[84]=i(" Export Inventory ke Excel "))]),_:1,__:[84]}),t(X),t(H,null,{default:o(()=>[n("div",bo,[e[86]||(e[86]=n("h6",{class:"text-h6 mb-2"},"Filter yang akan diterapkan:",-1)),n("div",ho,[a(l).search?(g(),V(U,{key:0,color:"primary",variant:"tonal",size:"small","prepend-icon":"tabler-search"},{default:o(()=>[i(' Pencarian: "'+u(a(l).search)+'" ',1)]),_:1})):x("",!0),a(l).stock_status&&a(l).stock_status!=="all"?(g(),V(U,{key:1,color:"info",variant:"tonal",size:"small","prepend-icon":"tabler-package"},{default:o(()=>[i(" Status: "+u(a(l).stock_status),1)]),_:1})):x("",!0),a(l).station&&a(l).station!=="all"?(g(),V(U,{key:2,color:"primary",variant:"tonal",size:"small","prepend-icon":"tabler-building-store"},{default:o(()=>[i(" Station: "+u(a(l).station==="kitchen"?"Kitchen Only":a(l).station==="bar"?"Bar Only":"Kitchen & Bar"),1)]),_:1})):x("",!0),!a(l).search&&(!a(l).stock_status||a(l).stock_status==="all")&&(!a(l).station||a(l).station==="all")?(g(),V(U,{key:3,color:"success",variant:"tonal",size:"small","prepend-icon":"tabler-check"},{default:o(()=>e[85]||(e[85]=[i(" Semua Data (Tanpa Filter) ")])),_:1,__:[85]})):x("",!0)])]),t(oe,{type:"info",variant:"tonal",class:"mb-4"},{default:o(()=>e[87]||(e[87]=[i(" Data yang akan di-export akan mengikuti filter yang sedang aktif. File Excel akan berisi kolom Station (Kitchen & Bar) untuk setiap item. ")])),_:1,__:[87]})]),_:1}),t(X),t(De,null,{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:Ke,disabled:L.value},{default:o(()=>e[88]||(e[88]=[i(" Batal ")])),_:1,__:[88]},8,["disabled"]),t(S,{color:"success","prepend-icon":"tabler-file-spreadsheet",loading:L.value,onClick:e[33]||(e[33]=s=>{vt(),Ke()})},{default:o(()=>e[89]||(e[89]=[i(" Export ke Excel ")])),_:1,__:[89]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Se,{modelValue:ve.value,"onUpdate:modelValue":e[36]||(e[36]=s=>ve.value=s),"max-width":"500",persistent:""},{default:o(()=>[t(O,null,{default:o(()=>[t(pe,{class:"d-flex align-center gap-2"},{default:o(()=>[t(I,{icon:"tabler-file-spreadsheet",color:"success"}),e[90]||(e[90]=i(" Export Data ke Excel "))]),_:1,__:[90]}),t(X),t(H,null,{default:o(()=>[n("div",xo,[e[92]||(e[92]=n("h6",{class:"text-h6 mb-2"},"Filter yang akan diterapkan:",-1)),n("div",wo,[a(l).search?(g(),V(U,{key:0,color:"primary",variant:"tonal",size:"small","prepend-icon":"tabler-search"},{default:o(()=>[i(' Pencarian: "'+u(a(l).search)+'" ',1)]),_:1})):x("",!0),a(l).stock_status&&a(l).stock_status!=="all"?(g(),V(U,{key:1,color:"info",variant:"tonal",size:"small","prepend-icon":"tabler-package"},{default:o(()=>[i(" Status: "+u(a(l).stock_status),1)]),_:1})):x("",!0),a(l).station&&a(l).station!=="all"?(g(),V(U,{key:2,color:"primary",variant:"tonal",size:"small","prepend-icon":"tabler-building-store"},{default:o(()=>[i(" Station: "+u(a(l).station==="kitchen"?"Kitchen Only":a(l).station==="bar"?"Bar Only":"Kitchen & Bar"),1)]),_:1})):x("",!0),!a(l).search&&(!a(l).stock_status||a(l).stock_status==="all")&&(!a(l).station||a(l).station==="all")?(g(),V(U,{key:3,color:"success",variant:"tonal",size:"small","prepend-icon":"tabler-database"},{default:o(()=>e[91]||(e[91]=[i(" Semua Data ")])),_:1,__:[91]})):x("",!0)])]),t(oe,{type:"info",variant:"tonal",class:"mb-4"},{default:o(()=>e[93]||(e[93]=[i(" Data yang akan di-export sesuai dengan filter yang aktif saat ini. File Excel akan mencakup kolom Station (Kitchen/Bar) untuk setiap item. ")])),_:1,__:[93]})]),_:1}),t(X),t(De,null,{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:Ke},{default:o(()=>e[94]||(e[94]=[i(" Batal ")])),_:1,__:[94]}),t(S,{color:"success",variant:"elevated","prepend-icon":"tabler-download",loading:L.value,onClick:e[35]||(e[35]=s=>{vt(),Ke()})},{default:o(()=>e[95]||(e[95]=[i(" Export Excel ")])),_:1,__:[95]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Qo=Ct(So,[["__scopeId","data-v-9aec616e"]]);export{Qo as default};
