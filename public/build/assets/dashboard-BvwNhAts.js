import{d as ne,r as v,V as A,w as ie,D as de,c as O,e as o,b as e,f as a,a1 as ue,ax as ce,au as me,av as j,o as L,X as d,H as fe,I as pe,t as i,s as _,_ as _e}from"./main-0qEogi63.js";import{C as w}from"./auto-Cz6uSJnr.js";import{V as G}from"./VTextField-D2UwyMtr.js";import{V as ve}from"./VSelect-CxF7utKJ.js";import{V as D,a as c}from"./VRow-7_4ZJ7H2.js";import{V as m,b as x}from"./VCard-Bc03UEPl.js";import{V as f}from"./VCardText-CASrXxsQ.js";import{V as U}from"./VDataTable-6avjlEbX.js";import{V as he}from"./VChip-DAGBKxZt.js";import{b as J}from"./route-block-B_A1xBdJ.js";import"./VImg-DWcSS5sD.js";import"./forwardRefs-B931MWyl.js";import"./VList-D-rpqObY.js";import"./VAvatar-Ds3zMaAD.js";import"./VDivider-BFhZzUf-.js";import"./VOverlay-Cl5udQ18.js";import"./VMenu-B6YXBijJ.js";import"./VCheckboxBtn-BHzMpH7M.js";/* empty css              */import"./VTable-B37U8owj.js";import"./filter-DNr67qnA.js";const ye={class:"dashboard-page"},ge={class:"d-flex flex-column flex-md-row justify-space-between align-start align-md-center mb-6 ga-4"},xe={class:"d-flex flex-column flex-sm-row gap-3 align-stretch align-sm-center w-100 w-md-auto"},be={class:"d-flex flex-column flex-sm-row gap-2 align-stretch"},ke={key:0,class:"text-center py-8"},Ce={key:1},we={class:"flex-grow-1"},De={class:"text-h4 text-success mt-2"},Ve={class:"text-caption text-medium-emphasis"},Te={class:"flex-grow-1"},Ae={class:"text-h4 text-info mt-2"},Fe={class:"text-caption text-medium-emphasis"},Ie={class:"flex-grow-1"},Pe={class:"text-h4 text-warning mt-2"},Se={class:"text-caption text-medium-emphasis"},Be={class:"flex-grow-1"},Ee={class:"text-h4 text-primary mt-2"},He={class:"text-caption text-medium-emphasis"},Re={class:"flex-grow-1"},ze={class:"text-h4 text-secondary mt-2"},Ne={class:"text-caption text-medium-emphasis"},Oe={style:{height:"300px"}},je={style:{height:"300px"}},Le={style:{height:"300px"}},Ue={style:{height:"300px"}},Me={style:{height:"300px"}},K=ne({__name:"dashboard",setup($e){const g=l=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),V=v(!1),b=v("30"),h=v(""),y=v(""),p=v(null),F=v(null),I=v(null),P=v(null),S=v(null),B=v(null);let E=null,H=null,R=null,z=null,N=null;const M=[{label:"7 Hari Terakhir",value:"7"},{label:"30 Hari Terakhir",value:"30"},{label:"90 Hari Terakhir",value:"90"},{label:"1 Tahun Terakhir",value:"365"},{label:"Custom Range",value:"custom"}],Q=[{title:"Item",key:"item_name"},{title:"Stock Saat Ini",key:"current_stock"},{title:"Stock Minimum",key:"min_stock"}],W=[{title:"Produk",key:"product_name"},{title:"Terjual",key:"total_quantity"},{title:"Pendapatan",key:"total_revenue"}],Y=[{title:"Supplier",key:"supplier_name"},{title:"Total Pembelian",key:"purchase_count"},{title:"Total Nilai",key:"total_amount"}],u=A(()=>{var l;return((l=p.value)==null?void 0:l.summary)||{}}),k=A(()=>{var l;return((l=p.value)==null?void 0:l.sales)||{}}),C=A(()=>{var l;return((l=p.value)==null?void 0:l.purchases)||{}}),$=A(()=>{var l;return((l=p.value)==null?void 0:l.inventory)||{}}),T=async()=>{V.value=!0;try{const l={};if(b.value==="custom")if(h.value&&y.value){const s=new Date(h.value),r=new Date(y.value);l.start_date=s.toISOString().split("T")[0],l.end_date=r.toISOString().split("T")[0]}else l.period="30";else l.period=b.value;const t=await me.get("/api/dashboard/analytics",{params:l});t.data.success&&(p.value=t.data.data,await j(),X())}catch(l){console.error("Error loading dashboard:",l)}finally{V.value=!1}},ee=l=>{l!=="custom"&&(h.value="",y.value=""),T()},q=()=>{h.value&&y.value&&(b.value="custom",T())},te=()=>{const l=new Date,t=new Date;t.setDate(l.getDate()-30),y.value=l.toISOString().split("T")[0],h.value=t.toISOString().split("T")[0]},Z=()=>{var l;if(b.value==="custom"&&h.value&&y.value){const t=new Date(h.value).toLocaleDateString("id-ID"),s=new Date(y.value).toLocaleDateString("id-ID");return`(${t} - ${s})`}else return`(${((l=M.find(s=>s.value===b.value))==null?void 0:l.label)||"30 Hari Terakhir"})`},X=()=>{p.value&&j(()=>{setTimeout(()=>{var l,t,s,r,n;F.value&&((l=p.value)!=null&&l.sales)&&ae(),I.value&&((t=k.value)!=null&&t.top_products)&&se(),P.value&&((s=p.value)!=null&&s.purchases)&&le(),S.value&&((r=C.value)!=null&&r.top_purchased_items)&&oe(),B.value&&((n=p.value)!=null&&n.inventory)&&re()},200)})},ae=()=>{var s,r;E&&E.destroy();const l=(s=F.value)==null?void 0:s.getContext("2d");if(!l||!((r=k.value)!=null&&r.daily_trend)||!Array.isArray(k.value.daily_trend))return;const t=k.value.daily_trend;try{E=new w(l,{type:"line",data:{labels:t.map(n=>new Date(n.date).toLocaleDateString("id-ID")),datasets:[{label:"Penjualan Harian",data:t.map(n=>n.total_revenue),borderColor:"#D4A574",backgroundColor:"rgba(212, 165, 116, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(n){return g(Number(n))}}}}}})}catch(n){console.error("Error creating sales chart:",n)}},se=()=>{var s,r;H&&H.destroy();const l=(s=I.value)==null?void 0:s.getContext("2d");if(!l)return;const t=(r=k.value)==null?void 0:r.top_products;if(!(!t||!Array.isArray(t)))try{H=new w(l,{type:"pie",data:{labels:t.map(n=>n.product_name||"Unknown"),datasets:[{data:t.map(n=>n.total_quantity||0),backgroundColor:["#D4A574","#E6B887","#F2D099","#B8956A","#9A7F5A","#C69C6C","#E4C29F","#A08660","#BD9B73","#F0D8B5"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})}catch(n){console.error("Error creating sales pie chart:",n)}},le=()=>{var s;R&&R.destroy();const l=(s=P.value)==null?void 0:s.getContext("2d");if(!l||!C.value.daily_trend)return;const t=C.value.daily_trend;R=new w(l,{type:"line",data:{labels:t.map(r=>new Date(r.date).toLocaleDateString("id-ID")),datasets:[{label:"Pembelian Harian",data:t.map(r=>r.total_amount),borderColor:"#2196F3",backgroundColor:"rgba(33, 150, 243, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(r){return g(Number(r))}}}}}})},oe=()=>{var s,r;z&&z.destroy();const l=(s=S.value)==null?void 0:s.getContext("2d");if(!l)return;const t=(r=C.value)==null?void 0:r.top_purchased_items;!t||!Array.isArray(t)||(z=new w(l,{type:"doughnut",data:{labels:t.map(n=>n.item_name||"Unknown"),datasets:[{data:t.map(n=>n.total_quantity||0),backgroundColor:["#4CAF50","#FF9800","#F44336","#9C27B0","#607D8B","#2196F3","#FF5722","#795548","#E91E63","#3F51B5"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}}))},re=()=>{var s,r;N&&N.destroy();const l=(s=B.value)==null?void 0:s.getContext("2d");if(!l)return;const t=(r=$.value)==null?void 0:r.by_category;!t||!Array.isArray(t)||(N=new w(l,{type:"doughnut",data:{labels:t.map(n=>n.item_name||"Unknown"),datasets:[{data:t.map(n=>n.total_stock||0),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E6B887","#D4A574","#F2D099","#B8956A"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}}))};return ie(p,()=>{p.value&&j(()=>{X()})}),de(()=>{te(),T()}),(l,t)=>(L(),O("div",ye,[o("div",ge,[t[4]||(t[4]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold coffee-title"},"Dashboard Analytics"),o("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"}," Pantau penjualan, pembelian, dan inventory coffee shop Anda ")],-1)),o("div",xe,[o("div",be,[e(G,{modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=s=>h.value=s),type:"date",label:"Tanggal Mulai",density:"comfortable",variant:"outlined","hide-details":"",class:"flex-grow-1",onChange:q},null,8,["modelValue"]),e(G,{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=s=>y.value=s),type:"date",label:"Tanggal Akhir",density:"comfortable",variant:"outlined","hide-details":"",class:"flex-grow-1",onChange:q},null,8,["modelValue"])]),e(ve,{modelValue:b.value,"onUpdate:modelValue":[t[2]||(t[2]=s=>b.value=s),ee],items:M,"item-title":"label","item-value":"value",density:"comfortable",variant:"outlined","hide-details":"",class:"flex-shrink-0",style:{"min-width":"180px"}},{"prepend-inner":a(()=>[e(d,{icon:"mdi-calendar-range"})]),_:1},8,["modelValue"]),e(ue,{color:"primary","prepend-icon":"mdi-refresh",onClick:T,loading:V.value,class:"flex-shrink-0"},{default:a(()=>[t[3]||(t[3]=o("span",{class:"d-none d-sm-inline"},"Refresh",-1)),fe(e(d,{icon:"mdi-refresh"},null,512),[[pe,l.$vuetify.display.xs]])]),_:1,__:[3]},8,["loading"])])]),V.value?(L(),O("div",ke,[e(ce,{indeterminate:"",color:"primary",size:"64"}),t[5]||(t[5]=o("p",{class:"text-body-1 mt-4"},"Memuat data dashboard...",-1))])):(L(),O("div",Ce,[e(D,{class:"mb-6"},{default:a(()=>[e(c,{cols:"12",md:"3"},{default:a(()=>[e(m,{class:"summary-card h-100"},{default:a(()=>[e(f,{class:"d-flex align-center"},{default:a(()=>{var s,r,n;return[o("div",we,[t[6]||(t[6]=o("div",{class:"text-h6 font-weight-bold"},"Total Pendapatan",-1)),o("div",De,i(g(((s=u.value.period_summary)==null?void 0:s.total_revenue)||0)),1),o("div",Ve,i((((r=u.value.period_summary)==null?void 0:r.growth)??0)>=0?"+":"")+i(((n=u.value.period_summary)==null?void 0:n.growth)??0)+"% dari periode sebelumnya ",1)]),e(d,{icon:"mdi-currency-usd",size:"48",class:"text-success"})]}),_:1})]),_:1})]),_:1}),e(c,{cols:"12",md:"3"},{default:a(()=>[e(m,{class:"summary-card h-100"},{default:a(()=>[e(f,{class:"d-flex align-center"},{default:a(()=>{var s,r,n;return[o("div",Te,[t[7]||(t[7]=o("div",{class:"text-h6 font-weight-bold"},"Penjualan Hari Ini",-1)),o("div",Ae,i(g(((s=u.value.today_sales)==null?void 0:s.value)||0)),1),o("div",Fe,i((((r=u.value.today_sales)==null?void 0:r.growth)??0)>=0?"+":"")+i(((n=u.value.today_sales)==null?void 0:n.growth)??0)+"% dari kemarin ",1)]),e(d,{icon:"mdi-cash-multiple",size:"48",class:"text-info"})]}),_:1})]),_:1})]),_:1}),e(c,{cols:"12",md:"3"},{default:a(()=>[e(m,{class:"summary-card h-100"},{default:a(()=>[e(f,{class:"d-flex align-center"},{default:a(()=>{var s,r;return[o("div",Ie,[t[8]||(t[8]=o("div",{class:"text-h6 font-weight-bold"},"Nilai Inventory",-1)),o("div",Pe,i(g(((s=u.value.inventory_value)==null?void 0:s.value)||0)),1),o("div",Se,i(((r=u.value.inventory_value)==null?void 0:r.low_stock_count)||0)+" item stok rendah ",1)]),e(d,{icon:"mdi-package-variant",size:"48",class:"text-warning"})]}),_:1})]),_:1})]),_:1}),e(c,{cols:"12",md:"3"},{default:a(()=>[e(m,{class:"summary-card h-100"},{default:a(()=>[e(f,{class:"d-flex align-center"},{default:a(()=>{var s,r;return[o("div",Be,[t[9]||(t[9]=o("div",{class:"text-h6 font-weight-bold"},"Rata-rata Order",-1)),o("div",Ee,i(g(((s=u.value.period_summary)==null?void 0:s.avg_order_value)||0)),1),o("div",He,i(((r=u.value.period_summary)==null?void 0:r.total_orders)||0)+" total order ",1)]),e(d,{icon:"mdi-chart-line",size:"48",class:"text-primary"})]}),_:1})]),_:1})]),_:1}),e(c,{cols:"12",md:"3"},{default:a(()=>[e(m,{class:"summary-card h-100"},{default:a(()=>[e(f,{class:"d-flex align-center"},{default:a(()=>{var s,r,n;return[o("div",Re,[t[10]||(t[10]=o("div",{class:"text-h6 font-weight-bold"},"Total Order Hari Ini",-1)),o("div",ze,i(((s=u.value.today_orders)==null?void 0:s.value)||0),1),o("div",Ne,i((((r=u.value.today_orders)==null?void 0:r.growth)??0)>=0?"+":"")+i(((n=u.value.today_orders)==null?void 0:n.growth)??0)+"% dari kemarin ",1)]),e(d,{icon:"mdi-receipt-text",size:"48",class:"text-secondary"})]}),_:1})]),_:1})]),_:1})]),_:1}),e(D,{class:"mb-6"},{default:a(()=>[e(c,{cols:"12",lg:"8"},{default:a(()=>[e(m,{class:"chart-card"},{default:a(()=>[e(x,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-chart-line",class:"me-2"}),_(" Tren Penjualan "+i(Z()),1)]),_:1}),e(f,null,{default:a(()=>[o("div",Oe,[o("canvas",{ref_key:"salesChart",ref:F},null,512)])]),_:1})]),_:1})]),_:1}),e(c,{cols:"12",lg:"4"},{default:a(()=>[e(m,{class:"chart-card"},{default:a(()=>[e(x,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-chart-pie",class:"me-2"}),t[11]||(t[11]=_(" Produk Terlaris "))]),_:1,__:[11]}),e(f,null,{default:a(()=>[o("div",je,[o("canvas",{ref_key:"salesPieChart",ref:I},null,512)])]),_:1})]),_:1})]),_:1})]),_:1}),e(D,{class:"mb-6"},{default:a(()=>[e(c,{cols:"12",lg:"8"},{default:a(()=>[e(m,{class:"chart-card"},{default:a(()=>[e(x,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-cart",class:"me-2"}),_(" Tren Pembelian "+i(Z()),1)]),_:1}),e(f,null,{default:a(()=>[o("div",Le,[o("canvas",{ref_key:"purchaseChart",ref:P},null,512)])]),_:1})]),_:1})]),_:1}),e(c,{cols:"12",lg:"4"},{default:a(()=>[e(m,{class:"chart-card"},{default:a(()=>[e(x,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-chart-donut",class:"me-2"}),t[12]||(t[12]=_(" Produk Terbanyak Dibeli "))]),_:1,__:[12]}),e(f,null,{default:a(()=>[o("div",Ue,[o("canvas",{ref_key:"purchasePieChart",ref:S},null,512)])]),_:1})]),_:1})]),_:1})]),_:1}),e(D,{class:"mb-6"},{default:a(()=>[e(c,{cols:"12",lg:"6"},{default:a(()=>[e(m,{class:"chart-card"},{default:a(()=>[e(x,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-chart-donut-variant",class:"me-2"}),t[13]||(t[13]=_(" Top Items by Stock "))]),_:1,__:[13]}),e(f,null,{default:a(()=>[o("div",Me,[o("canvas",{ref_key:"inventoryChart",ref:B},null,512)])]),_:1})]),_:1})]),_:1}),e(c,{cols:"12",lg:"6"},{default:a(()=>[e(m,{class:"chart-card"},{default:a(()=>[e(x,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-alert-triangle",class:"me-2"}),t[14]||(t[14]=_(" Item Stok Rendah "))]),_:1,__:[14]}),e(f,null,{default:a(()=>[e(U,{headers:Q,items:$.value.low_stock||[],"hide-default-footer":"",density:"compact"},{"item.current_stock":a(({item:s})=>[e(he,{color:s.current_stock<=0?"error":"warning",size:"small"},{default:a(()=>[_(i(s.current_stock),1)]),_:2},1032,["color"])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})]),_:1}),e(D,null,{default:a(()=>[e(c,{cols:"12",lg:"6"},{default:a(()=>[e(m,{class:"chart-card"},{default:a(()=>[e(x,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-star",class:"me-2"}),t[15]||(t[15]=_(" Produk Terlaris "))]),_:1,__:[15]}),e(f,null,{default:a(()=>[e(U,{headers:W,items:k.value.top_products||[],"hide-default-footer":"",density:"compact"},{"item.total_revenue":a(({item:s})=>[_(i(g(s.total_revenue)),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),e(c,{cols:"12",lg:"6"},{default:a(()=>[e(m,{class:"chart-card"},{default:a(()=>[e(x,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-truck",class:"me-2"}),t[16]||(t[16]=_(" Supplier Teratas "))]),_:1,__:[16]}),e(f,null,{default:a(()=>[e(U,{headers:Y,items:C.value.top_suppliers||[],"hide-default-footer":"",density:"compact"},{"item.total_amount":a(({item:s})=>[_(i(g(s.total_amount)),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})]),_:1})]))]))}});typeof J=="function"&&J(K);const mt=_e(K,[["__scopeId","data-v-9b45b3ca"]]);export{mt as default};
