import{g as K}from"./auth-a9M5ekjn.js";import{d as ve,V as W,r as w,w as ce,D as we,g as R,o as V,f as a,b as e,e as t,X as H,s as _,t as r,a0 as P,ap as Ce,aq as $e,c as M,l as C,i as ke,p as xe,F as Ie,aI as Q,aX as he,v as be}from"./main-BAoom0fI.js";import{V as fe}from"./VDialog-BmgDQMRG.js";import{b as G,V as $,c as _e}from"./VCard-DKixmwd6.js";import{V as U}from"./VCardText-yO_LL98H.js";import{V as qe}from"./VForm-DgH_Emvc.js";import{V as Y,a as I}from"./VRow-CzNjCVcw.js";import{V as pe}from"./VSelect-G7MgFaCB.js";import{a as oe,b as ne,d as Ve,V as Pe}from"./VList-u_Bmr7t0.js";import{V as X}from"./VTextField-DXPIZ412.js";import{V as Se}from"./VTextarea-Bnrln25Y.js";import{V as De}from"./VTable-D4YUyDzm.js";import{V as Te}from"./VAutocomplete-s5xxfkGz.js";import{V as me}from"./VDivider-_RM1H4oe.js";import{V as ge}from"./VSpacer-wXUiayGy.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ee}from"./VChip-D9OHswR6.js";import{V as ze,a as Ue}from"./VDataTable-Dh_60B_A.js";import{V as je}from"./VContainer-D6of_QsA.js";import{V as Ae}from"./VDataTableServer-Do6QFktG.js";import{V as Ne}from"./VMenu-CpAU4c1j.js";import{V as Re}from"./VSnackbar-w2FGd14L.js";import"./VOverlay-DiNeOxb-.js";import"./forwardRefs-B931MWyl.js";import"./VImg-B6o-C-IY.js";import"./VAvatar-BGY_BPux.js";/* empty css              */import"./VCheckboxBtn-DQc1gldW.js";import"./filter-Clp8NBwU.js";const Be={class:"d-flex align-center gap-2"},Fe={class:"mt-6"},Oe={class:"d-flex justify-space-between align-center mb-4"},Ee={key:0},Me={class:"font-weight-medium"},Le={class:"text-end"},Qe={class:"d-flex justify-space-between mb-2"},Ke={class:"font-weight-medium"},He={class:"d-flex justify-space-between mb-2"},Xe={class:"text-success"},Ge={class:"d-flex justify-space-between mb-2"},Je={class:"d-flex justify-space-between"},We={class:"text-h6 font-weight-bold text-primary"},Ye=ve({__name:"PurchaseDialog",props:{modelValue:{type:Boolean},purchase:{default:null},mode:{default:"create"}},emits:["update:modelValue","saved"],setup(te,{emit:J}){const v=te,B=J,z=W({get:()=>v.modelValue,set:u=>B("update:modelValue",u)}),S=w(),T=w(!1),x=w(!1),k=w(!1),j=w(!1),F=w([]),A=w([]),g=w({id_supplier:null,purchase_date:new Date().toISOString().split("T")[0],notes:"",discount_amount:0,discount_amount_display:"0",items:[]}),c=W(()=>v.mode==="edit"?"Edit Purchase Order":"Buat Purchase Order Baru"),s=W(()=>{const u=g.value.items.reduce((l,o)=>l+(o.total_cost||0),0),i=Number.parseFloat(g.value.discount_amount_display.replace(/\D/g,""))||0,f=(u-i)*.11,n=u-i+f;return{subtotal:u,discount:i,tax:f,total:n}}),b=W(()=>T.value&&g.value.items.length>0&&g.value.items.every(u=>u.id_item&&u.quantity>0&&u.unit_cost>0)),N={required:u=>!!u||"Field ini wajib diisi"},D=async()=>{try{k.value=!0;const u=K(),i={"Content-Type":"application/json",Accept:"application/json"};u&&(i.Authorization=`Bearer ${u}`);const f=await Q.get("/api/suppliers",{headers:i});F.value=f.data.data||[],console.log("ðŸ“‹ Suppliers loaded:",F.value.length,"suppliers")}catch(u){console.error("Error loading suppliers:",u)}finally{k.value=!1}},O=async()=>{var u;try{j.value=!0;const i=K();console.log("Loading items with token:",i?"Token found":"No token");const f={"Content-Type":"application/json",Accept:"application/json"};i&&(f.Authorization=`Bearer ${i}`),console.log("Making request to /api/items");const n=await Q.get("/api/items",{headers:f});console.log("Items response:",n.data);const l=n.data.data;l&&l.data?A.value=l.data||[]:A.value=n.data.data||[],console.log("Items loaded:",A.value.length,"items")}catch(i){console.error("Error loading items:",i),console.error("Error response:",(u=i.response)==null?void 0:u.data)}finally{j.value=!1}},E=u=>{try{const i=g.value.items[u];if(!i){console.warn("Item not found at index:",u);return}i.total_cost=(i.quantity||0)*(i.unit_cost||0),console.log(`Item ${u} total calculated:`,i.total_cost)}catch(i){console.error("Error in calculateItemTotal:",i)}},ie=()=>{try{console.log("Adding new item..."),console.log("Current items count:",g.value.items.length);const u={id_item:null,quantity:1,unit_cost:0,unit_cost_display:"0",total_cost:0};g.value.items.push(u),console.log("Item added successfully. New count:",g.value.items.length)}catch(u){console.error("Error in addItem:",u)}},re=u=>{g.value.items.splice(u,1)},ae=(u,i)=>{E(u)},le=(u,i)=>{var l;const f=(l=i.target)==null?void 0:l.value,n=g.value.items[u];f===""||f===null||f===void 0?n.quantity=1:n.quantity=Number.parseInt(f)||1,E(u)},y=(u,i)=>{var o;const f=(o=i.target)==null?void 0:o.value,n=(f==null?void 0:f.replace(/\D/g,""))||"",l=g.value.items[u];n===""?(l.unit_cost=0,l.unit_cost_display="0"):(l.unit_cost=Number.parseInt(n),l.unit_cost_display=new Intl.NumberFormat("id-ID").format(l.unit_cost))},p=u=>{var n;const i=(n=u.target)==null?void 0:n.value,f=(i==null?void 0:i.replace(/\D/g,""))||"";f===""?g.value.discount_amount_display="0":g.value.discount_amount_display=new Intl.NumberFormat("id-ID").format(Number.parseInt(f))},d=()=>{},h=u=>Number.isNaN(u)||u===null||u===void 0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(u),L=()=>{var u,i,f,n;if(console.log("ðŸ” initializeForm called"),console.log("ðŸ“ Mode:",v.mode),console.log("ðŸ’¾ Purchase data:",v.purchase),v.mode==="edit"&&v.purchase){console.log("âœ… Initializing form for edit mode"),console.log("ï¿½ All purchase properties:",Object.keys(v.purchase)),console.log("ï¿½ðŸ‘¤ Supplier ID from purchase:",v.purchase.id_supplier),console.log("ï¿½ Supplier object from purchase:",v.purchase.supplier),console.log("ðŸ‘¤ Supplier_id from purchase:",v.purchase.supplier_id),console.log("ï¿½ðŸ“¦ Items from purchase:",v.purchase.items);const l=v.purchase.supplier_id||v.purchase.id_supplier||((u=v.purchase.supplier)==null?void 0:u.id_supplier)||((i=v.purchase.supplier)==null?void 0:i.id);if(console.log("ðŸ“¦ Items from purchase:",v.purchase.items),v.purchase.items&&v.purchase.items.length>0){const m=v.purchase.items[0];console.log("ï¿½ First item debug:",{quantity:m.quantity,quantity_ordered:m.quantity_ordered,unit_cost:m.unit_cost,total_cost:m.total_cost,item_id:((f=m.item)==null?void 0:f.id_item)||m.id_item})}console.log("ðŸŽ¯ Resolved supplier ID:",l),console.log("ðŸ“… Original purchase_date:",v.purchase.purchase_date),console.log("ðŸ“… Purchase_date type:",typeof v.purchase.purchase_date);const o=v.purchase.purchase_date?new Date(v.purchase.purchase_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0];console.log("ðŸ“… Formatted purchase_date:",o),g.value={id_supplier:l,purchase_date:o,notes:v.purchase.notes||"",discount_amount:v.purchase.discount_amount||0,discount_amount_display:new Intl.NumberFormat("id-ID").format(v.purchase.discount_amount||0),items:((n=v.purchase.items)==null?void 0:n.map(m=>{var q;return console.log("ðŸ”„ Mapping item:",m),console.log("ðŸ“Š Item quantity_ordered:",m.quantity_ordered),console.log("ðŸ“Š Item quantity:",m.quantity),{id_item:((q=m.item)==null?void 0:q.id_item)||m.id_item,quantity:Number.parseInt(m.quantity_ordered||m.quantity||0)||0,unit_cost:m.unit_cost,unit_cost_display:new Intl.NumberFormat("id-ID").format(m.unit_cost),total_cost:m.total_cost}}))||[]},console.log("ðŸ“‹ Form data after initialization:",g.value)}else console.log("ðŸ†• Initializing form for create mode"),g.value={id_supplier:null,purchase_date:new Date().toISOString().split("T")[0],notes:"",discount_amount:0,discount_amount_display:"0",items:[]}},se=async()=>{var u,i,f;if((u=S.value)!=null&&u.validate())try{x.value=!0;const n=K(),l={"Content-Type":"application/json",Accept:"application/json"};n&&(l.Authorization=`Bearer ${n}`);const o={supplier_id:g.value.id_supplier,purchase_date:g.value.purchase_date,notes:g.value.notes,discount_amount:Number.parseFloat(g.value.discount_amount_display.replace(/\D/g,""))||0,items:g.value.items.map(m=>({id_item:m.id_item,quantity:m.quantity,unit_cost:m.unit_cost}))};v.mode==="edit"?await Q.put(`/api/purchases/${v.purchase.id_purchase}`,o,{headers:l}):await Q.post("/api/purchases",o,{headers:l}),B("saved")}catch(n){console.error("Error saving purchase:",n),console.error("Error saving purchase:",((f=(i=n.response)==null?void 0:i.data)==null?void 0:f.message)||n.message)}finally{x.value=!1}},Z=()=>{z.value=!1};return ce(()=>v.modelValue,async u=>{u&&(await Promise.all([D(),O()]),await he(),L())}),ce(()=>v.purchase,async u=>{u&&v.mode==="edit"&&(F.value.length===0&&await D(),A.value.length===0&&await O(),await he(),L())},{deep:!0,immediate:!0}),we(()=>{D(),O()}),(u,i)=>(V(),R(fe,{modelValue:z.value,"onUpdate:modelValue":i[5]||(i[5]=f=>z.value=f),"max-width":"1200",persistent:""},{default:a(()=>[e($,null,{default:a(()=>[e(G,{class:"d-flex align-center justify-space-between"},{default:a(()=>[t("div",Be,[e(H,null,{default:a(()=>i[6]||(i[6]=[_("mdi-cart-plus")])),_:1,__:[6]}),t("span",null,r(c.value),1)]),e(P,{icon:"mdi-close",size:"small",variant:"text",onClick:Z})]),_:1}),e(U,null,{default:a(()=>[e(qe,{ref_key:"form",ref:S,modelValue:T.value,"onUpdate:modelValue":i[3]||(i[3]=f=>T.value=f)},{default:a(()=>[e(Y,null,{default:a(()=>[e(I,{cols:"12",md:"6"},{default:a(()=>[e(pe,{modelValue:g.value.id_supplier,"onUpdate:modelValue":i[0]||(i[0]=f=>g.value.id_supplier=f),label:"Supplier *",items:F.value,"item-title":"name","item-value":"id_supplier",variant:"outlined",rules:[N.required],loading:k.value},{item:a(({props:f,item:n})=>[e(oe,Ce($e(f)),{default:a(()=>[e(ne,null,{default:a(()=>[_(r(n.raw.name),1)]),_:2},1024),e(Ve,null,{default:a(()=>[_(r(n.raw.phone)+" - "+r(n.raw.email),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","rules","loading"])]),_:1}),e(I,{cols:"12",md:"3"},{default:a(()=>[e(X,{modelValue:g.value.purchase_date,"onUpdate:modelValue":i[1]||(i[1]=f=>g.value.purchase_date=f),label:"Tanggal Purchase *",type:"date",variant:"outlined",rules:[N.required]},null,8,["modelValue","rules"])]),_:1}),e(I,{cols:"12"},{default:a(()=>[e(Se,{modelValue:g.value.notes,"onUpdate:modelValue":i[2]||(i[2]=f=>g.value.notes=f),label:"Catatan",variant:"outlined",rows:"2",placeholder:"Catatan tambahan untuk purchase order ini..."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t("div",Fe,[t("div",Oe,[i[9]||(i[9]=t("h3",{class:"text-h6"}," Items Purchase ",-1)),e(P,{color:"primary",variant:"tonal",onClick:ie},{default:a(()=>[e(H,{start:""},{default:a(()=>i[7]||(i[7]=[_(" mdi-plus ")])),_:1,__:[7]}),i[8]||(i[8]=_(" Tambah Item "))]),_:1,__:[8]})]),e($,{variant:"outlined"},{default:a(()=>[e(De,null,{default:a(()=>[i[11]||(i[11]=t("thead",null,[t("tr",null,[t("th",{style:{"inline-size":"45%"}}," Item "),t("th",{style:{"inline-size":"15%"}}," Quantity "),t("th",{style:{"inline-size":"15%"}}," Unit Cost "),t("th",{style:{"inline-size":"15%"}}," Total "),t("th",{style:{"inline-size":"10%"}}," Action ")])],-1)),t("tbody",null,[g.value.items.length===0?(V(),M("tr",Ee,i[10]||(i[10]=[t("td",{colspan:"6",class:"text-center py-8 text-medium-emphasis"},' Belum ada item. Klik "Tambah Item" untuk menambah item purchase. ',-1)]))):C("",!0),(V(!0),M(Ie,null,ke(g.value.items,(f,n)=>(V(),M("tr",{key:n},[t("td",null,[e(Te,{modelValue:f.id_item,"onUpdate:modelValue":[l=>f.id_item=l,l=>ae(n,l)],label:"Pilih Item",items:A.value,"item-title":"name","item-value":"id_item",variant:"outlined",density:"compact",loading:j.value,clearable:"","no-data-text":"Tidak ada item ditemukan"},{item:a(({props:l,item:o})=>[e(oe,xe({ref_for:!0},l),{default:a(()=>[e(ne,null,{default:a(()=>[_(r(o.raw.name),1)]),_:2},1024),e(Ve,null,{default:a(()=>{var m;return[_(r((m=o.raw.category)==null?void 0:m.name)+" - SKU: "+r(o.raw.sku),1)]}),_:2},1024)]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","items","loading"])]),t("td",null,[e(X,{modelValue:f.quantity,"onUpdate:modelValue":l=>f.quantity=l,label:"Qty",type:"number",min:"1",step:"1",variant:"outlined",density:"compact",onInput:l=>le(n,l),onBlur:l=>E(n)},null,8,["modelValue","onUpdate:modelValue","onInput","onBlur"])]),t("td",null,[e(X,{modelValue:f.unit_cost_display,"onUpdate:modelValue":l=>f.unit_cost_display=l,label:"Harga Satuan",variant:"outlined",density:"compact",prefix:"Rp",onInput:l=>y(n,l),onBlur:l=>E(n)},null,8,["modelValue","onUpdate:modelValue","onInput","onBlur"])]),t("td",null,[t("span",Me,r(h(f.total_cost)),1)]),t("td",null,[e(P,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:l=>re(n)},null,8,["onClick"])])]))),128))])]),_:1,__:[11]})]),_:1}),e($,{class:"mt-4",variant:"outlined"},{default:a(()=>[e(U,null,{default:a(()=>[e(Y,null,{default:a(()=>[e(I,{cols:"12",md:"8"},{default:a(()=>[e(X,{modelValue:g.value.discount_amount_display,"onUpdate:modelValue":i[4]||(i[4]=f=>g.value.discount_amount_display=f),label:"Diskon",variant:"outlined",prefix:"Rp",placeholder:"0",onInput:p,onBlur:d},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",md:"4"},{default:a(()=>[t("div",Le,[t("div",Qe,[i[12]||(i[12]=t("span",null,"Subtotal:",-1)),t("span",Ke,r(h(s.value.subtotal)),1)]),t("div",He,[i[13]||(i[13]=t("span",null,"Diskon:",-1)),t("span",Xe,"-"+r(h(s.value.discount)),1)]),t("div",Ge,[i[14]||(i[14]=t("span",null,"PPN (11%):",-1)),t("span",null,r(h(s.value.tax)),1)]),e(me,{class:"my-2"}),t("div",Je,[i[15]||(i[15]=t("span",{class:"text-h6 font-weight-bold"},"Total:",-1)),t("span",We,r(h(s.value.total)),1)])])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),e(_e,{class:"pa-4"},{default:a(()=>[e(ge),e(P,{variant:"text",onClick:Z},{default:a(()=>i[16]||(i[16]=[_(" Batal ")])),_:1,__:[16]}),e(P,{color:"primary",loading:x.value,disabled:!b.value,onClick:se},{default:a(()=>[_(r(u.mode==="edit"?"Update":"Simpan"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ze=ye(Ye,[["__scopeId","data-v-98b818fb"]]),et={class:"d-flex align-center gap-3"},tt={class:"d-flex justify-space-between align-center"},at={class:"text-h6"},lt={class:"text-body-1"},st={class:"font-weight-medium"},ot={class:"text-caption text-medium-emphasis"},nt={class:"font-weight-medium"},it={class:"d-flex justify-space-between"},rt={class:"font-weight-medium"},ut=ve({__name:"PurchaseReceiveDialog",props:{modelValue:{type:Boolean},purchase:{}},emits:["update:modelValue","success"],setup(te,{emit:J}){const v=te,B=J,z=w(!1),S=w(!1),T=w(new Date().toISOString().split("T")[0]),x=w([]),k=W({get:()=>v.modelValue,set:y=>B("update:modelValue",y)}),j=W(()=>T.value&&s()>0&&!S.value),F=[{title:"Item",key:"item_name",sortable:!1,width:"250px"},{title:"Ordered",key:"quantity_ordered",sortable:!1,width:"110px"},{title:"Received",key:"quantity_received",sortable:!1,width:"110px"},{title:"Remaining",key:"remaining",sortable:!1,width:"110px"},{title:"Receive Qty",key:"receive_quantity",sortable:!1,width:"140px"},{title:"Quality",key:"quality_check",sortable:!1,width:"140px"},{title:"Notes",key:"notes",sortable:!1,width:"200px"},{title:"Status",key:"status",sortable:!1,width:"120px"}],A=[{title:"âœ… Good",value:"good"},{title:"âŒ Damaged",value:"damaged"},{title:"â° Expired",value:"expired"},{title:"âš ï¸ Issues",value:"partial"}],g=y=>y.quantity_ordered-(y.quantity_received||0),c=y=>{const p=g(y);return p<=0?"text-success":p<y.quantity_ordered*.5?"text-warning":""},s=()=>x.value.filter(y=>y.receive_quantity&&y.receive_quantity>0).length,b=y=>{const p=g(y);y.receive_quantity>p&&(y.receive_quantity=p),y.receive_quantity<0&&(y.receive_quantity=0)},N=y=>({pending:"warning",ordered:"info",partial:"primary",received:"success",completed:"success",cancelled:"error"})[y]||"default",D=y=>({pending:"Pending",ordered:"Ordered",partial:"Partial",received:"Received",completed:"Completed",cancelled:"Cancelled"})[y]||y,O=y=>({pending:"warning",partial:"primary",received:"success"})[y]||"default",E=y=>({pending:"Pending",partial:"Partial",received:"Complete"})[y]||y,ie=y=>new Date(y).toLocaleDateString("id-ID"),re=async()=>{var y,p;if((y=v.purchase)!=null&&y.id_purchase){z.value=!0;try{if(console.log("Purchase props:",v.purchase),v.purchase.items&&v.purchase.items.length>0){console.log("Using items from props:",v.purchase.items),x.value=v.purchase.items.map(h=>({...h,receive_quantity:0,quality_condition:"good",receive_notes:""})),z.value=!1;return}console.log("Fetching items from API...");const d=await Q.get(`/api/purchases/${v.purchase.id_purchase}`,{headers:{Authorization:`Bearer ${K()}`}});console.log("API Response:",d.data),d.data.success&&((p=d.data.data)!=null&&p.items)&&(console.log("Using items from API data.data:",d.data.data.items),x.value=d.data.data.items.map(h=>({...h,receive_quantity:0,quality_condition:"good",receive_notes:""})))}catch(d){console.error("Error loading purchase items:",d)}finally{z.value=!1}}},ae=async()=>{if(!j.value)return;const y=x.value.filter(p=>p.receive_quantity&&p.receive_quantity>0).map(p=>({id_purchase_item:p.id_purchase_item,quantity_received:p.receive_quantity,quality_check:{condition:p.quality_condition,checked_at:new Date().toISOString(),checked_by:"current_user"},notes:p.receive_notes||null}));if(y.length!==0){S.value=!0;try{const p=await Q.post(`/api/purchases/${v.purchase.id_purchase}/receive`,{items:y,delivery_date:T.value},{headers:{Authorization:`Bearer ${K()}`}});p.data.success&&(B("success",p.data),le())}catch(p){console.error("Error receiving items:",p)}finally{S.value=!1}}},le=()=>{k.value=!1,x.value=[],T.value=new Date().toISOString().split("T")[0]};return ce(k,y=>{y&&v.purchase&&re()}),(y,p)=>(V(),R(fe,{modelValue:k.value,"onUpdate:modelValue":p[1]||(p[1]=d=>k.value=d),"max-width":"1400px",persistent:""},{default:a(()=>[e($,null,{default:a(()=>[e(G,{class:"pa-4"},{default:a(()=>{var d;return[t("div",et,[e(H,{icon:"mdi-package-variant"}),t("span",null,"Receive Items - Purchase #"+r((d=y.purchase)==null?void 0:d.purchase_number),1)])]}),_:1}),e(me),e(U,{class:"pa-4"},{default:a(()=>[e($,{variant:"outlined",class:"mb-4"},{default:a(()=>[e(U,{class:"pa-3"},{default:a(()=>{var d,h,L,se;return[t("div",tt,[t("div",null,[p[2]||(p[2]=t("div",{class:"text-body-2 text-medium-emphasis"}," Supplier ",-1)),t("div",at,r((h=(d=y.purchase)==null?void 0:d.supplier)==null?void 0:h.name),1)]),t("div",null,[p[3]||(p[3]=t("div",{class:"text-body-2 text-medium-emphasis"}," Order Date ",-1)),t("div",lt,r(ie((L=y.purchase)==null?void 0:L.purchase_date)),1)]),t("div",null,[p[4]||(p[4]=t("div",{class:"text-body-2 text-medium-emphasis"}," Status ",-1)),e(ee,{color:N((se=y.purchase)==null?void 0:se.status),variant:"tonal",size:"small"},{default:a(()=>{var Z;return[_(r(D((Z=y.purchase)==null?void 0:Z.status)),1)]}),_:1},8,["color"])])])]}),_:1})]),_:1}),e(Y,{class:"mb-4"},{default:a(()=>[e(I,{cols:"12",md:"6"},{default:a(()=>[e(X,{modelValue:T.value,"onUpdate:modelValue":p[0]||(p[0]=d=>T.value=d),label:"Delivery Date",type:"date",variant:"outlined",rules:[d=>!!d||"Delivery date is required"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),p[7]||(p[7]=t("div",{class:"text-h6 mb-3"}," Items to Receive ",-1)),e(ze,{headers:F,items:x.value,loading:z.value,"item-key":"id_purchase_item",class:"border rounded",density:"compact"},{"item.item_name":a(({item:d})=>{var h,L;return[t("div",null,[t("div",st,r((h=d.item)==null?void 0:h.name),1),t("div",ot,r((L=d.item)==null?void 0:L.item_code),1)])]}),"item.quantity_ordered":a(({item:d})=>{var h;return[t("span",nt,r(parseInt(d.quantity_ordered))+" "+r((h=d.item)==null?void 0:h.unit),1)]}),"item.quantity_received":a(({item:d})=>{var h;return[t("span",{class:be(d.quantity_received>0?"text-success":"")},r(d.quantity_received||0)+" "+r((h=d.item)==null?void 0:h.unit),3)]}),"item.remaining":a(({item:d})=>{var h;return[t("span",{class:be(["font-weight-medium",c(d)])},r(g(d))+" "+r((h=d.item)==null?void 0:h.unit),3)]}),"item.receive_quantity":a(({item:d})=>[e(X,{modelValue:d.receive_quantity,"onUpdate:modelValue":h=>d.receive_quantity=h,modelModifiers:{number:!0},type:"number",min:0,max:g(d),step:"0.001",density:"compact",variant:"outlined",style:{"inline-size":"140px"},disabled:g(d)<=0,onInput:h=>b(d)},null,8,["modelValue","onUpdate:modelValue","max","disabled","onInput"])]),"item.quality_check":a(({item:d})=>[e(pe,{modelValue:d.quality_condition,"onUpdate:modelValue":h=>d.quality_condition=h,items:A,density:"compact",variant:"outlined",style:{"inline-size":"140px"},disabled:!d.receive_quantity||d.receive_quantity<=0},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.notes":a(({item:d})=>[e(X,{modelValue:d.receive_notes,"onUpdate:modelValue":h=>d.receive_notes=h,placeholder:"Notes...",density:"compact",variant:"outlined",style:{"inline-size":"200px"},disabled:!d.receive_quantity||d.receive_quantity<=0},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.status":a(({item:d})=>[e(ee,{color:O(d.status),variant:"tonal",size:"small"},{default:a(()=>[_(r(E(d.status)),1)]),_:2},1032,["color"])]),_:1},8,["items","loading"]),e($,{variant:"outlined",class:"mt-4"},{default:a(()=>[e(U,{class:"pa-3"},{default:a(()=>[p[6]||(p[6]=t("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Receive Summary ",-1)),t("div",it,[p[5]||(p[5]=t("span",null,"Items to receive:",-1)),t("span",rt,r(s()),1)])]),_:1,__:[6]})]),_:1})]),_:1,__:[7]}),e(me),e(_e,{class:"pa-4"},{default:a(()=>[e(ge),e(P,{variant:"outlined",disabled:S.value,onClick:le},{default:a(()=>p[8]||(p[8]=[_(" Cancel ")])),_:1,__:[8]},8,["disabled"]),e(P,{color:"primary",loading:S.value,disabled:!j.value,onClick:ae},{default:a(()=>[e(H,{start:"",icon:"mdi-check"}),p[9]||(p[9]=_(" Confirm Receipt "))]),_:1,__:[9]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),dt={class:"d-flex align-center gap-2"},ct={class:"mb-2"},pt={class:"text-primary font-weight-medium"},mt={class:"mb-2"},vt={class:"mb-2"},ft={key:0,class:"mb-2"},_t={key:1},gt={class:"mb-2"},yt={class:"mb-2"},ht={class:"mb-2"},bt={class:"mb-1 font-weight-medium"},Vt={key:0,class:"text-caption text-medium-emphasis mb-0"},wt={key:1,class:"text-caption text-medium-emphasis mb-0"},kt={class:"text-center"},xt={key:0},It={class:"text-right font-weight-medium"},Dt={class:"text-right font-weight-medium"},Ct={class:"text-center"},$t={class:"mb-0"},qt={class:"mb-2"},Pt={key:0},St={class:"d-flex justify-space-between mb-2"},Tt={class:"font-weight-medium"},zt={key:0,class:"d-flex justify-space-between mb-2"},Ut={class:"text-success"},jt={class:"d-flex justify-space-between mb-2"},At={class:"d-flex justify-space-between"},Nt={class:"text-h6 font-weight-bold text-primary"},Rt=ve({__name:"PurchaseViewDialog",props:{modelValue:{type:Boolean},purchase:{default:null}},emits:["update:modelValue"],setup(te,{emit:J}){const v=te,B=J,z=W({get:()=>v.modelValue,set:c=>B("update:modelValue",c)}),S=W(()=>v.purchase&&v.purchase.status!=="cancelled"),T=()=>{z.value=!1},x=c=>{const s=typeof c=="string"?parseFloat(c):c;return isNaN(s)||s===null||s===void 0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)},k=c=>c?new Date(c).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"}):"-",j=c=>c?new Date(c).toLocaleString("id-ID",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",F=c=>({pending:"warning",partial:"info",received:"success",cancelled:"error"})[c]||"default",A=c=>({pending:"Pending",partial:"Sebagian",received:"Diterima",cancelled:"Dibatalkan"})[c]||c,g=()=>{window.print()};return(c,s)=>(V(),R(fe,{modelValue:z.value,"onUpdate:modelValue":s[0]||(s[0]=b=>z.value=b),"max-width":"900",persistent:""},{default:a(()=>[e($,null,{default:a(()=>[e(G,{class:"d-flex align-center justify-space-between"},{default:a(()=>[t("div",dt,[e(H,null,{default:a(()=>s[1]||(s[1]=[_("mdi-file-document-outline")])),_:1,__:[1]}),s[2]||(s[2]=t("span",null,"Purchase Order Detail",-1))]),e(P,{icon:"mdi-close",size:"small",variant:"text",onClick:T})]),_:1}),c.purchase?(V(),R(U,{key:0},{default:a(()=>[e(Y,{class:"mb-6"},{default:a(()=>[e(I,{cols:"12",md:"6"},{default:a(()=>[e($,{variant:"outlined"},{default:a(()=>[e(G,{class:"text-subtitle-1"},{default:a(()=>s[3]||(s[3]=[_("Purchase Information")])),_:1,__:[3]}),e(U,null,{default:a(()=>[t("div",ct,[s[4]||(s[4]=t("strong",null,"Purchase Number:",-1)),s[5]||(s[5]=t("br",null,null,-1)),t("span",pt,r(c.purchase.purchase_number),1)]),t("div",mt,[s[6]||(s[6]=t("strong",null,"Status:",-1)),s[7]||(s[7]=t("br",null,null,-1)),e(ee,{color:F(c.purchase.status),size:"small",variant:"elevated"},{default:a(()=>[_(r(A(c.purchase.status)),1)]),_:1},8,["color"])]),t("div",vt,[s[8]||(s[8]=t("strong",null,"Tanggal Purchase:",-1)),s[9]||(s[9]=t("br",null,null,-1)),_(" "+r(k(c.purchase.purchase_date)),1)]),c.purchase.expected_delivery_date?(V(),M("div",ft,[s[10]||(s[10]=t("strong",null,"Tanggal Kirim Diharapkan:",-1)),s[11]||(s[11]=t("br",null,null,-1)),_(" "+r(k(c.purchase.expected_delivery_date)),1)])):C("",!0),c.purchase.actual_delivery_date?(V(),M("div",_t,[s[12]||(s[12]=t("strong",null,"Tanggal Kirim Aktual:",-1)),s[13]||(s[13]=t("br",null,null,-1)),_(" "+r(k(c.purchase.actual_delivery_date)),1)])):C("",!0)]),_:1})]),_:1})]),_:1}),e(I,{cols:"12",md:"6"},{default:a(()=>[e($,{variant:"outlined"},{default:a(()=>[e(G,{class:"text-subtitle-1"},{default:a(()=>s[14]||(s[14]=[_("Supplier Information")])),_:1,__:[14]}),e(U,null,{default:a(()=>{var b,N,D,O;return[t("div",gt,[s[15]||(s[15]=t("strong",null,"Nama Supplier:",-1)),s[16]||(s[16]=t("br",null,null,-1)),_(" "+r(((b=c.purchase.supplier)==null?void 0:b.name)||"-"),1)]),t("div",yt,[s[17]||(s[17]=t("strong",null,"Telepon:",-1)),s[18]||(s[18]=t("br",null,null,-1)),_(" "+r(((N=c.purchase.supplier)==null?void 0:N.phone)||"-"),1)]),t("div",ht,[s[19]||(s[19]=t("strong",null,"Email:",-1)),s[20]||(s[20]=t("br",null,null,-1)),_(" "+r(((D=c.purchase.supplier)==null?void 0:D.email)||"-"),1)]),t("div",null,[s[21]||(s[21]=t("strong",null,"Alamat:",-1)),s[22]||(s[22]=t("br",null,null,-1)),_(" "+r(((O=c.purchase.supplier)==null?void 0:O.address)||"-"),1)])]}),_:1})]),_:1})]),_:1})]),_:1}),e($,{variant:"outlined",class:"mb-6"},{default:a(()=>[e(G,{class:"text-subtitle-1"},{default:a(()=>s[23]||(s[23]=[_("Items Purchase")])),_:1,__:[23]}),e(De,null,{default:a(()=>[s[24]||(s[24]=t("thead",null,[t("tr",null,[t("th",null,"Item"),t("th",{class:"text-center"},"Qty"),t("th",{class:"text-right"},"Unit Cost"),t("th",{class:"text-right"},"Total Cost"),t("th",{class:"text-center"},"Status")])],-1)),t("tbody",null,[(V(!0),M(Ie,null,ke(c.purchase.items,b=>{var N,D,O;return V(),M("tr",{key:b.id_purchase_item},[t("td",null,[t("div",null,[t("p",bt,r(((N=b.item)==null?void 0:N.name)||"-"),1),(D=b.item)!=null&&D.code?(V(),M("p",Vt," Code: "+r(b.item.code),1)):C("",!0),(O=b.item)!=null&&O.description?(V(),M("p",wt,r(b.item.description),1)):C("",!0)])]),t("td",kt,[e(ee,{size:"small",variant:"outlined"},{default:a(()=>[_(r(parseInt(b.quantity_ordered))+" "+r(b.unit||"pcs"),1)]),_:2},1024),b.quantity_received>0?(V(),M("br",xt)):C("",!0),b.quantity_received>0?(V(),R(ee,{key:1,size:"x-small",variant:"tonal",color:"success",class:"mt-1"},{default:a(()=>[_(" Received: "+r(parseInt(b.quantity_received)),1)]),_:2},1024)):C("",!0)]),t("td",It,r(x(b.unit_cost)),1),t("td",Dt,r(x(b.total_cost)),1),t("td",Ct,[e(ee,{color:F(b.status),size:"small",variant:"tonal"},{default:a(()=>[_(r(A(b.status)),1)]),_:2},1032,["color"])])])}),128))])]),_:1,__:[24]})]),_:1}),e(Y,null,{default:a(()=>[e(I,{cols:"12",md:"6"},{default:a(()=>[c.purchase.notes?(V(),R($,{key:0,variant:"outlined"},{default:a(()=>[e(G,{class:"text-subtitle-1"},{default:a(()=>s[25]||(s[25]=[_("Catatan")])),_:1,__:[25]}),e(U,null,{default:a(()=>[t("p",$t,r(c.purchase.notes),1)]),_:1})]),_:1})):C("",!0),e($,{variant:"outlined",class:"mt-4"},{default:a(()=>[e(G,{class:"text-subtitle-1"},{default:a(()=>s[26]||(s[26]=[_("Purchase History")])),_:1,__:[26]}),e(U,null,{default:a(()=>{var b,N;return[t("div",qt,[s[27]||(s[27]=t("strong",null,"Dibuat oleh:",-1)),s[28]||(s[28]=t("br",null,null,-1)),_(" "+r(((b=c.purchase.creator)==null?void 0:b.name)||"-")+" â€¢ "+r(j(c.purchase.created_at)),1)]),c.purchase.updated_at&&c.purchase.updated_at!==c.purchase.created_at?(V(),M("div",Pt,[s[29]||(s[29]=t("strong",null,"Diupdate oleh:",-1)),s[30]||(s[30]=t("br",null,null,-1)),_(" "+r(((N=c.purchase.updater)==null?void 0:N.name)||"-")+" â€¢ "+r(j(c.purchase.updated_at)),1)])):C("",!0)]}),_:1})]),_:1})]),_:1}),e(I,{cols:"12",md:"6"},{default:a(()=>[e($,{variant:"outlined"},{default:a(()=>[e(G,{class:"text-subtitle-1"},{default:a(()=>s[31]||(s[31]=[_("Total Summary")])),_:1,__:[31]}),e(U,null,{default:a(()=>[t("div",St,[s[32]||(s[32]=t("span",null,"Subtotal:",-1)),t("span",Tt,r(x(c.purchase.subtotal)),1)]),c.purchase.discount_amount>0?(V(),M("div",zt,[s[33]||(s[33]=t("span",null,"Diskon:",-1)),t("span",Ut,"-"+r(x(c.purchase.discount_amount)),1)])):C("",!0),t("div",jt,[s[34]||(s[34]=t("span",null,"PPN (11%):",-1)),t("span",null,r(x(c.purchase.tax_amount)),1)]),e(me,{class:"my-3"}),t("div",At,[s[35]||(s[35]=t("span",{class:"text-h6 font-weight-bold"},"Total:",-1)),t("span",Nt,r(x(c.purchase.total_amount)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):C("",!0),e(_e,{class:"pa-4"},{default:a(()=>[e(ge),e(P,{variant:"text",onClick:T},{default:a(()=>s[36]||(s[36]=[_(" Tutup ")])),_:1,__:[36]}),S.value?(V(),R(P,{key:0,color:"primary",variant:"tonal","prepend-icon":"mdi-printer",onClick:g},{default:a(()=>s[37]||(s[37]=[_(" Print ")])),_:1,__:[37]})):C("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Bt=ye(Rt,[["__scopeId","data-v-9531ec00"]]),Ft={class:"d-flex justify-space-between align-center"},Ot={class:"d-flex justify-space-between align-center"},Et={class:"text-h4 font-weight-bold text-white"},Mt={class:"d-flex justify-space-between align-center"},Lt={class:"text-h4 font-weight-bold text-white"},Qt={class:"d-flex justify-space-between align-center"},Kt={class:"text-h4 font-weight-bold text-white"},Ht={class:"d-flex justify-space-between align-center"},Xt={class:"text-h4 font-weight-bold text-white"},Gt={class:"d-flex align-center"},Jt={class:"mb-0 font-weight-medium"},Wt={class:"text-caption text-medium-emphasis mb-0"},Yt={class:"font-weight-medium"},Zt={class:"d-flex gap-1"},ea={class:"d-flex justify-center pt-2"},ta=ve({__name:"purchases-management",setup(te){const J=w([]),v=w([]),B=w({}),z=w(!1),S=w(1),T=w(15),x=w(0),k=w({show:!1,message:"",color:"success"}),j=w(!1),F=w(!1),A=w(!1),g=w(null),c=w("create"),s=w({search:"",status:"",supplier_id:"",start_date:"",end_date:""}),b=[{title:"Purchase Number",key:"purchase_number",sortable:!0},{title:"Supplier",key:"supplier.name",sortable:!1},{title:"Tanggal",key:"purchase_date",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Total",key:"total_amount",sortable:!0},{title:"Actions",key:"actions",sortable:!1,width:"150px"}],N=[{label:"Semua Status",value:""},{label:"Pending",value:"pending"},{label:"Ordered",value:"ordered"},{label:"Received",value:"received"},{label:"Completed",value:"completed"},{label:"Cancelled",value:"cancelled"}],D=async()=>{var n,l;try{z.value=!0;const o={page:S.value,per_page:T.value};Object.keys(s.value).forEach(de=>{s.value[de]&&s.value[de]!==""&&(o[de]=s.value[de])});const m=K(),q={"Content-Type":"application/json",Accept:"application/json"};m&&(q.Authorization=`Bearer ${m}`);const ue=await Q.get("/api/purchases",{params:o,headers:q});J.value=ue.data.data.data||[],x.value=ue.data.data.total||0}catch(o){console.error("Error loading purchases:",o),k.value={show:!0,message:"Error loading purchases: "+(((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||o.message),color:"error"}}finally{z.value=!1}},O=async()=>{try{const n=K(),l={"Content-Type":"application/json",Accept:"application/json"};n&&(l.Authorization=`Bearer ${n}`);const o=await Q.get("/api/suppliers",{headers:l});v.value=o.data.data||[]}catch(n){console.error("Error loading suppliers:",n)}},E=async()=>{try{const n=K(),l={"Content-Type":"application/json",Accept:"application/json"};n&&(l.Authorization=`Bearer ${n}`);const o=await Q.get("/api/purchases/statistics",{headers:l});B.value=o.data.data||{}}catch(n){console.error("Error loading statistics:",n)}},ie=()=>{g.value=null,c.value="create",j.value=!0},re=n=>{console.log("ðŸ”§ editPurchase called with:",n),console.log("ðŸ‘¤ Purchase supplier ID:",n.id_supplier),console.log("ðŸ“¦ Purchase items:",n.items),g.value=n,c.value="edit",j.value=!0,console.log("ðŸ“‹ selectedPurchase set to:",g.value),console.log("ðŸŽ¯ dialogMode set to:",c.value)},ae=n=>{g.value=n,F.value=!0},le=n=>{g.value=n,A.value=!0},y=async n=>{var l,o;if(confirm(`Apakah Anda yakin ingin menghapus purchase ${n.purchase_number}?`))try{const m=K(),q={"Content-Type":"application/json",Accept:"application/json"};m&&(q.Authorization=`Bearer ${m}`),await Q.delete(`/api/purchases/${n.id_purchase}`,{headers:q}),D(),E()}catch(m){console.error("Error deleting purchase:",m),alert("Error deleting purchase: "+(((o=(l=m.response)==null?void 0:l.data)==null?void 0:o.message)||m.message))}},p=async(n,l)=>{var o,m;try{const q=K(),ue={"Content-Type":"application/json",Accept:"application/json"};q&&(ue.Authorization=`Bearer ${q}`),await Q.patch(`/api/purchases/${n.id_purchase}/status`,{status:l},{headers:ue}),D(),E(),k.value={show:!0,message:`Purchase status berhasil diubah ke ${l}!`,color:"success"}}catch(q){console.error("Error updating purchase status:",q),k.value={show:!0,message:"Error updating status: "+(((m=(o=q.response)==null?void 0:o.data)==null?void 0:m.message)||q.message),color:"error"}}},d=()=>{j.value=!1,D(),E(),k.value={show:!0,message:c.value==="create"?"Purchase order berhasil dibuat!":"Purchase order berhasil diperbarui!",color:"success"}},h=()=>{A.value=!1,D(),E(),k.value={show:!0,message:"Items berhasil diterima!",color:"success"}},L=n=>{const l=typeof n=="string"?parseFloat(n):n;return isNaN(l)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l)},se=n=>n?new Date(n).toLocaleDateString("id-ID"):"-",Z=n=>({pending:"warning",ordered:"info",received:"primary",completed:"success",cancelled:"error"})[n]||"default",u=n=>({pending:"Pending",ordered:"Dipesan",received:"Diterima",completed:"Selesai",cancelled:"Dibatalkan"})[n]||n,i=n=>["pending","ordered"].includes(n.status),f=n=>n.status==="pending";return ce(s,()=>{S.value=1,D()},{deep:!0}),we(()=>{D(),O(),E()}),(n,l)=>(V(),R(je,{fluid:""},{default:a(()=>[e(Y,{class:"mb-4"},{default:a(()=>[e(I,{cols:"12"},{default:a(()=>[t("div",Ft,[l[15]||(l[15]=t("div",null,[t("h1",{class:"text-h4 font-weight-bold"},"Purchase Management"),t("p",{class:"text-body-1 text-medium-emphasis"},"Kelola pembelian barang dari supplier")],-1)),e(P,{color:"primary",size:"large",onClick:ie},{default:a(()=>[e(H,{start:""},{default:a(()=>l[13]||(l[13]=[_("mdi-plus")])),_:1,__:[13]}),l[14]||(l[14]=_(" Buat Purchase Order "))]),_:1,__:[14]})])]),_:1})]),_:1}),e(Y,{class:"mb-6"},{default:a(()=>[e(I,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e($,{color:"primary"},{default:a(()=>[e(U,null,{default:a(()=>[t("div",Ot,[t("div",null,[l[16]||(l[16]=t("p",{class:"text-caption text-white mb-1"},"Total Purchase",-1)),t("p",Et,r(B.value.total_purchases||0),1)]),e(H,{size:"40",class:"text-white"},{default:a(()=>l[17]||(l[17]=[_("mdi-cart")])),_:1,__:[17]})])]),_:1})]),_:1})]),_:1}),e(I,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e($,{color:"warning"},{default:a(()=>[e(U,null,{default:a(()=>[t("div",Mt,[t("div",null,[l[18]||(l[18]=t("p",{class:"text-caption text-white mb-1"},"Pending",-1)),t("p",Lt,r(B.value.pending_purchases||0),1)]),e(H,{size:"40",class:"text-white"},{default:a(()=>l[19]||(l[19]=[_("mdi-clock")])),_:1,__:[19]})])]),_:1})]),_:1})]),_:1}),e(I,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e($,{color:"success"},{default:a(()=>[e(U,null,{default:a(()=>[t("div",Qt,[t("div",null,[l[20]||(l[20]=t("p",{class:"text-caption text-white mb-1"},"Completed",-1)),t("p",Kt,r(B.value.completed_purchases||0),1)]),e(H,{size:"40",class:"text-white"},{default:a(()=>l[21]||(l[21]=[_("mdi-check-circle")])),_:1,__:[21]})])]),_:1})]),_:1})]),_:1}),e(I,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e($,{color:"info"},{default:a(()=>[e(U,null,{default:a(()=>[t("div",Ht,[t("div",null,[l[22]||(l[22]=t("p",{class:"text-caption text-white mb-1"},"Bulan Ini",-1)),t("p",Xt,r(L(B.value.total_amount_this_month||0)),1)]),e(H,{size:"40",class:"text-white"},{default:a(()=>l[23]||(l[23]=[_("mdi-currency-usd")])),_:1,__:[23]})])]),_:1})]),_:1})]),_:1})]),_:1}),e($,{class:"mb-6"},{default:a(()=>[e(U,null,{default:a(()=>[e(Y,null,{default:a(()=>[e(I,{cols:"12",md:"3"},{default:a(()=>[e(X,{modelValue:s.value.search,"onUpdate:modelValue":l[0]||(l[0]=o=>s.value.search=o),label:"Cari Purchase Number","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"","onClick:clear":l[1]||(l[1]=o=>s.value.search="")},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",md:"2"},{default:a(()=>[e(pe,{modelValue:s.value.status,"onUpdate:modelValue":l[2]||(l[2]=o=>s.value.status=o),label:"Status",items:N,"item-title":"label","item-value":"value",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",md:"2"},{default:a(()=>[e(pe,{modelValue:s.value.supplier_id,"onUpdate:modelValue":l[3]||(l[3]=o=>s.value.supplier_id=o),label:"Supplier",items:v.value,"item-title":"name","item-value":"id_supplier",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),e(I,{cols:"12",md:"2"},{default:a(()=>[e(X,{modelValue:s.value.start_date,"onUpdate:modelValue":l[4]||(l[4]=o=>s.value.start_date=o),label:"Tanggal Mulai",type:"date",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",md:"2"},{default:a(()=>[e(X,{modelValue:s.value.end_date,"onUpdate:modelValue":l[5]||(l[5]=o=>s.value.end_date=o),label:"Tanggal Akhir",type:"date",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",md:"1"},{default:a(()=>[e(P,{color:"primary",variant:"tonal",icon:"mdi-refresh",onClick:D})]),_:1})]),_:1})]),_:1})]),_:1}),e($,null,{default:a(()=>[e(Ae,{"items-per-page":T.value,"onUpdate:itemsPerPage":l[7]||(l[7]=o=>T.value=o),page:S.value,"onUpdate:page":l[8]||(l[8]=o=>S.value=o),headers:b,items:J.value,"items-length":x.value,loading:z.value,"item-value":"id_purchase","onUpdate:options":D},{"item.purchase_number":a(({item:o})=>[t("div",Gt,[e(P,{variant:"text",color:"primary",size:"small",onClick:m=>ae(o)},{default:a(()=>[_(r(o.purchase_number),1)]),_:2},1032,["onClick"])])]),"item.supplier.name":a(({item:o})=>{var m,q;return[t("div",null,[t("p",Jt,r(((m=o.supplier)==null?void 0:m.name)||"-"),1),t("p",Wt,r(((q=o.supplier)==null?void 0:q.phone)||"-"),1)])]}),"item.purchase_date":a(({item:o})=>[_(r(se(o.purchase_date)),1)]),"item.status":a(({item:o})=>[e(ee,{color:Z(o.status),size:"small",variant:"elevated"},{default:a(()=>[_(r(u(o.status)),1)]),_:2},1032,["color"])]),"item.total_amount":a(({item:o})=>[t("span",Yt,r(L(o.total_amount)),1)]),"item.actions":a(({item:o})=>[t("div",Zt,[e(P,{icon:"mdi-eye",size:"small",variant:"text",color:"info",onClick:m=>ae(o)},null,8,["onClick"]),i(o)?(V(),R(P,{key:0,icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:m=>re(o)},null,8,["onClick"])):C("",!0),["ordered","received"].includes(o.status)?(V(),R(P,{key:1,icon:"mdi-truck-delivery",size:"small",variant:"text",color:"success",onClick:m=>le(o)},null,8,["onClick"])):C("",!0),f(o)?(V(),R(P,{key:2,icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:m=>y(o)},null,8,["onClick"])):C("",!0),e(Ne,null,{activator:a(({props:m})=>[e(P,xe({icon:"mdi-dots-vertical",size:"small",variant:"text"},m),null,16)]),default:a(()=>[e(Pe,null,{default:a(()=>[o.status==="pending"?(V(),R(oe,{key:0,onClick:m=>p(o,"ordered")},{default:a(()=>[e(ne,null,{default:a(()=>l[24]||(l[24]=[_("Mark as Ordered")])),_:1,__:[24]})]),_:2},1032,["onClick"])):C("",!0),o.status==="ordered"?(V(),R(oe,{key:1,onClick:m=>p(o,"received")},{default:a(()=>[e(ne,null,{default:a(()=>l[25]||(l[25]=[_("Mark as Received")])),_:1,__:[25]})]),_:2},1032,["onClick"])):C("",!0),o.status==="received"?(V(),R(oe,{key:2,onClick:m=>p(o,"completed")},{default:a(()=>[e(ne,null,{default:a(()=>l[26]||(l[26]=[_("Mark as Completed")])),_:1,__:[26]})]),_:2},1032,["onClick"])):C("",!0),["pending","ordered"].includes(o.status)?(V(),R(oe,{key:3,onClick:m=>p(o,"cancelled")},{default:a(()=>[e(ne,{class:"text-error"},{default:a(()=>l[27]||(l[27]=[_("Cancel Purchase")])),_:1,__:[27]})]),_:2},1032,["onClick"])):C("",!0)]),_:2},1024)]),_:2},1024)])]),bottom:a(()=>[t("div",ea,[e(Ue,{modelValue:S.value,"onUpdate:modelValue":l[6]||(l[6]=o=>S.value=o),length:Math.ceil(x.value/T.value),"total-visible":5},null,8,["modelValue","length"])])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1}),e(Ze,{modelValue:j.value,"onUpdate:modelValue":l[9]||(l[9]=o=>j.value=o),purchase:g.value,mode:c.value,onSaved:d},null,8,["modelValue","purchase","mode"]),e(Bt,{modelValue:F.value,"onUpdate:modelValue":l[10]||(l[10]=o=>F.value=o),purchase:g.value},null,8,["modelValue","purchase"]),e(ut,{modelValue:A.value,"onUpdate:modelValue":l[11]||(l[11]=o=>A.value=o),purchase:g.value,onSuccess:h},null,8,["modelValue","purchase"]),e(Re,{modelValue:k.value.show,"onUpdate:modelValue":l[12]||(l[12]=o=>k.value.show=o),color:k.value.color,timeout:4e3,location:"top right"},{default:a(()=>[_(r(k.value.message),1)]),_:1},8,["modelValue","color"])]),_:1}))}}),Sa=ye(ta,[["__scopeId","data-v-964b720f"]]);export{Sa as default};
