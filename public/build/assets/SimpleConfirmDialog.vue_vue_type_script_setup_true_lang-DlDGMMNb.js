import{$ as c}from"./api-BAksowdi.js";import{r as v,ax as w,V as m,d as _,c as C,l as $,e as u,t as g,v as T,$ as j,o as F}from"./main-CXIqLbCW.js";function Q(){const l=v([]),r=v(null),a=v(!1),o=v(null),y=w({current_page:1,last_page:1,per_page:20,total:0,from:0,to:0}),p=w({search:"",is_active:void 0,sort_by:"sort_order",sort_order:"asc"}),h=m(()=>l.value.length>0),b=m(()=>!a.value&&!h.value),R=m(()=>l.value.filter(e=>e.is_active)),x=m(()=>l.value.filter(e=>!e.is_active)),f=async(e=1)=>{a.value=!0,o.value=null;try{const s=new URLSearchParams({page:e.toString(),per_page:y.per_page.toString(),...Object.fromEntries(Object.entries(p).filter(([i,n])=>n!==void 0&&n!==""&&n!==null))}),t=await c(`/api/roles?${s}`);l.value=t.data,Object.assign(y,{current_page:t.current_page,last_page:t.last_page,per_page:t.per_page,total:t.total,from:t.from,to:t.to})}catch(s){o.value=s.message||"Failed to fetch roles",l.value=[]}finally{a.value=!1}};return{roles:l,role:r,loading:a,error:o,pagination:y,filters:p,hasRoles:h,isEmpty:b,activeRoles:R,inactiveRoles:x,fetchRoles:f,fetchRole:async e=>{a.value=!0,o.value=null;try{const s=await c(`/api/roles/${e}`);r.value=s.data}catch(s){o.value=s.message||"Failed to fetch role",r.value=null}finally{a.value=!1}},createRole:async e=>{a.value=!0,o.value=null;try{const s=await c("/api/roles",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return l.value.push(s.data),s.data}catch(s){throw o.value=s.message||"Failed to create role",s}finally{a.value=!1}},updateRole:async(e,s)=>{a.value=!0,o.value=null;try{const t=await c(`/api/roles/${e}`,{method:"PUT",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}),i=l.value.findIndex(n=>n.id===e);return i!==-1&&(l.value[i]=t.data),r.value&&r.value.id===e&&(r.value=t.data),t.data}catch(t){throw o.value=t.message||"Failed to update role",t}finally{a.value=!1}},updateRolePermissions:async(e,s)=>{a.value=!0,o.value=null;try{const t=await c(`/api/roles/${e}/permissions`,{method:"PUT",body:{permission_ids:s}}),i=l.value.findIndex(n=>n.id===e);return i!==-1&&(l.value[i]={...l.value[i],...t.data}),t}catch(t){throw o.value=t instanceof Error?t.message:"Failed to update role permissions",t}finally{a.value=!1}},deleteRole:async e=>{a.value=!0,o.value=null;try{await c(`/api/roles/${e}`,{method:"DELETE"}),l.value=l.value.filter(s=>s.id!==e),r.value&&r.value.id===e&&(r.value=null)}catch(s){throw o.value=s.message||"Failed to delete role",s}finally{a.value=!1}},assignPermissions:async(e,s)=>{a.value=!0,o.value=null;try{const t=await c(`/api/roles/${e}/permissions`,{method:"POST",body:JSON.stringify({permission_ids:s}),headers:{"Content-Type":"application/json"}}),i=l.value.findIndex(n=>n.id===e);return i!==-1&&(l.value[i]=t.data),t.data}catch(t){throw o.value=t.message||"Failed to assign permissions",t}finally{a.value=!1}},getRolePermissions:async e=>{a.value=!0,o.value=null;try{return(await c(`/api/roles/${e}/permissions`)).data}catch(s){return o.value=s.message||"Failed to fetch role permissions",[]}finally{a.value=!1}},getRoleUsers:async e=>{a.value=!0,o.value=null;try{return(await c(`/api/roles/${e}/users`)).data}catch(s){return o.value=s.message||"Failed to fetch role users",[]}finally{a.value=!1}},duplicateRole:async(e,s)=>{a.value=!0,o.value=null;try{const t=await c(`/api/roles/${e}/duplicate`,{method:"POST",body:JSON.stringify({name:s}),headers:{"Content-Type":"application/json"}});return l.value.push(t.data),t.data}catch(t){throw o.value=t.message||"Failed to duplicate role",t}finally{a.value=!1}},searchRoles:async e=>{p.search=e,await f(1)},filterRoles:async e=>{Object.assign(p,e),await f(1)},resetFilters:async()=>{Object.assign(p,{search:"",is_active:void 0,sort_by:"sort_order",sort_order:"asc"}),await f(1)},sortRoles:(e,s="asc")=>{l.value.sort((t,i)=>{let n=t[e],d=i[e];return typeof n=="string"&&typeof d=="string"&&(n=n.toLowerCase(),d=d.toLowerCase()),s==="asc"?n<d?-1:n>d?1:0:n>d?-1:n<d?1:0})}}}const O={class:"mt-3 text-center"},P={class:"text-lg leading-6 font-medium text-gray-900 mt-4"},S={class:"mt-2 px-7 py-3"},k={class:"text-sm text-gray-500"},E={class:"flex items-center justify-center space-x-4 px-4 py-3"},W=_({__name:"SimpleConfirmDialog",props:{show:{type:Boolean},title:{},message:{},confirmText:{default:"Confirm"},cancelText:{default:"Cancel"},confirmClass:{default:""}},emits:["confirm","cancel"],setup(l){return(r,a)=>r.show?(F(),C("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:a[3]||(a[3]=o=>r.$emit("cancel"))},[u("div",{class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",onClick:a[2]||(a[2]=j(()=>{},["stop"]))},[u("div",O,[a[4]||(a[4]=u("div",{class:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100"},[u("svg",{class:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),u("h3",P,g(r.title),1),u("div",S,[u("p",k,g(r.message),1)]),u("div",E,[u("button",{onClick:a[0]||(a[0]=o=>r.$emit("cancel")),type:"button",class:"px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},g(r.cancelText),1),u("button",{onClick:a[1]||(a[1]=o=>r.$emit("confirm")),type:"button",class:T(["px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2",r.confirmClass||"bg-red-600 hover:bg-red-700 focus:ring-red-500"])},g(r.confirmText),3)])])])])):$("",!0)}});export{W as _,Q as u};
