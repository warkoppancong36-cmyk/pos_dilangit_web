var Oe=Object.defineProperty;var Je=(s,t,o)=>t in s?Oe(s,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[t]=o;var De=(s,t,o)=>Je(s,typeof t!="symbol"?t+"":t,o);import{D as He}from"./DeleteConfirmationDialog-RmeRaRpg.js";import{a9 as _e,V,cu as Pe,aF as he,W as Z,aG as Ce,r as D,cb as Qe,aB as We,al as Xe,aK as Ue,b9 as Le,L as Ge,a8 as ke,bn as Ye,N as Be,aE as Ze,ag as et,cc as tt,aa as Ve,aJ as ne,b as e,H as Te,ba as at,ck as lt,I as ot,ac as Fe,ae as it,ad as qe,aM as st,p as nt,F as ie,aA as ee,d as Se,w as ut,g as H,f as l,e as i,X as pe,t as f,a0 as X,$ as rt,c as W,l as q,s as z,o as w,i as dt,D as mt,m as ct,aU as vt}from"./main-BfWAMvaV.js";import{V as $e}from"./VDialog-Dp6iNOSB.js";import{b as Me,c as ze,V as ue}from"./VCard-BIHbi9V_.js";import{V as pt}from"./VForm-Dz0jHYrA.js";import{V as re}from"./VCardText-_XlzbKNZ.js";import{V as oe,a as p}from"./VRow-zLONtsgC.js";import{b as yt,c as Re,d as ft,j as _t,a as bt,V as J}from"./VTextField-rwMsrtP_.js";import{V as ye}from"./VSelect-DUZT39jv.js";import{V as gt}from"./VTextarea-BfFz235c.js";import{V as ge}from"./VDivider-B81YhPBz.js";import{V as ht}from"./VSwitch-D4hMP5Pt.js";import{V as Ne}from"./VSpacer-Dcoe1UQv.js";import{V as te}from"./VChip-BXv1AOmX.js";import{V as kt}from"./VDataTableServer-DXpTXL_B.js";import{_ as Vt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VOverlay-Cq2UdRKC.js";import"./forwardRefs-B931MWyl.js";import"./VImg-DLYY_Eya.js";import"./VAvatar-BEF9S7lr.js";/* empty css              */import"./VList-C7jdsZAn.js";import"./VMenu-DBewhLPw.js";import"./VCheckboxBtn-CONHCgFr.js";import"./VDataTable-CcdS6sXp.js";import"./VTable-Dw2UJq8C.js";import"./filter-qlEcaNpm.js";const we=Symbol.for("vuetify:v-slider");function St(s,t,o){const _=o==="vertical",b=t.getBoundingClientRect(),S="touches"in s?s.touches[0]:s;return _?S.clientY-(b.top+b.height/2):S.clientX-(b.left+b.width/2)}function wt(s,t){return"touches"in s&&s.touches.length?s.touches[0][t]:"changedTouches"in s&&s.changedTouches.length?s.changedTouches[0][t]:s[t]}const xt=_e({disabled:{type:Boolean,default:null},error:Boolean,readonly:{type:Boolean,default:null},max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:s=>typeof s=="boolean"||s==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:s=>typeof s=="boolean"||s==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:s=>["vertical","horizontal"].includes(s)},reverse:Boolean,...Xe(),...We({elevation:2}),ripple:{type:Boolean,default:!0}},"Slider"),Dt=s=>{const t=V(()=>parseFloat(s.min)),o=V(()=>parseFloat(s.max)),_=V(()=>Number(s.step)>0?parseFloat(s.step):0),b=V(()=>Math.max(Pe(_.value),Pe(t.value)));function S(P){if(P=parseFloat(P),_.value<=0)return P;const a=Ue(P,t.value,o.value),C=t.value%_.value,$=Math.round((a-C)/_.value)*_.value+C;return parseFloat(Math.min($,o.value).toFixed(b.value))}return{min:t,max:o,step:_,decimals:b,roundValue:S}},Pt=s=>{let{props:t,steps:o,onSliderStart:_,onSliderMove:b,onSliderEnd:S,getActiveThumb:P}=s;const{isRtl:a}=he(),C=Z(()=>t.reverse),$=V(()=>t.direction==="vertical"),R=V(()=>$.value!==C.value),{min:k,max:U,step:L,decimals:N,roundValue:A}=o,Q=V(()=>parseInt(t.thumbSize,10)),u=V(()=>parseInt(t.tickSize,10)),r=V(()=>parseInt(t.trackSize,10)),g=V(()=>(U.value-k.value)/L.value),B=Z(()=>t.disabled),x=V(()=>t.error||t.disabled?void 0:t.thumbColor??t.color),d=V(()=>t.error||t.disabled?void 0:t.trackColor??t.color),m=V(()=>t.error||t.disabled?void 0:t.trackFillColor??t.color),v=Ce(!1),M=Ce(0),j=D(),O=D();function T(n){var xe;const h=(xe=j.value)==null?void 0:xe.$el;if(!h)return;const c=t.direction==="vertical",ve=c?"top":"left",Ee=c?"height":"width",Ie=c?"clientY":"clientX",{[ve]:Ae,[Ee]:Ke}=h.getBoundingClientRect(),je=wt(n,Ie);let be=Math.min(Math.max((je-Ae-M.value)/Ke,0),1)||0;return(c?R.value:R.value!==a.value)&&(be=1-be),A(k.value+be*(U.value-k.value))}const G=n=>{const h=T(n);h!=null&&S({value:h}),v.value=!1,M.value=0},Y=n=>{const h=T(n);O.value=P(n),O.value&&(v.value=!0,O.value.contains(n.target)?M.value=St(n,O.value,t.direction):(M.value=0,h!=null&&b({value:h})),h!=null&&_({value:h}),Le(()=>{var c;return(c=O.value)==null?void 0:c.focus()}))},K={passive:!0,capture:!0};function le(n){const h=T(n);h!=null&&b({value:h})}function de(n){n.stopPropagation(),n.preventDefault(),G(n),window.removeEventListener("mousemove",le,K),window.removeEventListener("mouseup",de)}function me(n){var h;G(n),window.removeEventListener("touchmove",le,K),(h=n.target)==null||h.removeEventListener("touchend",me)}function fe(n){var h;Y(n),window.addEventListener("touchmove",le,K),(h=n.target)==null||h.addEventListener("touchend",me,{passive:!1})}function E(n){n.button===0&&(n.preventDefault(),Y(n),window.addEventListener("mousemove",le,K),window.addEventListener("mouseup",de,{passive:!1}))}const F=n=>{const h=(n-k.value)/(U.value-k.value)*100;return Ue(isNaN(h)?0:h,0,100)},ae=Z(()=>t.showTicks),se=V(()=>ae.value?t.ticks?Array.isArray(t.ticks)?t.ticks.map(n=>({value:n,position:F(n),label:n.toString()})):Object.keys(t.ticks).map(n=>({value:parseFloat(n),position:F(parseFloat(n)),label:t.ticks[n]})):g.value!==1/0?Qe(g.value+1).map(n=>{const h=k.value+n*L.value;return{value:h,position:F(h)}}):[]:[]),ce=V(()=>se.value.some(n=>{let{label:h}=n;return!!h})),y={activeThumbRef:O,color:Z(()=>t.color),decimals:N,disabled:B,direction:Z(()=>t.direction),elevation:Z(()=>t.elevation),hasLabels:ce,isReversed:C,indexFromEnd:R,min:k,max:U,mousePressed:v,numTicks:g,onSliderMousedown:E,onSliderTouchstart:fe,parsedTicks:se,parseMouseMove:T,position:F,readonly:Z(()=>t.readonly),rounded:Z(()=>t.rounded),roundValue:A,showTicks:ae,startOffset:M,step:L,thumbSize:Q,thumbColor:x,thumbLabel:Z(()=>t.thumbLabel),ticks:Z(()=>t.ticks),tickSize:u,trackColor:d,trackContainerRef:j,trackFillColor:m,trackSize:r,vertical:$};return Ge(we,y),y},Ct=_e({focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0},ripple:{type:[Boolean,Object],default:!0},name:String,...Fe()},"VSliderThumb"),Tt=ke()({name:"VSliderThumb",directives:{Ripple:Ye},props:Ct(),emits:{"update:modelValue":s=>!0},setup(s,t){let{slots:o,emit:_}=t;const b=Be(we),{isRtl:S,rtlClasses:P}=he();if(!b)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:a,step:C,disabled:$,thumbSize:R,thumbLabel:k,direction:U,isReversed:L,vertical:N,readonly:A,elevation:Q,mousePressed:u,decimals:r,indexFromEnd:g}=b,B=V(()=>$.value?void 0:Q.value),{elevationClasses:x}=Ze(B),{textColorClasses:d,textColorStyles:m}=et(a),{pageup:v,pagedown:M,end:j,home:O,left:T,right:G,down:Y,up:K}=tt,le=[v,M,j,O,T,G,Y,K],de=V(()=>C.value?[1,2,3]:[1,5,10]);function me(E,F){if(!le.includes(E.key))return;E.preventDefault();const ae=C.value||.1,se=(s.max-s.min)/ae;if([T,G,Y,K].includes(E.key)){const y=(N.value?[S.value?T:G,L.value?Y:K]:g.value!==S.value?[T,K]:[G,K]).includes(E.key)?1:-1,n=E.shiftKey?2:E.ctrlKey?1:0;F=F+y*ae*de.value[n]}else if(E.key===O)F=s.min;else if(E.key===j)F=s.max;else{const ce=E.key===M?1:-1;F=F-ce*ae*(se>100?se/10:10)}return Math.max(s.min,Math.min(s.max,F))}function fe(E){const F=me(E,s.modelValue);F!=null&&_("update:modelValue",F)}return Ve(()=>{const E=ne(g.value?100-s.position:s.position,"%");return e("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":s.focused,"v-slider-thumb--pressed":s.focused&&u.value},s.class,P.value],style:[{"--v-slider-thumb-position":E,"--v-slider-thumb-size":ne(R.value)},s.style],role:"slider",tabindex:$.value?-1:0,"aria-label":s.name,"aria-valuemin":s.min,"aria-valuemax":s.max,"aria-valuenow":s.modelValue,"aria-readonly":!!A.value,"aria-orientation":U.value,onKeydown:A.value?void 0:fe},[e("div",{class:["v-slider-thumb__surface",d.value,x.value],style:{...m.value}},null),Te(e("div",{class:["v-slider-thumb__ripple",d.value],style:m.value},null),[[at("ripple"),s.ripple,null,{circle:!0,center:!0}]]),e(lt,{origin:"bottom center"},{default:()=>{var F;return[Te(e("div",{class:"v-slider-thumb__label-container"},[e("div",{class:["v-slider-thumb__label"]},[e("div",null,[((F=o["thumb-label"])==null?void 0:F.call(o,{modelValue:s.modelValue}))??s.modelValue.toFixed(C.value?r.value:1)])])]),[[ot,k.value&&s.focused||k.value==="always"]])]}})])}),{}}}),qt=_e({start:{type:Number,required:!0},stop:{type:Number,required:!0},...Fe()},"VSliderTrack"),Rt=ke()({name:"VSliderTrack",props:qt(),emits:{},setup(s,t){let{slots:o}=t;const _=Be(we);if(!_)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:b,parsedTicks:S,rounded:P,showTicks:a,tickSize:C,trackColor:$,trackFillColor:R,trackSize:k,vertical:U,min:L,max:N,indexFromEnd:A}=_,{roundedClasses:Q}=it(P),{backgroundColorClasses:u,backgroundColorStyles:r}=qe(R),{backgroundColorClasses:g,backgroundColorStyles:B}=qe($),x=V(()=>`inset-${U.value?"block":"inline"}-${A.value?"end":"start"}`),d=V(()=>U.value?"height":"width"),m=V(()=>({[x.value]:"0%",[d.value]:"100%"})),v=V(()=>s.stop-s.start),M=V(()=>({[x.value]:ne(s.start,"%"),[d.value]:ne(v.value,"%")})),j=V(()=>a.value?(U.value?S.value.slice().reverse():S.value).map((T,G)=>{var K;const Y=T.value!==L.value&&T.value!==N.value?ne(T.position,"%"):void 0;return e("div",{key:T.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":T.position>=s.start&&T.position<=s.stop,"v-slider-track__tick--first":T.value===L.value,"v-slider-track__tick--last":T.value===N.value}],style:{[x.value]:Y}},[(T.label||o["tick-label"])&&e("div",{class:"v-slider-track__tick-label"},[((K=o["tick-label"])==null?void 0:K.call(o,{tick:T,index:G}))??T.label])])}):[]);return Ve(()=>e("div",{class:["v-slider-track",Q.value,s.class],style:[{"--v-slider-track-size":ne(k.value),"--v-slider-tick-size":ne(C.value)},s.style]},[e("div",{class:["v-slider-track__background",g.value,{"v-slider-track__background--opacity":!!b.value||!R.value}],style:{...m.value,...B.value}},null),e("div",{class:["v-slider-track__fill",u.value],style:{...M.value,...r.value}},null),a.value&&e("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":a.value==="always"}]},[j.value])])),{}}}),Ut=_e({..._t(),...xt(),...ft(),modelValue:{type:[Number,String],default:0}},"VSlider"),Lt=ke()({name:"VSlider",props:Ut(),emits:{"update:focused":s=>!0,"update:modelValue":s=>!0,start:s=>!0,end:s=>!0},setup(s,t){let{slots:o,emit:_}=t;const b=D(),{rtlClasses:S}=he(),P=Dt(s),a=st(s,"modelValue",void 0,d=>P.roundValue(d??P.min.value)),{min:C,max:$,mousePressed:R,roundValue:k,onSliderMousedown:U,onSliderTouchstart:L,trackContainerRef:N,position:A,hasLabels:Q,readonly:u}=Pt({props:s,steps:P,onSliderStart:()=>{_("start",a.value)},onSliderEnd:d=>{let{value:m}=d;const v=k(m);a.value=v,_("end",v)},onSliderMove:d=>{let{value:m}=d;return a.value=k(m)},getActiveThumb:()=>{var d;return(d=b.value)==null?void 0:d.$el}}),{isFocused:r,focus:g,blur:B}=yt(s),x=V(()=>A(a.value));return Ve(()=>{const d=Re.filterProps(s),m=!!(s.label||o.label||o.prepend);return e(Re,nt({class:["v-slider",{"v-slider--has-labels":!!o["tick-label"]||Q.value,"v-slider--focused":r.value,"v-slider--pressed":R.value,"v-slider--disabled":s.disabled},S.value,s.class],style:s.style},d,{focused:r.value}),{...o,prepend:m?v=>{var M,j;return e(ie,null,[((M=o.label)==null?void 0:M.call(o,v))??(s.label?e(bt,{id:v.id.value,class:"v-slider__label",text:s.label},null):void 0),(j=o.prepend)==null?void 0:j.call(o,v)])}:void 0,default:v=>{let{id:M,messagesId:j}=v;return e("div",{class:"v-slider__container",onMousedown:u.value?void 0:U,onTouchstartPassive:u.value?void 0:L},[e("input",{id:M.value,name:s.name||M.value,disabled:!!s.disabled,readonly:!!s.readonly,tabindex:"-1",value:a.value},null),e(Rt,{ref:N,start:0,stop:x.value},{"tick-label":o["tick-label"]}),e(Tt,{ref:b,"aria-describedby":j.value,focused:r.value,min:C.value,max:$.value,modelValue:a.value,"onUpdate:modelValue":O=>a.value=O,position:x.value,elevation:s.elevation,onFocus:g,onBlur:B,ripple:s.ripple,name:s.name},{"thumb-label":o["thumb-label"]})])}})}),{}}});class I{static async getPromotions(t={}){return(await ee.get(this.BASE_URL,{params:t})).data.data}static async getPromotion(t){return(await ee.get(`${this.BASE_URL}/${t}`)).data.data}static async createPromotion(t){return(await ee.post(this.BASE_URL,t)).data.data}static async updatePromotion(t,o){return(await ee.put(`${this.BASE_URL}/${t}`,o)).data.data}static async deletePromotion(t){await ee.delete(`${this.BASE_URL}/${t}`)}static async getActivePromotions(){return(await ee.get(`${this.BASE_URL}/active`)).data.data}static async calculatePromotions(t){return(await ee.post(`${this.BASE_URL}/calculate`,{cart_items:t})).data.data}static async getStats(){return(await ee.get(`${this.BASE_URL}/stats`)).data.data}static async toggleStatus(t){return(await ee.post(`${this.BASE_URL}/${t}/toggle-status`)).data.data}static async duplicate(t){return(await ee.post(`${this.BASE_URL}/${t}/duplicate`)).data.data}static getPromotionTypeLabel(t){return{happy_hour:"Happy Hour",buy_one_get_one:"Buy 1 Get 1",combo_deal:"Combo Deal",member_discount:"Member Discount",seasonal:"Seasonal"}[t]||t}static getPromotionTypeIcon(t){return{happy_hour:"mdi-clock-outline",buy_one_get_one:"mdi-numeric-1-box-multiple",combo_deal:"mdi-food-variant",member_discount:"mdi-account-star",seasonal:"mdi-weather-sunny"}[t]||"mdi-tag"}static getPromotionTypeColor(t){return{happy_hour:"warning",buy_one_get_one:"success",combo_deal:"info",member_discount:"secondary",seasonal:"primary"}[t]||"primary"}static getStatusColor(t){return{active:"success",inactive:"secondary",expired:"error",scheduled:"warning",not_applicable:"info"}[t]||"primary"}static getStatusLabel(t){return{active:"Aktif",inactive:"Tidak Aktif",expired:"Kadaluarsa",scheduled:"Terjadwal",not_applicable:"Tidak Berlaku"}[t]||t}static formatCurrency(t){return new Intl.NumberFormat("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}static formatDiscountValue(t){if(!t.discount_value)return"Special Offer";switch(t.discount_type){case"percentage":return`${t.discount_value}% OFF`;case"fixed_amount":return`Rp ${this.formatCurrency(t.discount_value)} OFF`;default:return"Special Offer"}}static getDayLabel(t){return{monday:"Senin",tuesday:"Selasa",wednesday:"Rabu",thursday:"Kamis",friday:"Jumat",saturday:"Sabtu",sunday:"Minggu"}[t]||t}static formatValidDays(t){if(!t||t.length===0)return"Setiap hari";const o=t.map(_=>this.getDayLabel(_));return o.length===7?"Setiap hari":o.length===1?o[0]:o.length===2?o.join(" & "):o.slice(0,-1).join(", ")+" & "+o.slice(-1)[0]}static formatTimeRange(t,o){return!t||!o?"Sepanjang hari":`${t} - ${o}`}static formatPromotionDiscount(t){return t.discount_type==="percentage"?`${t.discount_value}%`:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t.discount_value)}static isPromotionValid(t){if(!t.active)return!1;const o=new Date;if(t.valid_from&&t.valid_until){const _=new Date(t.valid_from),b=new Date(t.valid_until);if(o<_||o>b)return!1}if(t.valid_days&&t.valid_days.length>0){const _=o.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();if(!t.valid_days.includes(_))return!1}if(t.type==="happy_hour"&&t.start_time&&t.end_time){const _=o.toTimeString().slice(0,5);if(_<t.start_time||_>t.end_time)return!1}return!0}static createPromotionRules(t,o){switch(t){case"happy_hour":return{discount_percentage:o.discount_percentage||0,applicable_hours:o.applicable_hours||[]};case"buy_one_get_one":return{buy_quantity:o.buy_quantity||1,get_quantity:o.get_quantity||1,max_free_items:o.max_free_items};case"combo_deal":return{required_items:o.required_items||[],combo_price:o.combo_price||0};case"member_discount":return{member_tiers:o.member_tiers||[],discount_percentage:o.discount_percentage||0};case"seasonal":return{season:o.season||"",discount_percentage:o.discount_percentage||0};default:return o}}static getPriorityLabel(t){return t>=90?"Sangat Tinggi":t>=70?"Tinggi":t>=50?"Sedang":t>=30?"Rendah":"Sangat Rendah"}static getPriorityColor(t){return t>=90?"error":t>=70?"warning":t>=50?"info":t>=30?"success":"secondary"}}De(I,"BASE_URL","/api/promotions");const Bt={class:"d-flex align-center"},Ft=Se({__name:"PromotionDialog",props:{modelValue:{type:Boolean},promotion:{default:null},mode:{}},emits:["update:modelValue","saved"],setup(s,{emit:t}){const o=s,_=t,b=D(),S=D(!1),P=D(!1),a=D({name:"",description:"",type:"happy_hour",discount_type:"percentage",discount_value:0,max_discount_amount:null,minimum_amount:null,priority:5,start_time:null,end_time:null,valid_days:[],buy_quantity:null,get_quantity:null,combo_quantity:null,combo_price:null,min_quantity:null,valid_from:null,valid_until:null,active:!0,promotion_rules:[]}),C=[{title:"Happy Hour",value:"happy_hour"},{title:"Beli 1 Dapat 1",value:"buy_one_get_one"},{title:"Paket Combo",value:"combo_deal"},{title:"Diskon Kategori",value:"category_discount"},{title:"Diskon Quantity",value:"quantity_discount"}],$=[{title:"Persentase (%)",value:"percentage"},{title:"Jumlah Tetap (Rp)",value:"fixed_amount"}],R=[{title:"Senin",value:"monday"},{title:"Selasa",value:"tuesday"},{title:"Rabu",value:"wednesday"},{title:"Kamis",value:"thursday"},{title:"Jumat",value:"friday"},{title:"Sabtu",value:"saturday"},{title:"Minggu",value:"sunday"}],k=V({get:()=>o.modelValue,set:d=>_("update:modelValue",d)}),U=V(()=>o.mode==="create"?"Tambah Promosi Baru":"Edit Promosi"),L=[d=>!!d||"Nama promosi wajib diisi",d=>d.length>=3||"Nama minimal 3 karakter"],N=V(()=>[d=>d>0||"Nilai diskon harus lebih dari 0",...a.value.discount_type==="percentage"?[d=>d<=100||"Persentase maksimal 100%"]:[]]),A=()=>a.value.discount_type==="percentage"?"Persentase Diskon":"Jumlah Diskon",Q=()=>{a.value.start_time=null,a.value.end_time=null,a.value.valid_days=[],a.value.buy_quantity=null,a.value.get_quantity=null,a.value.combo_quantity=null,a.value.combo_price=null,a.value.min_quantity=null},u=()=>{a.value={name:"",description:"",type:"happy_hour",discount_type:"percentage",discount_value:0,max_discount_amount:null,minimum_amount:null,priority:5,start_time:null,end_time:null,valid_days:[],buy_quantity:null,get_quantity:null,combo_quantity:null,combo_price:null,min_quantity:null,valid_from:null,valid_until:null,active:!0,promotion_rules:[]},Le(()=>{var d;(d=b.value)==null||d.resetValidation()})},r=()=>{if(o.promotion){const d=o.promotion;a.value={name:d.name,description:d.description||"",type:d.type,discount_type:d.discount_type,discount_value:d.discount_value,max_discount_amount:d.max_discount_amount,minimum_amount:d.minimum_amount,priority:d.priority,start_time:d.start_time,end_time:d.end_time,valid_days:d.valid_days||[],buy_quantity:d.buy_quantity,get_quantity:d.get_quantity,combo_quantity:d.combo_quantity,combo_price:d.combo_price,min_quantity:d.min_quantity,valid_from:d.valid_from?new Date(d.valid_from).toISOString().slice(0,16):null,valid_until:d.valid_until?new Date(d.valid_until).toISOString().slice(0,16):null,active:d.active,promotion_rules:d.promotion_rules||[]}}},g=async()=>{if(S.value)try{P.value=!0,a.value.promotion_rules=B(),o.mode==="create"?await I.createPromotion(a.value):o.promotion&&await I.updatePromotion(o.promotion.id_promotion,a.value),_("saved")}catch(d){console.error("Save error:",d)}finally{P.value=!1}},B=()=>{const d=[];switch(a.value.type){case"happy_hour":d.push({type:"time_based",start_time:a.value.start_time,end_time:a.value.end_time,valid_days:a.value.valid_days||[]});break;case"buy_one_get_one":d.push({type:"quantity_based",buy_quantity:a.value.buy_quantity||1,get_quantity:a.value.get_quantity||1});break;case"combo_deal":d.push({type:"combo_based",combo_quantity:a.value.combo_quantity||2,combo_price:a.value.combo_price||0});break;case"category_discount":d.push({type:"category_based",applicable_categories:a.value.applicable_categories||[]});break;case"quantity_discount":d.push({type:"quantity_threshold",min_quantity:a.value.min_quantity||1});break}return d.push({type:"discount",discount_type:a.value.discount_type,discount_value:a.value.discount_value,max_discount_amount:a.value.max_discount_amount,minimum_amount:a.value.minimum_amount}),d},x=()=>{k.value=!1};return ut(()=>o.modelValue,d=>{d&&(o.mode==="edit"&&o.promotion?r():u())}),(d,m)=>(w(),H($e,{modelValue:k.value,"onUpdate:modelValue":m[20]||(m[20]=v=>k.value=v),"max-width":"900px",persistent:"",scrollable:""},{default:l(()=>[e(ue,null,{default:l(()=>[e(Me,{class:"d-flex align-center justify-space-between bg-primary text-white"},{default:l(()=>[i("div",Bt,[e(pe,{icon:"mdi-bullhorn-outline",size:"24",class:"me-2"}),i("span",null,f(U.value),1)]),e(X,{icon:"mdi-close",variant:"text",color:"white",onClick:x})]),_:1}),e(pt,{ref_key:"formRef",ref:b,modelValue:S.value,"onUpdate:modelValue":m[19]||(m[19]=v=>S.value=v),onSubmit:rt(g,["prevent"])},{default:l(()=>[e(re,{class:"pa-6"},{default:l(()=>[e(oe,null,{default:l(()=>[e(p,{cols:"12"},{default:l(()=>m[21]||(m[21]=[i("h6",{class:"text-h6 mb-4"},"Informasi Dasar",-1)])),_:1,__:[21]}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(J,{modelValue:a.value.name,"onUpdate:modelValue":m[0]||(m[0]=v=>a.value.name=v),label:"Nama Promosi",rules:L,variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(ye,{modelValue:a.value.type,"onUpdate:modelValue":[m[1]||(m[1]=v=>a.value.type=v),Q],items:C,label:"Tipe Promosi",rules:[v=>!!v||"Tipe promosi wajib dipilih"],variant:"outlined",required:""},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:l(()=>[e(gt,{modelValue:a.value.description,"onUpdate:modelValue":m[2]||(m[2]=v=>a.value.description=v),label:"Deskripsi",variant:"outlined",rows:"3","auto-grow":""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:l(()=>[e(ge,{class:"my-4"}),m[22]||(m[22]=i("h6",{class:"text-h6 mb-4"},"Konfigurasi Promosi",-1))]),_:1,__:[22]}),a.value.type==="happy_hour"?(w(),W(ie,{key:0},[e(p,{cols:"12",md:"4"},{default:l(()=>[e(J,{modelValue:a.value.start_time,"onUpdate:modelValue":m[3]||(m[3]=v=>a.value.start_time=v),label:"Jam Mulai",type:"time",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4"},{default:l(()=>[e(J,{modelValue:a.value.end_time,"onUpdate:modelValue":m[4]||(m[4]=v=>a.value.end_time=v),label:"Jam Berakhir",type:"time",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4"},{default:l(()=>[e(ye,{modelValue:a.value.valid_days,"onUpdate:modelValue":m[5]||(m[5]=v=>a.value.valid_days=v),items:R,label:"Hari Berlaku",multiple:"",chips:"",variant:"outlined"},null,8,["modelValue"])]),_:1})],64)):q("",!0),a.value.type==="buy_one_get_one"?(w(),W(ie,{key:1},[e(p,{cols:"12",md:"6"},{default:l(()=>[e(J,{modelValue:a.value.buy_quantity,"onUpdate:modelValue":m[6]||(m[6]=v=>a.value.buy_quantity=v),modelModifiers:{number:!0},label:"Beli Quantity",type:"number",min:"1",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(J,{modelValue:a.value.get_quantity,"onUpdate:modelValue":m[7]||(m[7]=v=>a.value.get_quantity=v),modelModifiers:{number:!0},label:"Dapat Quantity",type:"number",min:"1",variant:"outlined",required:""},null,8,["modelValue"])]),_:1})],64)):q("",!0),a.value.type==="combo_deal"?(w(),W(ie,{key:2},[e(p,{cols:"12",md:"6"},{default:l(()=>[e(J,{modelValue:a.value.combo_quantity,"onUpdate:modelValue":m[8]||(m[8]=v=>a.value.combo_quantity=v),modelModifiers:{number:!0},label:"Jumlah Item Combo",type:"number",min:"2",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(J,{modelValue:a.value.combo_price,"onUpdate:modelValue":m[9]||(m[9]=v=>a.value.combo_price=v),modelModifiers:{number:!0},label:"Harga Combo",type:"number",min:"0",prefix:"Rp",variant:"outlined",required:""},null,8,["modelValue"])]),_:1})],64)):q("",!0),a.value.type==="quantity_discount"?(w(),H(p,{key:3,cols:"12",md:"6"},{default:l(()=>[e(J,{modelValue:a.value.min_quantity,"onUpdate:modelValue":m[10]||(m[10]=v=>a.value.min_quantity=v),modelModifiers:{number:!0},label:"Minimum Quantity",type:"number",min:"1",variant:"outlined",required:""},null,8,["modelValue"])]),_:1})):q("",!0),e(p,{cols:"12",md:"4"},{default:l(()=>[e(ye,{modelValue:a.value.discount_type,"onUpdate:modelValue":m[11]||(m[11]=v=>a.value.discount_type=v),items:$,label:"Tipe Diskon",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4"},{default:l(()=>[e(J,{modelValue:a.value.discount_value,"onUpdate:modelValue":m[12]||(m[12]=v=>a.value.discount_value=v),modelModifiers:{number:!0},label:A(),rules:N.value,variant:"outlined",type:"number",suffix:a.value.discount_type==="percentage"?"%":"Rp",required:""},null,8,["modelValue","label","rules","suffix"])]),_:1}),a.value.discount_type==="percentage"?(w(),H(p,{key:4,cols:"12",md:"4"},{default:l(()=>[e(J,{modelValue:a.value.max_discount_amount,"onUpdate:modelValue":m[13]||(m[13]=v=>a.value.max_discount_amount=v),modelModifiers:{number:!0},label:"Maksimum Diskon",variant:"outlined",type:"number",min:"0",prefix:"Rp",hint:"Opsional"},null,8,["modelValue"])]),_:1})):q("",!0),e(p,{cols:"12",md:"6"},{default:l(()=>[e(Lt,{modelValue:a.value.priority,"onUpdate:modelValue":m[14]||(m[14]=v=>a.value.priority=v),label:"Prioritas",min:1,max:10,step:1,"thumb-label":"always",variant:"outlined",color:"primary"},{"thumb-label":l(({modelValue:v})=>[z(f(v),1)]),_:1},8,["modelValue"]),m[23]||(m[23]=i("div",{class:"text-caption text-medium-emphasis mt-2"}," 1 = Prioritas Rendah, 10 = Prioritas Tinggi ",-1))]),_:1,__:[23]}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(J,{modelValue:a.value.minimum_amount,"onUpdate:modelValue":m[15]||(m[15]=v=>a.value.minimum_amount=v),modelModifiers:{number:!0},label:"Minimum Pembelian",variant:"outlined",type:"number",prefix:"Rp",min:"0",hint:"Kosongkan jika tidak ada minimum"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:l(()=>[e(ge,{class:"my-4"}),m[24]||(m[24]=i("h6",{class:"text-h6 mb-4"},"Periode Berlaku",-1))]),_:1,__:[24]}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(J,{modelValue:a.value.valid_from,"onUpdate:modelValue":m[16]||(m[16]=v=>a.value.valid_from=v),label:"Berlaku Dari",variant:"outlined",type:"datetime-local",hint:"Opsional untuk promosi berkelanjutan"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(J,{modelValue:a.value.valid_until,"onUpdate:modelValue":m[17]||(m[17]=v=>a.value.valid_until=v),label:"Berlaku Sampai",variant:"outlined",type:"datetime-local",hint:"Opsional untuk promosi berkelanjutan"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:l(()=>[e(ge,{class:"my-4"}),m[25]||(m[25]=i("h6",{class:"text-h6 mb-4"},"Status",-1))]),_:1,__:[25]}),e(p,{cols:"12"},{default:l(()=>[e(ht,{modelValue:a.value.active,"onUpdate:modelValue":m[18]||(m[18]=v=>a.value.active=v),label:"Aktifkan promosi ini",color:"primary",inset:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(ze,{class:"pa-6 pt-0"},{default:l(()=>[e(Ne),e(X,{variant:"outlined",onClick:x},{default:l(()=>m[26]||(m[26]=[z(" Batal ")])),_:1,__:[26]}),e(X,{type:"submit",color:"primary",loading:P.value,disabled:!S.value},{default:l(()=>[z(f(d.mode==="create"?"Simpan":"Update"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]))}}),$t={class:"d-flex align-center"},Mt={class:"mb-6"},zt={class:"mb-3"},Nt={class:"text-h6 font-weight-medium"},Et={class:"mb-3"},It={class:"mb-3"},At={class:"mb-3"},Kt={class:"text-body-1"},jt={class:"mb-6"},Ot={class:"mb-3"},Jt={class:"text-body-1 font-weight-medium"},Ht={class:"mb-3"},Qt={class:"d-flex flex-wrap gap-1"},Wt={class:"mb-3"},Xt={class:"text-body-1 font-weight-medium"},Gt={class:"mb-3"},Yt={class:"text-body-1 font-weight-medium"},Zt={class:"mb-3"},ea={class:"text-body-1 font-weight-medium"},ta={class:"mb-3"},aa={class:"text-body-1 font-weight-medium"},la={class:"mb-3"},oa={class:"text-body-1 font-weight-medium"},ia={class:"mb-3"},sa={class:"mb-3"},na={class:"text-body-1 font-weight-medium"},ua={class:"mb-3"},ra={class:"text-body-1 font-weight-medium"},da={class:"mb-3"},ma={class:"text-body-1 font-weight-medium"},ca={key:0,class:"mb-6"},va={class:"mb-3"},pa={class:"text-body-1 font-weight-medium"},ya={class:"mb-3"},fa={class:"text-body-1 font-weight-medium"},_a={class:"mb-3"},ba={class:"mb-6"},ga={class:"mb-3"},ha={class:"mb-3"},ka={class:"mb-3"},Va={class:"text-body-2"},Sa={class:"mb-3"},wa={class:"text-body-2"},xa=Se({__name:"PromotionViewDialog",props:{modelValue:{type:Boolean},promotion:{}},emits:["update:modelValue"],setup(s,{emit:t}){const o=s,_=t,b=V({get:()=>o.modelValue,set:u=>_("update:modelValue",u)}),S=()=>{b.value=!1},P=u=>I.formatPromotionDiscount(u),a=u=>I.getPromotionTypeLabel(u),C=u=>({happy_hour:"orange",buy_one_get_one:"purple",combo_deal:"teal",category_discount:"indigo",quantity_discount:"pink"})[u]||"secondary",$=u=>u>=8?"error":u>=5?"warning":"success",R=u=>I.getStatusColor(u),k=u=>I.getStatusLabel(u),U=u=>({monday:"Sen",tuesday:"Sel",wednesday:"Rab",thursday:"Kam",friday:"Jum",saturday:"Sab",sunday:"Min"})[u]||u,L=u=>u?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(u):"-",N=u=>new Date(u).toLocaleString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),A=()=>{var m;if(!((m=o.promotion)!=null&&m.valid_until))return"Tidak terbatas";const u=new Date,g=new Date(o.promotion.valid_until).getTime()-u.getTime();if(g<=0)return"Kadaluarsa";const B=Math.floor(g/(1e3*60*60*24)),x=Math.floor(g%(1e3*60*60*24)/(1e3*60*60)),d=Math.floor(g%(1e3*60*60)/(1e3*60));return B>0?`${B} hari ${x} jam`:x>0?`${x} jam ${d} menit`:d>0?`${d} menit`:"Kurang dari 1 menit"},Q=()=>{var x;if(!((x=o.promotion)!=null&&x.valid_until))return"info";const u=new Date,g=new Date(o.promotion.valid_until).getTime()-u.getTime();if(g<=0)return"error";const B=Math.floor(g/(1e3*60*60*24));return B<=1?"error":B<=7?"warning":"success"};return(u,r)=>(w(),H($e,{modelValue:b.value,"onUpdate:modelValue":r[0]||(r[0]=g=>b.value=g),"max-width":"700px",scrollable:""},{default:l(()=>[u.promotion?(w(),H(ue,{key:0},{default:l(()=>[e(Me,{class:"d-flex align-center justify-space-between bg-primary text-white"},{default:l(()=>[i("div",$t,[e(pe,{icon:"mdi-eye",size:"24",class:"me-2"}),r[1]||(r[1]=i("span",null,"Detail Promosi",-1))]),e(X,{icon:"mdi-close",variant:"text",color:"white",onClick:S})]),_:1}),e(re,{class:"pa-6"},{default:l(()=>[i("div",Mt,[r[6]||(r[6]=i("h6",{class:"text-h6 mb-4"},"Informasi Dasar",-1)),e(oe,null,{default:l(()=>[e(p,{cols:"12"},{default:l(()=>[i("div",zt,[r[2]||(r[2]=i("div",{class:"text-caption text-medium-emphasis"},"Nama Promosi",-1)),i("div",Nt,f(u.promotion.name),1)])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Et,[r[3]||(r[3]=i("div",{class:"text-caption text-medium-emphasis"},"Tipe Promosi",-1)),e(te,{color:C(u.promotion.type),variant:"tonal",size:"small"},{default:l(()=>[z(f(a(u.promotion.type)),1)]),_:1},8,["color"])])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",It,[r[4]||(r[4]=i("div",{class:"text-caption text-medium-emphasis"},"Prioritas",-1)),e(te,{color:$(u.promotion.priority),variant:"tonal",size:"small"},{default:l(()=>[z(f(u.promotion.priority),1)]),_:1},8,["color"])])]),_:1}),u.promotion.description?(w(),H(p,{key:0,cols:"12"},{default:l(()=>[i("div",At,[r[5]||(r[5]=i("div",{class:"text-caption text-medium-emphasis"},"Deskripsi",-1)),i("div",Kt,f(u.promotion.description),1)])]),_:1})):q("",!0)]),_:1})]),i("div",jt,[r[18]||(r[18]=i("h6",{class:"text-h6 mb-4"},"Konfigurasi Promosi",-1)),e(oe,null,{default:l(()=>{var g;return[u.promotion.type==="happy_hour"?(w(),W(ie,{key:0},[e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Ot,[r[7]||(r[7]=i("div",{class:"text-caption text-medium-emphasis"},"Jam Berlaku",-1)),i("div",Jt,f(u.promotion.start_time||"00:00")+" - "+f(u.promotion.end_time||"23:59"),1)])]),_:1}),(g=u.promotion.valid_days)!=null&&g.length?(w(),H(p,{key:0,cols:"12",md:"6"},{default:l(()=>[i("div",Ht,[r[8]||(r[8]=i("div",{class:"text-caption text-medium-emphasis"},"Hari Berlaku",-1)),i("div",Qt,[(w(!0),W(ie,null,dt(u.promotion.valid_days,B=>(w(),H(te,{key:B,size:"x-small",variant:"tonal",color:"primary"},{default:l(()=>[z(f(U(B)),1)]),_:2},1024))),128))])])]),_:1})):q("",!0)],64)):q("",!0),u.promotion.type==="buy_one_get_one"?(w(),W(ie,{key:1},[e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Wt,[r[9]||(r[9]=i("div",{class:"text-caption text-medium-emphasis"},"Beli Quantity",-1)),i("div",Xt,f(u.promotion.buy_quantity||1),1)])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Gt,[r[10]||(r[10]=i("div",{class:"text-caption text-medium-emphasis"},"Dapat Quantity",-1)),i("div",Yt,f(u.promotion.get_quantity||1),1)])]),_:1})],64)):q("",!0),u.promotion.type==="combo_deal"?(w(),W(ie,{key:2},[e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Zt,[r[11]||(r[11]=i("div",{class:"text-caption text-medium-emphasis"},"Jumlah Item Combo",-1)),i("div",ea,f(u.promotion.combo_quantity||2),1)])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",ta,[r[12]||(r[12]=i("div",{class:"text-caption text-medium-emphasis"},"Harga Combo",-1)),i("div",aa,f(L(u.promotion.combo_price)),1)])]),_:1})],64)):q("",!0),u.promotion.type==="quantity_discount"?(w(),H(p,{key:3,cols:"12",md:"6"},{default:l(()=>[i("div",la,[r[13]||(r[13]=i("div",{class:"text-caption text-medium-emphasis"},"Minimum Quantity",-1)),i("div",oa,f(u.promotion.min_quantity||1),1)])]),_:1})):q("",!0),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",ia,[r[14]||(r[14]=i("div",{class:"text-caption text-medium-emphasis"},"Tipe Diskon",-1)),e(te,{color:u.promotion.discount_type==="percentage"?"primary":"success",variant:"tonal",size:"small"},{default:l(()=>[z(f(u.promotion.discount_type==="percentage"?"Persentase":"Jumlah Tetap"),1)]),_:1},8,["color"])])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",sa,[r[15]||(r[15]=i("div",{class:"text-caption text-medium-emphasis"},"Nilai Diskon",-1)),i("div",na,f(P(u.promotion)),1)])]),_:1}),u.promotion.max_discount_amount?(w(),H(p,{key:4,cols:"12",md:"6"},{default:l(()=>[i("div",ua,[r[16]||(r[16]=i("div",{class:"text-caption text-medium-emphasis"},"Maksimum Diskon",-1)),i("div",ra,f(L(u.promotion.max_discount_amount)),1)])]),_:1})):q("",!0),u.promotion.minimum_amount?(w(),H(p,{key:5,cols:"12",md:"6"},{default:l(()=>[i("div",da,[r[17]||(r[17]=i("div",{class:"text-caption text-medium-emphasis"},"Minimum Pembelian",-1)),i("div",ma,f(L(u.promotion.minimum_amount)),1)])]),_:1})):q("",!0)]}),_:1})]),u.promotion.valid_from||u.promotion.valid_until?(w(),W("div",ca,[r[22]||(r[22]=i("h6",{class:"text-h6 mb-4"},"Periode Berlaku",-1)),e(oe,null,{default:l(()=>[u.promotion.valid_from?(w(),H(p,{key:0,cols:"12",md:"6"},{default:l(()=>[i("div",va,[r[19]||(r[19]=i("div",{class:"text-caption text-medium-emphasis"},"Berlaku Dari",-1)),i("div",pa,f(N(u.promotion.valid_from)),1)])]),_:1})):q("",!0),u.promotion.valid_until?(w(),H(p,{key:1,cols:"12",md:"6"},{default:l(()=>[i("div",ya,[r[20]||(r[20]=i("div",{class:"text-caption text-medium-emphasis"},"Berlaku Sampai",-1)),i("div",fa,f(N(u.promotion.valid_until)),1)])]),_:1})):q("",!0),u.promotion.valid_until?(w(),H(p,{key:2,cols:"12"},{default:l(()=>[i("div",_a,[r[21]||(r[21]=i("div",{class:"text-caption text-medium-emphasis"},"Sisa Waktu",-1)),e(te,{color:Q(),variant:"tonal",size:"small"},{default:l(()=>[e(pe,{icon:"mdi-clock-outline",size:"16",class:"me-1"}),z(" "+f(A()),1)]),_:1},8,["color"])])]),_:1})):q("",!0)]),_:1})])):q("",!0),i("div",ba,[r[25]||(r[25]=i("h6",{class:"text-h6 mb-4"},"Status",-1)),e(oe,null,{default:l(()=>[e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",ga,[r[23]||(r[23]=i("div",{class:"text-caption text-medium-emphasis"},"Status Aktif",-1)),e(te,{color:u.promotion.active?"success":"error",variant:"tonal",size:"small"},{default:l(()=>[e(pe,{icon:u.promotion.active?"mdi-check":"mdi-close",size:"16",class:"me-1"},null,8,["icon"]),z(" "+f(u.promotion.active?"Aktif":"Tidak Aktif"),1)]),_:1},8,["color"])])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",ha,[r[24]||(r[24]=i("div",{class:"text-caption text-medium-emphasis"},"Status Berlaku",-1)),e(te,{color:R(u.promotion.status||"unknown"),variant:"tonal",size:"small"},{default:l(()=>[z(f(k(u.promotion.status||"unknown")),1)]),_:1},8,["color"])])]),_:1})]),_:1})]),i("div",null,[r[28]||(r[28]=i("h6",{class:"text-h6 mb-4"},"Informasi Sistem",-1)),e(oe,null,{default:l(()=>[e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",ka,[r[26]||(r[26]=i("div",{class:"text-caption text-medium-emphasis"},"Dibuat Pada",-1)),i("div",Va,f(N(u.promotion.created_at)),1)])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Sa,[r[27]||(r[27]=i("div",{class:"text-caption text-medium-emphasis"},"Terakhir Diupdate",-1)),i("div",wa,f(N(u.promotion.updated_at)),1)])]),_:1})]),_:1})])]),_:1}),e(ze,{class:"pa-6 pt-0"},{default:l(()=>[e(Ne),e(X,{variant:"outlined",onClick:S},{default:l(()=>r[29]||(r[29]=[z(" Tutup ")])),_:1,__:[29]})]),_:1})]),_:1})):q("",!0)]),_:1},8,["modelValue"]))}}),Da={class:"promotion-management"},Pa={class:"d-flex justify-space-between align-center mb-6"},Ca={class:"d-flex gap-3 align-center"},Ta={class:"text-h3 font-weight-bold"},qa={class:"text-h3 font-weight-bold"},Ra={class:"text-h3 font-weight-bold"},Ua={class:"text-h3 font-weight-bold"},La={class:"font-weight-medium"},Ba={key:0,class:"text-caption text-medium-emphasis"},Fa={class:"font-weight-medium"},$a={class:"text-sm"},Ma={key:0},za={key:1},Na={key:2},Ea={class:"d-flex align-center gap-2"},Ia=Se({__name:"promotions-management",setup(s){const t=D([]),o=D(!1),_=D(null),b=D(1),S=D(15),P=D(0),a=D({search:"",type:"all",status:"all",sort_by:"created_at",sort_order:"desc"});D(""),D("all"),D("all"),D("all");const C=D(!1),$=D(!1),R=D(!1),k=D(null),U=D("create"),L=D(!1),N=[{title:"Semua Tipe",value:"all"},{title:"Happy Hour",value:"happy_hour"},{title:"Beli 1 Dapat 1",value:"buy_one_get_one"},{title:"Paket Combo",value:"combo_deal"},{title:"Diskon Kategori",value:"category_discount"},{title:"Diskon Quantity",value:"quantity_discount"}],A=[{title:"Semua Status",value:"all"},{title:"Aktif",value:"active"},{title:"Tidak Aktif",value:"inactive"},{title:"Kadaluarsa",value:"expired"},{title:"Terjadwal",value:"scheduled"}],Q=[{title:"Tanggal Dibuat",value:"created_at"},{title:"Nama",value:"name"},{title:"Prioritas",value:"priority"},{title:"Tanggal Berlaku",value:"valid_from"}],u=[{title:"Nama",key:"name",sortable:!0},{title:"Tipe",key:"type",sortable:!0},{title:"Diskon",key:"discount_value",sortable:!0},{title:"Periode",key:"valid_period",sortable:!1},{title:"Jam",key:"time_range",sortable:!1},{title:"Prioritas",key:"priority",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Aksi",key:"actions",sortable:!1,align:"center"}],r=vt(()=>{b.value=1,g()},500),g=async()=>{try{o.value=!0;const y={search:a.value.search||void 0,type:a.value.type==="all"?void 0:a.value.type,status:a.value.status==="all"?void 0:a.value.status,sort_by:a.value.sort_by||"priority",sort_order:"desc",page:b.value,per_page:S.value},n=await I.getPromotions(y);t.value=n.data,P.value=n.total}catch(y){console.error("Failed to fetch promotions:",y)}finally{o.value=!1}},B=async()=>{try{_.value=await I.getStats()}catch(y){console.error("Failed to fetch promotion stats:",y)}},x=async()=>{await Promise.all([g(),B()])},d=y=>{b.value=y.page,S.value=y.itemsPerPage,g()},m=()=>{k.value=null,U.value="create",C.value=!0},v=y=>{k.value=y,$.value=!0},M=y=>{k.value=y,U.value="edit",C.value=!0},j=async y=>{try{await I.duplicate(y.id_promotion),await x()}catch(n){console.error("Failed to duplicate promotion:",n)}},O=async y=>{try{await I.toggleStatus(y.id_promotion),await g()}catch(n){console.error("Failed to toggle promotion status:",n)}},T=y=>{k.value=y,R.value=!0},G=async()=>{if(k.value)try{L.value=!0,await I.deletePromotion(k.value.id_promotion),await x(),R.value=!1}catch(y){console.error("Failed to delete promotion:",y)}finally{L.value=!1}},Y=()=>{k.value=null,R.value=!1},K=()=>{C.value=!1,x()},le=y=>I.formatPromotionDiscount(y),de=y=>I.getPromotionTypeLabel(y),me=y=>({happy_hour:"orange",buy_one_get_one:"purple",combo_deal:"teal",category_discount:"indigo",quantity_discount:"pink"})[y]||"secondary",fe=y=>y>=8?"error":y>=5?"warning":"success",E=y=>I.getStatusColor(y||"inactive"),F=y=>I.getStatusLabel(y||"inactive"),ae=y=>y?new Date(y).toLocaleDateString("id-ID"):"-",se=y=>{const n={monday:"Sen",tuesday:"Sel",wednesday:"Rab",thursday:"Kam",friday:"Jum",saturday:"Sab",sunday:"Min"};return y.map(h=>n[h]||h).join(", ")},ce=(y,n)=>y.length>n?y.substring(0,n)+"...":y;return mt(()=>{x()}),(y,n)=>{var h;return w(),W("div",Da,[i("div",Pa,[n[10]||(n[10]=i("div",null,[i("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Promosi"),i("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola promosi dan penawaran khusus untuk coffee shop Anda")],-1)),i("div",Ca,[e(X,{color:"primary","prepend-icon":"mdi-plus",onClick:m},{default:l(()=>n[9]||(n[9]=[z(" Tambah Promosi ")])),_:1,__:[9]})])]),e(oe,{class:"mb-6"},{default:l(()=>[e(p,{cols:"12",md:"3"},{default:l(()=>[e(ue,{color:"primary",variant:"tonal"},{default:l(()=>[e(re,{class:"text-center"},{default:l(()=>{var c;return[i("div",Ta,f(((c=_.value)==null?void 0:c.total_promotions)||0),1),n[11]||(n[11]=i("div",{class:"text-body-2 text-medium-emphasis"},"Total Promosi",-1))]}),_:1,__:[11]})]),_:1})]),_:1}),e(p,{cols:"12",md:"3"},{default:l(()=>[e(ue,{color:"success",variant:"tonal"},{default:l(()=>[e(re,{class:"text-center"},{default:l(()=>{var c;return[i("div",qa,f(((c=_.value)==null?void 0:c.active_promotions)||0),1),n[12]||(n[12]=i("div",{class:"text-body-2 text-medium-emphasis"},"Aktif",-1))]}),_:1,__:[12]})]),_:1})]),_:1}),e(p,{cols:"12",md:"3"},{default:l(()=>[e(ue,{color:"warning",variant:"tonal"},{default:l(()=>[e(re,{class:"text-center"},{default:l(()=>{var c;return[i("div",Ra,f(((c=_.value)==null?void 0:c.scheduled_promotions)||0),1),n[13]||(n[13]=i("div",{class:"text-body-2 text-medium-emphasis"},"Terjadwal",-1))]}),_:1,__:[13]})]),_:1})]),_:1}),e(p,{cols:"12",md:"3"},{default:l(()=>[e(ue,{color:"error",variant:"tonal"},{default:l(()=>[e(re,{class:"text-center"},{default:l(()=>{var c;return[i("div",Ua,f(((c=_.value)==null?void 0:c.expired_promotions)||0),1),n[14]||(n[14]=i("div",{class:"text-body-2 text-medium-emphasis"},"Kedaluwarsa",-1))]}),_:1,__:[14]})]),_:1})]),_:1})]),_:1}),e(ue,null,{default:l(()=>[e(re,null,{default:l(()=>[e(oe,{class:"mb-4"},{default:l(()=>[e(p,{cols:"12",md:"4"},{default:l(()=>[e(J,{modelValue:a.value.search,"onUpdate:modelValue":n[0]||(n[0]=c=>a.value.search=c),label:"Cari promosi...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:ct(r)},null,8,["modelValue","onInput"])]),_:1}),e(p,{cols:"12",md:"2"},{default:l(()=>[e(ye,{modelValue:a.value.type,"onUpdate:modelValue":[n[1]||(n[1]=c=>a.value.type=c),g],items:N,label:"Tipe",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"2"},{default:l(()=>[e(ye,{modelValue:a.value.status,"onUpdate:modelValue":[n[2]||(n[2]=c=>a.value.status=c),g],items:A,label:"Status",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"2"},{default:l(()=>[e(ye,{modelValue:a.value.sort_by,"onUpdate:modelValue":[n[3]||(n[3]=c=>a.value.sort_by=c),g],items:Q,label:"Urutkan",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"2",class:"d-flex align-center"},{default:l(()=>[e(X,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:x},{default:l(()=>n[15]||(n[15]=[z(" Refresh ")])),_:1,__:[15]})]),_:1})]),_:1}),e(kt,{"items-per-page":S.value,"onUpdate:itemsPerPage":n[4]||(n[4]=c=>S.value=c),page:b.value,"onUpdate:page":n[5]||(n[5]=c=>b.value=c),headers:u,items:t.value,"items-length":P.value,loading:o.value,class:"promotion-table","onUpdate:options":d},{"item.name":l(({item:c})=>[i("div",null,[i("div",La,f(c.name),1),c.description?(w(),W("div",Ba,f(ce(c.description,50)),1)):q("",!0)])]),"item.type":l(({item:c})=>[e(te,{size:"small",color:me(c.type),variant:"tonal"},{default:l(()=>[z(f(de(c.type)),1)]),_:2},1032,["color"])]),"item.discount":l(({item:c})=>[i("span",Fa,f(le(c)),1)]),"item.schedule":l(({item:c})=>[i("div",$a,[c.type==="happy_hour"?(w(),W("div",Ma,[e(pe,{icon:"mdi-clock-outline",size:"14",class:"me-1"}),z(" "+f(c.start_time)+" - "+f(c.end_time),1)])):q("",!0),c.valid_days&&c.valid_days.length>0?(w(),W("div",za,[e(pe,{icon:"mdi-calendar",size:"14",class:"me-1"}),z(" "+f(se(c.valid_days)),1)])):q("",!0),c.valid_from?(w(),W("div",Na,f(ae(c.valid_from))+" - "+f(ae(c.valid_until)),1)):q("",!0)])]),"item.priority":l(({item:c})=>[e(te,{size:"small",color:fe(c.priority),variant:"tonal"},{default:l(()=>[z(f(c.priority),1)]),_:2},1032,["color"])]),"item.status":l(({item:c})=>[e(te,{size:"small",color:E(c.status),variant:"tonal"},{default:l(()=>[z(f(F(c.status)),1)]),_:2},1032,["color"])]),"item.actions":l(({item:c})=>[i("div",Ea,[e(X,{icon:"mdi-eye",size:"small",variant:"text",onClick:ve=>v(c)},null,8,["onClick"]),e(X,{icon:"mdi-pencil",size:"small",variant:"text",onClick:ve=>M(c)},null,8,["onClick"]),e(X,{icon:c.active?"mdi-pause":"mdi-play",size:"small",variant:"text",onClick:ve=>O(c)},null,8,["icon","onClick"]),e(X,{icon:"mdi-content-copy",size:"small",variant:"text",onClick:ve=>j(c)},null,8,["onClick"]),e(X,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:ve=>T(c)},null,8,["onClick"])])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1})]),_:1}),e(Ft,{modelValue:C.value,"onUpdate:modelValue":n[6]||(n[6]=c=>C.value=c),promotion:k.value,mode:U.value,onSaved:K},null,8,["modelValue","promotion","mode"]),e(xa,{modelValue:$.value,"onUpdate:modelValue":n[7]||(n[7]=c=>$.value=c),promotion:k.value},null,8,["modelValue","promotion"]),e(He,{modelValue:R.value,"onUpdate:modelValue":n[8]||(n[8]=c=>R.value=c),loading:L.value,"item-name":((h=k.value)==null?void 0:h.name)||"",title:"Konfirmasi Hapus Promosi",onConfirm:G,onCancel:Y},null,8,["modelValue","loading","item-name"])])}}}),fl=Vt(Ia,[["__scopeId","data-v-b67a41c5"]]);export{fl as default};
