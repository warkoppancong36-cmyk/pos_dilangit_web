import{D as ze}from"./DeleteConfirmationDialog-Bjteg3c5.js";import{d as pe,V as A,r as f,w as ve,g as C,f as t,a5 as w,m as s,b as e,l as K,e as r,X as D,t as k,a0 as q,$ as Le,s as P,o as v,b8 as Re,c as $,az as Me,F as Ke,i as Ie,ay as J,ax as ke,D as Be}from"./main-BeYChyqE.js";import{V as je}from"./VDialog-DB-_06qg.js";import{b as Oe,c as Ge,V as O}from"./VCard-BE4J-KWK.js";import{V as Ve}from"./VDivider-C4pCokCc.js";import{V as G}from"./VCardText-CiCmkOkk.js";import{V as We}from"./VForm-B2b_Armc.js";import{V as he,a as y}from"./VRow-BIUD78Be.js";import{V as z}from"./VTextField-DjRwf3lZ.js";import{V as $e}from"./VSelect-CxNmxtHk.js";import{V as xe}from"./VTextarea-CtOkH5XM.js";import{V as He}from"./VSpacer-DgnnU6eh.js";import{V as Je}from"./VSnackbar-CelyaIKg.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ie}from"./VChip-Q4c6Slz2.js";import{V as ee}from"./VAvatar-CNQQSkfG.js";import{V as te}from"./VSkeletonLoader-B7NLHUZA.js";import{V as Xe}from"./VDataTableServer-D9oLdqE_.js";import{V as Se}from"./VTooltip-lP6wu5sI.js";import{V as we}from"./VAlert-BeNH_8Ij.js";import"./VOverlay-BeIaK0FG.js";import"./forwardRefs-B931MWyl.js";import"./VImg-Byrj7t-L.js";/* empty css              */import"./VList-C_4ZD0s3.js";import"./VMenu-CMH2fMN5.js";import"./VCheckboxBtn-CXIxfrKE.js";import"./VDataTable-BD3pYhAj.js";import"./VTable-oigA70NC.js";import"./filter-DBt9VDVE.js";const qe={class:"d-flex align-center justify-space-between"},Qe={class:"d-flex align-center gap-2"},Ye={class:"text-h6 text-white"},Ze={class:"text-h6 mb-4 d-flex align-center gap-2"},et={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},tt={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},at={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},lt={class:"d-flex align-center"},st={class:"text-subtitle-1"},ot=pe({__name:"SupplierDialog",props:{modelValue:{type:Boolean},supplier:{},loading:{type:Boolean},errorMessage:{},useDialogError:{type:Boolean}},emits:["update:modelValue","save","clear-error","close"],setup(F,{emit:u}){const n=F,h=u,V=A({get:()=>n.modelValue,set:o=>h("update:modelValue",o)}),x=f(""),c=f(""),b=f(""),E=f(""),U=f(""),S=f(""),p=f(""),m=f(""),l=f(""),_=f(""),I=f(""),T=f(""),N=f(""),L=f(""),R=f("active"),B=A(()=>({code:x.value,name:c.value,email:b.value,phone:E.value,address:U.value,city:S.value,province:p.value,postal_code:m.value,contact_person:l.value,tax_number:_.value,bank_name:I.value,bank_account:T.value,bank_account_name:N.value,notes:L.value,status:R.value}));ve(B,o=>{console.log("Form data changed:",o)},{deep:!0});const Q=f(!1),W=f(),H={code:[o=>!!o||"Kode supplier wajib diisi",o=>o&&o.length>=2||"Kode supplier minimal 2 karakter",o=>o&&o.length<=20||"Kode supplier maksimal 20 karakter"],name:[o=>!!o||"Nama supplier wajib diisi",o=>o&&o.length>=2||"Nama supplier minimal 2 karakter",o=>o&&o.length<=100||"Nama supplier maksimal 100 karakter"],email:[o=>o?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)||"Format email tidak valid":!0],phone:[o=>o?/^[\d\s\-\+\(\)]+$/.test(o)||"Format nomor telepon tidak valid":!0],postal_code:[o=>o?/^\d{5}$/.test(o)||"Kode pos harus 5 digit":!0]},re=[{title:"Aktif",value:"active"},{title:"Nonaktif",value:"inactive"}],Y=A(()=>!!n.supplier),ue=A(()=>Y.value?"Edit Supplier":"Tambah Supplier"),de=A(()=>Y.value?"Update":"Simpan"),ae=A(()=>n.errorMessage||null),le=()=>{x.value="",c.value="",b.value="",E.value="",U.value="",S.value="",p.value="",m.value="",l.value="",_.value="",I.value="",T.value="",N.value="",L.value="",R.value="active",Re(()=>{var o;(o=W.value)==null||o.resetValidation()})};ve(()=>n.supplier,o=>{o?(x.value=o.code,c.value=o.name,b.value=o.email||"",E.value=o.phone||"",U.value=o.address||"",S.value=o.city||"",p.value=o.province||"",m.value=o.postal_code||"",l.value=o.contact_person||"",_.value=o.tax_number||"",I.value=o.bank_name||"",T.value=o.bank_account||"",N.value=o.bank_account_name||"",L.value=o.notes||"",R.value=o.status):le()},{immediate:!0}),ve(V,o=>{o||le()});const se=async()=>{var i;console.log("Form data before save:",B.value),console.log("Form data stringified:",JSON.stringify(B.value));const{valid:o}=await((i=W.value)==null?void 0:i.validate());if(console.log("Form validation result:",o),o){const d={...B.value};console.log("Payload to emit:",d),h("save",d)}},oe=()=>{V.value=!1,h("close")};return(o,i)=>(v(),C(je,{modelValue:s(V),"onUpdate:modelValue":i[18]||(i[18]=d=>w(V)?V.value=d:null),"max-width":"900px",persistent:"",scrollable:""},{default:t(()=>[e(O,{class:"supplier-dialog coffee-dialog"},{default:t(()=>[e(Oe,{class:"pa-6 pb-4 coffee-header"},{default:t(()=>[r("div",qe,[r("div",Qe,[e(D,{icon:s(Y)?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),r("span",Ye,k(s(ue)),1)]),e(q,{icon:"tabler-x",variant:"text",color:"white",size:"small",onClick:oe})])]),_:1}),e(Ve),e(G,{class:"pa-6"},{default:t(()=>[e(We,{ref_key:"formRef",ref:W,modelValue:s(Q),"onUpdate:modelValue":i[15]||(i[15]=d=>w(Q)?Q.value=d:null),onSubmit:Le(se,["prevent"])},{default:t(()=>[e(he,null,{default:t(()=>[e(y,{cols:"12"},{default:t(()=>[r("h6",Ze,[e(D,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),i[19]||(i[19]=P(" Informasi Dasar "))])]),_:1}),e(y,{cols:"12",md:"4"},{default:t(()=>[e(z,{modelValue:s(x),"onUpdate:modelValue":i[0]||(i[0]=d=>w(x)?x.value=d:null),label:"Kode Supplier *",rules:H.code,disabled:s(Y),placeholder:"Masukkan kode supplier",variant:"outlined"},null,8,["modelValue","rules","disabled"])]),_:1}),e(y,{cols:"12",md:"8"},{default:t(()=>[e(z,{modelValue:s(c),"onUpdate:modelValue":i[1]||(i[1]=d=>w(c)?c.value=d:null),label:"Nama Supplier *",rules:H.name,placeholder:"Masukkan nama supplier",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:s(b),"onUpdate:modelValue":i[2]||(i[2]=d=>w(b)?b.value=d:null),label:"Email",rules:H.email,placeholder:"supplier@email.com",type:"email",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:s(E),"onUpdate:modelValue":i[3]||(i[3]=d=>w(E)?E.value=d:null),label:"Nomor Telepon",rules:H.phone,placeholder:"08123456789",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12",md:"8"},{default:t(()=>[e(z,{modelValue:s(l),"onUpdate:modelValue":i[4]||(i[4]=d=>w(l)?l.value=d:null),label:"Nama Kontak",placeholder:"Nama person in charge",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:t(()=>[e($e,{modelValue:s(R),"onUpdate:modelValue":i[5]||(i[5]=d=>w(R)?R.value=d:null),label:"Status *",items:re,"item-title":"title","item-value":"value",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[r("h6",et,[e(D,{icon:"tabler-map-pin",size:"20",class:"coffee-icon"}),i[20]||(i[20]=P(" Informasi Alamat "))])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(xe,{modelValue:s(U),"onUpdate:modelValue":i[6]||(i[6]=d=>w(U)?U.value=d:null),label:"Alamat",placeholder:"Masukkan alamat lengkap",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:t(()=>[e(z,{modelValue:s(S),"onUpdate:modelValue":i[7]||(i[7]=d=>w(S)?S.value=d:null),label:"Kota",placeholder:"Nama kota",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:t(()=>[e(z,{modelValue:s(p),"onUpdate:modelValue":i[8]||(i[8]=d=>w(p)?p.value=d:null),label:"Provinsi",placeholder:"Nama provinsi",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:t(()=>[e(z,{modelValue:s(m),"onUpdate:modelValue":i[9]||(i[9]=d=>w(m)?m.value=d:null),label:"Kode Pos",rules:H.postal_code,placeholder:"12345",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[r("h6",tt,[e(D,{icon:"tabler-credit-card",size:"20",class:"coffee-icon"}),i[21]||(i[21]=P(" Informasi Keuangan "))])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:s(_),"onUpdate:modelValue":i[10]||(i[10]=d=>w(_)?_.value=d:null),label:"NPWP",placeholder:"Nomor NPWP",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:s(I),"onUpdate:modelValue":i[11]||(i[11]=d=>w(I)?I.value=d:null),label:"Nama Bank",placeholder:"Nama bank",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:s(T),"onUpdate:modelValue":i[12]||(i[12]=d=>w(T)?T.value=d:null),label:"Nomor Rekening",placeholder:"Nomor rekening bank",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:s(N),"onUpdate:modelValue":i[13]||(i[13]=d=>w(N)?N.value=d:null),label:"Nama Pemilik Rekening",placeholder:"Nama pemilik rekening",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[r("h6",at,[e(D,{icon:"tabler-notes",size:"20",class:"coffee-icon"}),i[22]||(i[22]=P(" Informasi Tambahan "))])]),_:1}),e(y,{cols:"12"},{default:t(()=>[e(xe,{modelValue:s(L),"onUpdate:modelValue":i[14]||(i[14]=d=>w(L)?L.value=d:null),label:"Catatan",placeholder:"Catatan tambahan tentang supplier",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(Ve),e(Ge,{class:"pa-6"},{default:t(()=>[e(He),e(q,{color:"secondary",variant:"outlined",class:"coffee-secondary",onClick:oe},{default:t(()=>i[23]||(i[23]=[P(" Batal ")])),_:1,__:[23]}),e(q,{color:"primary",class:"coffee-primary",loading:o.loading,disabled:!s(Q),onClick:se},{default:t(()=>[P(k(s(de)),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),o.useDialogError?K("",!0):(v(),C(Je,{key:0,"model-value":!!s(ae),"onUpdate:modelValue":i[17]||(i[17]=d=>!d&&o.$emit("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500",class:"coffee-error"},{actions:t(()=>[e(q,{icon:"tabler-x",size:"small",variant:"text",onClick:i[16]||(i[16]=d=>o.$emit("clear-error"))})]),default:t(()=>[r("div",lt,[e(D,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),r("div",null,[i[24]||(i[24]=r("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),r("div",st,k(s(ae)),1)])])]),_:1},8,["model-value"]))]),_:1},8,["modelValue"]))}}),nt=Ce(ot,[["__scopeId","data-v-7e584f6b"]]),it={class:"d-flex gap-2"},rt={key:0,class:"mt-4"},ut={class:"d-flex align-center gap-2 flex-wrap"},dt=pe({__name:"SupplierSearchFilters",props:{filters:{},loading:{type:Boolean,default:!1}},emits:["update:filters","search","reset"],setup(F,{emit:u}){let n=null;const h=(m,l=500)=>{n&&clearTimeout(n),n=setTimeout(m,l)},V=F,x=u,c=f({...V.filters});ve(()=>V.filters,m=>{c.value={...m}},{deep:!0});const b=(m,l)=>{c.value[m]=l,m!=="search"?x("update:filters",{...c.value}):h(()=>{console.log("Emitting debounced search filter update:",{...c.value}),x("update:filters",{...c.value})})},E=()=>{x("search")},U=()=>{const m={search:"",status:void 0,city:"",province:""};c.value={...m},x("update:filters",m),x("reset")},S=[{title:"Semua Status",value:void 0},{title:"Aktif",value:"active"},{title:"Nonaktif",value:"inactive"}],p=A(()=>!!(c.value.search||c.value.status||c.value.city||c.value.province));return(m,l)=>(v(),C(O,null,{default:t(()=>[e(G,null,{default:t(()=>[e(he,null,{default:t(()=>[e(y,{cols:"12",md:"4"},{default:t(()=>[e(z,{modelValue:c.value.search,"onUpdate:modelValue":[l[0]||(l[0]=_=>c.value.search=_),l[1]||(l[1]=_=>b("search",_))],placeholder:"Cari nama, kode, atau email supplier...","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined",onKeydown:Me(E,["enter"])},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:t(()=>[e($e,{modelValue:c.value.status,"onUpdate:modelValue":[l[2]||(l[2]=_=>c.value.status=_),l[3]||(l[3]=_=>b("status",_))],items:S,"item-title":"title","item-value":"value",placeholder:"Status",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:t(()=>[e(z,{modelValue:c.value.city,"onUpdate:modelValue":[l[4]||(l[4]=_=>c.value.city=_),l[5]||(l[5]=_=>b("city",_))],placeholder:"Kota",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:t(()=>[e(z,{modelValue:c.value.province,"onUpdate:modelValue":[l[6]||(l[6]=_=>c.value.province=_),l[7]||(l[7]=_=>b("province",_))],placeholder:"Provinsi",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:t(()=>[r("div",it,[e(q,{color:"primary",loading:m.loading,onClick:E},{default:t(()=>[e(D,{icon:"tabler-search"}),l[12]||(l[12]=P(" Cari "))]),_:1,__:[12]},8,["loading"]),p.value?(v(),C(q,{key:0,variant:"outlined",color:"secondary",onClick:U},{default:t(()=>[e(D,{icon:"tabler-x"}),l[13]||(l[13]=P(" Reset "))]),_:1,__:[13]})):K("",!0)])]),_:1})]),_:1}),p.value?(v(),$("div",rt,[r("div",ut,[l[14]||(l[14]=r("span",{class:"text-caption text-medium-emphasis"},"Filter aktif:",-1)),c.value.search?(v(),C(ie,{key:0,size:"small",closable:"","onClick:close":l[8]||(l[8]=_=>b("search",""))},{default:t(()=>[P(" Pencarian: "+k(c.value.search),1)]),_:1})):K("",!0),c.value.status?(v(),C(ie,{key:1,size:"small",closable:"","onClick:close":l[9]||(l[9]=_=>b("status",void 0))},{default:t(()=>[P(" Status: "+k(c.value.status==="active"?"Aktif":"Nonaktif"),1)]),_:1})):K("",!0),c.value.city?(v(),C(ie,{key:2,size:"small",closable:"","onClick:close":l[10]||(l[10]=_=>b("city",""))},{default:t(()=>[P(" Kota: "+k(c.value.city),1)]),_:1})):K("",!0),c.value.province?(v(),C(ie,{key:3,size:"small",closable:"","onClick:close":l[11]||(l[11]=_=>b("province",""))},{default:t(()=>[P(" Provinsi: "+k(c.value.province),1)]),_:1})):K("",!0)])])):K("",!0)]),_:1})]),_:1}))}}),ct={class:"d-flex align-center"},pt={class:"text-h6 font-weight-semibold"},mt={key:1},vt={class:"d-flex align-center"},ft={class:"text-h6 font-weight-semibold"},gt={key:1},ht={class:"d-flex align-center"},_t={class:"text-h6 font-weight-semibold"},bt={key:1},yt={class:"d-flex align-center"},kt={class:"text-h6 font-weight-semibold"},Vt={key:1},xt={class:"d-flex align-center"},St={class:"text-h6 font-weight-semibold"},wt={key:1},$t={class:"d-flex align-center"},Ct={class:"text-h6 font-weight-semibold"},Pt={key:1},Et=pe({__name:"SupplierStatsCards",props:{stats:{},loading:{type:Boolean,default:!1}},setup(F){return(u,n)=>(v(),C(he,null,{default:t(()=>[e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",ct,[e(ee,{color:"primary",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-building-store"})]),_:1}),r("div",null,[n[0]||(n[0]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Supplier",-1)),r("h6",pt,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",mt,k(u.stats.total_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",vt,[e(ee,{color:"success",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-check"})]),_:1}),r("div",null,[n[1]||(n[1]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Supplier Aktif",-1)),r("h6",ft,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",gt,k(u.stats.active_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",ht,[e(ee,{color:"info",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-shopping-cart"})]),_:1}),r("div",null,[n[2]||(n[2]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Dengan Pembelian",-1)),r("h6",_t,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",bt,k(u.stats.suppliers_with_purchases.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",yt,[e(ee,{color:"warning",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-map-pin"})]),_:1}),r("div",null,[n[3]||(n[3]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Kota",-1)),r("h6",kt,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",Vt,k(u.stats.total_cities.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",xt,[e(ee,{color:"error",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-x"})]),_:1}),r("div",null,[n[4]||(n[4]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Supplier Nonaktif",-1)),r("h6",St,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",wt,k(u.stats.inactive_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",$t,[e(ee,{color:"secondary",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(D,{icon:"tabler-map"})]),_:1}),r("div",null,[n[5]||(n[5]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Provinsi",-1)),r("h6",Ct,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",Pt,k(u.stats.total_provinces.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ut={class:"font-weight-medium"},Ft={class:"d-flex align-center"},Dt={class:"text-sm font-weight-medium"},Nt={class:"font-weight-medium"},At={key:0,class:"text-caption text-medium-emphasis"},Tt=["href"],zt={key:1,class:"text-medium-emphasis"},Lt=["href"],Rt={key:1,class:"text-medium-emphasis"},Mt={key:0},Kt={key:0,class:"font-weight-medium"},It={key:1,class:"text-caption text-medium-emphasis"},Bt={key:1,class:"text-medium-emphasis"},jt={class:"d-flex gap-1"},Ot={class:"text-center py-8"},Gt=pe({__name:"SupplierTable",props:{suppliers:{},loading:{type:Boolean,default:!1},totalItems:{default:0},page:{default:1},itemsPerPage:{default:10}},emits:["edit","delete","update:page","update:itemsPerPage","sort"],setup(F,{emit:u}){const n=u,h=[{title:"Kode",key:"code",sortable:!0},{title:"Nama",key:"name",sortable:!0},{title:"Email",key:"email",sortable:!0},{title:"Telepon",key:"phone",sortable:!1},{title:"Kota",key:"city",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Aksi",key:"actions",sortable:!1,align:"center"}],V=p=>p==="active"?"success":"error",x=p=>p==="active"?"Aktif":"Nonaktif",c=p=>{n("edit",p)},b=p=>{n("delete",p)},E=p=>{n("update:page",p)},U=p=>{n("update:itemsPerPage",p)},S=p=>{if(p&&p.length>0){const m=p[0],l=m.order==="desc"?"-":"";n("sort",`${l}${m.key}`)}};return(p,m)=>(v(),C(O,null,{default:t(()=>[e(G,{class:"pa-0"},{default:t(()=>[e(Xe,{page:p.page,"items-per-page":p.itemsPerPage,headers:h,items:p.suppliers,"items-length":p.totalItems,loading:p.loading,"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],"loading-text":"Memuat data supplier...","no-data-text":"Tidak ada data supplier","items-per-page-text":"Supplier per halaman:","page-text":"{0}-{1} dari {2}",class:"text-no-wrap","onUpdate:page":E,"onUpdate:itemsPerPage":U,"onUpdate:sortBy":S},{"item.code":t(({item:l})=>[r("div",Ut,k(l.code),1)]),"item.name":t(({item:l})=>[r("div",Ft,[e(ee,{size:"32",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[r("span",Dt,k(l.name.charAt(0).toUpperCase()),1)]),_:2},1024),r("div",null,[r("div",Nt,k(l.name),1),l.contact_person?(v(),$("div",At,k(l.contact_person),1)):K("",!0)])])]),"item.email":t(({item:l})=>[l.email?(v(),$("a",{key:0,href:`mailto:${l.email}`,class:"text-decoration-none"},k(l.email),9,Tt)):(v(),$("span",zt,"-"))]),"item.phone":t(({item:l})=>[l.phone?(v(),$("a",{key:0,href:`tel:${l.phone}`,class:"text-decoration-none"},k(l.phone),9,Lt)):(v(),$("span",Rt,"-"))]),"item.city":t(({item:l})=>[l.city||l.province?(v(),$("div",Mt,[l.city?(v(),$("div",Kt,k(l.city),1)):K("",!0),l.province?(v(),$("div",It,k(l.province),1)):K("",!0)])):(v(),$("span",Bt,"-"))]),"item.status":t(({item:l})=>[e(ie,{color:V(l.status),variant:"tonal",size:"small"},{default:t(()=>[P(k(x(l.status)),1)]),_:2},1032,["color"])]),"item.actions":t(({item:l})=>[r("div",jt,[e(q,{icon:"",size:"small",color:"primary",variant:"text",onClick:_=>c(l)},{default:t(()=>[e(D,{icon:"tabler-edit"}),e(Se,{activator:"parent",location:"top"},{default:t(()=>m[0]||(m[0]=[P(" Edit Supplier ")])),_:1,__:[0]})]),_:2},1032,["onClick"]),e(q,{icon:"",size:"small",color:"error",variant:"text",onClick:_=>b(l)},{default:t(()=>[e(D,{icon:"tabler-trash"}),e(Se,{activator:"parent",location:"top"},{default:t(()=>m[1]||(m[1]=[P(" Hapus Supplier ")])),_:1,__:[1]})]),_:2},1032,["onClick"])])]),loading:t(()=>[(v(),$(Ke,null,Ie(5,l=>e(te,{key:l,type:"table-row",class:"border-b"})),64))]),"no-data":t(()=>[r("div",Ot,[e(D,{icon:"tabler-building-store",size:"48",class:"text-medium-emphasis mb-4"}),m[2]||(m[2]=r("div",{class:"text-h6 mb-2"},"Tidak ada data supplier",-1)),m[3]||(m[3]=r("p",{class:"text-medium-emphasis mb-0"}," Silakan tambah supplier baru atau ubah filter pencarian ",-1))])]),_:1},8,["page","items-per-page","items","items-length","loading"])]),_:1})]),_:1}))}}),X="/api/suppliers";class j{static async getAll(u={}){var n;try{const h=new URLSearchParams;Object.entries(u).forEach(([c,b])=>{b!=null&&b!==""&&h.append(c,String(b))});const V=`${X}?${h.toString()}`;return(await J.get(V)).data}catch(h){throw console.error("SuppliersApi.getAll error:",h),((n=h.response)==null?void 0:n.data)||{success:!1,message:"Failed to fetch suppliers"}}}static async getById(u){var n;try{return(await J.get(`${X}/${u}`)).data}catch(h){throw((n=h.response)==null?void 0:n.data)||{success:!1,message:"Failed to fetch supplier"}}}static async create(u){var n;try{return(await J.post(X,u)).data}catch(h){throw((n=h.response)==null?void 0:n.data)||{success:!1,message:"Failed to create supplier"}}}static async update(u,n){var h;try{return(await J.put(`${X}/${u}`,n)).data}catch(V){throw((h=V.response)==null?void 0:h.data)||{success:!1,message:"Failed to update supplier"}}}static async delete(u){var n;try{return(await J.delete(`${X}/${u}`)).data}catch(h){throw((n=h.response)==null?void 0:n.data)||{success:!1,message:"Failed to delete supplier"}}}static async toggleActive(u){var n;try{return(await J.put(`${X}/${u}/toggle-active`)).data}catch(h){throw((n=h.response)==null?void 0:n.data)||{success:!1,message:"Failed to toggle supplier status"}}}static async getStats(){var u;try{return(await J.get(`${X}/stats`)).data}catch(n){throw((u=n.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch supplier statistics"}}}static async getCities(){var u;try{return(await J.get(`${X}/cities`)).data}catch(n){throw((u=n.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch cities"}}}static async getProvinces(){var u;try{return(await J.get(`${X}/provinces`)).data}catch(n){throw((u=n.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch provinces"}}}static validateEmail(u){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)?{valid:!0}:{valid:!1,error:"Please enter a valid email address"}}static validatePhone(u){return/^[\+]?[\d\s\-\(\)]{7,20}$/.test(u)?{valid:!0}:{valid:!1,error:"Please enter a valid phone number"}}static validateCode(u){return u.length<3?{valid:!1,error:"Supplier code must be at least 3 characters"}:u.length>50?{valid:!1,error:"Supplier code must not exceed 50 characters"}:{valid:!0}}}const Wt=()=>{const F=f([]),u=f([]),n=f([]),h=f(!1),V=f(!1),x=f(!1),c=f({}),b=f({total_suppliers:0,active_suppliers:0,inactive_suppliers:0,suppliers_with_purchases:0,total_cities:0,total_provinces:0}),E=f(!1),U=f(!1),S=f(!1),p=f(null),m=f([]),l=f(1),_=f(0),I=f(15),T=ke({search:"",status:void 0,city:"",province:"",sort_by:"created_at",sort_order:"desc"}),N=f(""),L=f(""),R=f(""),B=ke({name:"",code:"",contact_person:"",phone:"",email:"",address:"",city:"",province:"",postal_code:"",tax_number:"",bank_name:"",bank_account:"",bank_account_name:"",status:"active",notes:""}),Q=[a=>!!a||"Nama supplier wajib diisi",a=>a.length>=2||"Nama supplier minimal 2 karakter",a=>a.length<=255||"Nama supplier maksimal 255 karakter"],W=[a=>{if(!a)return!0;const g=j.validateCode(a);return g.valid||g.error}],H=[a=>{if(!a)return!0;const g=j.validateEmail(a);return g.valid||g.error}],re=[a=>{if(!a)return!0;const g=j.validatePhone(a);return g.valid||g.error}],Y=A(()=>!0),ue=A(()=>!0),de=A(()=>b.value.active_suppliers),ae=A(()=>b.value.inactive_suppliers),le=A(()=>b.value.suppliers_with_purchases),se=A(()=>b.value.total_cities),oe=A(()=>b.value.total_provinces),o=A(()=>m.value.length>0),i=A(()=>F.value.length),d=async()=>{try{h.value=!0,N.value="";const a={...T,page:l.value,per_page:I.value};Object.keys(a).forEach(ne=>{(a[ne]===""||a[ne]==="all")&&delete a[ne]});const g=await j.getAll(a);if(g.success)F.value=g.data,g.pagination&&(_.value=g.pagination.total,l.value=g.pagination.current_page),console.log("Suppliers loaded:",F.value.length);else throw new Error(g.message)}catch(a){console.error("Error fetching suppliers:",a),N.value=a.message||"Gagal mengambil data supplier",F.value=[]}finally{h.value=!1}},fe=async()=>{try{const a=await j.getCities();a.success&&(u.value=a.data)}catch(a){console.error("Error fetching cities:",a)}},ge=async()=>{try{const a=await j.getProvinces();a.success&&(n.value=a.data)}catch(a){console.error("Error fetching provinces:",a)}},ce=async()=>{try{const a=await j.getStats();a.success&&(b.value=a.data)}catch(a){console.error("Error fetching stats:",a)}},M=async a=>{try{V.value=!0,R.value="",console.log("Saving supplier with data:",a);let g;if(S.value&&p.value?g=await j.update(p.value.id_supplier,a):g=await j.create(a),g.success)L.value=g.message||"Supplier saved successfully",_e(),await d(),await ce();else throw new Error(g.message)}catch(g){console.error("Error saving supplier:",g),R.value=g.errors||g.message}finally{V.value=!1}},me=async()=>{if(p.value)try{x.value=!0;const a=await j.delete(p.value.id_supplier);if(a.success)L.value=a.message,U.value=!1,await d(),await ce();else throw new Error(a.message)}catch(a){console.error("Error deleting supplier:",a),N.value=a.message||"Gagal menghapus supplier"}finally{x.value=!1}},Z=async a=>{try{c.value[a.id_supplier]=!0;const g=await j.toggleActive(a.id_supplier);if(g.success){const ne=F.value.findIndex(Te=>Te.id_supplier===a.id_supplier);ne!==-1&&(F.value[ne]=g.data),await ce()}else throw new Error(g.message)}catch(g){console.error("Error toggling active status:",g),N.value=g.message||"Gagal mengubah status supplier"}finally{c.value[a.id]=!1}},Pe=()=>{S.value=!1,p.value=null,be(),E.value=!0},Ee=a=>{S.value=!0,p.value=a,Fe(a),E.value=!0},Ue=a=>{p.value=a,U.value=!0},_e=()=>{E.value=!1,R.value="",be()},be=()=>{Object.assign(B,{name:"",code:"",contact_person:"",phone:"",email:"",address:"",city:"",province:"",postal_code:"",tax_number:"",payment_terms:null,active:!0,notes:""})},Fe=a=>{Object.assign(B,{name:a.name,code:a.code||"",contact_person:a.contact_person||"",phone:a.phone||"",email:a.email||"",address:a.address||"",city:a.city||"",province:a.province||"",postal_code:a.postal_code||"",tax_number:a.tax_number||"",bank_name:a.bank_name||"",bank_account:a.bank_account||"",bank_account_name:a.bank_account_name||"",status:a.status,notes:a.notes||""})},De=()=>{R.value=""},Ne=a=>{l.value=a,d()},Ae=()=>{l.value=1,d()},ye=()=>{l.value=1,d()};return{suppliersList:F,cities:u,provinces:n,loading:h,saveLoading:V,deleteLoading:x,toggleLoading:c,stats:b,dialog:E,deleteDialog:U,editMode:S,selectedSupplier:p,selectedSuppliers:m,currentPage:l,totalItems:_,itemsPerPage:I,filters:T,errorMessage:N,successMessage:L,modalErrorMessage:R,formData:B,nameRules:Q,codeRules:W,emailRules:H,phoneRules:re,canCreateEdit:Y,canDelete:ue,totalActiveSuppliers:de,totalInactiveSuppliers:ae,totalSuppliersWithPurchases:le,totalCities:se,totalProvinces:oe,hasSelectedSuppliers:o,filteredSuppliersCount:i,fetchSuppliersList:d,fetchCities:fe,fetchProvinces:ge,fetchStats:ce,saveSupplier:M,deleteSupplier:me,toggleActiveStatus:Z,openCreateDialog:Pe,openEditDialog:Ee,openDeleteDialog:Ue,closeDialog:_e,clearModalError:De,onPageChange:Ne,onSearch:Ae,onFilterChange:ye,handleFiltersUpdate:a=>{console.log("=== SUPPLIERS FILTERS UPDATE ==="),console.log("Old filters:",{...T}),console.log("New filters received:",a),Object.assign(T,a),console.log("Updated filters:",{...T}),ye()},onSortChange:()=>{l.value=1,d()},resetFilters:()=>{Object.assign(T,{search:"",active:"all",city:"",province:"",sort_by:"created_at",sort_order:"desc"}),l.value=1,d()},toggleSupplierSelection:a=>{const g=m.value.indexOf(a);g>-1?m.value.splice(g,1):m.value.push(a)},selectAllSuppliers:()=>{m.value.length===F.value.length?m.value=[]:m.value=F.value.map(a=>a.id)}}},Ht={class:"supplier-management"},Jt={class:"d-flex justify-space-between align-center mb-6"},Xt={class:"d-flex gap-3 align-center"},qt={key:0,class:"d-flex gap-2"},Qt=pe({__name:"suppliers-management",setup(F){const{suppliersList:u,cities:n,provinces:h,loading:V,saveLoading:x,deleteLoading:c,toggleLoading:b,stats:E,dialog:U,deleteDialog:S,selectedSupplier:p,selectedSuppliers:m,currentPage:l,totalItems:_,itemsPerPage:I,filters:T,errorMessage:N,successMessage:L,modalErrorMessage:R,canCreateEdit:B,hasSelectedSuppliers:Q,fetchSuppliersList:W,fetchCities:H,fetchProvinces:re,fetchStats:Y,saveSupplier:ue,deleteSupplier:de,toggleActiveStatus:ae,openCreateDialog:le,openEditDialog:se,openDeleteDialog:oe,closeDialog:o,clearModalError:i,onPageChange:d,handleFiltersUpdate:fe}=Wt(),ge=async()=>{await de()};return Be(()=>{W(),H(),re(),Y()}),(ce,M)=>{var me;return v(),$("div",Ht,[r("div",Jt,[M[5]||(M[5]=r("div",null,[r("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Supplier"),r("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola data supplier dan vendor untuk coffee shop Anda")],-1)),r("div",Xt,[s(Q)?(v(),$("div",qt,[e(ie,{color:"primary",size:"small"},{default:t(()=>[P(k(s(m).length)+" dipilih ",1)]),_:1})])):K("",!0),s(B)?(v(),C(q,{key:1,color:"primary",variant:"elevated","prepend-icon":"tabler-plus",onClick:s(le)},{default:t(()=>M[4]||(M[4]=[P(" Tambah Supplier ")])),_:1,__:[4]},8,["onClick"])):K("",!0)])]),e(Et,{stats:s(E),loading:s(V),class:"mb-6"},null,8,["stats","loading"]),e(dt,{filters:s(T),cities:s(n),provinces:s(h),loading:s(V),"onUpdate:filters":s(fe),onSearch:s(W),onReset:s(W),class:"mb-6"},null,8,["filters","cities","provinces","loading","onUpdate:filters","onSearch","onReset"]),s(L)?(v(),C(we,{key:0,type:"success",variant:"tonal",closable:"",class:"mb-4","onClick:close":M[0]||(M[0]=Z=>L.value="")},{default:t(()=>[P(k(s(L)),1)]),_:1})):K("",!0),s(N)?(v(),C(we,{key:1,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":M[1]||(M[1]=Z=>N.value="")},{default:t(()=>[P(k(s(N)),1)]),_:1})):K("",!0),e(O,null,{default:t(()=>[e(G,{class:"pa-0"},{default:t(()=>[e(Gt,{suppliers:s(u),loading:s(V),"toggle-loading":s(b),"current-page":s(l),"total-items":s(_),"items-per-page":s(I),"selected-suppliers":s(m),"can-create-edit":s(B),onEdit:s(se),onDelete:s(oe),onToggleActive:s(ae),onPageChange:s(d)},null,8,["suppliers","loading","toggle-loading","current-page","total-items","items-per-page","selected-suppliers","can-create-edit","onEdit","onDelete","onToggleActive","onPageChange"])]),_:1})]),_:1}),e(nt,{modelValue:s(U),"onUpdate:modelValue":M[2]||(M[2]=Z=>w(U)?U.value=Z:null),supplier:s(p),loading:s(x),"error-message":s(R),onSave:s(ue),onClose:s(o),onClearError:s(i)},null,8,["modelValue","supplier","loading","error-message","onSave","onClose","onClearError"]),e(ze,{modelValue:s(S),"onUpdate:modelValue":M[3]||(M[3]=Z=>w(S)?S.value=Z:null),loading:s(c),"item-name":(me=s(p))==null?void 0:me.name,"item-type":"supplier",onConfirm:ge},null,8,["modelValue","loading","item-name"])])}}}),Na=Ce(Qt,[["__scopeId","data-v-db136099"]]);export{Na as default};
