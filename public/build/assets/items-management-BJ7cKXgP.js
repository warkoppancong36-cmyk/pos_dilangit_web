import{D as Oe}from"./DeleteConfirmationDialog-DPlCFh-L.js";import{d as W,r as V,V as G,g as S,f as t,a5 as se,m as r,b as e,e as l,X as y,t as k,a0 as I,$ as Be,s as g,c as O,l as C,i as Ke,F as Ge,o as x,w as He,v as qe,ax as ke,D as Je}from"./main-D3qual4m.js";import{V as Xe}from"./VDialog-ewO1hyzi.js";import{b as de,c as Ye,V as T}from"./VCard-BHrPvDVU.js";import{V as oe}from"./VDivider-CP88Pi7H.js";import{V as E}from"./VCardText-B6mKMLUi.js";import{V as Qe}from"./VForm-BEPpVqhb.js";import{V as J,a as p}from"./VRow-C-Gp4AHv.js";import{V as M,a as ae}from"./VTextField-Pqj_LXrG.js";import{V as ee}from"./VSelect-BxF6RNrF.js";import{V as We}from"./VTextarea-DP06YGpV.js";import{V as le}from"./VSwitch-Dach4Urw.js";import{V as Ze}from"./VSpacer-z4qf_7hE.js";import{V as et}from"./VSnackbar-C9ed6Lvf.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as tt,a as at,b as lt,c as st}from"./VExpansionPanels-BtHlkLLo.js";import{V as ot}from"./VCheckbox-BMUCQDya.js";import{f as be}from"./helpers-B-vn2Qqf.js";import{V as L}from"./VAvatar-CNzqVu-8.js";import{V as F}from"./VChip-Dp2du0U6.js";import{V as it}from"./VDataTableServer-Dba9EJ2a.js";import{I as X}from"./ItemsApi-DhdjlxxM.js";import{V as _e}from"./VAlert-DpZvISZm.js";import"./VOverlay-3qoIxvRA.js";import"./forwardRefs-B931MWyl.js";import"./VImg-BDQFnPKc.js";/* empty css              */import"./VList-lgEclvBH.js";import"./VMenu-Dwry_UTm.js";import"./VCheckboxBtn-B6nZfzHV.js";import"./VDataTable-DJtlZ2Os.js";import"./VTable-BFzNdH2m.js";import"./filter-CYNG3fOG.js";const rt={class:"d-flex align-center gap-2"},nt={class:"text-white"},dt={class:"text-h6 mb-4 d-flex align-center gap-2"},ut={class:"text-h6 mb-4 d-flex align-center gap-2"},mt={class:"d-flex align-center"},ct={class:"text-h6 mb-4 d-flex align-center gap-2"},pt={class:"d-flex align-center"},ft={class:"d-flex align-center"},gt={class:"text-h6 mb-4 d-flex align-center gap-2"},vt={class:"d-flex align-center"},_t={class:"text-subtitle-1"},kt=W({__name:"ItemDialog",props:{modelValue:{type:Boolean},editMode:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},formData:{},errorMessage:{default:""}},emits:["update:modelValue","save","close","clear-error"],setup(a,{emit:c}){const d=a,n=c,m=V(),f=G({get:()=>d.modelValue,set:i=>{i||n("close"),n("update:modelValue",i)}}),v=["kg","gram","liter","ml","butir","pcs","pack","dus","meter","lembar"],s=["Gudang A - Rak 1","Gudang A - Rak 2","Gudang A - Rak 3","Gudang B - Rak 1","Gudang B - Rak 2","Gudang B - Rak 3","Kulkas - Rak 1","Kulkas - Rak 2","Freezer - Rak 1","Freezer - Rak 2"],h=async()=>{var i,o;if(console.log("handleSave called"),console.log("formData:",d.formData),!((i=d.formData.name)!=null&&i.trim())){console.log("Name is required");return}if(!((o=d.formData.unit)!=null&&o.trim())){console.log("Unit is required");return}if(m.value){const{valid:u}=await m.value.validate();if(!u){console.log("Form validation failed");return}}n("clear-error"),n("save")},A=()=>{d.formData.properties||(d.formData.properties={});const i=`property_${Date.now()}`;d.formData.properties[i]=""},w=i=>{d.formData.properties&&delete d.formData.properties[i]},_=(i,o)=>{if(d.formData.properties&&i!==o){const u=d.formData.properties[i];delete d.formData.properties[i],d.formData.properties[o]=u}};return(i,o)=>(x(),S(Xe,{modelValue:r(f),"onUpdate:modelValue":o[12]||(o[12]=u=>se(f)?f.value=u:null),"max-width":"900px",persistent:"",scrollable:""},{default:t(()=>[e(T,{class:"item-dialog coffee-dialog"},{default:t(()=>[e(de,{class:"d-flex align-center justify-space-between coffee-header"},{default:t(()=>[l("div",rt,[e(y,{icon:i.editMode?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),l("span",nt,k(i.editMode?"Edit Item":"Tambah Item Baru"),1)]),e(I,{icon:"tabler-x",variant:"text",color:"white",onClick:o[0]||(o[0]=u=>f.value=!1)})]),_:1}),e(oe),e(E,{class:"pa-6"},{default:t(()=>[e(Qe,{ref_key:"formRef",ref:m,onSubmit:Be(h,["prevent"])},{default:t(()=>[e(J,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[l("h6",dt,[e(y,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),o[13]||(o[13]=g(" Informasi Dasar "))])]),_:1}),e(p,{cols:"12",md:"8"},{default:t(()=>[e(M,{modelValue:i.formData.name,"onUpdate:modelValue":o[1]||(o[1]=u=>i.formData.name=u),label:"Nama Item",placeholder:"Masukkan nama item",variant:"outlined",required:"",rules:[u=>!!u||"Nama item harus diisi"]},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12",md:"4"},{default:t(()=>[e(ee,{modelValue:i.formData.unit,"onUpdate:modelValue":o[2]||(o[2]=u=>i.formData.unit=u),items:v,label:"Satuan",placeholder:"Pilih satuan",variant:"outlined",required:"",rules:[u=>!!u||"Satuan harus dipilih"]},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(We,{modelValue:i.formData.description,"onUpdate:modelValue":o[3]||(o[3]=u=>i.formData.description=u),label:"Deskripsi",placeholder:"Masukkan deskripsi item",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[l("h6",ut,[e(y,{icon:"tabler-building-warehouse",size:"20",class:"coffee-icon"}),o[14]||(o[14]=g(" Lokasi & Tanggal "))])]),_:1}),e(p,{cols:"12",md:"6"},{default:t(()=>[e(ee,{modelValue:i.formData.storage_location,"onUpdate:modelValue":o[4]||(o[4]=u=>i.formData.storage_location=u),items:s,label:"Lokasi Penyimpanan",placeholder:"Pilih lokasi",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:t(()=>[e(M,{modelValue:i.formData.expiry_date,"onUpdate:modelValue":o[5]||(o[5]=u=>i.formData.expiry_date=u),label:"Tanggal Kadaluwarsa",type:"date",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:t(()=>[l("div",mt,[e(le,{modelValue:i.formData.active,"onUpdate:modelValue":o[6]||(o[6]=u=>i.formData.active=u),color:"success",class:"me-3"},null,8,["modelValue"]),e(ae,{class:"text-body-1"},{default:t(()=>o[15]||(o[15]=[g("Item Aktif")])),_:1,__:[15]})])]),_:1}),e(p,{cols:"12"},{default:t(()=>[l("h6",ct,[e(y,{icon:"tabler-truck-delivery",size:"20",class:"coffee-icon"}),o[16]||(o[16]=g(" Jenis Layanan "))])]),_:1}),e(p,{cols:"12",md:"6"},{default:t(()=>[l("div",pt,[e(le,{modelValue:i.formData.is_delivery,"onUpdate:modelValue":o[7]||(o[7]=u=>i.formData.is_delivery=u),color:"primary",class:"me-3"},null,8,["modelValue"]),e(ae,{class:"text-body-1"},{default:t(()=>[e(y,{icon:"tabler-truck-delivery",class:"me-2",size:"18"}),o[17]||(o[17]=g(" Tersedia untuk Delivery "))]),_:1,__:[17]})])]),_:1}),e(p,{cols:"12",md:"6"},{default:t(()=>[l("div",ft,[e(le,{modelValue:i.formData.is_takeaway,"onUpdate:modelValue":o[8]||(o[8]=u=>i.formData.is_takeaway=u),color:"secondary",class:"me-3"},null,8,["modelValue"]),e(ae,{class:"text-body-1"},{default:t(()=>[e(y,{icon:"tabler-package",class:"me-2",size:"18"}),o[18]||(o[18]=g(" Tersedia untuk Take Away "))]),_:1,__:[18]})])]),_:1}),e(p,{cols:"12"},{default:t(()=>[l("h6",gt,[e(y,{icon:"tabler-settings",size:"20",class:"coffee-icon"}),o[19]||(o[19]=g(" Properti Tambahan "))])]),_:1}),e(p,{cols:"12"},{default:t(()=>[o[21]||(o[21]=l("div",{class:"text-caption text-medium-emphasis mb-3"}," Tambahkan informasi tambahan seperti kandungan, spesifikasi, dll. ",-1)),e(I,{variant:"outlined","prepend-icon":"tabler-plus",class:"coffee-secondary mb-3",onClick:A},{default:t(()=>o[20]||(o[20]=[g(" Tambah Properti ")])),_:1,__:[20]}),i.formData.properties?(x(!0),O(Ge,{key:0},Ke(i.formData.properties,(u,P)=>(x(),O("div",{key:P,class:"mb-3"},[e(J,{"no-gutters":""},{default:t(()=>[e(p,{cols:"4"},{default:t(()=>[e(M,{"model-value":P,"onUpdate:modelValue":z=>_(P,z),label:"Nama Properti",variant:"outlined",density:"compact"},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),e(p,{cols:"7",class:"ps-2"},{default:t(()=>[e(M,{modelValue:i.formData.properties[P],"onUpdate:modelValue":z=>i.formData.properties[P]=z,label:"Nilai",variant:"outlined",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(p,{cols:"1",class:"ps-2 d-flex align-center"},{default:t(()=>[e(I,{icon:"tabler-trash",color:"error",variant:"text",size:"small",onClick:z=>w(P)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)):C("",!0)]),_:1,__:[21]})]),_:1})]),_:1},512)]),_:1}),e(oe),e(Ye,{class:"pa-6"},{default:t(()=>[e(Ze),e(I,{variant:"outlined",class:"coffee-secondary",onClick:o[9]||(o[9]=u=>f.value=!1)},{default:t(()=>o[22]||(o[22]=[g(" Batal ")])),_:1,__:[22]}),e(I,{color:"primary",class:"coffee-primary",loading:i.loading,onClick:h},{default:t(()=>[g(k(i.editMode?"Perbarui":"Simpan")+" Item ",1)]),_:1},8,["loading"])]),_:1})]),_:1}),e(et,{"model-value":!!i.errorMessage,"onUpdate:modelValue":o[11]||(o[11]=u=>!u&&n("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500"},{actions:t(()=>[e(I,{icon:"tabler-x",size:"small",variant:"text",onClick:o[10]||(o[10]=u=>n("clear-error"))})]),default:t(()=>[l("div",vt,[e(y,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),l("div",null,[o[23]||(o[23]=l("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),l("div",_t,k(i.errorMessage),1)])])]),_:1},8,["model-value"])]),_:1},8,["modelValue"]))}}),bt=Z(kt,[["__scopeId","data-v-9d8735a2"]]),yt=W({__name:"ItemSearchFilters",props:{filters:{}},emits:["update:filters"],setup(a,{emit:c}){const d=a,n=c,m=V({...d.filters});He(()=>d.filters,w=>{m.value={...w}},{deep:!0});const f=[{title:"all",value:"all"},{title:"active",value:"active"},{title:"inactive",value:"inactive"}],v=[{title:"all",value:"all"},{title:"in-stock",value:"in-stock"},{title:"low-stock",value:"low-stock"},{title:"out-of-stock",value:"out-of-stock"}],s=()=>{console.log("ItemSearchFilters - onFilterChange called with:",m.value),n("update:filters",{...m.value})},h=()=>{m.value={search:"",active:"all",supplier_id:void 0,unit:"",stock_status:"all",expiring_days:void 0,show_expired:!1},s()},A=G(()=>m.value.search||m.value.active!=="all"||m.value.supplier_id||m.value.unit||m.value.stock_status!=="all"||m.value.expiring_days||m.value.show_expired);return(w,_)=>(x(),S(T,{class:"mb-6"},{default:t(()=>[e(de,{class:"d-flex align-center gap-2"},{default:t(()=>[e(y,{icon:"tabler-filter",class:"coffee-icon"}),_[6]||(_[6]=g(" Filter & Pencarian Item "))]),_:1,__:[6]}),e(E,null,{default:t(()=>[e(J,null,{default:t(()=>[e(p,{cols:"12",md:"4"},{default:t(()=>[e(M,{modelValue:r(m).search,"onUpdate:modelValue":[_[0]||(_[0]=i=>r(m).search=i),s],label:"Cari item...",placeholder:"Nama, kode, atau deskripsi","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"2"},{default:t(()=>[e(ee,{modelValue:r(m).active,"onUpdate:modelValue":[_[1]||(_[1]=i=>r(m).active=i),s],items:f,label:"Status","prepend-inner-icon":"tabler-toggle-left",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"2"},{default:t(()=>[e(ee,{modelValue:r(m).stock_status,"onUpdate:modelValue":[_[2]||(_[2]=i=>r(m).stock_status=i),s],items:v,label:"Stok","prepend-inner-icon":"tabler-package",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4",class:"d-flex align-center gap-3"},{default:t(()=>[e(I,{color:"primary",variant:"tonal","prepend-icon":"tabler-search",onClick:s},{default:t(()=>_[7]||(_[7]=[g(" Cari ")])),_:1,__:[7]}),r(A)?(x(),S(I,{key:0,color:"secondary",variant:"outlined","prepend-icon":"tabler-x",onClick:h},{default:t(()=>_[8]||(_[8]=[g(" Reset ")])),_:1,__:[8]})):C("",!0)]),_:1})]),_:1}),e(tt,{class:"mt-4"},{default:t(()=>[e(at,null,{default:t(()=>[e(lt,{class:"text-sm"},{default:t(()=>[e(y,{icon:"tabler-adjustments-horizontal",class:"me-2"}),_[9]||(_[9]=g(" Filter Lanjutan "))]),_:1,__:[9]}),e(st,null,{default:t(()=>[e(J,null,{default:t(()=>[e(p,{cols:"12",md:"3"},{default:t(()=>[e(M,{modelValue:r(m).unit,"onUpdate:modelValue":[_[3]||(_[3]=i=>r(m).unit=i),s],label:"Satuan",placeholder:"kg, pcs, liter...","prepend-inner-icon":"tabler-ruler",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"3"},{default:t(()=>[e(M,{modelValue:r(m).expiring_days,"onUpdate:modelValue":[_[4]||(_[4]=i=>r(m).expiring_days=i),s],type:"number",label:"Akan kadaluarsa (hari)",placeholder:"30","prepend-inner-icon":"tabler-calendar-time",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"3",class:"d-flex align-center"},{default:t(()=>[e(ot,{modelValue:r(m).show_expired,"onUpdate:modelValue":[_[5]||(_[5]=i=>r(m).show_expired=i),s],label:"Tampilkan yang kadaluarsa",color:"warning"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),Vt=Z(yt,[["__scopeId","data-v-0de951d0"]]),xt={class:"d-flex align-center gap-2"},ht={class:"text-h6"},It={class:"d-flex align-center gap-2"},Dt={class:"text-h6"},wt={class:"d-flex align-center gap-2"},Ct={class:"text-h6"},St={class:"d-flex align-center gap-2"},Pt={class:"text-h6"},$t={class:"d-flex align-center gap-2"},Tt={class:"text-h6"},Ut={class:"d-flex align-center gap-2"},At={class:"text-h6"},zt=W({__name:"ItemStatsCards",props:{stats:{},loading:{type:Boolean,default:!1}},setup(a){return(c,d)=>(x(),S(J,{class:"mb-6"},{default:t(()=>[e(p,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(T,{class:"stats-card"},{default:t(()=>[e(E,{class:"d-flex align-center"},{default:t(()=>{var n;return[e(L,{size:"44",rounded:"",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[e(y,{icon:"tabler-package"})]),_:1}),l("div",null,[d[0]||(d[0]=l("span",{class:"text-sm text-medium-emphasis"},"Total Item",-1)),l("div",xt,[l("h6",ht,k(((n=c.stats)==null?void 0:n.total_items)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(p,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(T,{class:"stats-card"},{default:t(()=>[e(E,{class:"d-flex align-center"},{default:t(()=>{var n;return[e(L,{size:"44",rounded:"",color:"success",variant:"tonal",class:"me-3"},{default:t(()=>[e(y,{icon:"tabler-check"})]),_:1}),l("div",null,[d[1]||(d[1]=l("span",{class:"text-sm text-medium-emphasis"},"Item Aktif",-1)),l("div",It,[l("h6",Dt,k(((n=c.stats)==null?void 0:n.active_items)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(p,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(T,{class:"stats-card"},{default:t(()=>[e(E,{class:"d-flex align-center"},{default:t(()=>{var n;return[e(L,{size:"44",rounded:"",color:"warning",variant:"tonal",class:"me-3"},{default:t(()=>[e(y,{icon:"tabler-alert-triangle"})]),_:1}),l("div",null,[d[2]||(d[2]=l("span",{class:"text-sm text-medium-emphasis"},"Stok Rendah",-1)),l("div",wt,[l("h6",Ct,k(((n=c.stats)==null?void 0:n.low_stock_items)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(p,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(T,{class:"stats-card"},{default:t(()=>[e(E,{class:"d-flex align-center"},{default:t(()=>{var n;return[e(L,{size:"44",rounded:"",color:"error",variant:"tonal",class:"me-3"},{default:t(()=>[e(y,{icon:"tabler-x"})]),_:1}),l("div",null,[d[3]||(d[3]=l("span",{class:"text-sm text-medium-emphasis"},"Stok Habis",-1)),l("div",St,[l("h6",Pt,k(((n=c.stats)==null?void 0:n.out_of_stock_items)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(p,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(T,{class:"stats-card"},{default:t(()=>[e(E,{class:"d-flex align-center"},{default:t(()=>{var n;return[e(L,{size:"44",rounded:"",color:"info",variant:"tonal",class:"me-3"},{default:t(()=>[e(y,{icon:"tabler-currency-dollar"})]),_:1}),l("div",null,[d[4]||(d[4]=l("span",{class:"text-sm text-medium-emphasis"},"Nilai Stok",-1)),l("div",$t,[l("h6",Tt,k(r(be)(((n=c.stats)==null?void 0:n.total_value)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(p,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(T,{class:"stats-card"},{default:t(()=>[e(E,{class:"d-flex align-center"},{default:t(()=>{var n;return[e(L,{size:"44",rounded:"",color:"secondary",variant:"tonal",class:"me-3"},{default:t(()=>[e(y,{icon:"tabler-pause"})]),_:1}),l("div",null,[d[5]||(d[5]=l("span",{class:"text-sm text-medium-emphasis"},"Item Nonaktif",-1)),l("div",Ut,[l("h6",At,k(((n=c.stats)==null?void 0:n.inactive_items)||0),1)])])]}),_:1})]),_:1})]),_:1})]),_:1}))}}),Ft=Z(zt,[["__scopeId","data-v-1e00df2a"]]),Et={class:"d-flex align-center gap-2"},Mt={class:"d-flex align-center gap-2"},Nt={class:"font-weight-medium text-high-emphasis"},Rt={key:0,class:"text-caption text-medium-emphasis mt-1"},Lt={class:"text-end"},jt={class:"font-weight-medium"},Ot={class:"text-center"},Bt={class:"d-flex align-center justify-center gap-1"},Kt={class:"text-medium-emphasis"},Gt={class:"text-center"},Ht={class:"font-weight-medium"},qt={class:"text-medium-emphasis"},Jt={class:"d-flex align-center justify-center gap-1"},Xt={class:"text-sm"},Yt={class:"d-flex flex-column gap-1"},Qt={key:2,class:"text-caption text-medium-emphasis"},Wt={class:"d-flex gap-1 justify-center"},Zt=W({__name:"ItemTable",props:{items:{},loading:{type:Boolean,default:!1},selectedItems:{default:()=>[]},currentPage:{default:1},itemsPerPage:{default:15},totalItems:{default:0}},emits:["update:selected-items","add-item","edit-item","delete-item","update:page","update:items-per-page"],setup(a,{emit:c}){const d=[{title:"KODE ITEM",key:"item_code",align:"start"},{title:"NAMA ITEM",key:"name",align:"start"},{title:"SATUAN",key:"unit",align:"center"},{title:"HARGA/UNIT",key:"cost_per_unit",align:"end"},{title:"STOK",key:"current_stock",align:"center"},{title:"MIN. STOK",key:"minimum_stock",align:"center"},{title:"STATUS STOK",key:"stock_status",align:"center"},{title:"LOKASI",key:"storage_location",align:"center"},{title:"STATUS",key:"active",align:"center"},{title:"JENIS LAYANAN",key:"service_type",align:"center"},{title:"AKSI",key:"actions",align:"center",sortable:!1}],n=f=>{switch(f){case"in_stock":return"success";case"low_stock":return"warning";case"out_of_stock":return"error";default:return"success"}},m=f=>{switch(f){case"in_stock":return"Tersedia";case"low_stock":return"Stok Rendah";case"out_of_stock":return"Stok Habis";default:return"Tersedia"}};return(f,v)=>(x(),S(T,null,{default:t(()=>[e(de,{class:"d-flex align-center justify-space-between"},{default:t(()=>[l("div",Et,[e(y,{icon:"tabler-list",class:"coffee-icon"}),v[4]||(v[4]=g(" Data Item ")),f.totalItems?(x(),S(F,{key:0,size:"small",color:"primary",variant:"tonal"},{default:t(()=>[g(k(f.totalItems)+" item ",1)]),_:1})):C("",!0)]),l("div",Mt,[e(I,{"prepend-icon":"tabler-plus",color:"primary",onClick:v[0]||(v[0]=s=>f.$emit("add-item"))},{default:t(()=>v[5]||(v[5]=[g(" Tambah Item ")])),_:1,__:[5]})])]),_:1}),e(oe),e(it,{"model-value":f.selectedItems,"onUpdate:modelValue":v[1]||(v[1]=s=>f.$emit("update:selected-items",s)),headers:d,items:f.items,loading:f.loading,"items-length":f.totalItems,"items-per-page":f.itemsPerPage,page:f.currentPage,"item-value":"id_item","show-select":"","onUpdate:page":v[2]||(v[2]=s=>f.$emit("update:page",s)),"onUpdate:itemsPerPage":v[3]||(v[3]=s=>f.$emit("update:items-per-page",s)),class:"text-no-wrap"},{"item.item_code":t(({item:s})=>[e(F,{color:"primary",variant:"outlined",size:"small",class:"font-mono"},{default:t(()=>[g(k(s.item_code),1)]),_:2},1024)]),"item.name":t(({item:s})=>[l("div",null,[l("div",Nt,k(s.name),1),s.description?(x(),O("div",Rt,k(s.description),1)):C("",!0)])]),"item.unit":t(({item:s})=>[e(F,{color:"info",variant:"tonal",size:"small"},{default:t(()=>[g(k(s.unit),1)]),_:2},1024)]),"item.cost_per_unit":t(({item:s})=>[l("div",Lt,[l("div",jt,k(r(be)(s.cost_per_unit)),1)])]),"item.current_stock":t(({item:s})=>{var h,A,w;return[l("div",Ot,[l("div",Bt,[l("span",{class:qe(["font-weight-bold",(((h=s.inventory)==null?void 0:h.current_stock)||0)<=(((A=s.inventory)==null?void 0:A.reorder_level)||0)?"text-error":"text-success"])},k(((w=s.inventory)==null?void 0:w.current_stock)||0),3),l("small",Kt,k(s.unit),1)])])]}),"item.minimum_stock":t(({item:s})=>{var h;return[l("div",Gt,[l("span",Ht,k(((h=s.inventory)==null?void 0:h.reorder_level)||0),1),l("small",qt,k(s.unit),1)])]}),"item.stock_status":t(({item:s})=>[e(F,{color:n(s.stock_status||"in_stock"),variant:"tonal",size:"small"},{default:t(()=>[g(k(m(s.stock_status||"in_stock")),1)]),_:2},1032,["color"])]),"item.storage_location":t(({item:s})=>[l("div",Jt,[e(y,{icon:"tabler-map-pin",size:"16",class:"text-medium-emphasis"}),l("span",Xt,k(s.storage_location||"Gudang A-Rak 1"),1)])]),"item.active":t(({item:s})=>[e(F,{color:s.active?"success":"error",variant:"tonal",size:"small"},{default:t(()=>[g(k(s.active?"Aktif":"Nonaktif"),1)]),_:2},1032,["color"])]),"item.service_type":t(({item:s})=>[l("div",Yt,[s.is_delivery?(x(),S(F,{key:0,color:"primary",variant:"tonal",size:"x-small","prepend-icon":"tabler-truck-delivery"},{default:t(()=>v[6]||(v[6]=[g(" Delivery ")])),_:1,__:[6]})):C("",!0),s.is_takeaway?(x(),S(F,{key:1,color:"secondary",variant:"tonal",size:"x-small","prepend-icon":"tabler-package"},{default:t(()=>v[7]||(v[7]=[g(" Take Away ")])),_:1,__:[7]})):C("",!0),!s.is_delivery&&!s.is_takeaway?(x(),O("span",Qt," Tidak tersedia ")):C("",!0)])]),"item.actions":t(({item:s})=>[l("div",Wt,[e(I,{icon:"tabler-edit",size:"small",variant:"text",color:"primary",onClick:h=>f.$emit("edit-item",s)},null,8,["onClick"]),e(I,{icon:"tabler-trash",size:"small",variant:"text",color:"error",onClick:h=>f.$emit("delete-item",s)},null,8,["onClick"])])]),_:1},8,["model-value","items","loading","items-length","items-per-page","page"])]),_:1}))}}),ea=Z(Zt,[["__scopeId","data-v-1d78069b"]]),q=V([]),ie=V(!1),re=V(!1),ne=V(!1),ye=V({total_items:0,active_items:0,inactive_items:0,low_stock_items:0,out_of_stock_items:0,total_value:0}),te=V(!1),ue=V(!1),Y=V(!1),U=V(null),Ve=V([]),$=V(1),j=V(0),B=V(15),K=ke({search:"",active:"all",unit:"",stock_status:"all",expiring_days:void 0,show_expired:!1}),Q=V(""),me=V(""),N=V(""),R=ke({name:"",description:"",unit:"",cost_per_unit:0,current_stock:0,minimum_stock:0,storage_location:"",expiry_date:void 0,active:!0,is_delivery:!1,is_takeaway:!1,properties:{}}),ta=G(()=>!0),aa=G(()=>Ve.value.length>0),la=G(()=>[{title:"Semua Status",value:"all"},{title:"Stok Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Stok Habis",value:"out_of_stock"}]),sa=G(()=>{const a=new Set(q.value.map(c=>c.unit));return Array.from(a).map(c=>({title:c,value:c}))}),H=async()=>{var a;ie.value=!0,Q.value="";try{const c={page:$.value,per_page:B.value,...K};Object.keys(c).forEach(n=>{(c[n]===void 0||c[n]===""||c[n]==="all")&&delete c[n]}),console.log("Fetching items with params:",c),console.log("Filters state:",K);const d=await X.getAll(c);if(console.log("🔍 Full API Response:",d),d.success&&d.data){const n=d.data;console.log("📄 Paginated Data Object:",n),q.value=n.data||[],j.value=n.total||0,$.value=n.current_page||1,console.log("Items fetched:",{data:(a=n.data)==null?void 0:a.length,total:n.total,current_page:n.current_page,per_page:n.per_page,last_page:n.last_page}),console.log("📊 Final State Values:",{itemsListLength:q.value.length,totalItemsValue:j.value,currentPageValue:$.value,itemsPerPageValue:B.value})}}catch(c){console.error("Error fetching items:",c),Q.value=c.message||"Failed to fetch items",q.value=[],j.value=0}finally{ie.value=!1}},ce=async()=>{try{const a=await X.getStats();a.success&&a.data&&(ye.value=a.data)}catch(a){console.error("Error fetching stats:",a)}},oa=async()=>{if(ra()){re.value=!0,N.value="";try{let a;Y.value&&U.value?a=await X.update(U.value.id_item,R):a=await X.create(R),a.success?(me.value=Y.value?"Item berhasil diperbarui!":"Item berhasil ditambahkan!",xe(),await H(),await ce()):N.value=a.message||"Terjadi kesalahan saat menyimpan item"}catch(a){console.error("Error saving item:",a),N.value=a.message||"Terjadi kesalahan saat menyimpan item"}finally{re.value=!1}}},ia=async()=>{if(U.value){ne.value=!0;try{const a=await X.delete(U.value.id_item);a.success?(me.value="Item berhasil dihapus!",he(),await H(),await ce()):Q.value=a.message||"Gagal menghapus item"}catch(a){console.error("Error deleting item:",a),Q.value=a.message||"Terjadi kesalahan saat menghapus item"}finally{ne.value=!1}}},ra=()=>R.name.trim()?R.unit.trim()?!0:(N.value="Satuan harus diisi",!1):(N.value="Nama item harus diisi",!1),na=()=>{Y.value=!1,U.value=null,Ie(),te.value=!0},da=a=>{Y.value=!0,U.value=a,ma(a),te.value=!0},ua=a=>{U.value=a,ue.value=!0},xe=()=>{te.value=!1,De(),Ie()},he=()=>{ue.value=!1,U.value=null},Ie=()=>{Object.assign(R,{name:"",description:"",unit:"",cost_per_unit:0,current_stock:0,minimum_stock:0,storage_location:"",expiry_date:void 0,active:!0,is_delivery:!1,is_takeaway:!1,properties:{}})},ma=a=>{Object.assign(R,{name:a.name,description:a.description||"",unit:a.unit,cost_per_unit:a.cost_per_unit||0,current_stock:a.current_stock||0,minimum_stock:a.minimum_stock||0,storage_location:a.storage_location||"",expiry_date:a.expiry_date,active:a.active,is_delivery:a.is_delivery||!1,is_takeaway:a.is_takeaway||!1,properties:a.properties||{}})},De=()=>{N.value=""},ca=a=>{console.log("🔄 Items onPageChange called with page:",a),console.log("📄 Current state - currentPage:",$.value,"totalItems:",j.value,"itemsPerPage:",B.value),a!==$.value&&($.value=a,H())},pa=a=>{console.log("🔄 Items onItemsPerPageChange called with itemsPerPage:",a),console.log("📄 Current state - currentPage:",$.value,"totalItems:",j.value),a!==B.value&&(B.value=a,$.value=1,H())},we=a=>{a&&(Object.assign(K,a),console.log("useItems - Filters updated:",K)),$.value=1,H()},fa=()=>{Object.assign(K,{search:"",active:"all",supplier_id:void 0,unit:"",stock_status:"all",expiring_days:void 0,show_expired:!1}),we()},ga=()=>({itemsList:q,loading:ie,saveLoading:re,deleteLoading:ne,stats:ye,dialog:te,deleteDialog:ue,editMode:Y,selectedItem:U,selectedItems:Ve,currentPage:$,totalItems:j,itemsPerPage:B,filters:K,errorMessage:Q,successMessage:me,modalErrorMessage:N,formData:R,canCreateEdit:ta,hasSelectedItems:aa,stockStatusOptions:la,unitOptions:sa,fetchItemsList:H,fetchStats:ce,saveItem:oa,deleteItem:ia,openCreateDialog:na,openEditDialog:da,openDeleteDialog:ua,closeDialog:xe,closeDeleteDialog:he,clearModalError:De,onPageChange:ca,onItemsPerPageChange:pa,handleFiltersUpdate:we,clearFilters:fa}),va={class:"item-management"},_a={class:"d-flex justify-space-between align-center mb-6"},ka={class:"d-flex gap-3 align-center"},ba={key:0,class:"d-flex gap-2"},ya=W({__name:"items-management",setup(a){const{itemsList:c,loading:d,saveLoading:n,deleteLoading:m,stats:f,dialog:v,deleteDialog:s,editMode:h,selectedItem:A,selectedItems:w,currentPage:_,totalItems:i,itemsPerPage:o,filters:u,errorMessage:P,successMessage:z,modalErrorMessage:Ce,formData:pe,canCreateEdit:Se,hasSelectedItems:Pe,fetchItemsList:$e,fetchStats:Te,saveItem:Ue,deleteItem:Ae,openCreateDialog:fe,openEditDialog:ze,openDeleteDialog:ge,closeDialog:Fe,clearModalError:Ee,onPageChange:Me,onItemsPerPageChange:Ne,handleFiltersUpdate:Re}=ga(),Le=async()=>{await Ae()};return Je(()=>{$e(),Te()}),(Va,b)=>{var ve;return x(),O("div",va,[l("div",_a,[b[10]||(b[10]=l("div",null,[l("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Item"),l("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola bahan baku dan item untuk operasional coffee shop Anda")],-1)),l("div",ka,[r(Pe)?(x(),O("div",ba,[e(F,{color:"primary",size:"small"},{default:t(()=>[g(k(r(w).length)+" dipilih ",1)]),_:1}),e(I,{color:"error",variant:"outlined",size:"small","prepend-icon":"mdi-delete",onClick:r(ge)},{default:t(()=>b[8]||(b[8]=[g(" Hapus Terpilih ")])),_:1,__:[8]},8,["onClick"])])):C("",!0),r(Se)?(x(),S(I,{key:1,color:"primary","prepend-icon":"mdi-plus",class:"coffee-btn",onClick:r(fe)},{default:t(()=>b[9]||(b[9]=[g(" Tambah Item ")])),_:1,__:[9]},8,["onClick"])):C("",!0)])]),r(P)?(x(),S(_e,{key:0,type:"error",variant:"outlined",class:"mb-4",text:r(P),closable:"","onClick:close":b[0]||(b[0]=D=>P.value="")},null,8,["text"])):C("",!0),r(z)?(x(),S(_e,{key:1,type:"success",variant:"outlined",class:"mb-4",text:r(z),closable:"","onClick:close":b[1]||(b[1]=D=>z.value="")},null,8,["text"])):C("",!0),e(Ft,{stats:r(f)},null,8,["stats"]),e(Vt,{filters:r(u),"onUpdate:filters":r(Re)},null,8,["filters","onUpdate:filters"]),e(ea,{items:r(c),loading:r(d),"current-page":r(_),"total-items":r(i),"items-per-page":r(o),"selected-items":r(w),"onUpdate:page":r(Me),"onUpdate:itemsPerPage":r(Ne),onAddItem:r(fe),onEditItem:r(ze),onDeleteItem:r(ge),"onUpdate:selectedItems":b[2]||(b[2]=D=>w.value=D)},null,8,["items","loading","current-page","total-items","items-per-page","selected-items","onUpdate:page","onUpdate:itemsPerPage","onAddItem","onEditItem","onDeleteItem"]),e(bt,{modelValue:r(v),"onUpdate:modelValue":[b[3]||(b[3]=D=>se(v)?v.value=D:null),b[4]||(b[4]=D=>v.value=D)],"edit-mode":r(h),"form-data":r(pe),loading:r(n),"error-message":r(Ce),onClose:r(Fe),onSave:r(Ue),onClearError:r(Ee),onUpdateForm:b[5]||(b[5]=(D,je)=>r(pe)[D]=je)},null,8,["modelValue","edit-mode","form-data","loading","error-message","onClose","onSave","onClearError"]),e(Oe,{modelValue:r(s),"onUpdate:modelValue":b[6]||(b[6]=D=>se(s)?s.value=D:null),title:"Konfirmasi Hapus Item","item-name":(ve=r(A))==null?void 0:ve.name,loading:r(m),"confirm-text":"Hapus Item",onConfirm:Le,onCancel:b[7]||(b[7]=D=>s.value=!1)},null,8,["modelValue","item-name","loading"])])}}}),tl=Z(ya,[["__scopeId","data-v-88f2c338"]]);export{tl as default};
