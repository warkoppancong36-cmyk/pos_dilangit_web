import{d as ne,r as v,V as A,w as ie,D as de,c as z,e as r,b as e,f as a,a1 as ue,ax as ce,au as me,av as L,o as O,X as d,H as fe,I as pe,t as i,s as p,_ as _e}from"./main-BrqnTWe2.js";import{C as D}from"./auto-Cz6uSJnr.js";import{V as G}from"./VTextField-B8Xfi90b.js";import{V as ve}from"./VSelect-pNrOXW29.js";import{V as w,a as u}from"./VRow-CKlLKJBC.js";import{V as c,b as y}from"./VCard-jypEpmgm.js";import{V as m}from"./VCardText-CITdBgrp.js";import{V as U}from"./VDataTable-B2pvmvWi.js";import{V as he}from"./VChip-wrQbqNYk.js";import{b as J}from"./route-block-B_A1xBdJ.js";import"./VImg-Ce8SpBNq.js";import"./forwardRefs-B931MWyl.js";import"./VList-Qs6x_u2a.js";import"./VAvatar-Bg4psVXw.js";import"./VDivider-BfIgQDUM.js";import"./VOverlay-Cd4CgNVa.js";import"./VMenu-DgaqchZo.js";import"./VCheckboxBtn-BzhOWjYe.js";/* empty css              */import"./VTable-C5KdnG4G.js";import"./filter-Bd8BqEeZ.js";const ge={class:"dashboard-page"},ye={class:"d-flex flex-column flex-md-row justify-space-between align-start align-md-center mb-6 ga-4"},xe={class:"d-flex flex-column flex-sm-row gap-3 align-stretch align-sm-center w-100 w-md-auto"},be={class:"d-flex flex-column flex-sm-row gap-2 align-stretch"},ke={key:0,class:"text-center py-8"},Ce={key:1},De={class:"flex-grow-1"},we={class:"text-h4 text-success mt-2"},Ve={class:"text-caption text-medium-emphasis"},Te={class:"flex-grow-1"},Ae={class:"text-h4 text-info mt-2"},Fe={class:"text-caption text-medium-emphasis"},Ie={class:"flex-grow-1"},Pe={class:"text-h4 text-warning mt-2"},Se={class:"text-caption text-medium-emphasis"},Be={class:"flex-grow-1"},Ee={class:"text-h4 text-primary mt-2"},He={class:"text-caption text-medium-emphasis"},Re={style:{height:"300px"}},Ne={style:{height:"300px"}},je={style:{height:"300px"}},ze={style:{height:"300px"}},Le={style:{height:"300px"}},K=ne({__name:"dashboard",setup(Oe){const x=l=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),V=v(!1),b=v("30"),h=v(""),g=v(""),f=v(null),F=v(null),I=v(null),P=v(null),S=v(null),B=v(null);let E=null,H=null,R=null,N=null,j=null;const M=[{label:"7 Hari Terakhir",value:"7"},{label:"30 Hari Terakhir",value:"30"},{label:"90 Hari Terakhir",value:"90"},{label:"1 Tahun Terakhir",value:"365"},{label:"Custom Range",value:"custom"}],Q=[{title:"Item",key:"item_name"},{title:"Stock Saat Ini",key:"current_stock"},{title:"Stock Minimum",key:"min_stock"}],W=[{title:"Produk",key:"product_name"},{title:"Terjual",key:"total_quantity"},{title:"Pendapatan",key:"total_revenue"}],Y=[{title:"Supplier",key:"supplier_name"},{title:"Total Pembelian",key:"purchase_count"},{title:"Total Nilai",key:"total_amount"}],_=A(()=>{var l;return((l=f.value)==null?void 0:l.summary)||{}}),k=A(()=>{var l;return((l=f.value)==null?void 0:l.sales)||{}}),C=A(()=>{var l;return((l=f.value)==null?void 0:l.purchases)||{}}),$=A(()=>{var l;return((l=f.value)==null?void 0:l.inventory)||{}}),T=async()=>{V.value=!0;try{const l={};if(b.value==="custom")if(h.value&&g.value){const s=new Date(h.value),o=new Date(g.value);l.start_date=s.toISOString().split("T")[0],l.end_date=o.toISOString().split("T")[0]}else l.period="30";else l.period=b.value;const t=await me.get("/api/dashboard/analytics",{params:l});t.data.success&&(f.value=t.data.data,await L(),X())}catch(l){console.error("Error loading dashboard:",l)}finally{V.value=!1}},ee=l=>{l!=="custom"&&(h.value="",g.value=""),T()},q=()=>{h.value&&g.value&&(b.value="custom",T())},te=()=>{const l=new Date,t=new Date;t.setDate(l.getDate()-30),g.value=l.toISOString().split("T")[0],h.value=t.toISOString().split("T")[0]},Z=()=>{var l;if(b.value==="custom"&&h.value&&g.value){const t=new Date(h.value).toLocaleDateString("id-ID"),s=new Date(g.value).toLocaleDateString("id-ID");return`(${t} - ${s})`}else return`(${((l=M.find(s=>s.value===b.value))==null?void 0:l.label)||"30 Hari Terakhir"})`},X=()=>{f.value&&L(()=>{setTimeout(()=>{var l,t,s,o,n;F.value&&((l=f.value)!=null&&l.sales)&&ae(),I.value&&((t=k.value)!=null&&t.top_products)&&le(),P.value&&((s=f.value)!=null&&s.purchases)&&se(),S.value&&((o=C.value)!=null&&o.top_purchased_items)&&oe(),B.value&&((n=f.value)!=null&&n.inventory)&&re()},200)})},ae=()=>{var s,o;E&&E.destroy();const l=(s=F.value)==null?void 0:s.getContext("2d");if(!l||!((o=k.value)!=null&&o.daily_trend)||!Array.isArray(k.value.daily_trend))return;const t=k.value.daily_trend;try{E=new D(l,{type:"line",data:{labels:t.map(n=>new Date(n.date).toLocaleDateString("id-ID")),datasets:[{label:"Penjualan Harian",data:t.map(n=>n.total_revenue),borderColor:"#D4A574",backgroundColor:"rgba(212, 165, 116, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(n){return x(Number(n))}}}}}})}catch(n){console.error("Error creating sales chart:",n)}},le=()=>{var s,o;H&&H.destroy();const l=(s=I.value)==null?void 0:s.getContext("2d");if(!l)return;const t=(o=k.value)==null?void 0:o.top_products;if(!(!t||!Array.isArray(t)))try{H=new D(l,{type:"pie",data:{labels:t.map(n=>n.product_name||"Unknown"),datasets:[{data:t.map(n=>n.total_quantity||0),backgroundColor:["#D4A574","#E6B887","#F2D099","#B8956A","#9A7F5A","#C69C6C","#E4C29F","#A08660","#BD9B73","#F0D8B5"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})}catch(n){console.error("Error creating sales pie chart:",n)}},se=()=>{var s;R&&R.destroy();const l=(s=P.value)==null?void 0:s.getContext("2d");if(!l||!C.value.daily_trend)return;const t=C.value.daily_trend;R=new D(l,{type:"line",data:{labels:t.map(o=>new Date(o.date).toLocaleDateString("id-ID")),datasets:[{label:"Pembelian Harian",data:t.map(o=>o.total_amount),borderColor:"#2196F3",backgroundColor:"rgba(33, 150, 243, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(o){return x(Number(o))}}}}}})},oe=()=>{var s,o;N&&N.destroy();const l=(s=S.value)==null?void 0:s.getContext("2d");if(!l)return;const t=(o=C.value)==null?void 0:o.top_purchased_items;!t||!Array.isArray(t)||(N=new D(l,{type:"doughnut",data:{labels:t.map(n=>n.item_name||"Unknown"),datasets:[{data:t.map(n=>n.total_quantity||0),backgroundColor:["#4CAF50","#FF9800","#F44336","#9C27B0","#607D8B","#2196F3","#FF5722","#795548","#E91E63","#3F51B5"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}}))},re=()=>{var s,o;j&&j.destroy();const l=(s=B.value)==null?void 0:s.getContext("2d");if(!l)return;const t=(o=$.value)==null?void 0:o.by_category;!t||!Array.isArray(t)||(j=new D(l,{type:"doughnut",data:{labels:t.map(n=>n.item_name||"Unknown"),datasets:[{data:t.map(n=>n.total_stock||0),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E6B887","#D4A574","#F2D099","#B8956A"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}}))};return ie(f,()=>{f.value&&L(()=>{X()})}),de(()=>{te(),T()}),(l,t)=>(O(),z("div",ge,[r("div",ye,[t[4]||(t[4]=r("div",null,[r("h1",{class:"text-h4 font-weight-bold coffee-title"},"Dashboard Analytics"),r("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"}," Pantau penjualan, pembelian, dan inventory coffee shop Anda ")],-1)),r("div",xe,[r("div",be,[e(G,{modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=s=>h.value=s),type:"date",label:"Tanggal Mulai",density:"comfortable",variant:"outlined","hide-details":"",class:"flex-grow-1",onChange:q},null,8,["modelValue"]),e(G,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),type:"date",label:"Tanggal Akhir",density:"comfortable",variant:"outlined","hide-details":"",class:"flex-grow-1",onChange:q},null,8,["modelValue"])]),e(ve,{modelValue:b.value,"onUpdate:modelValue":[t[2]||(t[2]=s=>b.value=s),ee],items:M,"item-title":"label","item-value":"value",density:"comfortable",variant:"outlined","hide-details":"",class:"flex-shrink-0",style:{"min-width":"180px"}},{"prepend-inner":a(()=>[e(d,{icon:"mdi-calendar-range"})]),_:1},8,["modelValue"]),e(ue,{color:"primary","prepend-icon":"mdi-refresh",onClick:T,loading:V.value,class:"flex-shrink-0"},{default:a(()=>[t[3]||(t[3]=r("span",{class:"d-none d-sm-inline"},"Refresh",-1)),fe(e(d,{icon:"mdi-refresh"},null,512),[[pe,l.$vuetify.display.xs]])]),_:1,__:[3]},8,["loading"])])]),V.value?(O(),z("div",ke,[e(ce,{indeterminate:"",color:"primary",size:"64"}),t[5]||(t[5]=r("p",{class:"text-body-1 mt-4"},"Memuat data dashboard...",-1))])):(O(),z("div",Ce,[e(w,{class:"mb-6"},{default:a(()=>[e(u,{cols:"12",md:"3"},{default:a(()=>[e(c,{class:"summary-card h-100"},{default:a(()=>[e(m,{class:"d-flex align-center"},{default:a(()=>{var s,o,n;return[r("div",De,[t[6]||(t[6]=r("div",{class:"text-h6 font-weight-bold"},"Penjualan Hari Ini",-1)),r("div",we,i(x(((s=_.value.today_sales)==null?void 0:s.value)||0)),1),r("div",Ve,i((((o=_.value.today_sales)==null?void 0:o.growth)??0)>=0?"+":"")+i(((n=_.value.today_sales)==null?void 0:n.growth)??0)+"% dari kemarin ",1)]),e(d,{icon:"mdi-currency-usd",size:"48",class:"text-success"})]}),_:1})]),_:1})]),_:1}),e(u,{cols:"12",md:"3"},{default:a(()=>[e(c,{class:"summary-card h-100"},{default:a(()=>[e(m,{class:"d-flex align-center"},{default:a(()=>{var s,o,n;return[r("div",Te,[t[7]||(t[7]=r("div",{class:"text-h6 font-weight-bold"},"Transaksi Penjualan Hari Ini",-1)),r("div",Ae,i(((s=_.value.today_orders)==null?void 0:s.value)||0),1),r("div",Fe,i((((o=_.value.today_orders)==null?void 0:o.growth)??0)>=0?"+":"")+i(((n=_.value.today_orders)==null?void 0:n.growth)??0)+"% dari kemarin ",1)]),e(d,{icon:"mdi-receipt",size:"48",class:"text-info"})]}),_:1})]),_:1})]),_:1}),e(u,{cols:"12",md:"3"},{default:a(()=>[e(c,{class:"summary-card h-100"},{default:a(()=>[e(m,{class:"d-flex align-center"},{default:a(()=>{var s,o;return[r("div",Ie,[t[8]||(t[8]=r("div",{class:"text-h6 font-weight-bold"},"Nilai Inventory",-1)),r("div",Pe,i(x(((s=_.value.inventory_value)==null?void 0:s.value)||0)),1),r("div",Se,i(((o=_.value.inventory_value)==null?void 0:o.low_stock_count)||0)+" item stok rendah ",1)]),e(d,{icon:"mdi-package-variant",size:"48",class:"text-warning"})]}),_:1})]),_:1})]),_:1}),e(u,{cols:"12",md:"3"},{default:a(()=>[e(c,{class:"summary-card h-100"},{default:a(()=>[e(m,{class:"d-flex align-center"},{default:a(()=>{var s,o;return[r("div",Be,[t[9]||(t[9]=r("div",{class:"text-h6 font-weight-bold"},"Rata-rata Order",-1)),r("div",Ee,i(x(((s=_.value.period_summary)==null?void 0:s.avg_order_value)||0)),1),r("div",He,i(((o=_.value.period_summary)==null?void 0:o.total_orders)||0)+" total order ",1)]),e(d,{icon:"mdi-chart-line",size:"48",class:"text-primary"})]}),_:1})]),_:1})]),_:1})]),_:1}),e(w,{class:"mb-6"},{default:a(()=>[e(u,{cols:"12",lg:"8"},{default:a(()=>[e(c,{class:"chart-card"},{default:a(()=>[e(y,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-chart-line",class:"me-2"}),p(" Tren Penjualan "+i(Z()),1)]),_:1}),e(m,null,{default:a(()=>[r("div",Re,[r("canvas",{ref_key:"salesChart",ref:F},null,512)])]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",lg:"4"},{default:a(()=>[e(c,{class:"chart-card"},{default:a(()=>[e(y,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-chart-pie",class:"me-2"}),t[10]||(t[10]=p(" Produk Terlaris "))]),_:1,__:[10]}),e(m,null,{default:a(()=>[r("div",Ne,[r("canvas",{ref_key:"salesPieChart",ref:I},null,512)])]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{class:"mb-6"},{default:a(()=>[e(u,{cols:"12",lg:"8"},{default:a(()=>[e(c,{class:"chart-card"},{default:a(()=>[e(y,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-cart",class:"me-2"}),p(" Tren Pembelian "+i(Z()),1)]),_:1}),e(m,null,{default:a(()=>[r("div",je,[r("canvas",{ref_key:"purchaseChart",ref:P},null,512)])]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",lg:"4"},{default:a(()=>[e(c,{class:"chart-card"},{default:a(()=>[e(y,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-chart-donut",class:"me-2"}),t[11]||(t[11]=p(" Produk Terbanyak Dibeli "))]),_:1,__:[11]}),e(m,null,{default:a(()=>[r("div",ze,[r("canvas",{ref_key:"purchasePieChart",ref:S},null,512)])]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{class:"mb-6"},{default:a(()=>[e(u,{cols:"12",lg:"6"},{default:a(()=>[e(c,{class:"chart-card"},{default:a(()=>[e(y,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-chart-donut-variant",class:"me-2"}),t[12]||(t[12]=p(" Top Items by Stock "))]),_:1,__:[12]}),e(m,null,{default:a(()=>[r("div",Le,[r("canvas",{ref_key:"inventoryChart",ref:B},null,512)])]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",lg:"6"},{default:a(()=>[e(c,{class:"chart-card"},{default:a(()=>[e(y,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-alert-triangle",class:"me-2"}),t[13]||(t[13]=p(" Item Stok Rendah "))]),_:1,__:[13]}),e(m,null,{default:a(()=>[e(U,{headers:Q,items:$.value.low_stock||[],"hide-default-footer":"",density:"compact"},{"item.current_stock":a(({item:s})=>[e(he,{color:s.current_stock<=0?"error":"warning",size:"small"},{default:a(()=>[p(i(s.current_stock),1)]),_:2},1032,["color"])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(u,{cols:"12",lg:"6"},{default:a(()=>[e(c,{class:"chart-card"},{default:a(()=>[e(y,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-star",class:"me-2"}),t[14]||(t[14]=p(" Produk Terlaris "))]),_:1,__:[14]}),e(m,null,{default:a(()=>[e(U,{headers:W,items:k.value.top_products||[],"hide-default-footer":"",density:"compact"},{"item.total_revenue":a(({item:s})=>[p(i(x(s.total_revenue)),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",lg:"6"},{default:a(()=>[e(c,{class:"chart-card"},{default:a(()=>[e(y,{class:"d-flex align-center"},{default:a(()=>[e(d,{icon:"mdi-truck",class:"me-2"}),t[15]||(t[15]=p(" Supplier Teratas "))]),_:1,__:[15]}),e(m,null,{default:a(()=>[e(U,{headers:Y,items:C.value.top_suppliers||[],"hide-default-footer":"",density:"compact"},{"item.total_amount":a(({item:s})=>[p(i(x(s.total_amount)),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})]),_:1})]))]))}});typeof J=="function"&&J(K);const dt=_e(K,[["__scopeId","data-v-e2bd604b"]]);export{dt as default};
