import{g as H}from"./auth-a9M5ekjn.js";import{d as ve,V as W,r as w,w as ce,D as we,g as R,o as V,f as t,b as e,e as a,X as K,s as g,t as r,a0 as S,ap as Ce,aq as $e,c as M,l as C,i as ke,p as xe,F as Ie,aA as Q,b9 as he,v as be}from"./main-CXIqLbCW.js";import{V as fe}from"./VDialog-BTTkqOUy.js";import{b as X,V as $,c as _e}from"./VCard-BhRwpvwJ.js";import{V as j}from"./VCardText-_9OayIFn.js";import{V as qe}from"./VForm-DyiQjb2R.js";import{V as Y,a as x}from"./VRow-dwXn6nJG.js";import{V as pe}from"./VSelect-eZTLj97C.js";import{a as oe,b as ne,d as Ve,V as Se}from"./VList-D1Fo_w26.js";import{V as G}from"./VTextField-CaLUHH_k.js";import{V as Pe}from"./VTextarea-DrocqHqH.js";import{V as De}from"./VTable-DcQB11Im.js";import{V as Te}from"./VAutocomplete-CaJZxyzw.js";import{V as me}from"./VDivider-CNSSiFqS.js";import{V as ge}from"./VSpacer-n2QvdcM0.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ee}from"./VChip-CssNH5Oa.js";import{V as ze,a as Ue}from"./VDataTable-BqCmKLc9.js";import{V as je}from"./VContainer-DjfwSltS.js";import{V as Ae}from"./VDataTableServer-BpK6Wj6o.js";import{V as Ne}from"./VMenu-DxJRxPvP.js";import{V as Re}from"./VSnackbar-BnsOEM0D.js";import"./VOverlay-nrd9aKYp.js";import"./forwardRefs-B931MWyl.js";import"./VImg-DqJ943ne.js";import"./VAvatar-FS82Gn65.js";/* empty css              */import"./VCheckboxBtn-CYuBx3iM.js";import"./filter-C7wo6B37.js";const Be={class:"d-flex align-center gap-2"},Fe={class:"mt-6"},Oe={class:"d-flex justify-space-between align-center mb-4"},Ee={key:0},Me={class:"text-center font-weight-medium"},Le={class:"text-center font-weight-medium"},Qe={class:"text-end"},He={class:"d-flex justify-space-between mb-2"},Ke={class:"font-weight-medium"},Ge={class:"d-flex justify-space-between mb-2"},Xe={class:"text-success"},Je={class:"d-flex justify-space-between"},We={class:"text-h6 font-weight-bold text-primary"},Ye=ve({__name:"PurchaseDialog",props:{modelValue:{type:Boolean},purchase:{default:null},mode:{default:"create"}},emits:["update:modelValue","saved"],setup(te,{emit:J}){const f=te,B=J,z=W({get:()=>f.modelValue,set:u=>B("update:modelValue",u)}),P=w(),T=w(!1),I=w(!1),k=w(!1),A=w(!1),F=w([]),U=w([]),_=w({id_supplier:null,purchase_date:new Date().toISOString().split("T")[0],notes:"",discount_amount:0,discount_amount_display:"0",items:[]}),p=W(()=>f.mode==="edit"?"Edit Purchase Order":"Buat Purchase Order Baru"),s=W(()=>{const u=_.value.items.reduce((l,o)=>l+(o.total_cost||0),0),i=Number.parseFloat(_.value.discount_amount_display.replace(/\D/g,""))||0,c=0,n=u-i+c;return{subtotal:u,discount:i,tax:c,total:n}}),b=W(()=>T.value&&_.value.items.length>0&&_.value.items.every(u=>u.id_item&&u.quantity>0&&u.unit_cost>0)),N={required:u=>!!u||"Field ini wajib diisi"},D=async()=>{try{k.value=!0;const u=H(),i={"Content-Type":"application/json",Accept:"application/json"};u&&(i.Authorization=`Bearer ${u}`);const c=await Q.get("/api/suppliers",{headers:i});F.value=c.data.data||[],console.log("ðŸ“‹ Suppliers loaded:",F.value.length,"suppliers")}catch(u){console.error("Error loading suppliers:",u)}finally{k.value=!1}},O=async()=>{var u;try{A.value=!0;const i=H();console.log("Loading items with token:",i?"Token found":"No token");const c={"Content-Type":"application/json",Accept:"application/json"};i&&(c.Authorization=`Bearer ${i}`),console.log("Making request to /api/items");const n=await Q.get("/api/items?per_page=all",{headers:c});console.log("Items response:",n.data);const l=n.data.data;l&&l.data?U.value=l.data||[]:U.value=n.data.data||[],console.log("Items loaded:",U.value.length,"items")}catch(i){console.error("Error loading items:",i),console.error("Error response:",(u=i.response)==null?void 0:u.data)}finally{A.value=!1}},E=u=>{try{const i=_.value.items[u];if(!i){console.warn("Item not found at index:",u);return}i.quantity>0&&i.total_cost>0?(i.unit_cost=i.total_cost/i.quantity,i.unit_cost_display=h(i.unit_cost).replace("Rp ","").replace(/\./g,"")):(i.unit_cost=0,i.unit_cost_display="0"),console.log(`Item ${u} unit cost calculated:`,i.unit_cost)}catch(i){console.error("Error in calculateUnitCost:",i)}},ie=(u,i)=>{try{const c=_.value.items[u];if(!c||!i)return;const n=U.value.find(l=>l.id_item===i);n&&(c.unit=n.unit||"",console.log(`Item ${u} unit set to:`,c.unit))}catch(c){console.error("Error in onItemChange:",c)}},re=()=>{try{console.log("Adding new item..."),console.log("Current items count:",_.value.items.length);const u={id_item:null,quantity:0,unit:"",unit_cost:0,unit_cost_display:"0",total_cost:0,total_cost_display:"0"};_.value.items.push(u),console.log("Item added successfully. New count:",_.value.items.length)}catch(u){console.error("Error in addItem:",u)}},ae=u=>{_.value.items.splice(u,1)},le=(u,i)=>{var l;const c=(l=i.target)==null?void 0:l.value,n=_.value.items[u];c===""||c===null||c===void 0?n.quantity=0:n.quantity=Number.parseInt(c)||1,E(u)},y=(u,i)=>{var o;const c=(o=i.target)==null?void 0:o.value,n=(c==null?void 0:c.replace(/\D/g,""))||"",l=_.value.items[u];n===""?(l.total_cost=0,l.total_cost_display="0"):(l.total_cost=Number.parseInt(n),l.total_cost_display=new Intl.NumberFormat("id-ID").format(l.total_cost)),E(u)},m=u=>{var n;const i=(n=u.target)==null?void 0:n.value,c=(i==null?void 0:i.replace(/\D/g,""))||"";c===""?_.value.discount_amount_display="0":_.value.discount_amount_display=new Intl.NumberFormat("id-ID").format(Number.parseInt(c))},d=()=>{},h=u=>Number.isNaN(u)||u===null||u===void 0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(u),L=()=>{var u,i,c,n;if(console.log("ðŸ” initializeForm called"),console.log("ðŸ“ Mode:",f.mode),console.log("ðŸ’¾ Purchase data:",f.purchase),f.mode==="edit"&&f.purchase){console.log("âœ… Initializing form for edit mode"),console.log("ï¿½ All purchase properties:",Object.keys(f.purchase)),console.log("ï¿½ðŸ‘¤ Supplier ID from purchase:",f.purchase.id_supplier),console.log("ï¿½ Supplier object from purchase:",f.purchase.supplier),console.log("ðŸ‘¤ Supplier_id from purchase:",f.purchase.supplier_id),console.log("ï¿½ðŸ“¦ Items from purchase:",f.purchase.items);const l=f.purchase.supplier_id||f.purchase.id_supplier||((u=f.purchase.supplier)==null?void 0:u.id_supplier)||((i=f.purchase.supplier)==null?void 0:i.id);if(console.log("ðŸ“¦ Items from purchase:",f.purchase.items),f.purchase.items&&f.purchase.items.length>0){const v=f.purchase.items[0];console.log("ï¿½ First item debug:",{quantity:v.quantity,quantity_ordered:v.quantity_ordered,unit_cost:v.unit_cost,total_cost:v.total_cost,item_id:((c=v.item)==null?void 0:c.id_item)||v.id_item})}console.log("ðŸŽ¯ Resolved supplier ID:",l),console.log("ðŸ“… Original purchase_date:",f.purchase.purchase_date),console.log("ðŸ“… Purchase_date type:",typeof f.purchase.purchase_date);const o=f.purchase.purchase_date?new Date(f.purchase.purchase_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0];console.log("ðŸ“… Formatted purchase_date:",o),_.value={id_supplier:l,purchase_date:o,notes:f.purchase.notes||"",discount_amount:f.purchase.discount_amount||0,discount_amount_display:new Intl.NumberFormat("id-ID").format(f.purchase.discount_amount||0),items:((n=f.purchase.items)==null?void 0:n.map(v=>{var q;return console.log("ðŸ”„ Mapping item:",v),console.log("ðŸ“Š Item quantity_ordered:",v.quantity_ordered),console.log("ðŸ“Š Item quantity:",v.quantity),{id_item:((q=v.item)==null?void 0:q.id_item)||v.id_item,quantity:Number.parseInt(v.quantity_ordered||v.quantity||0)||0,unit_cost:v.unit_cost,unit_cost_display:new Intl.NumberFormat("id-ID").format(v.unit_cost),total_cost:v.total_cost}}))||[]},console.log("ðŸ“‹ Form data after initialization:",_.value)}else console.log("ðŸ†• Initializing form for create mode"),_.value={id_supplier:null,purchase_date:new Date().toISOString().split("T")[0],notes:"",discount_amount:0,discount_amount_display:"0",items:[]}},se=async()=>{var u,i,c;if((u=P.value)!=null&&u.validate())try{I.value=!0;const n=H(),l={"Content-Type":"application/json",Accept:"application/json"};n&&(l.Authorization=`Bearer ${n}`);const o={supplier_id:_.value.id_supplier,purchase_date:_.value.purchase_date,notes:_.value.notes,discount_amount:Number.parseFloat(_.value.discount_amount_display.replace(/\D/g,""))||0,items:_.value.items.map(v=>({id_item:v.id_item,quantity:v.quantity,unit_cost:v.unit_cost}))};f.mode==="edit"?await Q.put(`/api/purchases/${f.purchase.id_purchase}`,o,{headers:l}):await Q.post("/api/purchases",o,{headers:l}),B("saved")}catch(n){console.error("Error saving purchase:",n),console.error("Error saving purchase:",((c=(i=n.response)==null?void 0:i.data)==null?void 0:c.message)||n.message)}finally{I.value=!1}},Z=()=>{z.value=!1};return ce(()=>f.modelValue,async u=>{u&&(await Promise.all([D(),O()]),await he(),L())}),ce(()=>f.purchase,async u=>{u&&f.mode==="edit"&&(F.value.length===0&&await D(),U.value.length===0&&await O(),await he(),L())},{deep:!0,immediate:!0}),we(()=>{D(),O()}),(u,i)=>(V(),R(fe,{modelValue:z.value,"onUpdate:modelValue":i[5]||(i[5]=c=>z.value=c),"max-width":"1200",persistent:""},{default:t(()=>[e($,null,{default:t(()=>[e(X,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",Be,[e(K,null,{default:t(()=>i[6]||(i[6]=[g("mdi-cart-plus")])),_:1,__:[6]}),a("span",null,r(p.value),1)]),e(S,{icon:"mdi-close",size:"small",variant:"text",onClick:Z})]),_:1}),e(j,null,{default:t(()=>[e(qe,{ref_key:"form",ref:P,modelValue:T.value,"onUpdate:modelValue":i[3]||(i[3]=c=>T.value=c)},{default:t(()=>[e(Y,null,{default:t(()=>[e(x,{cols:"12",md:"6"},{default:t(()=>[e(pe,{modelValue:_.value.id_supplier,"onUpdate:modelValue":i[0]||(i[0]=c=>_.value.id_supplier=c),label:"Supplier *",items:F.value,"item-title":"name","item-value":"id_supplier",variant:"outlined",rules:[N.required],loading:k.value},{item:t(({props:c,item:n})=>[e(oe,Ce($e(c)),{default:t(()=>[e(ne,null,{default:t(()=>[g(r(n.raw.name),1)]),_:2},1024),e(Ve,null,{default:t(()=>[g(r(n.raw.phone)+" - "+r(n.raw.email),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","rules","loading"])]),_:1}),e(x,{cols:"12",md:"3"},{default:t(()=>[e(G,{modelValue:_.value.purchase_date,"onUpdate:modelValue":i[1]||(i[1]=c=>_.value.purchase_date=c),label:"Tanggal Purchase *",type:"date",variant:"outlined",rules:[N.required]},null,8,["modelValue","rules"])]),_:1}),e(x,{cols:"12"},{default:t(()=>[e(Pe,{modelValue:_.value.notes,"onUpdate:modelValue":i[2]||(i[2]=c=>_.value.notes=c),label:"Catatan",variant:"outlined",rows:"2",placeholder:"Catatan tambahan untuk purchase order ini..."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a("div",Fe,[a("div",Oe,[i[9]||(i[9]=a("h3",{class:"text-h6"}," Items Purchase ",-1)),e(S,{color:"primary",variant:"tonal",onClick:re},{default:t(()=>[e(K,{start:""},{default:t(()=>i[7]||(i[7]=[g(" mdi-plus ")])),_:1,__:[7]}),i[8]||(i[8]=g(" Tambah Item "))]),_:1,__:[8]})]),e($,{variant:"outlined"},{default:t(()=>[e(De,null,{default:t(()=>[i[11]||(i[11]=a("thead",null,[a("tr",null,[a("th",{style:{"inline-size":"35%"}}," Item "),a("th",{style:{"inline-size":"12%"}}," Quantity "),a("th",{style:{"inline-size":"10%"}}," Unit "),a("th",{style:{"inline-size":"15%"}}," Total Harga "),a("th",{style:{"inline-size":"15%"}}," Harga Satuan "),a("th",{style:{"inline-size":"13%"}}," Action ")])],-1)),a("tbody",null,[_.value.items.length===0?(V(),M("tr",Ee,i[10]||(i[10]=[a("td",{colspan:"6",class:"text-center py-8 text-medium-emphasis"},' Belum ada item. Klik "Tambah Item" untuk menambah item purchase. ',-1)]))):C("",!0),(V(!0),M(Ie,null,ke(_.value.items,(c,n)=>(V(),M("tr",{key:n},[a("td",null,[e(Te,{modelValue:c.id_item,"onUpdate:modelValue":[l=>c.id_item=l,l=>ie(n,l)],label:"Pilih Item",items:U.value,"item-title":"name","item-value":"id_item",variant:"outlined",density:"compact",loading:A.value,clearable:"","no-data-text":"Tidak ada item ditemukan"},{item:t(({props:l,item:o})=>[e(oe,xe({ref_for:!0},l),{default:t(()=>[e(ne,null,{default:t(()=>[g(r(o.raw.name),1)]),_:2},1024),e(Ve,null,{default:t(()=>{var v;return[g(r((v=o.raw.category)==null?void 0:v.name)+" - SKU: "+r(o.raw.sku),1)]}),_:2},1024)]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","items","loading"])]),a("td",null,[e(G,{modelValue:c.quantity,"onUpdate:modelValue":l=>c.quantity=l,label:"Qty",type:"number",min:"1",step:"1",variant:"outlined",density:"compact",onInput:l=>le(n,l),onBlur:l=>E(n)},null,8,["modelValue","onUpdate:modelValue","onInput","onBlur"])]),a("td",null,[a("div",Me,r(c.unit||"-"),1)]),a("td",null,[e(G,{modelValue:c.total_cost_display,"onUpdate:modelValue":l=>c.total_cost_display=l,label:"Total Harga",variant:"outlined",density:"compact",prefix:"Rp",onInput:l=>y(n,l),onBlur:l=>E(n)},null,8,["modelValue","onUpdate:modelValue","onInput","onBlur"])]),a("td",null,[a("div",Le,r(h(c.unit_cost)),1)]),a("td",null,[e(S,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:l=>ae(n)},null,8,["onClick"])])]))),128))])]),_:1,__:[11]})]),_:1}),e($,{class:"mt-4",variant:"outlined"},{default:t(()=>[e(j,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(x,{cols:"12",md:"8"},{default:t(()=>[e(G,{modelValue:_.value.discount_amount_display,"onUpdate:modelValue":i[4]||(i[4]=c=>_.value.discount_amount_display=c),label:"Diskon",variant:"outlined",prefix:"Rp",placeholder:"0",onInput:m,onBlur:d},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:t(()=>[a("div",Qe,[a("div",He,[i[12]||(i[12]=a("span",null,"Subtotal:",-1)),a("span",Ke,r(h(s.value.subtotal)),1)]),a("div",Ge,[i[13]||(i[13]=a("span",null,"Diskon:",-1)),a("span",Xe,"-"+r(h(s.value.discount)),1)]),e(me,{class:"my-2"}),a("div",Je,[i[14]||(i[14]=a("span",{class:"text-h6 font-weight-bold"},"Total:",-1)),a("span",We,r(h(s.value.total)),1)])])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),e(_e,{class:"pa-4"},{default:t(()=>[e(ge),e(S,{variant:"text",onClick:Z},{default:t(()=>i[15]||(i[15]=[g(" Batal ")])),_:1,__:[15]}),e(S,{color:"primary",loading:I.value,disabled:!b.value,onClick:se},{default:t(()=>[g(r(u.mode==="edit"?"Update":"Simpan"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ze=ye(Ye,[["__scopeId","data-v-66907883"]]),et={class:"d-flex align-center gap-3"},tt={class:"d-flex justify-space-between align-center"},at={class:"text-h6"},lt={class:"text-body-1"},st={class:"font-weight-medium"},ot={class:"text-caption text-medium-emphasis"},nt={class:"font-weight-medium"},it={class:"d-flex justify-space-between"},rt={class:"font-weight-medium"},ut=ve({__name:"PurchaseReceiveDialog",props:{modelValue:{type:Boolean},purchase:{}},emits:["update:modelValue","success"],setup(te,{emit:J}){const f=te,B=J,z=w(!1),P=w(!1),T=w(new Date().toISOString().split("T")[0]),I=w([]),k=W({get:()=>f.modelValue,set:y=>B("update:modelValue",y)}),A=W(()=>T.value&&s()>0&&!P.value),F=[{title:"Item",key:"item_name",sortable:!1,width:"250px"},{title:"Ordered",key:"quantity_ordered",sortable:!1,width:"110px"},{title:"Received",key:"quantity_received",sortable:!1,width:"110px"},{title:"Remaining",key:"remaining",sortable:!1,width:"110px"},{title:"Receive Qty",key:"receive_quantity",sortable:!1,width:"140px"},{title:"Quality",key:"quality_check",sortable:!1,width:"140px"},{title:"Notes",key:"notes",sortable:!1,width:"200px"},{title:"Status",key:"status",sortable:!1,width:"120px"}],U=[{title:"âœ… Good",value:"good"},{title:"âŒ Damaged",value:"damaged"},{title:"â° Expired",value:"expired"},{title:"âš ï¸ Issues",value:"partial"}],_=y=>y.quantity_ordered-(y.quantity_received||0),p=y=>{const m=_(y);return m<=0?"text-success":m<y.quantity_ordered*.5?"text-warning":""},s=()=>I.value.filter(y=>y.receive_quantity&&y.receive_quantity>0).length,b=y=>{const m=_(y);y.receive_quantity>m&&(y.receive_quantity=m),y.receive_quantity<0&&(y.receive_quantity=0)},N=y=>({pending:"warning",ordered:"info",partial:"primary",received:"success",completed:"success",cancelled:"error"})[y]||"default",D=y=>({pending:"Pending",ordered:"Ordered",partial:"Partial",received:"Received",completed:"Completed",cancelled:"Cancelled"})[y]||y,O=y=>({pending:"warning",partial:"primary",received:"success"})[y]||"default",E=y=>({pending:"Pending",partial:"Partial",received:"Complete"})[y]||y,ie=y=>new Date(y).toLocaleDateString("id-ID"),re=async()=>{var y,m;if((y=f.purchase)!=null&&y.id_purchase){z.value=!0;try{if(console.log("Purchase props:",f.purchase),f.purchase.items&&f.purchase.items.length>0){console.log("Using items from props:",f.purchase.items),I.value=f.purchase.items.map(h=>({...h,receive_quantity:0,quality_condition:"good",receive_notes:""})),z.value=!1;return}console.log("Fetching items from API...");const d=await Q.get(`/api/purchases/${f.purchase.id_purchase}`,{headers:{Authorization:`Bearer ${H()}`}});console.log("API Response:",d.data),d.data.success&&((m=d.data.data)!=null&&m.items)&&(console.log("Using items from API data.data:",d.data.data.items),I.value=d.data.data.items.map(h=>({...h,receive_quantity:0,quality_condition:"good",receive_notes:""})))}catch(d){console.error("Error loading purchase items:",d)}finally{z.value=!1}}},ae=async()=>{if(!A.value)return;const y=I.value.filter(m=>m.receive_quantity&&m.receive_quantity>0).map(m=>({id_purchase_item:m.id_purchase_item,quantity_received:m.receive_quantity,quality_check:{condition:m.quality_condition,checked_at:new Date().toISOString(),checked_by:"current_user"},notes:m.receive_notes||null}));if(y.length!==0){P.value=!0;try{const m=await Q.post(`/api/purchases/${f.purchase.id_purchase}/receive`,{items:y,delivery_date:T.value},{headers:{Authorization:`Bearer ${H()}`}});m.data.success&&(B("success",m.data),le())}catch(m){console.error("Error receiving items:",m)}finally{P.value=!1}}},le=()=>{k.value=!1,I.value=[],T.value=new Date().toISOString().split("T")[0]};return ce(k,y=>{y&&f.purchase&&re()}),(y,m)=>(V(),R(fe,{modelValue:k.value,"onUpdate:modelValue":m[1]||(m[1]=d=>k.value=d),"max-width":"1400px",persistent:""},{default:t(()=>[e($,null,{default:t(()=>[e(X,{class:"pa-4"},{default:t(()=>{var d;return[a("div",et,[e(K,{icon:"mdi-package-variant"}),a("span",null,"Receive Items - Purchase #"+r((d=y.purchase)==null?void 0:d.purchase_number),1)])]}),_:1}),e(me),e(j,{class:"pa-4"},{default:t(()=>[e($,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(j,{class:"pa-3"},{default:t(()=>{var d,h,L,se;return[a("div",tt,[a("div",null,[m[2]||(m[2]=a("div",{class:"text-body-2 text-medium-emphasis"}," Supplier ",-1)),a("div",at,r((h=(d=y.purchase)==null?void 0:d.supplier)==null?void 0:h.name),1)]),a("div",null,[m[3]||(m[3]=a("div",{class:"text-body-2 text-medium-emphasis"}," Order Date ",-1)),a("div",lt,r(ie((L=y.purchase)==null?void 0:L.purchase_date)),1)]),a("div",null,[m[4]||(m[4]=a("div",{class:"text-body-2 text-medium-emphasis"}," Status ",-1)),e(ee,{color:N((se=y.purchase)==null?void 0:se.status),variant:"tonal",size:"small"},{default:t(()=>{var Z;return[g(r(D((Z=y.purchase)==null?void 0:Z.status)),1)]}),_:1},8,["color"])])])]}),_:1})]),_:1}),e(Y,{class:"mb-4"},{default:t(()=>[e(x,{cols:"12",md:"6"},{default:t(()=>[e(G,{modelValue:T.value,"onUpdate:modelValue":m[0]||(m[0]=d=>T.value=d),label:"Delivery Date",type:"date",variant:"outlined",rules:[d=>!!d||"Delivery date is required"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),m[7]||(m[7]=a("div",{class:"text-h6 mb-3"}," Items to Receive ",-1)),e(ze,{headers:F,items:I.value,loading:z.value,"item-key":"id_purchase_item",class:"border rounded",density:"compact"},{"item.item_name":t(({item:d})=>{var h,L;return[a("div",null,[a("div",st,r((h=d.item)==null?void 0:h.name),1),a("div",ot,r((L=d.item)==null?void 0:L.item_code),1)])]}),"item.quantity_ordered":t(({item:d})=>{var h;return[a("span",nt,r(parseInt(d.quantity_ordered))+" "+r((h=d.item)==null?void 0:h.unit),1)]}),"item.quantity_received":t(({item:d})=>{var h;return[a("span",{class:be(d.quantity_received>0?"text-success":"")},r(d.quantity_received||0)+" "+r((h=d.item)==null?void 0:h.unit),3)]}),"item.remaining":t(({item:d})=>{var h;return[a("span",{class:be(["font-weight-medium",p(d)])},r(_(d))+" "+r((h=d.item)==null?void 0:h.unit),3)]}),"item.receive_quantity":t(({item:d})=>[e(G,{modelValue:d.receive_quantity,"onUpdate:modelValue":h=>d.receive_quantity=h,modelModifiers:{number:!0},type:"number",min:0,max:_(d),step:"0.001",density:"compact",variant:"outlined",style:{"inline-size":"140px"},disabled:_(d)<=0,onInput:h=>b(d)},null,8,["modelValue","onUpdate:modelValue","max","disabled","onInput"])]),"item.quality_check":t(({item:d})=>[e(pe,{modelValue:d.quality_condition,"onUpdate:modelValue":h=>d.quality_condition=h,items:U,density:"compact",variant:"outlined",style:{"inline-size":"140px"},disabled:!d.receive_quantity||d.receive_quantity<=0},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.notes":t(({item:d})=>[e(G,{modelValue:d.receive_notes,"onUpdate:modelValue":h=>d.receive_notes=h,placeholder:"Notes...",density:"compact",variant:"outlined",style:{"inline-size":"200px"},disabled:!d.receive_quantity||d.receive_quantity<=0},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.status":t(({item:d})=>[e(ee,{color:O(d.status),variant:"tonal",size:"small"},{default:t(()=>[g(r(E(d.status)),1)]),_:2},1032,["color"])]),_:1},8,["items","loading"]),e($,{variant:"outlined",class:"mt-4"},{default:t(()=>[e(j,{class:"pa-3"},{default:t(()=>[m[6]||(m[6]=a("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Receive Summary ",-1)),a("div",it,[m[5]||(m[5]=a("span",null,"Items to receive:",-1)),a("span",rt,r(s()),1)])]),_:1,__:[6]})]),_:1})]),_:1,__:[7]}),e(me),e(_e,{class:"pa-4"},{default:t(()=>[e(ge),e(S,{variant:"outlined",disabled:P.value,onClick:le},{default:t(()=>m[8]||(m[8]=[g(" Cancel ")])),_:1,__:[8]},8,["disabled"]),e(S,{color:"primary",loading:P.value,disabled:!A.value,onClick:ae},{default:t(()=>[e(K,{start:"",icon:"mdi-check"}),m[9]||(m[9]=g(" Confirm Receipt "))]),_:1,__:[9]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),dt={class:"d-flex align-center gap-2"},ct={class:"mb-2"},pt={class:"text-primary font-weight-medium"},mt={class:"mb-2"},vt={class:"mb-2"},ft={key:0,class:"mb-2"},_t={key:1},gt={class:"mb-2"},yt={class:"mb-2"},ht={class:"mb-2"},bt={class:"mb-1 font-weight-medium"},Vt={key:0,class:"text-caption text-medium-emphasis mb-0"},wt={key:1,class:"text-caption text-medium-emphasis mb-0"},kt={class:"text-center"},xt={key:0},It={class:"text-right font-weight-medium"},Dt={class:"text-right font-weight-medium"},Ct={class:"text-center"},$t={class:"mb-0"},qt={class:"mb-2"},St={key:0},Pt={class:"d-flex justify-space-between mb-2"},Tt={class:"font-weight-medium"},zt={key:0,class:"d-flex justify-space-between mb-2"},Ut={class:"text-success"},jt={class:"d-flex justify-space-between"},At={class:"text-h6 font-weight-bold text-primary"},Nt=ve({__name:"PurchaseViewDialog",props:{modelValue:{type:Boolean},purchase:{default:null}},emits:["update:modelValue"],setup(te,{emit:J}){const f=te,B=J,z=W({get:()=>f.modelValue,set:p=>B("update:modelValue",p)}),P=W(()=>f.purchase&&f.purchase.status!=="cancelled"),T=()=>{z.value=!1},I=p=>{const s=typeof p=="string"?parseFloat(p):p;return isNaN(s)||s===null||s===void 0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)},k=p=>p?new Date(p).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"}):"-",A=p=>p?new Date(p).toLocaleString("id-ID",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",F=p=>({pending:"warning",partial:"info",received:"success",cancelled:"error"})[p]||"default",U=p=>({pending:"Pending",partial:"Sebagian",received:"Diterima",cancelled:"Dibatalkan"})[p]||p,_=()=>{window.print()};return(p,s)=>(V(),R(fe,{modelValue:z.value,"onUpdate:modelValue":s[0]||(s[0]=b=>z.value=b),"max-width":"900",persistent:""},{default:t(()=>[e($,null,{default:t(()=>[e(X,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",dt,[e(K,null,{default:t(()=>s[1]||(s[1]=[g("mdi-file-document-outline")])),_:1,__:[1]}),s[2]||(s[2]=a("span",null,"Purchase Order Detail",-1))]),e(S,{icon:"mdi-close",size:"small",variant:"text",onClick:T})]),_:1}),p.purchase?(V(),R(j,{key:0},{default:t(()=>[e(Y,{class:"mb-6"},{default:t(()=>[e(x,{cols:"12",md:"6"},{default:t(()=>[e($,{variant:"outlined"},{default:t(()=>[e(X,{class:"text-subtitle-1"},{default:t(()=>s[3]||(s[3]=[g("Purchase Information")])),_:1,__:[3]}),e(j,null,{default:t(()=>[a("div",ct,[s[4]||(s[4]=a("strong",null,"Purchase Number:",-1)),s[5]||(s[5]=a("br",null,null,-1)),a("span",pt,r(p.purchase.purchase_number),1)]),a("div",mt,[s[6]||(s[6]=a("strong",null,"Status:",-1)),s[7]||(s[7]=a("br",null,null,-1)),e(ee,{color:F(p.purchase.status),size:"small",variant:"elevated"},{default:t(()=>[g(r(U(p.purchase.status)),1)]),_:1},8,["color"])]),a("div",vt,[s[8]||(s[8]=a("strong",null,"Tanggal Purchase:",-1)),s[9]||(s[9]=a("br",null,null,-1)),g(" "+r(k(p.purchase.purchase_date)),1)]),p.purchase.expected_delivery_date?(V(),M("div",ft,[s[10]||(s[10]=a("strong",null,"Tanggal Kirim Diharapkan:",-1)),s[11]||(s[11]=a("br",null,null,-1)),g(" "+r(k(p.purchase.expected_delivery_date)),1)])):C("",!0),p.purchase.actual_delivery_date?(V(),M("div",_t,[s[12]||(s[12]=a("strong",null,"Tanggal Kirim Aktual:",-1)),s[13]||(s[13]=a("br",null,null,-1)),g(" "+r(k(p.purchase.actual_delivery_date)),1)])):C("",!0)]),_:1})]),_:1})]),_:1}),e(x,{cols:"12",md:"6"},{default:t(()=>[e($,{variant:"outlined"},{default:t(()=>[e(X,{class:"text-subtitle-1"},{default:t(()=>s[14]||(s[14]=[g("Supplier Information")])),_:1,__:[14]}),e(j,null,{default:t(()=>{var b,N,D,O;return[a("div",gt,[s[15]||(s[15]=a("strong",null,"Nama Supplier:",-1)),s[16]||(s[16]=a("br",null,null,-1)),g(" "+r(((b=p.purchase.supplier)==null?void 0:b.name)||"-"),1)]),a("div",yt,[s[17]||(s[17]=a("strong",null,"Telepon:",-1)),s[18]||(s[18]=a("br",null,null,-1)),g(" "+r(((N=p.purchase.supplier)==null?void 0:N.phone)||"-"),1)]),a("div",ht,[s[19]||(s[19]=a("strong",null,"Email:",-1)),s[20]||(s[20]=a("br",null,null,-1)),g(" "+r(((D=p.purchase.supplier)==null?void 0:D.email)||"-"),1)]),a("div",null,[s[21]||(s[21]=a("strong",null,"Alamat:",-1)),s[22]||(s[22]=a("br",null,null,-1)),g(" "+r(((O=p.purchase.supplier)==null?void 0:O.address)||"-"),1)])]}),_:1})]),_:1})]),_:1})]),_:1}),e($,{variant:"outlined",class:"mb-6"},{default:t(()=>[e(X,{class:"text-subtitle-1"},{default:t(()=>s[23]||(s[23]=[g("Items Purchase")])),_:1,__:[23]}),e(De,null,{default:t(()=>[s[24]||(s[24]=a("thead",null,[a("tr",null,[a("th",null,"Item"),a("th",{class:"text-center"},"Qty"),a("th",{class:"text-right"},"Unit Cost"),a("th",{class:"text-right"},"Total Cost"),a("th",{class:"text-center"},"Status")])],-1)),a("tbody",null,[(V(!0),M(Ie,null,ke(p.purchase.items,b=>{var N,D,O;return V(),M("tr",{key:b.id_purchase_item},[a("td",null,[a("div",null,[a("p",bt,r(((N=b.item)==null?void 0:N.name)||"-"),1),(D=b.item)!=null&&D.code?(V(),M("p",Vt," Code: "+r(b.item.code),1)):C("",!0),(O=b.item)!=null&&O.description?(V(),M("p",wt,r(b.item.description),1)):C("",!0)])]),a("td",kt,[e(ee,{size:"small",variant:"outlined"},{default:t(()=>[g(r(parseInt(b.quantity_ordered))+" "+r(b.unit||"pcs"),1)]),_:2},1024),b.quantity_received>0?(V(),M("br",xt)):C("",!0),b.quantity_received>0?(V(),R(ee,{key:1,size:"x-small",variant:"tonal",color:"success",class:"mt-1"},{default:t(()=>[g(" Received: "+r(parseInt(b.quantity_received)),1)]),_:2},1024)):C("",!0)]),a("td",It,r(I(b.unit_cost)),1),a("td",Dt,r(I(b.total_cost)),1),a("td",Ct,[e(ee,{color:F(b.status),size:"small",variant:"tonal"},{default:t(()=>[g(r(U(b.status)),1)]),_:2},1032,["color"])])])}),128))])]),_:1,__:[24]})]),_:1}),e(Y,null,{default:t(()=>[e(x,{cols:"12",md:"6"},{default:t(()=>[p.purchase.notes?(V(),R($,{key:0,variant:"outlined"},{default:t(()=>[e(X,{class:"text-subtitle-1"},{default:t(()=>s[25]||(s[25]=[g("Catatan")])),_:1,__:[25]}),e(j,null,{default:t(()=>[a("p",$t,r(p.purchase.notes),1)]),_:1})]),_:1})):C("",!0),e($,{variant:"outlined",class:"mt-4"},{default:t(()=>[e(X,{class:"text-subtitle-1"},{default:t(()=>s[26]||(s[26]=[g("Purchase History")])),_:1,__:[26]}),e(j,null,{default:t(()=>{var b,N;return[a("div",qt,[s[27]||(s[27]=a("strong",null,"Dibuat oleh:",-1)),s[28]||(s[28]=a("br",null,null,-1)),g(" "+r(((b=p.purchase.creator)==null?void 0:b.name)||"-")+" â€¢ "+r(A(p.purchase.created_at)),1)]),p.purchase.updated_at&&p.purchase.updated_at!==p.purchase.created_at?(V(),M("div",St,[s[29]||(s[29]=a("strong",null,"Diupdate oleh:",-1)),s[30]||(s[30]=a("br",null,null,-1)),g(" "+r(((N=p.purchase.updater)==null?void 0:N.name)||"-")+" â€¢ "+r(A(p.purchase.updated_at)),1)])):C("",!0)]}),_:1})]),_:1})]),_:1}),e(x,{cols:"12",md:"6"},{default:t(()=>[e($,{variant:"outlined"},{default:t(()=>[e(X,{class:"text-subtitle-1"},{default:t(()=>s[31]||(s[31]=[g("Total Summary")])),_:1,__:[31]}),e(j,null,{default:t(()=>[a("div",Pt,[s[32]||(s[32]=a("span",null,"Subtotal:",-1)),a("span",Tt,r(I(p.purchase.subtotal)),1)]),p.purchase.discount_amount>0?(V(),M("div",zt,[s[33]||(s[33]=a("span",null,"Diskon:",-1)),a("span",Ut,"-"+r(I(p.purchase.discount_amount)),1)])):C("",!0),e(me,{class:"my-3"}),a("div",jt,[s[34]||(s[34]=a("span",{class:"text-h6 font-weight-bold"},"Total:",-1)),a("span",At,r(I(p.purchase.total_amount)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):C("",!0),e(_e,{class:"pa-4"},{default:t(()=>[e(ge),e(S,{variant:"text",onClick:T},{default:t(()=>s[35]||(s[35]=[g(" Tutup ")])),_:1,__:[35]}),P.value?(V(),R(S,{key:0,color:"primary",variant:"tonal","prepend-icon":"mdi-printer",onClick:_},{default:t(()=>s[36]||(s[36]=[g(" Print ")])),_:1,__:[36]})):C("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Rt=ye(Nt,[["__scopeId","data-v-da47fee6"]]),Bt={class:"d-flex justify-space-between align-center"},Ft={class:"d-flex justify-space-between align-center"},Ot={class:"text-h4 font-weight-bold text-white"},Et={class:"d-flex justify-space-between align-center"},Mt={class:"text-h4 font-weight-bold text-white"},Lt={class:"d-flex justify-space-between align-center"},Qt={class:"text-h4 font-weight-bold text-white"},Ht={class:"d-flex justify-space-between align-center"},Kt={class:"text-h4 font-weight-bold text-white"},Gt={class:"d-flex align-center"},Xt={class:"mb-0 font-weight-medium"},Jt={class:"text-caption text-medium-emphasis mb-0"},Wt={class:"font-weight-medium"},Yt={class:"d-flex gap-1"},Zt={class:"d-flex justify-center pt-2"},ea=ve({__name:"purchases-management",setup(te){const J=w([]),f=w([]),B=w({}),z=w(!1),P=w(1),T=w(15),I=w(0),k=w({show:!1,message:"",color:"success"}),A=w(!1),F=w(!1),U=w(!1),_=w(null),p=w("create"),s=w({search:"",status:"",supplier_id:"",start_date:"",end_date:""}),b=[{title:"Purchase Number",key:"purchase_number",sortable:!0},{title:"Supplier",key:"supplier.name",sortable:!1},{title:"Tanggal",key:"purchase_date",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Total",key:"total_amount",sortable:!0},{title:"Actions",key:"actions",sortable:!1,width:"150px"}],N=[{label:"Semua Status",value:""},{label:"Pending",value:"pending"},{label:"Ordered",value:"ordered"},{label:"Received",value:"received"},{label:"Completed",value:"completed"},{label:"Cancelled",value:"cancelled"}],D=async()=>{var n,l;try{z.value=!0;const o={page:P.value,per_page:T.value};Object.keys(s.value).forEach(de=>{s.value[de]&&s.value[de]!==""&&(o[de]=s.value[de])});const v=H(),q={"Content-Type":"application/json",Accept:"application/json"};v&&(q.Authorization=`Bearer ${v}`);const ue=await Q.get("/api/purchases",{params:o,headers:q});J.value=ue.data.data.data||[],I.value=ue.data.data.total||0}catch(o){console.error("Error loading purchases:",o),k.value={show:!0,message:"Error loading purchases: "+(((l=(n=o.response)==null?void 0:n.data)==null?void 0:l.message)||o.message),color:"error"}}finally{z.value=!1}},O=async()=>{try{const n=H(),l={"Content-Type":"application/json",Accept:"application/json"};n&&(l.Authorization=`Bearer ${n}`);const o=await Q.get("/api/suppliers",{headers:l});f.value=o.data.data||[]}catch(n){console.error("Error loading suppliers:",n)}},E=async()=>{try{const n=H(),l={"Content-Type":"application/json",Accept:"application/json"};n&&(l.Authorization=`Bearer ${n}`);const o=await Q.get("/api/purchases/statistics",{headers:l});B.value=o.data.data||{}}catch(n){console.error("Error loading statistics:",n)}},ie=()=>{_.value=null,p.value="create",A.value=!0},re=n=>{console.log("ðŸ”§ editPurchase called with:",n),console.log("ðŸ‘¤ Purchase supplier ID:",n.id_supplier),console.log("ðŸ“¦ Purchase items:",n.items),_.value=n,p.value="edit",A.value=!0,console.log("ðŸ“‹ selectedPurchase set to:",_.value),console.log("ðŸŽ¯ dialogMode set to:",p.value)},ae=n=>{_.value=n,F.value=!0},le=n=>{_.value=n,U.value=!0},y=async n=>{var l,o;if(confirm(`Apakah Anda yakin ingin menghapus purchase ${n.purchase_number}?`))try{const v=H(),q={"Content-Type":"application/json",Accept:"application/json"};v&&(q.Authorization=`Bearer ${v}`),await Q.delete(`/api/purchases/${n.id_purchase}`,{headers:q}),D(),E()}catch(v){console.error("Error deleting purchase:",v),alert("Error deleting purchase: "+(((o=(l=v.response)==null?void 0:l.data)==null?void 0:o.message)||v.message))}},m=async(n,l)=>{var o,v;try{const q=H(),ue={"Content-Type":"application/json",Accept:"application/json"};q&&(ue.Authorization=`Bearer ${q}`),await Q.patch(`/api/purchases/${n.id_purchase}/status`,{status:l},{headers:ue}),D(),E(),k.value={show:!0,message:`Purchase status berhasil diubah ke ${l}!`,color:"success"}}catch(q){console.error("Error updating purchase status:",q),k.value={show:!0,message:"Error updating status: "+(((v=(o=q.response)==null?void 0:o.data)==null?void 0:v.message)||q.message),color:"error"}}},d=()=>{A.value=!1,D(),E(),k.value={show:!0,message:p.value==="create"?"Purchase order berhasil dibuat!":"Purchase order berhasil diperbarui!",color:"success"}},h=()=>{U.value=!1,D(),E(),k.value={show:!0,message:"Items berhasil diterima!",color:"success"}},L=n=>{const l=typeof n=="string"?parseFloat(n):n;return isNaN(l)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l)},se=n=>n?new Date(n).toLocaleDateString("id-ID"):"-",Z=n=>({pending:"warning",ordered:"info",received:"primary",completed:"success",cancelled:"error"})[n]||"default",u=n=>({pending:"Pending",ordered:"Dipesan",received:"Diterima",completed:"Selesai",cancelled:"Dibatalkan"})[n]||n,i=n=>["pending","ordered"].includes(n.status),c=n=>n.status==="pending";return ce(s,()=>{P.value=1,D()},{deep:!0}),we(()=>{D(),O(),E()}),(n,l)=>(V(),R(je,{fluid:""},{default:t(()=>[e(Y,{class:"mb-4"},{default:t(()=>[e(x,{cols:"12"},{default:t(()=>[a("div",Bt,[l[15]||(l[15]=a("div",null,[a("h1",{class:"text-h4 font-weight-bold"},"Purchase Management"),a("p",{class:"text-body-1 text-medium-emphasis"},"Kelola pembelian barang dari supplier")],-1)),e(S,{color:"primary",size:"large",onClick:ie},{default:t(()=>[e(K,{start:""},{default:t(()=>l[13]||(l[13]=[g("mdi-plus")])),_:1,__:[13]}),l[14]||(l[14]=g(" Buat Purchase Order "))]),_:1,__:[14]})])]),_:1})]),_:1}),e(Y,{class:"mb-6"},{default:t(()=>[e(x,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e($,{color:"primary"},{default:t(()=>[e(j,null,{default:t(()=>[a("div",Ft,[a("div",null,[l[16]||(l[16]=a("p",{class:"text-caption text-white mb-1"},"Total Purchase",-1)),a("p",Ot,r(B.value.total_purchases||0),1)]),e(K,{size:"40",class:"text-white"},{default:t(()=>l[17]||(l[17]=[g("mdi-cart")])),_:1,__:[17]})])]),_:1})]),_:1})]),_:1}),e(x,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e($,{color:"warning"},{default:t(()=>[e(j,null,{default:t(()=>[a("div",Et,[a("div",null,[l[18]||(l[18]=a("p",{class:"text-caption text-white mb-1"},"Pending",-1)),a("p",Mt,r(B.value.pending_purchases||0),1)]),e(K,{size:"40",class:"text-white"},{default:t(()=>l[19]||(l[19]=[g("mdi-clock")])),_:1,__:[19]})])]),_:1})]),_:1})]),_:1}),e(x,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e($,{color:"success"},{default:t(()=>[e(j,null,{default:t(()=>[a("div",Lt,[a("div",null,[l[20]||(l[20]=a("p",{class:"text-caption text-white mb-1"},"Completed",-1)),a("p",Qt,r(B.value.completed_purchases||0),1)]),e(K,{size:"40",class:"text-white"},{default:t(()=>l[21]||(l[21]=[g("mdi-check-circle")])),_:1,__:[21]})])]),_:1})]),_:1})]),_:1}),e(x,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e($,{color:"info"},{default:t(()=>[e(j,null,{default:t(()=>[a("div",Ht,[a("div",null,[l[22]||(l[22]=a("p",{class:"text-caption text-white mb-1"},"Bulan Ini",-1)),a("p",Kt,r(L(B.value.total_amount_this_month||0)),1)]),e(K,{size:"40",class:"text-white"},{default:t(()=>l[23]||(l[23]=[g("mdi-currency-usd")])),_:1,__:[23]})])]),_:1})]),_:1})]),_:1})]),_:1}),e($,{class:"mb-6"},{default:t(()=>[e(j,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(x,{cols:"12",md:"3"},{default:t(()=>[e(G,{modelValue:s.value.search,"onUpdate:modelValue":l[0]||(l[0]=o=>s.value.search=o),label:"Cari Purchase Number","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"","onClick:clear":l[1]||(l[1]=o=>s.value.search="")},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"2"},{default:t(()=>[e(pe,{modelValue:s.value.status,"onUpdate:modelValue":l[2]||(l[2]=o=>s.value.status=o),label:"Status",items:N,"item-title":"label","item-value":"value",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"2"},{default:t(()=>[e(pe,{modelValue:s.value.supplier_id,"onUpdate:modelValue":l[3]||(l[3]=o=>s.value.supplier_id=o),label:"Supplier",items:f.value,"item-title":"name","item-value":"id_supplier",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),e(x,{cols:"12",md:"2"},{default:t(()=>[e(G,{modelValue:s.value.start_date,"onUpdate:modelValue":l[4]||(l[4]=o=>s.value.start_date=o),label:"Tanggal Mulai",type:"date",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"2"},{default:t(()=>[e(G,{modelValue:s.value.end_date,"onUpdate:modelValue":l[5]||(l[5]=o=>s.value.end_date=o),label:"Tanggal Akhir",type:"date",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"1"},{default:t(()=>[e(S,{color:"primary",variant:"tonal",icon:"mdi-refresh",onClick:D})]),_:1})]),_:1})]),_:1})]),_:1}),e($,null,{default:t(()=>[e(Ae,{"items-per-page":T.value,"onUpdate:itemsPerPage":l[7]||(l[7]=o=>T.value=o),page:P.value,"onUpdate:page":l[8]||(l[8]=o=>P.value=o),headers:b,items:J.value,"items-length":I.value,loading:z.value,"item-value":"id_purchase","onUpdate:options":D},{"item.purchase_number":t(({item:o})=>[a("div",Gt,[e(S,{variant:"text",color:"primary",size:"small",onClick:v=>ae(o)},{default:t(()=>[g(r(o.purchase_number),1)]),_:2},1032,["onClick"])])]),"item.supplier.name":t(({item:o})=>{var v,q;return[a("div",null,[a("p",Xt,r(((v=o.supplier)==null?void 0:v.name)||"-"),1),a("p",Jt,r(((q=o.supplier)==null?void 0:q.phone)||"-"),1)])]}),"item.purchase_date":t(({item:o})=>[g(r(se(o.purchase_date)),1)]),"item.status":t(({item:o})=>[e(ee,{color:Z(o.status),size:"small",variant:"elevated"},{default:t(()=>[g(r(u(o.status)),1)]),_:2},1032,["color"])]),"item.total_amount":t(({item:o})=>[a("span",Wt,r(L(o.total_amount)),1)]),"item.actions":t(({item:o})=>[a("div",Yt,[e(S,{icon:"mdi-eye",size:"small",variant:"text",color:"info",onClick:v=>ae(o)},null,8,["onClick"]),i(o)?(V(),R(S,{key:0,icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:v=>re(o)},null,8,["onClick"])):C("",!0),["ordered","received"].includes(o.status)?(V(),R(S,{key:1,icon:"mdi-truck-delivery",size:"small",variant:"text",color:"success",onClick:v=>le(o)},null,8,["onClick"])):C("",!0),c(o)?(V(),R(S,{key:2,icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:v=>y(o)},null,8,["onClick"])):C("",!0),e(Ne,null,{activator:t(({props:v})=>[e(S,xe({icon:"mdi-dots-vertical",size:"small",variant:"text"},v),null,16)]),default:t(()=>[e(Se,null,{default:t(()=>[o.status==="pending"?(V(),R(oe,{key:0,onClick:v=>m(o,"ordered")},{default:t(()=>[e(ne,null,{default:t(()=>l[24]||(l[24]=[g("Mark as Ordered")])),_:1,__:[24]})]),_:2},1032,["onClick"])):C("",!0),o.status==="ordered"?(V(),R(oe,{key:1,onClick:v=>m(o,"received")},{default:t(()=>[e(ne,null,{default:t(()=>l[25]||(l[25]=[g("Mark as Received")])),_:1,__:[25]})]),_:2},1032,["onClick"])):C("",!0),o.status==="received"?(V(),R(oe,{key:2,onClick:v=>m(o,"completed")},{default:t(()=>[e(ne,null,{default:t(()=>l[26]||(l[26]=[g("Mark as Completed")])),_:1,__:[26]})]),_:2},1032,["onClick"])):C("",!0),["pending","ordered"].includes(o.status)?(V(),R(oe,{key:3,onClick:v=>m(o,"cancelled")},{default:t(()=>[e(ne,{class:"text-error"},{default:t(()=>l[27]||(l[27]=[g("Cancel Purchase")])),_:1,__:[27]})]),_:2},1032,["onClick"])):C("",!0)]),_:2},1024)]),_:2},1024)])]),bottom:t(()=>[a("div",Zt,[e(Ue,{modelValue:P.value,"onUpdate:modelValue":l[6]||(l[6]=o=>P.value=o),length:Math.ceil(I.value/T.value),"total-visible":5},null,8,["modelValue","length"])])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1}),e(Ze,{modelValue:A.value,"onUpdate:modelValue":l[9]||(l[9]=o=>A.value=o),purchase:_.value,mode:p.value,onSaved:d},null,8,["modelValue","purchase","mode"]),e(Rt,{modelValue:F.value,"onUpdate:modelValue":l[10]||(l[10]=o=>F.value=o),purchase:_.value},null,8,["modelValue","purchase"]),e(ut,{modelValue:U.value,"onUpdate:modelValue":l[11]||(l[11]=o=>U.value=o),purchase:_.value,onSuccess:h},null,8,["modelValue","purchase"]),e(Re,{modelValue:k.value.show,"onUpdate:modelValue":l[12]||(l[12]=o=>k.value.show=o),color:k.value.color,timeout:4e3,location:"top right"},{default:t(()=>[g(r(k.value.message),1)]),_:1},8,["modelValue","color"])]),_:1}))}}),Sa=ye(ea,[["__scopeId","data-v-964b720f"]]);export{Sa as default};
