import{d as _e,r as y,V as P,w as fe,D as he,c as h,e as o,b as e,f as a,a1 as ve,ax as ye,au as ge,av as O,o as v,X as c,H as xe,I as be,t as i,s as u,F as K,i as Q,G as W,_ as ke}from"./main-DoH7BNU0.js";import{C as F}from"./auto-Cz6uSJnr.js";import{V as Y}from"./VTextField-9Sc5KvAe.js";import{V as Ce}from"./VSelect-CFvVKkz4.js";import{V as T,a as m}from"./VRow-rYX4edDC.js";import{V as p,b as g}from"./VCard-DXDUncB3.js";import{V as _}from"./VCardText-yZra56bd.js";import{V as U}from"./VDataTable-GpqQrsR0.js";import{V as we}from"./VChip-r-xKq0AX.js";import{b as ee}from"./route-block-B_A1xBdJ.js";import"./VImg-CJPkcWWl.js";import"./forwardRefs-B931MWyl.js";import"./VList-DF0oT0kL.js";import"./VAvatar-GpMkftR2.js";import"./VDivider-B11OzaCF.js";import"./VOverlay-7fEsiQXu.js";import"./VMenu-DpRAsqgU.js";import"./VCheckboxBtn-RlaGNlgl.js";/* empty css              */import"./VTable-NMvqQ2hE.js";import"./filter-BqjlRo96.js";const De={class:"dashboard-page"},Fe={class:"d-flex flex-column flex-md-row justify-space-between align-start align-md-center mb-6 ga-4"},Te={class:"d-flex flex-column flex-sm-row gap-3 align-stretch align-sm-center w-100 w-md-auto"},Ae={class:"d-flex flex-column flex-sm-row gap-2 align-stretch"},Ve={key:0,class:"text-center py-8"},Pe={key:1},Ie={class:"flex-grow-1"},Se={class:"text-h4 text-success mt-2"},Ee={class:"text-caption text-medium-emphasis"},Be={class:"flex-grow-1"},He={class:"text-h4 text-info mt-2"},Re={class:"text-caption text-medium-emphasis"},ze={class:"text-caption text-medium-emphasis mt-1"},je={key:0},Le={class:"d-flex align-center"},Ne={class:"text-body-2"},Oe={class:"text-right"},Ue={class:"text-h6 font-weight-bold"},$e={class:"text-caption text-medium-emphasis"},Me={key:1,class:"text-center py-4"},qe={key:0},Je={class:"d-flex align-center"},Ze={class:"text-body-2"},Ge={class:"text-right"},Xe={class:"text-h6 font-weight-bold"},Ke={class:"text-caption text-medium-emphasis"},Qe={key:1,class:"text-center py-4"},We={class:"flex-grow-1"},Ye={class:"text-h4 text-secondary mt-2"},et={class:"text-caption text-medium-emphasis"},tt={style:{height:"300px"}},at={style:{height:"300px"}},st={style:{height:"300px"}},lt={style:{height:"300px"}},ot={style:{height:"300px"}},te=_e({__name:"dashboard",setup(rt){const C=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),A=y(!1),k=y("30"),x=y(""),b=y(""),f=y(null),I=y(null),S=y(null),E=y(null),B=y(null),H=y(null);let R=null,z=null,j=null,L=null,N=null;const $=[{label:"7 Hari Terakhir",value:"7"},{label:"30 Hari Terakhir",value:"30"},{label:"90 Hari Terakhir",value:"90"},{label:"1 Tahun Terakhir",value:"365"},{label:"Custom Range",value:"custom"}],ae=[{title:"Item",key:"item_name"},{title:"Stock Saat Ini",key:"current_stock"},{title:"Stock Minimum",key:"min_stock"}],se=[{title:"Produk",key:"product_name"},{title:"Terjual",key:"total_quantity"},{title:"Pendapatan",key:"total_revenue"}],le=[{title:"Supplier",key:"supplier_name"},{title:"Total Pembelian",key:"purchase_count"},{title:"Total Nilai",key:"total_amount"}],d=P(()=>{var s;return((s=f.value)==null?void 0:s.summary)||{}}),w=P(()=>{var s;return((s=f.value)==null?void 0:s.sales)||{}}),D=P(()=>{var s;return((s=f.value)==null?void 0:s.purchases)||{}}),M=P(()=>{var s;return((s=f.value)==null?void 0:s.inventory)||{}}),V=async()=>{A.value=!0;try{const s={};if(k.value==="custom")if(x.value&&b.value){const l=new Date(x.value),r=new Date(b.value);s.start_date=l.toISOString().split("T")[0],s.end_date=r.toISOString().split("T")[0]}else s.period="30";else s.period=k.value;const t=await ge.get("/api/dashboard/analytics",{params:s});t.data.success?(f.value=t.data.data,await O(),Z()):console.error("API returned error:",t.data)}catch(s){console.error("Error loading dashboard:",s)}finally{A.value=!1}},oe=s=>{s!=="custom"&&(x.value="",b.value=""),V()},q=()=>{x.value&&b.value&&(k.value="custom",V())},re=()=>{const s=new Date,t=new Date;t.setDate(s.getDate()-30),b.value=s.toISOString().split("T")[0],x.value=t.toISOString().split("T")[0]},J=()=>{var s;if(k.value==="custom"&&x.value&&b.value){const t=new Date(x.value).toLocaleDateString("id-ID"),l=new Date(b.value).toLocaleDateString("id-ID");return`(${t} - ${l})`}else return`(${((s=$.find(l=>l.value===k.value))==null?void 0:s.label)||"30 Hari Terakhir"})`},ne=s=>({qris:"#2196F3",cash:"#4CAF50",credit_card:"#9C27B0",debit_card:"#FF5722",bank_transfer:"#607D8B",e_wallet:"#FF9800",gopay:"#00D982",ovo:"#4C3DDB",dana:"#118EEA",shopeepay:"#EE4D2D"})[s]||"#9E9E9E",ie=s=>({dine_in:"#4CAF50",take_away:"#FF9800",delivery:"#2196F3",pickup:"#9C27B0"})[s]||"#9E9E9E",Z=()=>{f.value&&O(()=>{setTimeout(()=>{var s,t,l,r,n;I.value&&((s=f.value)!=null&&s.sales)&&de(),S.value&&((t=w.value)!=null&&t.top_products)&&ce(),E.value&&((l=f.value)!=null&&l.purchases)&&ue(),B.value&&((r=D.value)!=null&&r.top_purchased_items)&&me(),H.value&&((n=f.value)!=null&&n.inventory)&&pe()},200)})},de=()=>{var l,r;R&&R.destroy();const s=(l=I.value)==null?void 0:l.getContext("2d");if(!s||!((r=w.value)!=null&&r.daily_trend)||!Array.isArray(w.value.daily_trend))return;const t=w.value.daily_trend;try{R=new F(s,{type:"line",data:{labels:t.map(n=>new Date(n.date).toLocaleDateString("id-ID")),datasets:[{label:"Penjualan Harian",data:t.map(n=>n.total_revenue),borderColor:"#D4A574",backgroundColor:"rgba(212, 165, 116, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(n){return C(Number(n))}}}}}})}catch(n){console.error("Error creating sales chart:",n)}},ce=()=>{var l,r;z&&z.destroy();const s=(l=S.value)==null?void 0:l.getContext("2d");if(!s)return;const t=(r=w.value)==null?void 0:r.top_products;if(!(!t||!Array.isArray(t)))try{z=new F(s,{type:"pie",data:{labels:t.map(n=>n.product_name||"Unknown"),datasets:[{data:t.map(n=>n.total_quantity||0),backgroundColor:["#D4A574","#E6B887","#F2D099","#B8956A","#9A7F5A","#C69C6C","#E4C29F","#A08660","#BD9B73","#F0D8B5"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})}catch(n){console.error("Error creating sales pie chart:",n)}},ue=()=>{var l;j&&j.destroy();const s=(l=E.value)==null?void 0:l.getContext("2d");if(!s||!D.value.daily_trend)return;const t=D.value.daily_trend;j=new F(s,{type:"line",data:{labels:t.map(r=>new Date(r.date).toLocaleDateString("id-ID")),datasets:[{label:"Pembelian Harian",data:t.map(r=>r.total_amount),borderColor:"#2196F3",backgroundColor:"rgba(33, 150, 243, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{callback:function(r){return C(Number(r))}}}}}})},me=()=>{var l,r;L&&L.destroy();const s=(l=B.value)==null?void 0:l.getContext("2d");if(!s)return;const t=(r=D.value)==null?void 0:r.top_purchased_items;!t||!Array.isArray(t)||(L=new F(s,{type:"doughnut",data:{labels:t.map(n=>n.item_name||"Unknown"),datasets:[{data:t.map(n=>n.total_quantity||0),backgroundColor:["#4CAF50","#FF9800","#F44336","#9C27B0","#607D8B","#2196F3","#FF5722","#795548","#E91E63","#3F51B5"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}}))},pe=()=>{var l,r;N&&N.destroy();const s=(l=H.value)==null?void 0:l.getContext("2d");if(!s)return;const t=(r=M.value)==null?void 0:r.by_category;!t||!Array.isArray(t)||(N=new F(s,{type:"doughnut",data:{labels:t.map(n=>n.item_name||"Unknown"),datasets:[{data:t.map(n=>n.total_stock||0),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9F40","#E6B887","#D4A574","#F2D099","#B8956A"]}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}}))};return fe(f,()=>{f.value&&O(()=>{Z()})}),he(()=>{re(),V()}),(s,t)=>(v(),h("div",De,[o("div",Fe,[t[4]||(t[4]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold coffee-title"},"Dashboard Analytics"),o("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"}," Pantau penjualan, pembelian, dan inventory coffee shop Anda ")],-1)),o("div",Te,[o("div",Ae,[e(Y,{modelValue:x.value,"onUpdate:modelValue":t[0]||(t[0]=l=>x.value=l),type:"date",label:"Tanggal Mulai",density:"comfortable",variant:"outlined","hide-details":"",class:"flex-grow-1",onChange:q},null,8,["modelValue"]),e(Y,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=l=>b.value=l),type:"date",label:"Tanggal Akhir",density:"comfortable",variant:"outlined","hide-details":"",class:"flex-grow-1",onChange:q},null,8,["modelValue"])]),e(Ce,{modelValue:k.value,"onUpdate:modelValue":[t[2]||(t[2]=l=>k.value=l),oe],items:$,"item-title":"label","item-value":"value",density:"comfortable",variant:"outlined","hide-details":"",class:"flex-shrink-0",style:{"min-width":"180px"}},{"prepend-inner":a(()=>[e(c,{icon:"mdi-calendar-range"})]),_:1},8,["modelValue"]),e(ve,{color:"primary","prepend-icon":"mdi-refresh",onClick:V,loading:A.value,class:"flex-shrink-0"},{default:a(()=>[t[3]||(t[3]=o("span",{class:"d-none d-sm-inline"},"Refresh",-1)),xe(e(c,{icon:"mdi-refresh"},null,512),[[be,s.$vuetify.display.xs]])]),_:1,__:[3]},8,["loading"])])]),A.value?(v(),h("div",Ve,[e(ye,{indeterminate:"",color:"primary",size:"64"}),t[5]||(t[5]=o("p",{class:"text-body-1 mt-4"},"Memuat data dashboard...",-1))])):(v(),h("div",Pe,[e(T,{class:"mb-6"},{default:a(()=>[e(m,{cols:"12",md:"3"},{default:a(()=>[e(p,{class:"summary-card h-100"},{default:a(()=>[e(_,{class:"d-flex align-center"},{default:a(()=>{var l,r,n;return[o("div",Ie,[t[6]||(t[6]=o("div",{class:"text-h6 font-weight-bold"},"Total Pendapatan",-1)),o("div",Se,i(C(((l=d.value.period_summary)==null?void 0:l.total_revenue)||0)),1),o("div",Ee,i((((r=d.value.period_summary)==null?void 0:r.growth)??0)>=0?"+":"")+i(((n=d.value.period_summary)==null?void 0:n.growth)??0)+"% dari periode sebelumnya ",1)]),e(c,{icon:"mdi-currency-usd",size:"48",class:"text-success"})]}),_:1})]),_:1})]),_:1}),e(m,{cols:"12",md:"3"},{default:a(()=>[e(p,{class:"summary-card h-100"},{default:a(()=>[e(_,{class:"d-flex align-center"},{default:a(()=>{var l,r,n,G,X;return[o("div",Be,[t[7]||(t[7]=o("div",{class:"text-h6 font-weight-bold"},"Penjualan Hari Ini",-1)),o("div",He,i(C(((l=d.value.today_sales)==null?void 0:l.value)||0)),1),o("div",Re,i((((r=d.value.today_sales)==null?void 0:r.growth)??0)>=0?"+":"")+i(((n=d.value.today_sales)==null?void 0:n.growth)??0)+"% dari kemarin ",1),o("div",ze,i((((G=d.value.today_sales)==null?void 0:G.weekly_growth)??0)>=0?"+":"")+i(((X=d.value.today_sales)==null?void 0:X.weekly_growth)??0)+"% dari minggu lalu ",1)]),e(c,{icon:"mdi-cash-multiple",size:"48",class:"text-info"})]}),_:1})]),_:1})]),_:1}),e(m,{cols:"12",md:"3"},{default:a(()=>[e(p,{class:"summary-card h-100"},{default:a(()=>[e(g,{class:"d-flex align-center"},{default:a(()=>[e(c,{icon:"mdi-credit-card",class:"me-2"}),t[8]||(t[8]=u(" Jumlah Pembayaran Hari Ini "))]),_:1,__:[8]}),e(_,null,{default:a(()=>{var l;return[(l=d.value.payment_methods_today)!=null&&l.data&&d.value.payment_methods_today.data.length>0?(v(),h("div",je,[(v(!0),h(K,null,Q(d.value.payment_methods_today.data,r=>(v(),h("div",{key:r.payment_method,class:"d-flex justify-space-between align-center py-1"},[o("div",Le,[o("div",{class:"payment-method-color me-2",style:W(`background-color: ${ne(r.payment_method)}; width: 12px; height: 12px; border-radius: 50%;`)},null,4),o("span",Ne,i(r.payment_method_formatted),1)]),o("div",Oe,[o("div",Ue,i(r.total_amount_formatted),1),o("div",$e,i(r.percentage)+"%",1)])]))),128))])):(v(),h("div",Me,[e(c,{icon:"mdi-cash-off",size:"48",class:"text-grey-400 mb-2"}),t[9]||(t[9]=o("div",{class:"text-body-2 text-medium-emphasis"},"Tidak ada pembayaran hari ini",-1)),t[10]||(t[10]=o("div",{class:"text-h6 font-weight-bold mt-1"},"Rp 0",-1))]))]}),_:1})]),_:1})]),_:1}),e(m,{cols:"12",md:"3"},{default:a(()=>[e(p,{class:"summary-card h-100"},{default:a(()=>[e(g,{class:"d-flex align-center"},{default:a(()=>[e(c,{icon:"mdi-food",class:"me-2"}),t[11]||(t[11]=u(" Jenis Pesanan Hari Ini "))]),_:1,__:[11]}),e(_,null,{default:a(()=>{var l;return[(l=d.value.order_types_today)!=null&&l.data&&d.value.order_types_today.data.length>0?(v(),h("div",qe,[(v(!0),h(K,null,Q(d.value.order_types_today.data,r=>(v(),h("div",{key:r.order_type,class:"d-flex justify-space-between align-center py-1"},[o("div",Je,[o("div",{class:"order-type-color me-2",style:W(`background-color: ${ie(r.order_type)}; width: 12px; height: 12px; border-radius: 50%;`)},null,4),o("span",Ze,i(r.order_type_formatted),1)]),o("div",Ge,[o("div",Xe,i(r.total_amount_formatted),1),o("div",Ke,i(r.percentage)+"%",1)])]))),128))])):(v(),h("div",Qe,[e(c,{icon:"mdi-food-off",size:"48",class:"text-grey-400 mb-2"}),t[12]||(t[12]=o("div",{class:"text-body-2 text-medium-emphasis"},"Tidak ada pesanan hari ini",-1)),t[13]||(t[13]=o("div",{class:"text-h6 font-weight-bold mt-1"},"Rp 0",-1))]))]}),_:1})]),_:1})]),_:1}),e(m,{cols:"12",md:"3"},{default:a(()=>[e(p,{class:"summary-card h-100"},{default:a(()=>[e(_,{class:"d-flex align-center"},{default:a(()=>{var l,r,n;return[o("div",We,[t[14]||(t[14]=o("div",{class:"text-h6 font-weight-bold"},"Total Order Hari Ini",-1)),o("div",Ye,i(((l=d.value.today_orders)==null?void 0:l.value)||0),1),o("div",et,i((((r=d.value.today_orders)==null?void 0:r.growth)??0)>=0?"+":"")+i(((n=d.value.today_orders)==null?void 0:n.growth)??0)+"% dari kemarin ",1)]),e(c,{icon:"mdi-receipt-text",size:"48",class:"text-secondary"})]}),_:1})]),_:1})]),_:1})]),_:1}),e(T,{class:"mb-6"},{default:a(()=>[e(m,{cols:"12",lg:"8"},{default:a(()=>[e(p,{class:"chart-card"},{default:a(()=>[e(g,{class:"d-flex align-center"},{default:a(()=>[e(c,{icon:"mdi-chart-line",class:"me-2"}),u(" Tren Penjualan "+i(J()),1)]),_:1}),e(_,null,{default:a(()=>[o("div",tt,[o("canvas",{ref_key:"salesChart",ref:I},null,512)])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12",lg:"4"},{default:a(()=>[e(p,{class:"chart-card"},{default:a(()=>[e(g,{class:"d-flex align-center"},{default:a(()=>[e(c,{icon:"mdi-chart-pie",class:"me-2"}),t[15]||(t[15]=u(" Produk Terlaris "))]),_:1,__:[15]}),e(_,null,{default:a(()=>[o("div",at,[o("canvas",{ref_key:"salesPieChart",ref:S},null,512)])]),_:1})]),_:1})]),_:1})]),_:1}),e(T,{class:"mb-6"},{default:a(()=>[e(m,{cols:"12",lg:"8"},{default:a(()=>[e(p,{class:"chart-card"},{default:a(()=>[e(g,{class:"d-flex align-center"},{default:a(()=>[e(c,{icon:"mdi-cart",class:"me-2"}),u(" Tren Pembelian "+i(J()),1)]),_:1}),e(_,null,{default:a(()=>[o("div",st,[o("canvas",{ref_key:"purchaseChart",ref:E},null,512)])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12",lg:"4"},{default:a(()=>[e(p,{class:"chart-card"},{default:a(()=>[e(g,{class:"d-flex align-center"},{default:a(()=>[e(c,{icon:"mdi-chart-donut",class:"me-2"}),t[16]||(t[16]=u(" Produk Terbanyak Dibeli "))]),_:1,__:[16]}),e(_,null,{default:a(()=>[o("div",lt,[o("canvas",{ref_key:"purchasePieChart",ref:B},null,512)])]),_:1})]),_:1})]),_:1})]),_:1}),e(T,{class:"mb-6"},{default:a(()=>[e(m,{cols:"12",lg:"6"},{default:a(()=>[e(p,{class:"chart-card"},{default:a(()=>[e(g,{class:"d-flex align-center"},{default:a(()=>[e(c,{icon:"mdi-chart-donut-variant",class:"me-2"}),t[17]||(t[17]=u(" Top Items by Stock "))]),_:1,__:[17]}),e(_,null,{default:a(()=>[o("div",ot,[o("canvas",{ref_key:"inventoryChart",ref:H},null,512)])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12",lg:"6"},{default:a(()=>[e(p,{class:"chart-card"},{default:a(()=>[e(g,{class:"d-flex align-center"},{default:a(()=>[e(c,{icon:"mdi-alert-triangle",class:"me-2"}),t[18]||(t[18]=u(" Item Stok Rendah "))]),_:1,__:[18]}),e(_,null,{default:a(()=>[e(U,{headers:ae,items:M.value.low_stock||[],"hide-default-footer":"",density:"compact"},{"item.current_stock":a(({item:l})=>[e(we,{color:l.current_stock<=0?"error":"warning",size:"small"},{default:a(()=>[u(i(l.current_stock),1)]),_:2},1032,["color"])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})]),_:1}),e(T,null,{default:a(()=>[e(m,{cols:"12",lg:"6"},{default:a(()=>[e(p,{class:"chart-card"},{default:a(()=>[e(g,{class:"d-flex align-center"},{default:a(()=>[e(c,{icon:"mdi-star",class:"me-2"}),t[19]||(t[19]=u(" Produk Terlaris "))]),_:1,__:[19]}),e(_,null,{default:a(()=>[e(U,{headers:se,items:w.value.top_products||[],"hide-default-footer":"",density:"compact"},{"item.total_revenue":a(({item:l})=>[u(i(C(l.total_revenue)),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12",lg:"6"},{default:a(()=>[e(p,{class:"chart-card"},{default:a(()=>[e(g,{class:"d-flex align-center"},{default:a(()=>[e(c,{icon:"mdi-truck",class:"me-2"}),t[20]||(t[20]=u(" Supplier Teratas "))]),_:1,__:[20]}),e(_,null,{default:a(()=>[e(U,{headers:le,items:D.value.top_suppliers||[],"hide-default-footer":"",density:"compact"},{"item.total_amount":a(({item:l})=>[u(i(C(l.total_amount)),1)]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})]),_:1})]))]))}});typeof ee=="function"&&ee(te);const At=ke(te,[["__scopeId","data-v-b908ef06"]]);export{At as default};
