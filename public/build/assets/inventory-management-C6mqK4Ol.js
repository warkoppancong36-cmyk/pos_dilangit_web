import{ay as ae,d as Qe,r as v,V as B,w as Ye,g as M,f as s,b as e,s as p,X as U,t as c,l as V,c as N,e as r,aw as Ze,a0 as w,o as k,ax as We,aW as tt,D as at,m as a,a5 as he,F as st,i as ot,p as De,$ as Ie}from"./main-Ck3oUqWb.js";import{V as xe}from"./VDialog-BaCx5EhR.js";import{b as ce,c as je,V as E}from"./VCard-2F4cS_aM.js";import{V as Q}from"./VDivider-DxFhN4lP.js";import{V as F}from"./VCardText-BKByNquo.js";import{V as oe}from"./VAlert-DpBE1a89.js";import{V as lt}from"./VDataTable-D8X6sT4a.js";import{V as Y}from"./VChip-BFHVzcUj.js";import{V as we}from"./VSpacer-D9SzGbRv.js";import{_ as et}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as rt}from"./ItemsApi-CjzKzSer.js";import{V as se,a as I}from"./VRow-1DBZ728D.js";import{V as W}from"./VTextField-Cj1TfF2L.js";import{V as Xe}from"./VSelect-BV4WhzpI.js";import{V as nt}from"./VDataTableServer-Dj6hjWxi.js";import{V as Ue}from"./VTooltip-BYJR4ncq.js";import{V as Te}from"./VForm-BN6t1PjR.js";import{V as Fe}from"./VTextarea-Dx8K1_qG.js";import{V as it}from"./VAvatar-Csa6cPAe.js";import"./VOverlay-DZc1y4zN.js";import"./forwardRefs-B931MWyl.js";import"./VImg-DtUkqdhO.js";import"./VCheckboxBtn-CrZoWsPS.js";import"./VTable-gnjPFkML.js";import"./filter-BvukkJZ3.js";/* empty css              */import"./VList-Z_uKjW5U.js";import"./VMenu-BboVVtPU.js";const X="/api/inventory";class K{static async getAll(i){var u;try{return(await ae.get(X,{params:i})).data}catch(d){throw((u=d.response)==null?void 0:u.data)||this.handleError(d)}}static async getById(i){var u;try{return(await ae.get(`${X}/${i}`)).data}catch(d){throw((u=d.response)==null?void 0:u.data)||this.handleError(d)}}static async getStats(){var i;try{return(await ae.get(`${X}/stats`)).data}catch(u){throw((i=u.response)==null?void 0:i.data)||this.handleError(u)}}static async getLowStockAlerts(){var i;try{return(await ae.get(`${X}/low-stock-alerts`)).data}catch(u){throw((i=u.response)==null?void 0:i.data)||this.handleError(u)}}static async updateStock(i,u){var d;try{return(await ae.post(`${X}/${i}/update-stock`,u)).data}catch(y){throw((d=y.response)==null?void 0:d.data)||this.handleError(y)}}static async bulkUpdateStock(i){var u;try{return(await ae.post(`${X}/bulk-update-stock`,i)).data}catch(d){throw((u=d.response)==null?void 0:u.data)||this.handleError(d)}}static async setReorderLevel(i,u){var d;try{return(await ae.post(`${X}/${i}/reorder-level`,u)).data}catch(y){throw((d=y.response)==null?void 0:d.data)||this.handleError(y)}}static async getMovements(i){var u;try{const d=i!=null&&i.id_inventory?`${X}/${i.id_inventory}/movements`:`${X}/movements`;return(await ae.get(d,{params:i})).data}catch(d){throw((u=d.response)==null?void 0:u.data)||this.handleError(d)}}static async recordMovement(i){var u;try{return(await ae.post(`${X}/movement`,i)).data}catch(d){throw((u=d.response)==null?void 0:u.data)||this.handleError(d)}}static handleError(i){var u,d;return i.response?{message:((u=i.response.data)==null?void 0:u.message)||"Terjadi kesalahan pada server",success:!1,errors:(d=i.response.data)==null?void 0:d.errors}:i.request?{message:"Tidak dapat terhubung ke server",success:!1}:{message:i.message||"Terjadi kesalahan yang tidak diketahui",success:!1}}static formatError(i){return i.errors?Object.values(i.errors).flat().join(", "):i.message||"Terjadi kesalahan yang tidak diketahui"}static isValidationError(i){return i.errors&&typeof i.errors=="object"}static getFieldError(i,u){return i.errors&&i.errors[u]?Array.isArray(i.errors[u])?i.errors[u][0]:i.errors[u]:null}static getMovementTypes(){return[{value:"stock_in",label:"Stock Masuk",color:"success"},{value:"stock_out",label:"Stock Keluar",color:"warning"},{value:"adjustment",label:"Penyesuaian",color:"info"},{value:"transfer",label:"Transfer",color:"primary"},{value:"return",label:"Retur",color:"success"},{value:"damaged",label:"Rusak",color:"error"},{value:"expired",label:"Kadaluarsa",color:"error"}]}static getStockStatusOptions(){return[{value:"all",label:"Semua Status"},{value:"in_stock",label:"Tersedia"},{value:"low_stock",label:"Stok Menipis"},{value:"out_of_stock",label:"Habis"},{value:"overstock",label:"Stok Berlebih"}]}}const ut={key:1,class:"text-center py-8"},ct={class:"font-weight-medium"},dt={class:"text-medium-emphasis"},mt={class:"text-center"},pt={class:"text-center font-weight-medium"},vt={class:"text-center font-weight-bold text-primary"},_t={class:"text-end"},ft={class:"text-end font-weight-medium text-success"},kt={class:"max-width-200"},gt={class:"font-weight-medium"},yt={key:0,class:"text-medium-emphasis"},bt={key:1,class:"d-block text-caption"},ht={key:2,class:"text-info d-block"},xt={class:"text-center py-8"},wt=Qe({__name:"InventoryMovementsDialog",props:{modelValue:{type:Boolean},inventoryId:{},inventoryName:{}},emits:["update:modelValue"],setup(O,{emit:i}){const u=O,d=i,y=v([]),R=v(!1),$=v(""),C=B({get:()=>u.modelValue,set:f=>d("update:modelValue",f)}),z=async()=>{var f,_,n,x;if(u.inventoryId)try{R.value=!0,$.value="";const b=await K.getMovements({id_inventory:parseInt(u.inventoryId),page:1,per_page:50});b.data&&Array.isArray(b.data)?y.value=b.data:b.data&&((f=b==null?void 0:b.data)!=null&&f.data)&&Array.isArray((_=b==null?void 0:b.data)==null?void 0:_.data)?y.value=b.data.data:y.value=[]}catch(b){console.error("Error fetching movements:",b),$.value=((x=(n=b.response)==null?void 0:n.data)==null?void 0:x.message)||"Gagal memuat riwayat pergerakan"}finally{R.value=!1}},H=f=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(f),L=f=>({in:"success",out:"error",stock_in:"success",stock_out:"error",adjustment:"warning",transfer:"info",return:"secondary"})[f]||"primary",A=f=>({in:"Stock Masuk",out:"Stock Keluar",stock_in:"Stock Masuk",stock_out:"Stock Keluar",adjustment:"Penyesuaian",transfer:"Transfer",return:"Retur"})[f]||f,S=f=>({in:"tabler-plus",out:"tabler-minus",stock_in:"tabler-plus",stock_out:"tabler-minus",adjustment:"tabler-edit",transfer:"tabler-arrows-exchange",return:"tabler-arrow-back"})[f]||"tabler-package";return Ye(C,f=>{f&&u.inventoryId?z():(y.value=[],$.value="")}),(f,_)=>(k(),M(xe,{modelValue:C.value,"onUpdate:modelValue":_[1]||(_[1]=n=>C.value=n),"max-width":"900px",scrollable:""},{default:s(()=>[e(E,null,{default:s(()=>[e(ce,{class:"d-flex align-center"},{default:s(()=>[e(U,{icon:"tabler-history",class:"me-2"}),p(" Riwayat Pergerakan - "+c(f.inventoryName),1)]),_:1}),e(Q),e(F,{class:"pa-0"},{default:s(()=>[$.value?(k(),M(oe,{key:0,type:"error",variant:"tonal",class:"ma-4"},{default:s(()=>[p(c($.value),1)]),_:1})):V("",!0),R.value?(k(),N("div",ut,[e(Ze,{indeterminate:"",color:"primary",size:"40"}),_[2]||(_[2]=r("div",{class:"mt-4 text-medium-emphasis"}," Memuat riwayat pergerakan... ",-1))])):(k(),M(lt,{key:2,headers:[{title:"Tanggal",key:"created_at",sortable:!1},{title:"Jenis",key:"movement_type",sortable:!1},{title:"Kuantitas",key:"quantity",sortable:!1},{title:"Stok Sebelum",key:"stock_before",sortable:!1},{title:"Stok Sesudah",key:"stock_after",sortable:!1},{title:"Harga/Unit",key:"unit_cost",sortable:!1},{title:"Total Nilai",key:"total_cost",sortable:!1},{title:"Catatan",key:"notes",sortable:!1}],items:y.value,loading:R.value,class:"text-no-wrap","items-per-page":"15",height:"500","fixed-header":""},{"item.created_at":s(({item:n})=>[r("div",null,[r("div",ct,c(new Date(n.created_at).toLocaleDateString("id-ID")),1),r("small",dt,c(new Date(n.created_at).toLocaleTimeString("id-ID")),1)])]),"item.movement_type":s(({item:n})=>[e(Y,{color:L(n.movement_type),variant:"tonal",size:"small","prepend-icon":S(n.movement_type)},{default:s(()=>[p(c(A(n.movement_type)),1)]),_:2},1032,["color","prepend-icon"])]),"item.quantity":s(({item:n})=>[r("div",mt,[e(Y,{color:n.movement_type==="in"||n.movement_type==="stock_in"?"success":"error",variant:"outlined",size:"small"},{default:s(()=>[p(c(n.movement_type==="in"||n.movement_type==="stock_in"?"+":"-")+c(Math.abs(n.quantity)),1)]),_:2},1032,["color"])])]),"item.stock_before":s(({item:n})=>[r("div",pt,c(n.stock_before),1)]),"item.stock_after":s(({item:n})=>[r("div",vt,c(n.stock_after),1)]),"item.unit_cost":s(({item:n})=>[r("div",_t,c(n.unit_cost?H(n.unit_cost):"-"),1)]),"item.total_cost":s(({item:n})=>[r("div",ft,c(n.total_cost?H(n.total_cost):"-"),1)]),"item.notes":s(({item:n})=>[r("div",kt,[r("div",gt,c(n.notes||"-"),1),n.reference_type&&n.reference_id?(k(),N("small",yt," Ref: "+c(n.reference_type)+"-"+c(n.reference_id),1)):V("",!0),n.batch_number?(k(),N("small",bt," Batch: "+c(n.batch_number),1)):V("",!0),n.user?(k(),N("small",ht," oleh: "+c(n.user.name),1)):V("",!0)])]),"no-data":s(()=>[r("div",xt,[e(U,{icon:"tabler-history-off",size:"48",class:"text-medium-emphasis mb-4"}),_[3]||(_[3]=r("div",{class:"text-h6 text-medium-emphasis mb-2"}," Belum ada riwayat pergerakan ",-1)),_[4]||(_[4]=r("div",{class:"text-body-2 text-medium-emphasis"}," Riwayat akan muncul setelah ada pergerakan stok ",-1))])]),_:1},8,["items","loading"]))]),_:1}),e(Q),e(je,{class:"pa-4"},{default:s(()=>[e(we),e(w,{variant:"outlined",onClick:_[0]||(_[0]=n=>C.value=!1)},{default:s(()=>_[5]||(_[5]=[p(" Tutup ")])),_:1,__:[5]}),e(w,{color:"primary","prepend-icon":"tabler-refresh",onClick:z},{default:s(()=>_[6]||(_[6]=[p(" Refresh ")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),St=et(wt,[["__scopeId","data-v-ca0277a4"]]),Vt=()=>{const O=v([]),i=v(!1),u=v(!1),d=v({total_items:0,low_stock_items:0,out_of_stock_items:0,overstock_items:0,total_stock_value:0,total_stock_quantity:0,total_reserved_stock:0,items_need_restock:0}),y=v([]),R=v(!1),$=v([]),C=v(!1),z=v(!1),H=v(!1),L=v(!1),A=v(!1),S=v(null),f=v([]),_=v(1),n=v(0),x=v(15),b=v({search:"",stock_status:"all",category_id:void 0,supplier_id:void 0,sort_by:"current_stock",sort_order:"asc"}),G=v(""),P=v(""),T=v(""),re=v({movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:void 0,notes:""}),ne=v({reorder_level:0,max_stock_level:0}),Z=B(()=>f.value.length>0),de=B(()=>d.value.total_stock_value),ee=B(()=>d.value.low_stock_items),le=B(()=>d.value.out_of_stock_items),J=B(()=>Math.ceil(n.value/x.value)),me=B(()=>_.value<J.value),pe=B(()=>_.value>1),ve=B(()=>({currentPage:_.value,totalPages:J.value,totalItems:n.value,itemsPerPage:x.value,hasNext:me.value,hasPrev:pe.value})),Se=[o=>o>0||"Kuantitas harus lebih dari 0",o=>Number.isInteger(o)||"Kuantitas harus berupa bilangan bulat"],Ve=[o=>!!o||"Alasan wajib diisi",o=>o&&o.length>=3||"Alasan minimal 3 karakter"],Me=[o=>!o||o>=0||"Harga harus lebih dari atau sama dengan 0"],m=[{title:"Stock Masuk",value:"stock_in",color:"success"},{title:"Stock Keluar",value:"stock_out",color:"warning"},{title:"Penyesuaian",value:"adjustment",color:"info"},{title:"Transfer",value:"transfer",color:"primary"},{title:"Retur",value:"return",color:"success"}],j=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Menipis",value:"low_stock"},{title:"Habis",value:"out_of_stock"},{title:"Stok Berlebih",value:"overstock"}],h=async()=>{i.value=!0,G.value="";try{const o={...b.value,page:_.value,per_page:x.value};Object.keys(o).forEach(be=>{const ue=o[be];(ue===""||ue===void 0||ue===null||ue==="all")&&delete o[be]}),console.log("Fetching inventory with params:",o);const t=await K.getAll(o);if(console.log("ðŸ” Full Inventory API Response:",t),console.log("ðŸ“„ Response Data Structure:",t.data),t.success)O.value=t.data.data||[],n.value=t.data.total||0,t.data.current_page&&(_.value=t.data.current_page),console.log("Inventory data loaded:",{total:t.data.total,current_page:t.data.current_page,per_page:t.data.per_page,last_page:t.data.last_page,itemsLength:O.value.length}),console.log("ðŸ“Š Final Inventory State Values:",{inventoryListLength:O.value.length,totalItemsValue:n.value,currentPageValue:_.value,itemsPerPageValue:x.value});else throw new Error(t.message||"Gagal mengambil data inventory")}catch(o){console.error("Error fetching inventory:",o),G.value=K.formatError(o)||"Gagal mengambil data inventory",O.value=[],n.value=0}finally{i.value=!1}},Ce=async()=>{try{const o=await K.getStats();o.success&&(d.value=o.data)}catch(o){console.error("Error fetching inventory stats:",o)}},ie=async()=>{C.value=!0;try{const o=await K.getLowStockAlerts();o.success&&($.value=o.data.data||[])}catch(o){console.error("Error fetching low stock alerts:",o),$.value=[]}finally{C.value=!1}},_e=async o=>{R.value=!0;try{const t=await K.getMovements({id_inventory:o,page:1,per_page:20});t.success&&(y.value=t.data)}catch(t){console.error("Error fetching movements:",t)}finally{R.value=!1}},$e=async()=>{if(S.value){u.value=!0,T.value="";try{const o=await K.updateStock(S.value.id_inventory,re.value);if(o.success)P.value="Stock berhasil diperbarui",fe(),await h(),await Ce(),await ie();else throw new Error(o.message||"Gagal memperbarui stock")}catch(o){console.error("Error updating stock:",o),T.value=K.formatError(o)||"Gagal memperbarui stock"}finally{u.value=!1}}},Ee=async()=>{if(S.value){u.value=!0,T.value="";try{const o=await K.setReorderLevel(S.value.id_inventory,ne.value);if(o.success)P.value="Reorder level berhasil diperbarui",q(),await h();else throw new Error(o.message||"Gagal memperbarui reorder level")}catch(o){console.error("Error setting reorder level:",o),T.value=K.formatError(o)||"Gagal memperbarui reorder level"}finally{u.value=!1}}},ke=o=>{S.value=o,re.value={movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:o.average_cost||void 0,notes:""},T.value="",z.value=!0},Re=o=>{S.value=o,ne.value={reorder_level:o.reorder_level||0,max_stock_level:o.max_stock_level||0},T.value="",A.value=!0},ge=o=>{S.value=o,_e(o.id_inventory),L.value=!0},fe=()=>{z.value=!1,setTimeout(()=>{S.value=null,T.value=""},300)},q=()=>{A.value=!1,setTimeout(()=>{S.value=null,T.value=""},300)};return{inventoryList:O,loading:i,saveLoading:u,stats:d,movementsList:y,movementsLoading:R,lowStockItems:$,alertsLoading:C,stockUpdateDialog:z,bulkUpdateDialog:H,movementsDialog:L,reorderDialog:A,selectedInventory:S,selectedItems:f,currentPage:_,totalItems:n,itemsPerPage:x,filters:b,errorMessage:G,successMessage:P,modalErrorMessage:T,stockUpdateForm:re,reorderForm:ne,hasSelectedItems:Z,totalStockValue:de,lowStockCount:ee,outOfStockCount:le,quantityRules:Se,reasonRules:Ve,costRules:Me,movementTypeOptions:m,stockStatusOptions:j,fetchInventoryList:h,fetchStats:Ce,fetchLowStockAlerts:ie,fetchMovements:_e,updateStock:$e,setReorderLevel:Ee,openStockUpdateDialog:ke,openReorderDialog:Re,openMovementsDialog:ge,closeStockUpdateDialog:fe,closeReorderDialog:q,closeMovementsDialog:()=>{L.value=!1,setTimeout(()=>{S.value=null,y.value=[]},300)},clearModalError:()=>{T.value=""},onPageChange:o=>{console.log("Page changed to:",o,"Current total items:",n.value),o!==_.value&&(_.value=o,h())},onItemsPerPageChange:o=>{console.log("Items per page changed to:",o),o!==x.value&&(x.value=o,_.value=1,h())},handleFiltersUpdate:o=>{b.value={...b.value,...o},_.value=1,h()},formatCurrency:o=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(o),getStockStatusColor:o=>o.current_stock===0?"error":o.is_low_stock?"warning":"success",getStockStatusText:o=>o.current_stock===0?"Habis":o.reorder_level>0&&o.current_stock<=o.reorder_level?"Menipis":o.max_stock_level&&o.current_stock>o.max_stock_level?"Berlebih":"Tersedia",getMovementTypeColor:o=>({stock_in:"success",stock_out:"warning",adjustment:"info",transfer:"primary",return:"success",damaged:"error",expired:"error"})[o]||"grey",totalPages:J,hasNextPage:me,hasPrevPage:pe,paginationInfo:ve}};function Mt(O){const i=v([]),u=v([]),d=v(!1),y=v(!1),R=v({total_items:0,total_value:0,low_stock_items:0,out_of_stock_items:0,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}),$=v(1),C=v(0),z=v(10),H=We({search:"",stock_status:"all",movement_type:"",date_from:"",date_to:"",item_id:void 0}),L=v(!1),A=v(!1),S=v(null),f=We({item_id:0,type:"in",quantity:0,notes:"",cost_per_unit:0}),_=v(""),n=v(""),x=v(""),b=B(()=>!0),G=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],P=[{title:"Masuk",value:"in",color:"success",icon:"tabler-plus"},{title:"Keluar",value:"out",color:"error",icon:"tabler-minus"},{title:"Penyesuaian",value:"adjustment",color:"warning",icon:"tabler-adjustments"}],T=[{title:"Pembelian",value:"purchase"},{title:"Penjualan",value:"sale"},{title:"Produksi",value:"production"},{title:"Penyesuaian",value:"adjustment"},{title:"Kerusakan",value:"waste"}],re=m=>m.current_stock<=0?{status:"out_of_stock",color:"error",text:"Habis",icon:"tabler-x"}:m.current_stock<=m.minimum_stock?{status:"low_stock",color:"warning",text:"Rendah",icon:"tabler-alert-triangle"}:{status:"in_stock",color:"success",text:"Tersedia",icon:"tabler-check"},ne=m=>!m.maximum_stock||m.maximum_stock<=0?100:Math.round(m.current_stock/m.maximum_stock*100),Z=async()=>{d.value=!0;try{await new Promise(m=>setTimeout(m,1e3)),i.value=await rt.getAll(),C.value=i.value.length,n.value=""}catch{_.value="Gagal memuat data items"}finally{d.value=!1}},de=async m=>{d.value=!0;try{const j=await K.getMovements({id_inventory:m,page:$.value,per_page:z.value});u.value=j.data.map(h=>({id:h.id_movement,item_id:h.id_inventory,type:h.movement_type,quantity:h.quantity,unit:"pcs",reference_id:h.reference_number?parseInt(h.reference_number):void 0,reference_type:h.reason,notes:h.notes,cost_per_unit:h.cost_per_unit,total_cost:h.total_cost,created_by:h.created_by,created_at:h.created_at,creator:h.user})),C.value=j.total}catch(j){console.error("Failed to fetch stock movements:",j),u.value=[]}finally{d.value=!1}},ee=async()=>{try{await Z();const m=i.value;R.value={total_items:m.length,total_value:m.reduce((j,h)=>j+h.current_stock*h.cost_per_unit,0),low_stock_items:m.filter(j=>j.current_stock<=j.minimum_stock&&j.current_stock>0).length,out_of_stock_items:m.filter(j=>j.current_stock<=0).length,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}}catch(m){console.error("Failed to fetch stats:",m)}},le=async()=>{y.value=!0,x.value="";try{const m=await K.recordMovement({item_id:f.item_id,movement_type:f.type,quantity:f.quantity,notes:f.notes,cost_per_unit:f.cost_per_unit});if(m.success)n.value=`Stock ${f.type==="in"?"masuk":f.type==="out"?"keluar":"disesuaikan"} berhasil dicatat`,ve(),await Z(),await ee(),O&&O();else throw new Error(m.message||"Gagal mencatat pergerakan stok")}catch(m){x.value=m.message||"Gagal mencatat pergerakan stok"}finally{y.value=!1}},J=m=>{S.value=m,Object.assign(f,{item_id:m.id_item,type:"in",quantity:0,notes:"",cost_per_unit:m.cost_per_unit}),L.value=!0},me=m=>{S.value=m,Object.assign(f,{item_id:m.id_item,type:"out",quantity:0,notes:"",cost_per_unit:m.cost_per_unit}),L.value=!0},pe=m=>{S.value=m,Object.assign(f,{item_id:m.id_item,type:"adjustment",quantity:m.current_stock,notes:"",cost_per_unit:m.cost_per_unit}),A.value=!0},ve=()=>{L.value=!1,A.value=!1,x.value="",S.value=null};return{itemsList:i,stockMovements:u,loading:d,saveLoading:y,stats:R,currentPage:$,totalItems:C,itemsPerPage:z,filters:H,movementDialog:L,adjustmentDialog:A,selectedItem:S,movementFormData:f,errorMessage:_,successMessage:n,modalErrorMessage:x,canManageStock:b,stockStatusOptions:G,movementTypeOptions:P,referenceTypeOptions:T,getStockStatus:re,getStockPercentage:ne,fetchItems:Z,fetchStockMovements:de,fetchStats:ee,recordStockMovement:le,openStockInDialog:J,openStockOutDialog:me,openAdjustmentDialog:pe,closeMovementDialog:ve,clearModalError:()=>{x.value=""},onPageChange:m=>{$.value=m,Z()},handleFiltersUpdate:m=>{Object.assign(H,m),$.value=1,Z()}}}const Ct={class:"inventory-management"},Pt={class:"d-flex justify-space-between align-center mb-6"},Dt={class:"d-flex gap-3 align-center"},It={class:"d-flex align-center justify-space-between"},Ut={class:"text-h4 font-weight-bold text-primary"},Tt={class:"d-flex align-center justify-space-between"},jt={class:"text-h4 font-weight-bold text-warning"},$t={class:"d-flex align-center justify-space-between"},Et={class:"text-h4 font-weight-bold text-error"},Rt={class:"d-flex align-center justify-space-between"},Lt={class:"text-h4 font-weight-bold text-success"},At={class:"d-flex align-center justify-space-between"},Ft={class:"d-flex align-center gap-3"},zt={class:"d-flex gap-2"},qt={class:"d-flex flex-wrap gap-2"},Bt={class:"d-flex align-center"},Ot={class:"font-weight-medium"},Kt={class:"text-medium-emphasis"},Nt={class:"text-center"},Ht={class:"text-h6 font-weight-bold"},Gt={key:0,class:"text-warning"},Jt={class:"text-center"},Wt={class:"text-center"},Xt={class:"text-end"},Qt={class:"text-end font-weight-medium text-success"},Yt={class:"d-flex align-center gap-1"},Zt={class:"text-center py-12"},ea={class:"text-h5 text-medium-emphasis mb-2"},ta={class:"text-body-1 text-medium-emphasis mb-4"},aa={key:0},sa={key:0},oa={key:1},la={key:2},ra={key:1},na={class:"d-flex justify-center gap-3"},ia={class:"text-center py-8"},ua={class:"d-flex align-center gap-2"},ca={class:"d-flex align-center gap-3"},da={class:"font-weight-bold"},ma={class:"text-caption"},pa={class:"text-caption"},va={class:"d-flex gap-3 justify-end"},_a={class:"d-flex align-center gap-2"},fa={class:"text-white"},ka={class:"d-flex align-center gap-3"},ga={class:"font-weight-bold"},ya={class:"text-caption"},ba=Qe({__name:"inventory-management",setup(O){const{xs:i}=tt(),u=()=>{ee(),le(),J()},{inventoryList:d,loading:y,saveLoading:R,stats:$,lowStockItems:C,stockUpdateDialog:z,reorderDialog:H,movementsDialog:L,selectedInventory:A,currentPage:S,totalItems:f,itemsPerPage:_,filters:n,errorMessage:x,successMessage:b,modalErrorMessage:G,stockUpdateForm:P,reorderForm:T,totalStockValue:re,lowStockCount:ne,outOfStockCount:Z,stockStatusOptions:de,fetchInventoryList:ee,fetchStats:le,fetchLowStockAlerts:J,updateStock:me,setReorderLevel:pe,openStockUpdateDialog:ve,openReorderDialog:Se,openMovementsDialog:Ve,closeStockUpdateDialog:Me,closeReorderDialog:m,clearModalError:j,onPageChange:h,onItemsPerPageChange:Ce,handleFiltersUpdate:ie,formatCurrency:_e,getStockStatusColor:$e,getStockStatusText:Ee}=Vt(),{recordStockMovement:ke,openAdjustmentDialog:Re,movementDialog:ge,adjustmentDialog:fe,selectedItem:q,movementFormData:D,saveLoading:Le,closeMovementDialog:ye,successMessage:Pe,modalErrorMessage:Ae,clearModalError:ze}=Mt(u),qe=o=>o.item?{id_item:o.item.id_item,item_code:o.item.item_code,name:o.item.name,description:o.item.description||"",unit:o.item.unit,cost_per_unit:parseFloat(o.item.cost_per_unit),current_stock:o.current_stock,minimum_stock:o.reorder_level||0,active:!0,storage_location:o.item.storage_location||"",expiry_date:o.item.expiry_date||null,properties:o.item.properties||null,created_by:o.item.created_by||null,updated_by:o.item.updated_by||null,created_at:o.item.created_at,updated_at:o.item.updated_at,deleted_at:o.item.deleted_at||null}:null,Be=o=>{const t=qe(o);t&&Re(t)},Oe=B(()=>$.value);return B(()=>d.value),B(()=>y.value),at(()=>{ee(),le(),J()}),Ye(f,(o,t)=>{console.log("ðŸ” totalItems changed:",{oldValue:t,newValue:o}),console.log("ðŸ“Š VDataTable will receive server-items-length:",o)},{immediate:!0}),(o,t)=>{var be,ue,Ke,Ne;return k(),N("div",Ct,[r("div",Pt,[t[30]||(t[30]=r("div",null,[r("h1",{class:"text-h4 font-weight-bold inventory-title"}," Kelola Inventory "),r("p",{class:"text-body-1 text-medium-emphasis inventory-subtitle"}," Kelola stok barang dan pergerakan inventory ")],-1)),r("div",Dt,[e(w,{color:"primary","prepend-icon":"tabler-refresh",variant:"outlined",onClick:u},{default:s(()=>t[29]||(t[29]=[p(" Refresh Data ")])),_:1,__:[29]})])]),a(x)?(k(),M(oe,{key:0,type:"error",variant:"outlined",class:"mb-4",text:a(x),closable:"","onClick:close":t[0]||(t[0]=l=>x.value="")},null,8,["text"])):V("",!0),a(b)?(k(),M(oe,{key:1,type:"success",variant:"outlined",class:"mb-4",text:a(b),closable:"","onClick:close":t[1]||(t[1]=l=>b.value="")},null,8,["text"])):V("",!0),a(Pe)?(k(),M(oe,{key:2,type:"success",variant:"outlined",class:"mb-4",text:a(Pe),closable:"","onClick:close":t[2]||(t[2]=l=>Pe.value="")},null,8,["text"])):V("",!0),e(se,{class:"mb-6"},{default:s(()=>[e(I,{cols:"12",md:"3"},{default:s(()=>[e(E,{class:"stats-card"},{default:s(()=>[e(F,null,{default:s(()=>[r("div",It,[r("div",null,[r("div",Ut,c(Oe.value.total_items||0),1),t[31]||(t[31]=r("div",{class:"text-caption text-medium-emphasis"}," Total Produk ",-1))]),e(U,{icon:"tabler-package",size:"48",class:"text-primary opacity-50"})])]),_:1})]),_:1})]),_:1}),e(I,{cols:"12",md:"3"},{default:s(()=>[e(E,{class:"stats-card"},{default:s(()=>[e(F,null,{default:s(()=>[r("div",Tt,[r("div",null,[r("div",jt,c(a(ne)||0),1),t[32]||(t[32]=r("div",{class:"text-caption text-medium-emphasis"}," Stok Menipis ",-1))]),e(U,{icon:"tabler-alert-triangle",size:"48",class:"text-warning opacity-50"})])]),_:1})]),_:1})]),_:1}),e(I,{cols:"12",md:"3"},{default:s(()=>[e(E,{class:"stats-card"},{default:s(()=>[e(F,null,{default:s(()=>[r("div",$t,[r("div",null,[r("div",Et,c(a(Z)||0),1),t[33]||(t[33]=r("div",{class:"text-caption text-medium-emphasis"}," Stok Habis ",-1))]),e(U,{icon:"tabler-x-circle",size:"48",class:"text-error opacity-50"})])]),_:1})]),_:1})]),_:1}),e(I,{cols:"12",md:"3"},{default:s(()=>[e(E,{class:"stats-card"},{default:s(()=>[e(F,null,{default:s(()=>[r("div",Rt,[r("div",null,[r("div",Lt,c(a(_e)(a(re)||0)),1),t[34]||(t[34]=r("div",{class:"text-caption text-medium-emphasis"}," Nilai Stok ",-1))]),e(U,{icon:"tabler-currency-dollar",size:"48",class:"text-success opacity-50"})])]),_:1})]),_:1})]),_:1})]),_:1}),e(E,{class:"mb-6 info-card",color:"info",variant:"tonal"},{default:s(()=>[e(F,null,{default:s(()=>[r("div",At,[r("div",Ft,[e(U,{icon:"tabler-info-circle",size:"32",class:"text-info"}),t[35]||(t[35]=r("div",null,[r("div",{class:"text-subtitle-1 font-weight-medium text-info"}," Sistem Stock Movement Otomatis "),r("div",{class:"text-body-2 text-medium-emphasis"},[p(" Stok akan bertambah otomatis saat purchasing dan berkurang saat penjualan POS. Gunakan tombol "),r("strong",null,"Penyesuaian"),p(" untuk koreksi manual jika diperlukan. ")])],-1))]),r("div",zt,[e(Y,{color:"success",variant:"tonal",size:"small"},{default:s(()=>[e(U,{icon:"tabler-shopping-cart",class:"me-1"}),t[36]||(t[36]=p(" Purchase â†’ Stok + "))]),_:1,__:[36]}),e(Y,{color:"error",variant:"tonal",size:"small"},{default:s(()=>[e(U,{icon:"tabler-cash",class:"me-1"}),t[37]||(t[37]=p(" POS Sale â†’ Stok - "))]),_:1,__:[37]})])])]),_:1})]),_:1}),a(C).length>0?(k(),M(E,{key:3,class:"mb-6 low-stock-alert"},{default:s(()=>[e(ce,{class:"d-flex align-center"},{default:s(()=>[e(U,{icon:"tabler-alert-triangle",class:"text-warning me-2"}),p(" Peringatan Stok Menipis ("+c(a(C).length)+" produk) ",1)]),_:1}),e(F,null,{default:s(()=>[r("div",qt,[(k(!0),N(st,null,ot(a(C).slice(0,10),l=>(k(),M(Y,{key:l.id_inventory,color:"warning",variant:"outlined",size:"small"},{default:s(()=>{var g;return[p(c((g=l.product)==null?void 0:g.name)+" ("+c(l.current_stock)+"/"+c(l.reorder_level)+") ",1)]}),_:2},1024))),128)),a(C).length>10?(k(),M(Y,{key:0,color:"warning",variant:"tonal",size:"small"},{default:s(()=>[p(" +"+c(a(C).length-10)+" lainnya ",1)]),_:1})):V("",!0)])]),_:1})]),_:1})):V("",!0),!a(y)&&a(d).length===0&&!a(x)&&!a(n).search&&a(n).stock_status==="all"?(k(),M(E,{key:4,class:"mb-6"},{default:s(()=>[e(F,{class:"text-center py-6"},{default:s(()=>[e(U,{icon:"tabler-info-circle",size:"48",class:"text-info mb-3"}),t[38]||(t[38]=r("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),t[39]||(t[39]=r("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[38,39]})]),_:1})):V("",!0),e(E,{class:"mb-6"},{default:s(()=>[e(F,null,{default:s(()=>[e(se,null,{default:s(()=>[e(I,{cols:"12",md:"4"},{default:s(()=>[e(W,{modelValue:a(n).search,"onUpdate:modelValue":[t[3]||(t[3]=l=>a(n).search=l),t[4]||(t[4]=l=>a(ie)({search:l}))],label:"Cari inventory produk...",placeholder:"Nama produk, SKU, atau variant","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",md:"4"},{default:s(()=>[e(Xe,{modelValue:a(n).stock_status,"onUpdate:modelValue":[t[5]||(t[5]=l=>a(n).stock_status=l),t[6]||(t[6]=l=>a(ie)({stock_status:l||"all"}))],items:a(de),label:"Status Stok",variant:"outlined",clearable:""},null,8,["modelValue","items"])]),_:1}),e(I,{cols:"12",md:"4",class:"d-flex align-center gap-2"},{default:s(()=>[e(w,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:t[7]||(t[7]=l=>{a(ee)(),a(le)(),a(J)()})},{default:s(()=>t[40]||(t[40]=[p(" Refresh ")])),_:1,__:[40]}),a(n).search||a(n).stock_status!=="all"?(k(),M(w,{key:0,variant:"outlined",color:"warning","prepend-icon":"tabler-filter-off",onClick:t[8]||(t[8]=l=>a(ie)({search:"",stock_status:"all"}))},{default:s(()=>t[41]||(t[41]=[p(" Clear ")])),_:1,__:[41]})):V("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),!a(y)&&a(d).length===0&&!a(x)&&!a(n).search&&a(n).stock_status==="all"?(k(),M(E,{key:5,class:"mb-6"},{default:s(()=>[e(F,{class:"text-center py-6"},{default:s(()=>[e(U,{icon:"tabler-package-off",size:"48",class:"text-disabled mb-3"}),t[42]||(t[42]=r("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),t[43]||(t[43]=r("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[42,43]})]),_:1})):V("",!0),e(E,{class:"products-inventory-table"},{default:s(()=>[e(ce,{class:"d-flex align-center gap-2 coffee-header"},{default:s(()=>[e(U,{icon:"tabler-package",class:"text-white"}),t[44]||(t[44]=r("span",{class:"text-white"},"Inventory Produk",-1)),e(we),e(Y,{color:"white",size:"small",variant:"tonal"},{default:s(()=>[p(c(a(f))+" Produk ",1)]),_:1})]),_:1,__:[44]}),e(Q),e(nt,{headers:[{title:"Produk/Variant",key:"item_name",sortable:!1},{title:"SKU",key:"sku",sortable:!1},{title:"Stok Saat Ini",key:"current_stock",sortable:!1},{title:"Stok Tersedia",key:"available_stock",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Reorder Level",key:"reorder_level",sortable:!1},{title:"Harga Rata-rata",key:"average_cost",sortable:!1},{title:"Nilai Stok",key:"stock_value",sortable:!1},{title:"Aksi",key:"actions",sortable:!1}],items:a(d),loading:a(y),"items-length":a(f),"items-per-page":a(_),page:a(S),"items-per-page-options":[10,15,25,50,100],"items-per-page-text":"Items per page:","page-text":"{0}-{1} of {2}","no-data-text":"Tidak ada data inventory",class:"text-no-wrap","onUpdate:page":a(h),"onUpdate:itemsPerPage":a(Ce)},{"item.item_name":s(({item:l})=>{var g,te,He,Ge,Je;return[r("div",Bt,[r("div",null,[r("div",Ot,c(((g=l.item)==null?void 0:g.name)||((te=l.product)==null?void 0:te.name)||"Unknown Item"),1),r("small",Kt,c(((He=l.item)==null?void 0:He.description)||((Je=(Ge=l.product)==null?void 0:Ge.category)==null?void 0:Je.name)||"-"),1)])])]}),"item.sku":s(({item:l})=>[e(Y,{variant:"outlined",size:"small",color:"primary"},{default:s(()=>{var g,te;return[p(c(((g=l.item)==null?void 0:g.item_code)||((te=l.product)==null?void 0:te.sku)||"N/A"),1)]}),_:2},1024)]),"item.current_stock":s(({item:l})=>[r("div",Nt,[r("div",Ht,c(l.current_stock),1),l.reserved_stock>0?(k(),N("small",Gt," ("+c(l.reserved_stock)+" reserved) ",1)):V("",!0)])]),"item.available_stock":s(({item:l})=>[r("div",Jt,[e(Y,{color:l.available_stock>0?"success":"error",variant:"tonal",size:"small"},{default:s(()=>[p(c(l.available_stock),1)]),_:2},1032,["color"])])]),"item.status":s(({item:l})=>[e(Y,{color:a($e)(l),variant:"tonal",size:"small"},{default:s(()=>[p(c(a(Ee)(l)),1)]),_:2},1032,["color"])]),"item.reorder_level":s(({item:l})=>[r("div",Wt,c(l.reorder_level||"-"),1)]),"item.average_cost":s(({item:l})=>[r("div",Xt,c(a(_e)(l.average_cost)),1)]),"item.stock_value":s(({item:l})=>[r("div",Qt,c(a(_e)(l.current_stock*l.average_cost)),1)]),"item.actions":s(({item:l})=>[r("div",Yt,[e(Ue,{text:"Penyesuaian Stok"},{activator:s(({props:g})=>[e(w,De(g,{icon:"tabler-adjustments",color:"warning",variant:"text",size:"small",disabled:!l.item,onClick:te=>Be(l)}),null,16,["disabled","onClick"])]),_:2},1024),e(Ue,{text:"Update Stok"},{activator:s(({props:g})=>[e(w,De(g,{icon:"tabler-edit",color:"primary",variant:"text",size:"small",onClick:te=>a(ve)(l)}),null,16,["onClick"])]),_:2},1024),e(Ue,{text:"Set Reorder Level"},{activator:s(({props:g})=>[e(w,De(g,{icon:"tabler-settings",color:"info",variant:"text",size:"small",onClick:te=>a(Se)(l)}),null,16,["onClick"])]),_:2},1024),e(Ue,{text:"Lihat Riwayat"},{activator:s(({props:g})=>[e(w,De(g,{icon:"tabler-history",color:"secondary",variant:"text",size:"small",onClick:te=>a(Ve)(l)}),null,16,["onClick"])]),_:2},1024)])]),"no-data":s(()=>{var l;return[r("div",Zt,[e(U,{icon:a(n).search||a(n).stock_status!=="all"?"tabler-search-off":"tabler-package-off",size:"64",class:"text-medium-emphasis mb-4"},null,8,["icon"]),r("div",ea,c(a(n).search||a(n).stock_status!=="all"?"Tidak Ada Hasil Pencarian":"Belum Ada Data Inventory"),1),r("div",ta,[a(n).search||a(n).stock_status!=="all"?(k(),N("span",aa,[a(n).search?(k(),N("span",sa,[t[45]||(t[45]=p(' Tidak ditemukan inventory dengan kata kunci "')),r("strong",null,c(a(n).search),1),t[46]||(t[46]=p('" '))])):V("",!0),a(n).search&&a(n).stock_status!=="all"?(k(),N("span",oa," dan ")):V("",!0),a(n).stock_status!=="all"?(k(),N("span",la,[t[47]||(t[47]=p(' status stok "')),r("strong",null,c(((l=a(de).find(g=>g.value===a(n).stock_status))==null?void 0:l.title)||a(n).stock_status),1),t[48]||(t[48]=p('" '))])):V("",!0),t[49]||(t[49]=r("br",null,null,-1)),t[50]||(t[50]=p("Coba kata kunci yang berbeda atau hapus filter. "))])):(k(),N("span",ra,t[51]||(t[51]=[p(" Data inventory akan muncul setelah produk dan variant dibuat."),r("br",null,null,-1),p(" Silakan buat produk terlebih dahulu di menu "),r("strong",null,"Kelola Produk",-1),p(". ")])))]),r("div",na,[a(n).search||a(n).stock_status!=="all"?(k(),M(w,{key:0,color:"warning",variant:"outlined","prepend-icon":"tabler-filter-off",onClick:t[9]||(t[9]=g=>a(ie)({search:"",stock_status:"all"}))},{default:s(()=>t[52]||(t[52]=[p(" Hapus Filter ")])),_:1,__:[52]})):(k(),M(w,{key:1,color:"primary","prepend-icon":"tabler-plus",to:"/products-management"},{default:s(()=>t[53]||(t[53]=[p(" Buat Produk Baru ")])),_:1,__:[53]})),e(w,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:t[10]||(t[10]=g=>{a(ee)(),a(le)(),a(J)()})},{default:s(()=>t[54]||(t[54]=[p(" Refresh Data ")])),_:1,__:[54]})])])]}),loading:s(()=>[r("div",ia,[e(Ze,{indeterminate:"",color:"primary",size:"40"}),t[55]||(t[55]=r("div",{class:"mt-4 text-medium-emphasis"}," Memuat data inventory... ",-1))])]),_:1},8,["items","loading","items-length","items-per-page","page","onUpdate:page","onUpdate:itemsPerPage"])]),_:1}),e(xe,{modelValue:a(z),"onUpdate:modelValue":t[17]||(t[17]=l=>he(z)?z.value=l:null),"max-width":"800px",fullscreen:a(i),persistent:"",class:"stock-dialog"},{default:s(()=>[e(E,null,{default:s(()=>[e(ce,null,{default:s(()=>{var l,g;return[p(" Update Stok - "+c((g=(l=a(A))==null?void 0:l.product)==null?void 0:g.name),1)]}),_:1}),e(Q),e(Te,{onSubmit:Ie(a(me),["prevent"])},{default:s(()=>[e(F,null,{default:s(()=>[a(G)?(k(),M(oe,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":a(j)},{default:s(()=>[p(c(a(G)),1)]),_:1},8,["onClick:close"])):V("",!0),e(se,null,{default:s(()=>[e(I,{cols:"12",md:"6"},{default:s(()=>[e(Xe,{modelValue:a(P).movement_type,"onUpdate:modelValue":t[11]||(t[11]=l=>a(P).movement_type=l),label:"Jenis Pergerakan *",items:[{title:"Stock Masuk",value:"stock_in"},{title:"Stock Keluar",value:"stock_out"},{title:"Penyesuaian",value:"adjustment"},{title:"Transfer",value:"transfer"},{title:"Retur",value:"return"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",md:"6"},{default:s(()=>[e(W,{modelValue:a(P).quantity,"onUpdate:modelValue":t[12]||(t[12]=l=>a(P).quantity=l),modelModifiers:{number:!0},label:"Kuantitas *",type:"number",min:"1",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(se,null,{default:s(()=>[e(I,{cols:"12"},{default:s(()=>[e(W,{modelValue:a(P).reason,"onUpdate:modelValue":t[13]||(t[13]=l=>a(P).reason=l),label:"Alasan *",placeholder:"Contoh: Pembelian dari supplier, Penjualan, dll",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(se,null,{default:s(()=>[e(I,{cols:"12",md:"6"},{default:s(()=>[e(W,{modelValue:a(P).reference_number,"onUpdate:modelValue":t[14]||(t[14]=l=>a(P).reference_number=l),label:"Nomor Referensi",placeholder:"PO-001, SO-001, dll",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(I,{cols:"12",md:"6"},{default:s(()=>[e(W,{modelValue:a(P).cost_per_unit,"onUpdate:modelValue":t[15]||(t[15]=l=>a(P).cost_per_unit=l),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",min:"0",step:"0.01",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(se,null,{default:s(()=>[e(I,{cols:"12"},{default:s(()=>[e(Fe,{modelValue:a(P).notes,"onUpdate:modelValue":t[16]||(t[16]=l=>a(P).notes=l),label:"Catatan",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Q),e(je,{class:"pa-4"},{default:s(()=>[e(we),e(w,{variant:"outlined",onClick:a(Me)},{default:s(()=>t[56]||(t[56]=[p(" Batal ")])),_:1,__:[56]},8,["onClick"]),e(w,{type:"submit",color:"primary",loading:a(R)},{default:s(()=>t[57]||(t[57]=[p(" Update Stok ")])),_:1,__:[57]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),e(xe,{modelValue:a(H),"onUpdate:modelValue":t[20]||(t[20]=l=>he(H)?H.value=l:null),"max-width":"600px",fullscreen:a(i),persistent:"",class:"stock-dialog"},{default:s(()=>[e(E,null,{default:s(()=>[e(ce,null,{default:s(()=>{var l,g;return[p(" Set Reorder Level - "+c((g=(l=a(A))==null?void 0:l.product)==null?void 0:g.name),1)]}),_:1}),e(Q),e(Te,{onSubmit:Ie(a(pe),["prevent"])},{default:s(()=>[e(F,null,{default:s(()=>[a(G)?(k(),M(oe,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":a(j)},{default:s(()=>[p(c(a(G)),1)]),_:1},8,["onClick:close"])):V("",!0),e(se,null,{default:s(()=>[e(I,{cols:"12"},{default:s(()=>[e(W,{modelValue:a(T).reorder_level,"onUpdate:modelValue":t[18]||(t[18]=l=>a(T).reorder_level=l),modelModifiers:{number:!0},label:"Reorder Level *",type:"number",min:"0",hint:"Stok minimum sebelum perlu restock","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(se,null,{default:s(()=>[e(I,{cols:"12"},{default:s(()=>[e(W,{modelValue:a(T).max_stock_level,"onUpdate:modelValue":t[19]||(t[19]=l=>a(T).max_stock_level=l),modelModifiers:{number:!0},label:"Max Stock Level",type:"number",min:"0",hint:"Stok maksimum yang diizinkan","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Q),e(je,{class:"pa-4"},{default:s(()=>[e(we),e(w,{variant:"outlined",onClick:a(m)},{default:s(()=>t[58]||(t[58]=[p(" Batal ")])),_:1,__:[58]},8,["onClick"]),e(w,{type:"submit",color:"primary",loading:a(R)},{default:s(()=>t[59]||(t[59]=[p(" Simpan ")])),_:1,__:[59]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),e(St,{modelValue:a(L),"onUpdate:modelValue":t[21]||(t[21]=l=>he(L)?L.value=l:null),"inventory-id":(ue=(be=a(A))==null?void 0:be.id_inventory)==null?void 0:ue.toString(),"inventory-name":(Ne=(Ke=a(A))==null?void 0:Ke.item)==null?void 0:Ne.name},null,8,["modelValue","inventory-id","inventory-name"]),e(xe,{modelValue:a(fe),"onUpdate:modelValue":t[24]||(t[24]=l=>he(fe)?fe.value=l:null),"max-width":"600px",fullscreen:a(i),persistent:"",class:"stock-dialog"},{default:s(()=>[e(E,{class:"stock-movement-dialog coffee-dialog"},{default:s(()=>[e(ce,{class:"d-flex align-center justify-space-between coffee-header"},{default:s(()=>[r("div",ua,[e(U,{icon:"tabler-adjustments",class:"text-white"}),t[60]||(t[60]=r("span",{class:"text-white"}," Penyesuaian Stok ",-1))]),e(w,{icon:"tabler-x",variant:"text",color:"white",onClick:a(ye)},null,8,["onClick"])]),_:1}),e(Q),e(F,{class:"pa-6"},{default:s(()=>[e(Te,{onSubmit:Ie(a(ke),["prevent"])},{default:s(()=>{var l;return[a(q)?(k(),M(oe,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:s(()=>[r("div",ca,[e(U,{icon:"tabler-package"}),r("div",null,[r("div",da,c(a(q).name),1),r("div",ma,c(a(q).item_code),1),r("div",pa,"Stok Saat Ini: "+c(a(q).current_stock)+" "+c(a(q).unit),1)])])]),_:1})):V("",!0),a(Ae)?(k(),M(oe,{key:1,type:"error",variant:"outlined",class:"mb-4",text:a(Ae),closable:"","onClick:close":a(ze)},null,8,["text","onClick:close"])):V("",!0),e(W,{modelValue:a(D).quantity,"onUpdate:modelValue":t[22]||(t[22]=g=>a(D).quantity=g),modelModifiers:{number:!0},label:"Stok Baru",type:"number",min:"0",step:"0.001",variant:"outlined",suffix:(l=a(q))==null?void 0:l.unit,class:"mb-4",required:""},null,8,["modelValue","suffix"]),e(Fe,{modelValue:a(D).notes,"onUpdate:modelValue":t[23]||(t[23]=g=>a(D).notes=g),label:"Catatan (opsional)",variant:"outlined",rows:"3",class:"mb-4"},null,8,["modelValue"]),r("div",va,[e(w,{variant:"outlined",onClick:a(ye)},{default:s(()=>t[61]||(t[61]=[p(" Batal ")])),_:1,__:[61]},8,["onClick"]),e(w,{type:"submit",color:"primary",class:"coffee-primary",loading:a(Le)},{default:s(()=>t[62]||(t[62]=[p(" Simpan Penyesuaian ")])),_:1,__:[62]},8,["loading"])])]}),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),e(xe,{modelValue:a(ge),"onUpdate:modelValue":t[28]||(t[28]=l=>he(ge)?ge.value=l:null),"max-width":"800px",fullscreen:a(i),persistent:"",class:"stock-dialog"},{default:s(()=>[e(E,{class:"stock-movement-dialog coffee-dialog"},{default:s(()=>[e(ce,{class:"d-flex align-center justify-space-between coffee-header"},{default:s(()=>[r("div",_a,[e(U,{icon:a(D).type==="in"?"tabler-plus":"tabler-minus",class:"text-white"},null,8,["icon"]),r("span",fa,c(a(D).type==="in"?"Stok Masuk":a(D).type==="out"?"Stok Keluar":"Penyesuaian Stok"),1)]),e(w,{icon:"tabler-x",variant:"text",color:"white",onClick:a(ye)},null,8,["onClick"])]),_:1}),e(Q),e(F,{class:"pa-6"},{default:s(()=>[e(Te,{onSubmit:Ie(a(ke),["prevent"])},{default:s(()=>[a(q)?(k(),M(oe,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:s(()=>[r("div",ka,[e(it,{color:"primary",size:"40",variant:"tonal"},{default:s(()=>[e(U,{icon:"tabler-package"})]),_:1}),r("div",null,[r("div",ga,c(a(q).name),1),r("div",ya," Stok saat ini: "+c(a(q).current_stock)+" "+c(a(q).unit),1)])])]),_:1})):V("",!0),e(se,null,{default:s(()=>[e(I,{cols:"12",md:"6"},{default:s(()=>[e(W,{modelValue:a(D).quantity,"onUpdate:modelValue":t[25]||(t[25]=l=>a(D).quantity=l),modelModifiers:{number:!0},label:`Jumlah ${a(D).type==="in"?"Masuk":a(D).type==="out"?"Keluar":"Akhir"}`,type:"number",variant:"outlined",required:"",min:a(D).type==="adjustment"?0:1,rules:[l=>l>0||"Jumlah harus lebih dari 0"]},null,8,["modelValue","label","min","rules"])]),_:1}),e(I,{cols:"12",md:"6"},{default:s(()=>[e(W,{modelValue:a(D).cost_per_unit,"onUpdate:modelValue":t[26]||(t[26]=l=>a(D).cost_per_unit=l),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",variant:"outlined",prefix:"Rp",readonly:a(D).type!=="in"},null,8,["modelValue","readonly"])]),_:1}),e(I,{cols:"12"},{default:s(()=>[e(Fe,{modelValue:a(D).notes,"onUpdate:modelValue":t[27]||(t[27]=l=>a(D).notes=l),label:"Catatan",placeholder:"Masukkan catatan untuk pergerakan stok...",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(Q),e(je,{class:"pa-6"},{default:s(()=>[e(we),e(w,{variant:"outlined",class:"coffee-secondary",onClick:a(ye)},{default:s(()=>t[63]||(t[63]=[p(" Batal ")])),_:1,__:[63]},8,["onClick"]),e(w,{color:"primary",class:"coffee-primary",loading:a(Le),onClick:a(ke)},{default:s(()=>t[64]||(t[64]=[p(" Simpan ")])),_:1,__:[64]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}}),Wa=et(ba,[["__scopeId","data-v-150acc6b"]]);export{Wa as default};
