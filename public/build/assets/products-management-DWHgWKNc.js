import{D as wt}from"./DeleteConfirmationDialog-DIkwJ7SA.js";import{f as Ge}from"./formatters-BD6tdLx_.js";import{P as We,u as Yt}from"./useProductItems-DwOPTR2S.js";import{I as Jt}from"./ItemsApi-DalEvwS1.js";import{H as Zt,u as Qt}from"./HPPBreakdownDialog-C7pOEqUP.js";import{V as Le}from"./VDialog-kKqt15qI.js";import{V as le,b as Ve,c as Oe}from"./VCard-Af9i-cHC.js";import{cq as St,a8 as Be,a9 as Ee,as as ea,aF as ta,af as $t,bT as aa,r as O,V as ee,aG as Ue,w as _e,W as De,b as e,a0 as H,aa as Re,ak as la,ab as It,ac as Dt,H as Tt,b9 as oa,L as sa,N as zt,bZ as na,b_ as ia,b8 as it,aJ as rt,I as ra,ag as Ut,aM as Ye,bi as ua,bt as yt,p as ue,bd as gt,cr as da,c8 as ht,bg as ca,F as Ie,X as U,cj as ma,c9 as va,aI as fa,s as h,cs as pa,a_ as ga,ad as ka,aH as ba,b2 as _a,b4 as ya,d as Te,D as Qe,c as ne,f as t,e as l,t as p,g as F,l as N,m as A,ap as ha,aq as Va,i as Xe,v as ut,o as $,ay as Mt,aw as dt,$ as xa,j as At,ct as Ca,av as Vt,a5 as nt}from"./main-BDjA8ZE0.js";import{V as ie}from"./VCardText-pusdEz6_.js";import{V as be}from"./VAvatar-BJUFvcQH.js";import{V as oe,m as Pa,b as xt}from"./VChip-DmPw7oBU.js";import{V as we,a as M}from"./VRow-B_tm1uSD.js";import{V as wa}from"./VAutocomplete-X1kKS8Y9.js";import{u as Sa,e as $a,t as Ke,V as kt,a as je,b as ct,d as mt}from"./VList-BUBOvLR6.js";import{u as Ia,V as pe,m as Da}from"./VTextField-BQMuFhOa.js";import{V as vt}from"./VSwitch-DvQ6AnPY.js";import{V as et}from"./VSpacer-P6zft6lJ.js";import{V as Je}from"./VSnackbar-CrTM_ZJk.js";import{_ as ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Ta,m as za,a as Ua,V as Se}from"./VSelect-CqUH4kv5.js";import{V as Ma}from"./VCheckbox-B4UZWQP6.js";import{V as Me,a as Ct}from"./VAlert-BUxPj0YW.js";import{V as $e}from"./VDivider-CNJRCtTw.js";import{V as Aa}from"./VContainer-DGv6bNpU.js";import{a as Bt,u as Ba,P as Ea}from"./useProducts-CkT18C21.js";import{V as Ra}from"./VForm-D-6FADkt.js";import{V as Pt}from"./VTextarea-BZXiLEZc.js";import{V as Pe}from"./VTooltip-Ds7TpE81.js";import{M as Ha,m as Fa,V as Ka}from"./VImg-DavVY8Sw.js";import{V as La,u as Oa}from"./useCategories-CDaccZ7b.js";import{u as ja,m as qa,h as Na}from"./filter-BTEElEgT.js";import{f as Et,a as Wa,s as Ga}from"./forwardRefs-B931MWyl.js";import{V as Xa}from"./VMenu-BN6MK1Ni.js";import{V as Ya}from"./VCheckboxBtn-Ml9VaORK.js";import{V as Ja}from"./VDataTableServer-Di72ajGe.js";import{V as Za}from"./VSkeletonLoader-C5gg4rEk.js";import{_ as Qa}from"./VariantFormDialog.vue_vue_type_script_setup_true_lang-1r2W_LME.js";import el from"./VariantCompositionDialog-BMlI44YI.js";import{_ as tl}from"./VariantDetailDialog.vue_vue_type_script_setup_true_lang-DYjJCrL4.js";import al from"./VariantManagementDialog-BAsvyuUZ.js";import{V as ll}from"./VDataTable-BxIs7bLB.js";import{c as ol,d as sl,u as nl}from"./VOverlay-DpeqFwNJ.js";import"./ProductsApi-D2qWNXIV.js";import"./api-BW0WcotK.js";import"./index-D-EbNoF1.js";/* empty css              */import"./helpers-B-vn2Qqf.js";import"./CategoriesApi-CQia1UU7.js";import"./VTable-CQyojuSP.js";const il=a=>{const{touchstartX:C,touchendX:f,touchstartY:s,touchendY:P}=a,y=.5,g=16;a.offsetX=f-C,a.offsetY=P-s,Math.abs(a.offsetY)<y*Math.abs(a.offsetX)&&(a.left&&f<C-g&&a.left(a),a.right&&f>C+g&&a.right(a)),Math.abs(a.offsetX)<y*Math.abs(a.offsetY)&&(a.up&&P<s-g&&a.up(a),a.down&&P>s+g&&a.down(a))};function rl(a,C){var s;const f=a.changedTouches[0];C.touchstartX=f.clientX,C.touchstartY=f.clientY,(s=C.start)==null||s.call(C,{originalEvent:a,...C})}function ul(a,C){var s;const f=a.changedTouches[0];C.touchendX=f.clientX,C.touchendY=f.clientY,(s=C.end)==null||s.call(C,{originalEvent:a,...C}),il(C)}function dl(a,C){var s;const f=a.changedTouches[0];C.touchmoveX=f.clientX,C.touchmoveY=f.clientY,(s=C.move)==null||s.call(C,{originalEvent:a,...C})}function cl(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const C={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:a.left,right:a.right,up:a.up,down:a.down,start:a.start,move:a.move,end:a.end};return{touchstart:f=>rl(f,C),touchend:f=>ul(f,C),touchmove:f=>dl(f,C)}}function ml(a,C){var m;const f=C.value,s=f!=null&&f.parent?a.parentElement:a,P=(f==null?void 0:f.options)??{passive:!0},y=(m=C.instance)==null?void 0:m.$.uid;if(!s||!y)return;const g=cl(C.value);s._touchHandlers=s._touchHandlers??Object.create(null),s._touchHandlers[y]=g,St(g).forEach(r=>{s.addEventListener(r,g[r],P)})}function vl(a,C){var y,g;const f=(y=C.value)!=null&&y.parent?a.parentElement:a,s=(g=C.instance)==null?void 0:g.$.uid;if(!(f!=null&&f._touchHandlers)||!s)return;const P=f._touchHandlers[s];St(P).forEach(m=>{f.removeEventListener(m,P[m])}),delete f._touchHandlers[s]}const Rt={mounted:ml,unmounted:vl},Ht=Symbol.for("vuetify:v-window"),Ft=Symbol.for("vuetify:v-window-group"),Kt=Ee({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:a=>typeof a=="boolean"||a==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Dt(),...It(),...la()},"VWindow"),ft=Be()({name:"VWindow",directives:{Touch:Rt},props:Kt(),emits:{"update:modelValue":a=>!0},setup(a,C){let{slots:f}=C;const{themeClasses:s}=ea(a),{isRtl:P}=ta(),{t:y}=$t(),g=aa(a,Ft),m=O(),r=ee(()=>P.value?!a.reverse:a.reverse),o=Ue(!1),D=ee(()=>{const b=a.direction==="vertical"?"y":"x",W=(r.value?!o.value:o.value)?"-reverse":"";return`v-window-${b}${W}-transition`}),V=Ue(0),E=O(void 0),j=ee(()=>g.items.value.findIndex(b=>g.selected.value.includes(b.id)));_e(j,(b,z)=>{const W=g.items.value.length,Y=W-1;W<=2?o.value=b<z:b===Y&&z===0?o.value=!0:b===0&&z===Y?o.value=!1:o.value=b<z}),sa(Ht,{transition:D,isReversed:o,transitionCount:V,transitionHeight:E,rootRef:m});const I=De(()=>a.continuous||j.value!==0),w=De(()=>a.continuous||j.value!==g.items.value.length-1);function J(){I.value&&g.prev()}function re(){w.value&&g.next()}const B=ee(()=>{const b=[],z={icon:P.value?a.nextIcon:a.prevIcon,class:`v-window__${r.value?"right":"left"}`,onClick:g.prev,"aria-label":y("$vuetify.carousel.prev")};b.push(I.value?f.prev?f.prev({props:z}):e(H,z,null):e("div",null,null));const W={icon:P.value?a.prevIcon:a.nextIcon,class:`v-window__${r.value?"left":"right"}`,onClick:g.next,"aria-label":y("$vuetify.carousel.next")};return b.push(w.value?f.next?f.next({props:W}):e(H,W,null):e("div",null,null)),b}),R=ee(()=>a.touch===!1?a.touch:{...{left:()=>{r.value?J():re()},right:()=>{r.value?re():J()},start:z=>{let{originalEvent:W}=z;W.stopPropagation()}},...a.touch===!0?{}:a.touch});return Re(()=>Tt(e(a.tag,{ref:m,class:["v-window",{"v-window--show-arrows-on-hover":a.showArrows==="hover"},s.value,a.class],style:a.style},{default:()=>{var b,z;return[e("div",{class:"v-window__container",style:{height:E.value}},[(b=f.default)==null?void 0:b.call(f,{group:g}),a.showArrows!==!1&&e("div",{class:"v-window__controls"},[B.value])]),(z=f.additional)==null?void 0:z.call(f,{group:g})]}}),[[oa("touch"),R.value]])),{group:g}}}),Lt=Ee({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Dt(),...ia(),...sl()},"VWindowItem"),Ze=Be()({name:"VWindowItem",directives:{Touch:Rt},props:Lt(),emits:{"group:selected":a=>!0},setup(a,C){let{slots:f}=C;const s=zt(Ht),P=na(a,Ft),{isBooted:y}=Sa();if(!s||!P)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const g=Ue(!1),m=ee(()=>y.value&&(s.isReversed.value?a.reverseTransition!==!1:a.transition!==!1));function r(){!g.value||!s||(g.value=!1,s.transitionCount.value>0&&(s.transitionCount.value-=1,s.transitionCount.value===0&&(s.transitionHeight.value=void 0)))}function o(){var I;g.value||!s||(g.value=!0,s.transitionCount.value===0&&(s.transitionHeight.value=rt((I=s.rootRef.value)==null?void 0:I.clientHeight)),s.transitionCount.value+=1)}function D(){r()}function V(I){g.value&&it(()=>{!m.value||!g.value||!s||(s.transitionHeight.value=rt(I.clientHeight))})}const E=ee(()=>{const I=s.isReversed.value?a.reverseTransition:a.transition;return m.value?{name:typeof I!="string"?s.transition.value:I,onBeforeEnter:o,onAfterEnter:r,onEnterCancelled:D,onBeforeLeave:o,onAfterLeave:r,onLeaveCancelled:D,onEnter:V}:!1}),{hasContent:j}=ol(a,P.isSelected);return Re(()=>e(Ha,{transition:E.value,disabled:!y.value},{default:()=>{var I;return[Tt(e("div",{class:["v-window-item",P.selectedClass.value,a.class],style:a.style},[j.value&&((I=f.default)==null?void 0:I.call(f))]),[[ra,P.isSelected.value]])]}})),{groupItem:P}}}),fl=Ee({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...qa({filterKeys:["title"]}),...za({hideNoData:!0,returnObject:!0}),...gt(Da({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Fa({transition:!1})},"VCombobox"),pl=Be()({name:"VCombobox",props:fl(),emits:{"update:focused":a=>!0,"update:modelValue":a=>!0,"update:search":a=>!0,"update:menu":a=>!0},setup(a,C){var qe;let{emit:f,slots:s}=C;const{t:P}=$t(),y=O(),g=Ue(!1),m=Ue(!0),r=Ue(!1),o=O(),D=O(),V=Ue(-1);let E=!1;const{items:j,transformIn:I,transformOut:w}=$a(a),{textColorClasses:J,textColorStyles:re}=Ut(()=>{var S;return(S=y.value)==null?void 0:S.color}),B=Ye(a,"modelValue",[],S=>I(ua(S)),S=>{const G=w(S);return a.multiple?G:G[0]??null}),R=Ia(a),b=ee(()=>!!(a.chips||s.chip)),z=ee(()=>b.value||!!s.selection),W=Ue(!a.multiple&&!z.value?((qe=B.value[0])==null?void 0:qe.title)??"":""),Y=ee({get:()=>W.value,set:S=>{var G;if(W.value=S??"",!a.multiple&&!z.value&&(B.value=[Ke(a,S)]),S&&a.multiple&&((G=a.delimiters)!=null&&G.length)){const de=S.split(new RegExp(`(?:${a.delimiters.join("|")})+`));de.length>1&&(de.forEach(X=>{X=X.trim(),X&&xe(Ke(a,X))}),W.value="")}S||(V.value=-1),m.value=!S}}),K=ee(()=>typeof a.counterValue=="function"?a.counterValue(B.value):typeof a.counterValue=="number"?a.counterValue:a.multiple?B.value.length:Y.value.length),{filteredItems:d,getMatches:k}=ja(a,j,()=>m.value?"":Y.value),i=ee(()=>a.hideSelected?d.value.filter(S=>!B.value.some(G=>G.value===S.value)):d.value),T=ee(()=>a.hideNoData&&!i.value.length||R.isReadonly.value||R.isDisabled.value),Q=Ye(a,"menu"),x=ee({get:()=>Q.value,set:S=>{var G;Q.value&&!S&&((G=o.value)!=null&&G.Î¨openChildren.size)||S&&T.value||(Q.value=S)}}),_=De(()=>x.value?a.closeText:a.openText);_e(W,S=>{E?it(()=>E=!1):g.value&&!x.value&&(x.value=!0),f("update:search",S)}),_e(B,S=>{var G;!a.multiple&&!z.value&&(W.value=((G=S[0])==null?void 0:G.title)??"")});const c=ee(()=>B.value.map(S=>S.value)),q=ee(()=>{var G;return(a.autoSelectFirst===!0||a.autoSelectFirst==="exact"&&Y.value===((G=i.value[0])==null?void 0:G.title))&&i.value.length>0&&!m.value&&!r.value}),v=O(),n=Ta(v,y);function u(S){E=!0,a.openOnClear&&(x.value=!0)}function ge(){T.value||(x.value=!0)}function te(S){T.value||(g.value&&(S.preventDefault(),S.stopPropagation()),x.value=!x.value)}function ye(S){var G;S.key!==" "&&ht(S)&&((G=y.value)==null||G.focus())}function ve(S){var X,ce,ke,fe;if(da(S)||R.isReadonly.value)return;const G=(X=y.value)==null?void 0:X.selectionStart,de=B.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(S.key)&&S.preventDefault(),["Enter","ArrowDown"].includes(S.key)&&(x.value=!0),["Escape"].includes(S.key)&&(x.value=!1),["Enter","Escape","Tab"].includes(S.key)&&(q.value&&["Enter","Tab"].includes(S.key)&&!B.value.some(Z=>{let{value:Ce}=Z;return Ce===i.value[0].value})&&xe(d.value[0]),m.value=!0),S.key==="ArrowDown"&&q.value&&((ce=v.value)==null||ce.focus("next")),S.key==="Enter"&&Y.value&&(xe(Ke(a,Y.value)),z.value&&(W.value="")),["Backspace","Delete"].includes(S.key)){if(!a.multiple&&z.value&&B.value.length>0&&!Y.value)return xe(B.value[0],!1);if(~V.value){S.preventDefault();const Z=V.value;xe(B.value[V.value],!1),V.value=Z>=de-1?de-2:Z}else S.key==="Backspace"&&!Y.value&&(V.value=de-1);return}if(a.multiple)if(S.key==="ArrowLeft"){if(V.value<0&&G&&G>0)return;const Z=V.value>-1?V.value-1:de-1;B.value[Z]?V.value=Z:(V.value=-1,(ke=y.value)==null||ke.setSelectionRange(Y.value.length,Y.value.length))}else if(S.key==="ArrowRight"){if(V.value<0)return;const Z=V.value+1;B.value[Z]?V.value=Z:(V.value=-1,(fe=y.value)==null||fe.setSelectionRange(0,0))}else~V.value&&ht(S)&&(V.value=-1)}function he(){var S;a.eager&&((S=D.value)==null||S.calculateVisibleItems())}function tt(){var S;g.value&&(m.value=!0,(S=y.value)==null||S.focus())}function xe(S){let G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!S||S.props.disabled))if(a.multiple){const de=B.value.findIndex(ce=>(a.valueComparator||yt)(ce.value,S.value)),X=G??!~de;if(~de){const ce=X?[...B.value,S]:[...B.value];ce.splice(de,1),B.value=ce}else X&&(B.value=[...B.value,S]);a.clearOnSelect&&(Y.value="")}else{const de=G!==!1;B.value=de?[S]:[],W.value=de&&!z.value?S.title:"",it(()=>{x.value=!1,m.value=!0})}}function at(S){g.value=!0,setTimeout(()=>{r.value=!0})}function lt(S){r.value=!1}function ot(S){(S==null||S===""&&!a.multiple&&!z.value)&&(B.value=[])}return _e(g,(S,G)=>{if(!(S||S===G)&&(V.value=-1,x.value=!1,Y.value)){if(a.multiple){xe(Ke(a,Y.value));return}if(!z.value)return;B.value.some(de=>{let{title:X}=de;return X===Y.value})?W.value="":xe(Ke(a,Y.value))}}),_e(x,()=>{if(!a.hideSelected&&x.value&&B.value.length){const S=i.value.findIndex(G=>B.value.some(de=>(a.valueComparator||yt)(de.value,G.value)));ca&&window.requestAnimationFrame(()=>{var G;S>=0&&((G=D.value)==null||G.scrollToIndex(S))})}}),_e(()=>a.items,(S,G)=>{x.value||g.value&&!G.length&&S.length&&(x.value=!0)}),Re(()=>{const S=!!(!a.hideNoData||i.value.length||s["prepend-item"]||s["append-item"]||s["no-data"]),G=B.value.length>0,de=pe.filterProps(a);return e(pe,ue({ref:y},de,{modelValue:Y.value,"onUpdate:modelValue":[X=>Y.value=X,ot],focused:g.value,"onUpdate:focused":X=>g.value=X,validationValue:B.externalValue,counterValue:K.value,dirty:G,class:["v-combobox",{"v-combobox--active-menu":x.value,"v-combobox--chips":!!a.chips,"v-combobox--selection-slot":!!z.value,"v-combobox--selecting-index":V.value>-1,[`v-combobox--${a.multiple?"multiple":"single"}`]:!0},a.class],style:a.style,readonly:R.isReadonly.value,placeholder:G?void 0:a.placeholder,"onClick:clear":u,"onMousedown:control":ge,onKeydown:ve}),{...s,default:()=>e(Ie,null,[e(Xa,ue({ref:o,modelValue:x.value,"onUpdate:modelValue":X=>x.value=X,activator:"parent",contentClass:"v-combobox__content",disabled:T.value,eager:a.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:a.transition,onAfterEnter:he,onAfterLeave:tt},a.menuProps),{default:()=>[S&&e(kt,ue({ref:v,selected:c.value,selectStrategy:a.multiple?"independent":"single-independent",onMousedown:X=>X.preventDefault(),onKeydown:ye,onFocusin:at,onFocusout:lt,tabindex:"-1","aria-live":"polite",color:a.itemColor??a.color},n,a.listProps),{default:()=>{var X,ce,ke;return[(X=s["prepend-item"])==null?void 0:X.call(s),!i.value.length&&!a.hideNoData&&(((ce=s["no-data"])==null?void 0:ce.call(s))??e(je,{key:"no-data",title:P(a.noDataText)},null)),e(Ua,{ref:D,renderless:!0,items:i.value,itemKey:"value"},{default:fe=>{var Ne;let{item:Z,index:Ce,itemRef:me}=fe;const Ae=ue(Z.props,{ref:me,key:Z.value,active:q.value&&Ce===0?!0:void 0,onClick:()=>xe(Z,null)});return((Ne=s.item)==null?void 0:Ne.call(s,{item:Z,index:Ce,props:Ae}))??e(je,ue(Ae,{role:"option"}),{prepend:He=>{let{isSelected:st}=He;return e(Ie,null,[a.multiple&&!a.hideSelected?e(Ya,{key:Z.value,modelValue:st,ripple:!1,tabindex:"-1"},null):void 0,Z.props.prependAvatar&&e(be,{image:Z.props.prependAvatar},null),Z.props.prependIcon&&e(U,{icon:Z.props.prependIcon},null)])},title:()=>{var He;return m.value?Z.title:Na("v-combobox",Z.title,(He=k(Z))==null?void 0:He.title)}})}}),(ke=s["append-item"])==null?void 0:ke.call(s)]}})]}),B.value.map((X,ce)=>{function ke(me){me.stopPropagation(),me.preventDefault(),xe(X,!1)}const fe={"onClick:close":ke,onKeydown(me){me.key!=="Enter"&&me.key!==" "||(me.preventDefault(),me.stopPropagation(),ke(me))},onMousedown(me){me.preventDefault(),me.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},Z=b.value?!!s.chip:!!s.selection,Ce=Z?va(b.value?s.chip({item:X,index:ce,props:fe}):s.selection({item:X,index:ce})):void 0;if(!(Z&&!Ce))return e("div",{key:X.value,class:["v-combobox__selection",ce===V.value&&["v-combobox__selection--selected",J.value]],style:ce===V.value?re.value:{}},[b.value?s.chip?e(fa,{key:"chip-defaults",defaults:{VChip:{closable:a.closableChips,size:"small",text:X.title}}},{default:()=>[Ce]}):e(oe,ue({key:"chip",closable:a.closableChips,size:"small",text:X.title,disabled:X.props.disabled},fe),null):Ce??e("span",{class:"v-combobox__selection-text"},[X.title,a.multiple&&ce<B.value.length-1&&e("span",{class:"v-combobox__selection-comma"},[h(",")])])])})]),"append-inner":function(){var fe,Z;for(var X=arguments.length,ce=new Array(X),ke=0;ke<X;ke++)ce[ke]=arguments[ke];return e(Ie,null,[(fe=s["append-inner"])==null?void 0:fe.call(s,...ce),(!a.hideNoData||a.items.length)&&a.menuIcon?e(U,{class:"v-combobox__menu-icon",color:(Z=y.value)==null?void 0:Z.fieldIconColor,icon:a.menuIcon,onMousedown:te,onClick:ma,"aria-label":P(_.value),title:P(_.value),tabindex:"-1"},null):void 0])}})}),Et({isFocused:g,isPristine:m,menu:x,search:Y,selectionIndex:V,filteredItems:d,select:xe},y)}}),bt=Symbol.for("vuetify:v-tabs"),gl=Ee({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...gt(pa({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),pt=Be()({name:"VTab",props:gl(),setup(a,C){let{slots:f,attrs:s}=C;const{textColorClasses:P,textColorStyles:y}=Ut(()=>a.sliderColor),g=O(),m=O(),r=ee(()=>a.direction==="horizontal"),o=ee(()=>{var V,E;return((E=(V=g.value)==null?void 0:V.group)==null?void 0:E.isSelected.value)??!1});function D(V){var j,I;let{value:E}=V;if(E){const w=(I=(j=g.value)==null?void 0:j.$el.parentElement)==null?void 0:I.querySelector(".v-tab--selected .v-tab__slider"),J=m.value;if(!w||!J)return;const re=getComputedStyle(w).color,B=w.getBoundingClientRect(),R=J.getBoundingClientRect(),b=r.value?"x":"y",z=r.value?"X":"Y",W=r.value?"right":"bottom",Y=r.value?"width":"height",K=B[b],d=R[b],k=K>d?B[W]-R[W]:B[b]-R[b],i=Math.sign(k)>0?r.value?"right":"bottom":Math.sign(k)<0?r.value?"left":"top":"center",Q=(Math.abs(k)+(Math.sign(k)<0?B[Y]:R[Y]))/Math.max(B[Y],R[Y])||0,x=B[Y]/R[Y]||0,_=1.5;Wa(J,{backgroundColor:[re,"currentcolor"],transform:[`translate${z}(${k}px) scale${z}(${x})`,`translate${z}(${k/_}px) scale${z}(${(Q-1)/_+1})`,"none"],transformOrigin:Array(3).fill(i)},{duration:225,easing:Ga})}}return Re(()=>{const V=H.filterProps(a);return e(H,ue({symbol:bt,ref:g,class:["v-tab",a.class],style:a.style,tabindex:o.value?0:-1,role:"tab","aria-selected":String(o.value),active:!1},V,s,{block:a.fixed,maxWidth:a.fixed?300:void 0,"onGroup:selected":D}),{...f,default:()=>{var E;return e(Ie,null,[((E=f.default)==null?void 0:E.call(f))??a.text,!a.hideSlider&&e("div",{ref:m,class:["v-tab__slider",P.value],style:y.value},null)])}})}),Et({},g)}}),kl=Ee({...gt(Kt(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),bl=Be()({name:"VTabsWindow",props:kl(),emits:{"update:modelValue":a=>!0},setup(a,C){let{slots:f}=C;const s=zt(bt,null),P=Ye(a,"modelValue"),y=ee({get(){var g;return P.value!=null||!s?P.value:(g=s.items.value.find(m=>s.selected.value.includes(m.id)))==null?void 0:g.value},set(g){P.value=g}});return Re(()=>{const g=ft.filterProps(a);return e(ft,ue({_as:"VTabsWindow"},g,{modelValue:y.value,"onUpdate:modelValue":m=>y.value=m,class:["v-tabs-window",a.class],style:a.style,mandatory:!1,touch:!1}),f)}),{}}}),_l=Ee({...Lt()},"VTabsWindowItem"),yl=Be()({name:"VTabsWindowItem",props:_l(),setup(a,C){let{slots:f}=C;return Re(()=>{const s=Ze.filterProps(a);return e(Ze,ue({_as:"VTabsWindowItem"},s,{class:["v-tabs-window-item",a.class],style:a.style}),f)}),{}}});function hl(a){return a?a.map(C=>ya(C)?C:{text:C,value:C}):[]}const Vl=Ee({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Pa({mandatory:"force",selectedClass:"v-tab-item--selected"}),..._a(),...It()},"VTabs"),xl=Be()({name:"VTabs",props:Vl(),emits:{"update:modelValue":a=>!0},setup(a,C){let{attrs:f,slots:s}=C;const P=Ye(a,"modelValue"),y=ee(()=>hl(a.items)),{densityClasses:g}=ga(a),{backgroundColorClasses:m,backgroundColorStyles:r}=ka(()=>a.bgColor),{scopeId:o}=nl();return ba({VTab:{color:De(()=>a.color),direction:De(()=>a.direction),stacked:De(()=>a.stacked),fixed:De(()=>a.fixedTabs),sliderColor:De(()=>a.sliderColor),hideSlider:De(()=>a.hideSlider)}}),Re(()=>{const D=xt.filterProps(a),V=!!(s.window||a.items.length>0);return e(Ie,null,[e(xt,ue(D,{modelValue:P.value,"onUpdate:modelValue":E=>P.value=E,class:["v-tabs",`v-tabs--${a.direction}`,`v-tabs--align-tabs-${a.alignTabs}`,{"v-tabs--fixed-tabs":a.fixedTabs,"v-tabs--grow":a.grow,"v-tabs--stacked":a.stacked},g.value,m.value,a.class],style:[{"--v-tabs-height":rt(a.height)},r.value,a.style],role:"tablist",symbol:bt},o,f),{default:()=>{var E;return[((E=s.default)==null?void 0:E.call(s))??y.value.map(j=>{var I;return((I=s.tab)==null?void 0:I.call(s,{item:j}))??e(pt,ue(j,{key:j.text,value:j.value}),{default:s[`tab.${j.value}`]?()=>{var w;return(w=s[`tab.${j.value}`])==null?void 0:w.call(s,{item:j})}:void 0})})]}}),V&&e(bl,ue({modelValue:P.value,"onUpdate:modelValue":E=>P.value=E,key:"tabs-window"},o),{default:()=>{var E;return[y.value.map(j=>{var I;return((I=s.item)==null?void 0:I.call(s,{item:j}))??e(yl,{value:j.value},{default:()=>{var w;return(w=s[`item.${j.value}`])==null?void 0:w.call(s,{item:j})}})}),(E=s.window)==null?void 0:E.call(s)]}})])}),{}}}),Cl={class:"d-flex align-center gap-3"},Pl={class:"text-body-2 ma-0 opacity-90"},wl={class:"d-flex align-center gap-4"},Sl={class:"flex-grow-1"},$l={class:"text-h6 font-weight-bold mb-1"},Il={class:"text-body-2 text-medium-emphasis mb-1"},Dl={class:"text-body-2 text-medium-emphasis mb-0"},Tl={key:0,class:"text-center pa-8"},zl={class:"d-flex align-center gap-4 mt-1"},Ul={key:1,class:"text-primary"},Ml={class:"d-flex gap-2"},Al=Te({__name:"ProductCompositionDialog",props:{modelValue:{type:Boolean},product:{},items:{}},emits:["update:modelValue","save","refresh"],setup(a,{emit:C}){const f=a,s=C,P=ee({get:()=>f.modelValue,set:_=>s("update:modelValue",_)}),y=O(!1),g=O([]),m=O(!1),r=O(!1),o=O(""),D=O(""),V=O(!1),E=O(-1),j=O(!1),I=O({itemId:null,quantity:1,unit:"pcs",isCritical:!1}),w=O([]),J=O(!1),re=async()=>{var _;if(f.product)try{const c=f.product.id_product||f.product.id;console.log("ðŸ”„ Fetching composition for product ID:",c);const q=await We.getAll({product_id:c,page:1,per_page:100});q.success&&((_=q.data)!=null&&_.data)&&(console.log("ðŸ“¦ Loaded composition items:",q.data.data),g.value=q.data.data)}catch(c){console.error("Error fetching product composition:",c)}},B=async()=>{var _;J.value=!0;try{const c=await Jt.getAll({page:1,per_page:100,active:!0});c.success&&((_=c.data)!=null&&_.data)&&(w.value=c.data.data.map(q=>{var v,n,u;return{id:((v=q.id_item)==null?void 0:v.toString())||((n=q.id)==null?void 0:n.toString()),name:q.name,current_stock:((u=q.inventory)==null?void 0:u.current_stock)||0,unit:q.unit||"pcs"}}))}catch(c){console.error("Error fetching available items:",c),w.value=[{id:"1",name:"Kopi Arabica",current_stock:100,unit:"kg"},{id:"2",name:"Susu Segar",current_stock:50,unit:"liter"},{id:"3",name:"Gula Pasir",current_stock:25,unit:"kg"},{id:"4",name:"Whipped Cream",current_stock:30,unit:"pcs"},{id:"5",name:"Sirup Vanilla",current_stock:20,unit:"botol"},{id:"6",name:"Tepung Terigu",current_stock:15,unit:"kg"},{id:"7",name:"Mentega",current_stock:10,unit:"pack"},{id:"8",name:"Coklat Powder",current_stock:8,unit:"kg"}]}finally{J.value=!1}},R=ee(()=>I.value.itemId&&I.value.quantity>0&&I.value.unit.trim().length>0),b=ee(()=>{if(!I.value.itemId)return null;const _=w.value.find(c=>c.id===I.value.itemId);return(_==null?void 0:_.unit)||null});_e(()=>I.value.itemId,_=>{if(_){const c=w.value.find(q=>q.id===_);c!=null&&c.unit&&(I.value.unit=c.unit)}}),_e(()=>f.items,_=>{g.value=[..._]},{immediate:!0}),_e(()=>f.modelValue,_=>{_&&f.product&&(console.log("ðŸ”„ Dialog opened, fetching composition..."),re())}),Qe(()=>{B()});const z=()=>{j.value=!0},W=()=>g.value.some(c=>{var q;return((q=c.item)==null?void 0:q.inventory)&&c.item.inventory.current_stock<c.quantity_needed})?"error":"success",Y=()=>g.value.some(c=>{var q;return((q=c.item)==null?void 0:q.inventory)&&c.item.inventory.current_stock<c.quantity_needed})?"Stok Kritis":"Stok Aman",K=()=>{if(!R.value)return;const _=w.value.find(v=>v.id===I.value.itemId);if(!_)return;if(g.value.find(v=>{var n;return((n=v.item)==null?void 0:n.id)===_.id})){o.value=`Item "${_.name}" sudah ada dalam komposisi produk ini`,m.value=!0;return}const q={id_product_item:`temp_${Date.now()}`,item:{id:_.id,name:_.name,inventory:{current_stock:_.current_stock}},quantity_needed:I.value.quantity,unit:I.value.unit,is_critical:I.value.isCritical};g.value.push(q),i()},d=(_,c)=>{var q;V.value=!0,E.value=c,I.value={itemId:((q=_.item)==null?void 0:q.id)||null,quantity:_.quantity_needed,unit:_.unit,isCritical:_.is_critical}},k=()=>{if(!R.value||E.value===-1)return;const _=w.value.find(c=>c.id===I.value.itemId);_&&(g.value[E.value]={...g.value[E.value],item:{id:_.id,name:_.name,inventory:{current_stock:_.current_stock}},quantity_needed:I.value.quantity,unit:I.value.unit,is_critical:I.value.isCritical},i())},i=()=>{V.value=!1,E.value=-1,I.value={itemId:null,quantity:1,unit:"pcs",isCritical:!1}},T=_=>{g.value.splice(_,1)},Q=async()=>{var _,c,q,v;if(f.product){y.value=!0;try{console.log("ðŸ’¾ Saving composition for product:",f.product.name),console.log("ðŸ“¦ Items to save:",g.value);const n=f.product.id_product||f.product.id,u=f.items||[],ge=g.value;for(const te of ge){const ye=u.find(he=>he.id_product_item===te.id_product_item),ve={product_id:n,item_id:parseInt(((_=te.item)==null?void 0:_.id)||"0"),quantity_needed:te.quantity_needed,unit:te.unit,is_critical:te.is_critical,notes:te.notes||""};console.log("ðŸ“¤ API Data:",ve);try{ye&&!((c=te.id_product_item)!=null&&c.toString().startsWith("temp_"))?(console.log("âœï¸ Updating item:",ye.id_product_item),await We.update(ye.id_product_item,ve)):(console.log("âž• Creating new item"),await We.create(ve))}catch(he){throw console.error("âŒ Error processing item:",he),(q=he.message)!=null&&q.includes("already assigned")?o.value=`Item "${(v=te.item)==null?void 0:v.name}" sudah ditambahkan ke produk ini`:o.value=he.message||"Terjadi kesalahan saat menyimpan item",m.value=!0,he}}for(const te of u)if(!ge.find(ve=>ve.id_product_item===te.id_product_item)&&te.id_product_item)try{console.log("ðŸ—‘ï¸ Deleting item:",te.id_product_item),await We.delete(te.id_product_item)}catch(ve){console.error("âŒ Error deleting item:",ve),o.value=`Gagal menghapus item: ${ve.message}`,m.value=!0}console.log("âœ… Composition saved successfully!"),D.value="Komposisi produk berhasil disimpan!",r.value=!0,s("save",{product:f.product,items:g.value}),s("refresh"),x()}catch(n){console.error("âŒ Error saving composition:",n),m.value||(o.value=n.message||"Terjadi kesalahan saat menyimpan komposisi",m.value=!0)}finally{y.value=!1}}},x=()=>{P.value=!1,setTimeout(()=>{g.value=[...f.items],i()},300)};return(_,c)=>{var q,v,n;return $(),ne(Ie,null,[e(Le,{modelValue:P.value,"onUpdate:modelValue":c[9]||(c[9]=u=>P.value=u),"max-width":"900",persistent:""},{default:t(()=>[e(le,null,{default:t(()=>[e(Ve,{class:"d-flex align-center justify-between bg-primary text-white"},{default:t(()=>{var u;return[l("div",Cl,[e(U,{icon:"mdi-chef-hat",size:"24"}),l("div",null,[c[13]||(c[13]=l("h3",{class:"text-h6 font-weight-bold"},"Kelola Komposisi Item",-1)),l("p",Pl,p(((u=_.product)==null?void 0:u.name)||"Produk"),1)])]),e(H,{icon:"mdi-close",variant:"text",size:"small",onClick:x})]}),_:1}),e(ie,{class:"pa-6"},{default:t(()=>[e(le,{variant:"tonal",class:"mb-6"},{default:t(()=>[e(ie,{class:"pa-4"},{default:t(()=>{var u,ge,te,ye,ve;return[l("div",wl,[e(be,{image:(u=_.product)==null?void 0:u.image_url,size:"64"},{default:t(()=>{var he;return[(he=_.product)!=null&&he.image_url?N("",!0):($(),F(U,{key:0,icon:"mdi-coffee"}))]}),_:1},8,["image"]),l("div",Sl,[l("h4",$l,p((ge=_.product)==null?void 0:ge.name),1),l("p",Il," SKU: "+p(((te=_.product)==null?void 0:te.sku)||"SKU-"+((ye=_.product)==null?void 0:ye.id_product)),1),l("p",Dl," Harga: "+p(A(Ge)(((ve=_.product)==null?void 0:ve.price)||0)),1)]),e(oe,{color:W(),variant:"tonal"},{default:t(()=>[h(p(Y()),1)]),_:1},8,["color"])])]}),_:1})]),_:1}),e(le,{class:"mb-6",elevation:"2"},{default:t(()=>[e(Ve,{class:"bg-grey-lighten-4 py-3"},{default:t(()=>[e(U,{icon:V.value?"mdi-pencil-circle":"mdi-plus-circle",class:"me-2"},null,8,["icon"]),h(" "+p(V.value?"Edit Item Komposisi":"Tambah Item Komposisi"),1)]),_:1}),e(ie,{class:"pa-4"},{default:t(()=>[e(we,null,{default:t(()=>[e(M,{cols:"12",md:"4"},{default:t(()=>[e(wa,{modelValue:I.value.itemId,"onUpdate:modelValue":c[0]||(c[0]=u=>I.value.itemId=u),items:w.value,loading:J.value,"item-title":"name","item-value":"id",label:"Pilih Item",placeholder:"Cari item...","prepend-inner-icon":"mdi-magnify",variant:"outlined",clearable:""},{item:t(({props:u,item:ge})=>[e(je,ha(Va(u)),{prepend:t(()=>[e(be,{size:"32",class:"me-3"},{default:t(()=>[e(U,{icon:"mdi-package-variant"})]),_:1})]),default:t(()=>[e(ct,null,{default:t(()=>[h(p(ge.raw.name),1)]),_:2},1024),e(mt,null,{default:t(()=>[h(" Stok: "+p(ge.raw.current_stock)+" "+p(ge.raw.unit),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","loading"])]),_:1}),e(M,{cols:"12",md:"2"},{default:t(()=>[e(pe,{modelValue:I.value.quantity,"onUpdate:modelValue":c[1]||(c[1]=u=>I.value.quantity=u),modelModifiers:{number:!0},type:"number",label:"Jumlah",variant:"outlined",min:"0",step:"0.01"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"2"},{default:t(()=>[e(pe,{modelValue:I.value.unit,"onUpdate:modelValue":c[2]||(c[2]=u=>I.value.unit=u),label:"Satuan",variant:"outlined",placeholder:"kg, pcs, ml",readonly:!!b.value,hint:b.value?`Satuan dari item: ${b.value}`:"","persistent-hint":""},null,8,["modelValue","readonly","hint"])]),_:1}),e(M,{cols:"12",md:"2"},{default:t(()=>[e(vt,{modelValue:I.value.isCritical,"onUpdate:modelValue":c[3]||(c[3]=u=>I.value.isCritical=u),label:"Item Kritis",color:"error","hide-details":""},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"2"},{default:t(()=>[e(H,{color:V.value?"success":"primary",block:"","prepend-icon":V.value?"mdi-check":"mdi-plus",onClick:c[4]||(c[4]=u=>V.value?k():K()),disabled:!R.value},{default:t(()=>[h(p(V.value?"Update":"Tambah"),1)]),_:1},8,["color","prepend-icon","disabled"]),V.value?($(),F(H,{key:0,color:"error",variant:"outlined",block:"","prepend-icon":"mdi-close",class:"mt-2",onClick:i},{default:t(()=>c[14]||(c[14]=[h(" Batal ")])),_:1,__:[14]})):N("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(le,{elevation:"2"},{default:t(()=>[e(Ve,{class:"bg-grey-lighten-4 py-3"},{default:t(()=>[e(U,{icon:"mdi-format-list-bulleted",class:"me-2"}),h(" Daftar Item Komposisi ("+p(g.value.length)+") ",1)]),_:1}),e(ie,{class:"pa-0"},{default:t(()=>[g.value.length===0?($(),ne("div",Tl,[e(U,{icon:"mdi-package-variant-closed",size:"64",class:"text-disabled mb-4"}),c[15]||(c[15]=l("h4",{class:"text-h6 mb-2"},"Belum ada item komposisi",-1)),c[16]||(c[16]=l("p",{class:"text-body-2 text-medium-emphasis"}," Tambahkan item yang dibutuhkan untuk membuat produk ini ",-1))])):($(),F(kt,{key:1},{default:t(()=>[($(!0),ne(Ie,null,Xe(g.value,(u,ge)=>($(),F(je,{key:u.id||ge,class:"border-b"},{prepend:t(()=>[e(be,{size:"40",class:"me-3"},{default:t(()=>{var te,ye;return[e(U,{icon:(te=u.item)!=null&&te.inventory&&u.item.inventory.current_stock>=u.quantity_needed?"mdi-check-circle":"mdi-alert-circle",color:(ye=u.item)!=null&&ye.inventory&&u.item.inventory.current_stock>=u.quantity_needed?"success":"error"},null,8,["icon","color"])]}),_:2},1024)]),append:t(()=>[l("div",Ml,[e(H,{icon:"mdi-pencil",variant:"text",size:"small",color:"primary",onClick:te=>d(u,ge)},null,8,["onClick"]),e(H,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:te=>T(ge)},null,8,["onClick"])])]),default:t(()=>[e(ct,{class:"font-weight-medium"},{default:t(()=>{var te;return[h(p(((te=u.item)==null?void 0:te.name)||"Item tidak ditemukan")+" ",1),u.is_critical?($(),F(oe,{key:0,color:"error",size:"x-small",variant:"tonal",class:"ms-2"},{default:t(()=>c[17]||(c[17]=[h(" Kritis ")])),_:1,__:[17]})):N("",!0)]}),_:2},1024),e(mt,null,{default:t(()=>{var te;return[l("div",zl,[l("span",null,"Dibutuhkan: "+p(u.quantity_needed)+" "+p(u.unit),1),(te=u.item)!=null&&te.inventory?($(),ne("span",{key:0,class:ut(u.item.inventory.current_stock>=u.quantity_needed?"text-success":"text-error")}," Stok: "+p(u.item.inventory.current_stock)+" "+p(u.unit),3)):N("",!0),u.formatted_total_cost?($(),ne("span",Ul,p(u.formatted_total_cost),1)):N("",!0)])]}),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(Oe,{class:"pa-6 pt-0"},{default:t(()=>[e(H,{color:"warning",variant:"outlined","prepend-icon":"mdi-calculator",onClick:z},{default:t(()=>c[18]||(c[18]=[h(" Setting HPP ")])),_:1,__:[18]}),e(et),e(H,{variant:"outlined",onClick:x},{default:t(()=>c[19]||(c[19]=[h(" Batal ")])),_:1,__:[19]}),e(H,{color:"primary",onClick:Q,loading:y.value},{default:t(()=>c[20]||(c[20]=[h(" Simpan Komposisi ")])),_:1,__:[20]},8,["loading"])]),_:1})]),_:1}),e(Je,{modelValue:m.value,"onUpdate:modelValue":c[6]||(c[6]=u=>m.value=u),color:"error",location:"top",timeout:5e3},{actions:t(()=>[e(H,{color:"white",variant:"text",onClick:c[5]||(c[5]=u=>m.value=!1)},{default:t(()=>c[21]||(c[21]=[h(" Tutup ")])),_:1,__:[21]})]),default:t(()=>[h(p(o.value)+" ",1)]),_:1},8,["modelValue"]),e(Je,{modelValue:r.value,"onUpdate:modelValue":c[8]||(c[8]=u=>r.value=u),color:"success",location:"top",timeout:3e3},{actions:t(()=>[e(H,{color:"white",variant:"text",onClick:c[7]||(c[7]=u=>r.value=!1)},{default:t(()=>c[22]||(c[22]=[h(" Tutup ")])),_:1,__:[22]})]),default:t(()=>[h(p(D.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),e(Zt,{modelValue:j.value,"onUpdate:modelValue":c[10]||(c[10]=u=>j.value=u),"product-id":((q=_.product)==null?void 0:q.id_product)||((v=_.product)==null?void 0:v.id),"product-name":(n=_.product)==null?void 0:n.product_name,onHppUpdated:c[11]||(c[11]=u=>s("refresh")),onPriceUpdated:c[12]||(c[12]=u=>s("refresh"))},null,8,["modelValue","product-id","product-name"])],64)}}}),Ot=ze(Al,[["__scopeId","data-v-00c84096"]]),Bl={class:"composition-cards"},El={key:1,class:"text-center pa-12"},Rl={key:2,class:"text-center pa-12"},Hl={class:"d-flex align-center gap-3"},Fl={class:"flex-grow-1 min-width-0"},Kl={class:"text-h6 font-weight-bold text-truncate"},Ll={class:"text-caption text-medium-emphasis mb-0"},Ol={class:"d-flex align-center gap-2 mb-3"},jl={class:"text-body-2 font-weight-medium"},ql={class:"composition-items"},Nl={class:"d-flex align-center gap-2 flex-grow-1 min-width-0"},Wl={class:"text-body-2 text-truncate"},Gl={class:"text-end flex-shrink-0"},Xl={class:"text-body-2 font-weight-medium"},Yl={key:0,class:"text-caption text-success"},Jl={key:1,class:"text-caption text-primary"},Zl={class:"d-flex justify-between align-center mb-3"},Ql={class:"text-h6 font-weight-bold text-primary"},eo={class:"d-flex gap-2"},to={class:"d-flex align-center"},ao={class:"d-flex align-center gap-4"},lo={class:"flex-grow-1"},oo={class:"text-h5 font-weight-bold mb-2"},so={class:"d-flex align-center gap-4 mb-2"},no={class:"text-body-2"},io={class:"text-h6 text-primary font-weight-bold"},ro={class:"d-flex align-center mt-1 gap-4"},uo={class:"d-flex align-center"},co={class:"d-flex align-center"},mo={key:0,class:"d-flex align-center"},vo={class:"text-primary font-weight-medium"},fo={key:1,class:"text-center py-8"},po={class:"text-h6 font-weight-bold"},go={class:"text-h6 font-weight-bold"},ko={class:"text-h6 font-weight-bold"},bo=Te({__name:"ProductCompositionCards",props:{productItems:{},loading:{type:Boolean}},emits:["refresh","edit-composition","view-details"],setup(a,{emit:C}){const f=a,s=C,P=O(!1),y=O(!1),g=O(null),m=O([]),r=O(null),o=O({search:"",stockStatus:"",itemType:"",criticalOnly:!1,sortBy:"name_asc"}),D=[{title:"Semua Status",value:""},{title:"Stok Aman",value:"safe"},{title:"Stok Kritis",value:"critical"},{title:"Stok Habis",value:"out"}],V=[{title:"Nama A-Z",value:"name_asc"},{title:"Nama Z-A",value:"name_desc"},{title:"Harga Tertinggi",value:"price_desc"},{title:"Harga Terendah",value:"price_asc"},{title:"Item Terbanyak",value:"items_desc"},{title:"Item Tersedikit",value:"items_asc"}],E=K=>{g.value=K,m.value=K.items||[],P.value=!0},j=K=>{r.value=K,y.value=!0},I=K=>{console.log("Composition saved:",K),s("refresh")},w=()=>{o.value={search:"",stockStatus:"",itemType:"",criticalOnly:!1,sortBy:"name_asc"}},J=ee(()=>!!(o.value.search||o.value.stockStatus||o.value.itemType||o.value.criticalOnly||o.value.sortBy!=="name_asc")),re=ee(()=>{let K=0;return o.value.search&&K++,o.value.stockStatus&&K++,o.value.itemType&&K++,o.value.criticalOnly&&K++,o.value.sortBy!=="name_asc"&&K++,K}),B=ee(()=>{const K=new Map;f.productItems.forEach(k=>{if(!k.product)return;const i=k.product.id_product||k.product.id;K.has(i)||K.set(i,{...k.product,items:[],totalItems:0}),K.get(i).items.push(k),K.get(i).totalItems++});let d=Array.from(K.values());if(o.value.search){const k=o.value.search.toLowerCase();d=d.filter(i=>i.name.toLowerCase().includes(k)||i.sku&&i.sku.toLowerCase().includes(k)||i.items.some(T=>{var Q;return(Q=T.item)==null?void 0:Q.name.toLowerCase().includes(k)}))}return o.value.stockStatus&&(d=d.filter(k=>{const i=R(k);switch(o.value.stockStatus){case"safe":return i.color==="success";case"critical":return i.color==="warning";case"out":return i.color==="error";default:return!0}})),o.value.criticalOnly&&(d=d.filter(k=>k.items.some(i=>i.is_critical))),d.sort((k,i)=>{switch(o.value.sortBy){case"name_asc":return k.name.localeCompare(i.name);case"name_desc":return i.name.localeCompare(k.name);case"price_asc":return(k.price||0)-(i.price||0);case"price_desc":return(i.price||0)-(k.price||0);case"items_asc":return k.totalItems-i.totalItems;case"items_desc":return i.totalItems-k.totalItems;default:return k.name.localeCompare(i.name)}}),d}),R=K=>{let d=!1,k=!1;return K.items.forEach(i=>{var T;if((T=i.item)!=null&&T.inventory){const Q=i.item.inventory.current_stock||0,x=i.quantity_needed||0;Q<=0?d=!0:(Q<x||i.is_critical)&&(k=!0)}}),d?{text:"Stok Habis",color:"error"}:k?{text:"Stok Kritis",color:"warning"}:{text:"Stok Aman",color:"success"}},b=K=>{if(!(K!=null&&K.inventory))return"grey";const d=K.inventory.current_stock||0;return d<=0?"error":d<=10?"warning":"success"},z=K=>{if(!(K!=null&&K.inventory))return"Tidak ada data";const d=K.inventory.current_stock||0;return d<=0?"Habis":d<=10?"Rendah":"Aman"},W=K=>{const d=b(K);return{"text-error":d==="error","text-warning":d==="warning","text-success":d==="success","text-grey":d==="grey"}},Y=K=>`Item Komposisi (${K})`;return(K,d)=>($(),ne("div",Bl,[e(le,{class:"mb-6"},{default:t(()=>[e(Ve,{class:"d-flex align-center justify-between"},{default:t(()=>[d[12]||(d[12]=l("div",null,[l("h2",{class:"text-h5 font-weight-bold"},"Komposisi Produk"),l("p",{class:"text-body-2 text-medium-emphasis"}," Kelola komposisi bahan untuk setiap produk ")],-1)),e(H,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:d[0]||(d[0]=k=>s("refresh")),loading:K.loading},{default:t(()=>d[11]||(d[11]=[h(" Refresh ")])),_:1,__:[11]},8,["loading"])]),_:1,__:[12]})]),_:1}),e(le,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(ie,null,{default:t(()=>[e(we,null,{default:t(()=>[e(M,{cols:"12",md:"3"},{default:t(()=>[e(pe,{modelValue:o.value.search,"onUpdate:modelValue":d[1]||(d[1]=k=>o.value.search=k),label:"Cari Produk",placeholder:"Nama produk, SKU, atau item...",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"3"},{default:t(()=>[e(Se,{modelValue:o.value.stockStatus,"onUpdate:modelValue":d[2]||(d[2]=k=>o.value.stockStatus=k),items:D,label:"Status Stok",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-chart-line","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"3"},{default:t(()=>[e(Se,{modelValue:o.value.sortBy,"onUpdate:modelValue":d[3]||(d[3]=k=>o.value.sortBy=k),items:V,label:"Urutkan",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-sort","hide-details":""},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"3",class:"d-flex align-center"},{default:t(()=>[e(Ma,{modelValue:o.value.criticalOnly,"onUpdate:modelValue":d[4]||(d[4]=k=>o.value.criticalOnly=k),label:"Hanya Item Kritis",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(we,{class:"mt-3"},{default:t(()=>[e(M,{cols:"12",md:"6",class:"d-flex align-center gap-2"},{default:t(()=>[e(H,{variant:"outlined",color:"grey",size:"small","prepend-icon":"mdi-filter-off",onClick:w,disabled:!J.value},{default:t(()=>d[13]||(d[13]=[h(" Reset Filter ")])),_:1,__:[13]},8,["disabled"]),J.value?($(),F(oe,{key:0,color:"primary",variant:"tonal",size:"small"},{default:t(()=>[h(p(re.value)+" filter aktif ",1)]),_:1})):N("",!0)]),_:1}),e(M,{cols:"12",md:"6",class:"d-flex align-center justify-end"},{default:t(()=>[e(oe,{color:B.value.length>0?"success":"default",variant:"tonal","prepend-icon":"mdi-package-variant"},{default:t(()=>[h(p(B.value.length)+" Produk dengan Komposisi ",1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),!K.loading&&B.value.length===0&&J.value?($(),F(Me,{key:0,type:"info",variant:"outlined",class:"mb-6",title:"Tidak ada hasil",text:"Tidak ada produk yang sesuai dengan filter yang dipilih. Coba ubah filter pencarian."})):N("",!0),K.loading?($(),ne("div",El,[e(Mt,{color:"primary",indeterminate:"",size:"64"}),d[14]||(d[14]=l("div",{class:"mt-4 text-h6"},"Memuat komposisi...",-1))])):B.value.length===0?($(),ne("div",Rl,[e(U,{icon:"mdi-chef-hat-off",size:"96",class:"text-disabled mb-6"}),d[16]||(d[16]=l("h3",{class:"text-h5 font-weight-bold mb-4"},"Belum Ada Komposisi Produk",-1)),d[17]||(d[17]=l("p",{class:"text-body-1 text-medium-emphasis mb-6"}," Buat komposisi untuk produk Anda agar dapat melihat detail bahan yang dibutuhkan ",-1)),e(H,{color:"primary",size:"large","prepend-icon":"mdi-plus"},{default:t(()=>d[15]||(d[15]=[h(" Buat Komposisi Pertama ")])),_:1,__:[15]})])):($(),F(we,{key:3},{default:t(()=>[($(!0),ne(Ie,null,Xe(B.value,k=>($(),F(M,{key:k.id_product,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(le,{class:ut(["composition-card h-100",{"border-error":R(k).color==="error"}]),elevation:"2"},{default:t(()=>[e(Ve,{class:"pa-4 pb-2"},{default:t(()=>[l("div",Hl,[e(be,{image:k.image_url,size:"48",class:"flex-shrink-0"},{default:t(()=>[k.image_url?N("",!0):($(),F(U,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"]),l("div",Fl,[l("h3",Kl,p(k.name),1),l("p",Ll,p(k.sku||"SKU-"+k.id_product),1)])])]),_:2},1024),e(ie,{class:"py-2"},{default:t(()=>[e(oe,{color:R(k).color,size:"small",variant:"tonal",class:"mb-3"},{default:t(()=>[h(p(R(k).text),1)]),_:2},1032,["color"]),l("div",Ol,[e(U,{icon:"mdi-format-list-bulleted",size:"16"}),l("span",jl,p(Y(k.totalItems)),1)]),l("div",ql,[($(!0),ne(Ie,null,Xe(k.items,i=>{var T,Q,x,_;return $(),ne("div",{key:i.id_product_item,class:"composition-item d-flex align-center justify-between mb-2"},[l("div",Nl,[e(U,{icon:(T=i.item)!=null&&T.inventory&&i.item.inventory.current_stock>=i.quantity_needed?"mdi-check-circle":"mdi-alert-circle",color:(Q=i.item)!=null&&Q.inventory&&i.item.inventory.current_stock>=i.quantity_needed?"success":"error",size:"16"},null,8,["icon","color"]),l("span",Wl,p(((x=i.item)==null?void 0:x.name)||"Item tidak ditemukan"),1),i.is_critical?($(),F(oe,{key:0,color:"error",size:"x-small",variant:"tonal"},{default:t(()=>d[18]||(d[18]=[h(" Kritis ")])),_:1,__:[18]})):N("",!0)]),l("div",Gl,[l("div",Xl,p(i.quantity_needed)+" "+p(i.unit),1),(_=i.item)!=null&&_.inventory?($(),ne("div",Yl," Stok: "+p(i.item.inventory.current_stock)+" "+p(i.unit),1)):N("",!0),i.formatted_total_cost?($(),ne("div",Jl,p(i.formatted_total_cost),1)):N("",!0)])])}),128))])]),_:2},1024),e(ie,{class:"pt-0"},{default:t(()=>[e($e,{class:"mb-3"}),l("div",Zl,[d[19]||(d[19]=l("span",{class:"text-body-2"},"Harga:",-1)),l("span",Ql,p(A(Ge)(k.price||0)),1)]),e(H,{block:"",variant:"outlined",color:"secondary",size:"small","prepend-icon":"mdi-calculator",class:"mb-2"},{default:t(()=>d[20]||(d[20]=[h(" Setting HPP ")])),_:1,__:[20]}),l("div",eo,[e(H,{color:"primary",size:"small","prepend-icon":"mdi-eye",onClick:i=>j(k)},{default:t(()=>d[21]||(d[21]=[h(" Detail ")])),_:2,__:[21]},1032,["onClick"]),e(H,{color:"secondary",variant:"outlined",size:"small","prepend-icon":"mdi-cog",onClick:i=>E(k)},{default:t(()=>d[22]||(d[22]=[h(" Kelola ")])),_:2,__:[22]},1032,["onClick"])])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})),e(Ot,{modelValue:P.value,"onUpdate:modelValue":d[5]||(d[5]=k=>P.value=k),product:g.value,items:m.value,onSave:I,onRefresh:d[6]||(d[6]=k=>s("refresh"))},null,8,["modelValue","product","items"]),e(Le,{modelValue:y.value,"onUpdate:modelValue":d[10]||(d[10]=k=>y.value=k),"max-width":"900",scrollable:""},{default:t(()=>[e(le,null,{default:t(()=>[e(Ve,{class:"d-flex align-center justify-space-between"},{default:t(()=>[l("div",to,[e(U,{icon:"mdi-eye",class:"mr-2",color:"primary"}),d[23]||(d[23]=l("span",null,"Detail Komposisi Produk",-1))]),e(H,{icon:"",variant:"text",onClick:d[7]||(d[7]=k=>y.value=!1)},{default:t(()=>[e(U,{icon:"mdi-close"})]),_:1})]),_:1}),e($e),r.value?($(),F(ie,{key:0},{default:t(()=>[e(Aa,null,{default:t(()=>[e(we,null,{default:t(()=>[e(M,{cols:"12"},{default:t(()=>[e(le,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(ie,null,{default:t(()=>[l("div",ao,[e(be,{image:r.value.image_url,size:"80"},{default:t(()=>[r.value.image_url?N("",!0):($(),F(U,{key:0,icon:"mdi-coffee",size:"40"}))]),_:1},8,["image"]),l("div",lo,[l("h2",oo,p(r.value.name),1),l("div",so,[e(oe,{color:R(r.value).color,variant:"tonal",size:"small"},{default:t(()=>[h(p(R(r.value).text),1)]),_:1},8,["color"]),l("span",no,"SKU: "+p(r.value.sku||"-"),1)]),l("div",io,p(A(Ge)(r.value.price||0)),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(we,null,{default:t(()=>[e(M,{cols:"12"},{default:t(()=>[e(le,{variant:"outlined"},{default:t(()=>[e(Ve,{class:"text-h6"},{default:t(()=>[e(U,{icon:"mdi-format-list-bulleted",class:"mr-2"}),h(" Komposisi Item ("+p(r.value.totalItems||0)+") ",1)]),_:1}),e(ie,null,{default:t(()=>[r.value.items&&r.value.items.length>0?($(),F(kt,{key:0},{default:t(()=>[($(!0),ne(Ie,null,Xe(r.value.items,(k,i)=>($(),F(je,{key:k.id_product_item,class:"px-0"},{prepend:t(()=>[e(be,{size:"40",color:b(k.item),variant:"tonal"},{default:t(()=>{var T;return[e(U,{icon:(T=k.item)!=null&&T.inventory&&k.item.inventory.current_stock>=k.quantity_needed?"mdi-check":"mdi-alert"},null,8,["icon"])]}),_:2},1032,["color"])]),append:t(()=>[e(oe,{color:b(k.item),variant:"tonal",size:"small"},{default:t(()=>[h(p(z(k.item)),1)]),_:2},1032,["color"])]),default:t(()=>[e(ct,{class:"font-weight-medium"},{default:t(()=>{var T;return[h(p(((T=k.item)==null?void 0:T.name)||"Unknown Item")+" ",1),k.is_critical?($(),F(oe,{key:0,color:"error",variant:"tonal",size:"x-small",class:"ml-2"},{default:t(()=>d[24]||(d[24]=[h(" Kritis ")])),_:1,__:[24]})):N("",!0)]}),_:2},1024),e(mt,null,{default:t(()=>{var T,Q;return[l("div",ro,[l("div",uo,[e(U,{icon:"mdi-scale",size:"14",class:"mr-1"}),l("span",null," Kebutuhan: "+p(Number(k.quantity_needed||0).toLocaleString("id-ID"))+" "+p(k.unit),1)]),l("div",co,[e(U,{icon:"mdi-warehouse",size:"14",class:"mr-1"}),l("span",{class:ut(W(k.item))}," Stok: "+p(Number(((Q=(T=k.item)==null?void 0:T.inventory)==null?void 0:Q.current_stock)||0).toLocaleString("id-ID"))+" "+p(k.unit),3)]),k.formatted_total_cost?($(),ne("div",mo,[e(U,{icon:"mdi-currency-usd",size:"14",class:"mr-1"}),l("span",vo,p(k.formatted_total_cost),1)])):N("",!0)])]}),_:2},1024),i<r.value.items.length-1?($(),F($e,{key:0,class:"mt-3"})):N("",!0)]),_:2},1024))),128))]),_:1})):($(),ne("div",fo,[e(U,{icon:"mdi-package-variant-closed",size:"48",color:"grey-lighten-1",class:"mb-2"}),d[25]||(d[25]=l("p",{class:"text-body-1 text-grey"}," Belum ada komposisi item untuk produk ini ",-1))]))]),_:1})]),_:1})]),_:1})]),_:1}),e(we,{class:"mt-4"},{default:t(()=>[e(M,{cols:"12",md:"4"},{default:t(()=>[e(le,{variant:"outlined",color:"primary"},{default:t(()=>[e(ie,{class:"text-center"},{default:t(()=>[e(U,{icon:"mdi-format-list-bulleted",size:"32",class:"mb-2"}),l("div",po,p(r.value.totalItems||0),1),d[26]||(d[26]=l("div",{class:"text-body-2"},"Total Item",-1))]),_:1,__:[26]})]),_:1})]),_:1}),e(M,{cols:"12",md:"4"},{default:t(()=>[e(le,{variant:"outlined",color:"warning"},{default:t(()=>[e(ie,{class:"text-center"},{default:t(()=>{var k;return[e(U,{icon:"mdi-alert",size:"32",class:"mb-2"}),l("div",go,p(((k=r.value.items)==null?void 0:k.filter(i=>i.is_critical).length)||0),1),d[27]||(d[27]=l("div",{class:"text-body-2"},"Item Kritis",-1))]}),_:1,__:[27]})]),_:1})]),_:1}),e(M,{cols:"12",md:"4"},{default:t(()=>[e(le,{variant:"outlined",color:"success"},{default:t(()=>[e(ie,{class:"text-center"},{default:t(()=>[e(U,{icon:"mdi-currency-usd",size:"32",class:"mb-2"}),l("div",ko,p(A(Ge)(r.value.price||0)),1),d[28]||(d[28]=l("div",{class:"text-body-2"},"Harga Jual",-1))]),_:1,__:[28]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):N("",!0),e($e),e(Oe,{class:"pa-4"},{default:t(()=>[e(et),e(H,{variant:"outlined",onClick:d[8]||(d[8]=k=>y.value=!1)},{default:t(()=>d[29]||(d[29]=[h(" Tutup ")])),_:1,__:[29]}),e(H,{color:"secondary",variant:"outlined","prepend-icon":"mdi-cog",onClick:d[9]||(d[9]=()=>{y.value=!1,E(r.value)})},{default:t(()=>d[30]||(d[30]=[h(" Kelola Komposisi ")])),_:1,__:[30]}),e(H,{color:"primary",variant:"elevated","prepend-icon":"mdi-calculator-variant"},{default:t(()=>d[31]||(d[31]=[h(" Setting HPP ")])),_:1,__:[31]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),_o=ze(bo,[["__scopeId","data-v-ea8193a3"]]),yo={class:"d-flex align-center gap-2"},ho={class:"text-white"},Vo={class:"text-h6 mb-4 d-flex align-center gap-2"},xo={class:"text-h6 mb-4 d-flex align-center gap-2"},Co={class:"d-flex flex-column gap-2"},Po={key:0,class:"d-flex align-center gap-2"},wo={class:"d-flex align-center gap-2 mb-2"},So={class:"d-flex gap-2"},$o={class:"d-flex gap-2"},Io={class:"d-flex align-center justify-space-between"},Do={class:"d-flex align-center gap-2"},To={class:"text-end"},zo={class:"text-h6 font-weight-bold"},Uo={class:"text-caption"},Mo={class:"text-h6 mb-4 d-flex align-center gap-2"},Ao={class:"text-h6 mb-4 d-flex align-center gap-2"},Bo={class:"image-upload-container"},Eo={key:0,class:"mb-4"},Ro={class:"text-center mt-2"},Ho={class:"text-h6 mb-4 d-flex align-center gap-2"},Fo={class:"text-h6 mb-4 d-flex align-center gap-2"},Ko={class:"d-flex align-center"},Lo={class:"text-subtitle-1"},Oo={class:"text-body-1"},jo={class:"d-flex align-center"},qo={class:"text-subtitle-1"},No=Te({__name:"ProductDialog",props:{modelValue:{type:Boolean},editMode:{type:Boolean},formData:{},categories:{},loading:{type:Boolean},errorMessage:{},successMessage:{},selectedImage:{},imagePreview:{},useDialogError:{type:Boolean}},emits:["update:modelValue","close","submit","image-change","remove-image","clear-error","clear-success","update-form"],setup(a,{emit:C}){var _,c,q;const f=At(),{nameRules:s,categoryRules:P}=Bt(),{getProductHPPBreakdown:y}=Qt(),g=O(!1),m=O(!1),r=async()=>{if(!(!V.editMode||!w.id))try{const v=await fetch(`/api/products/${w.id}/items`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(v.ok){const n=await v.json();m.value=n.success&&n.data&&n.data.length>0}}catch(v){console.error("Error checking HPP status:",v)}},o=async()=>{if(w.id)try{g.value=!0;const v=await y(w.id,"latest");v&&(w.cost=v.total_hpp,j("update-form","cost",v.total_hpp))}catch(v){console.error("Error refreshing HPP:",v)}finally{g.value=!1}},D=()=>{console.log("Open items setup for product:",w.id)},V=a,E=ee(()=>V.errorMessage),j=C,I=O(),w=dt({...V.formData});_e(()=>V.formData,v=>{Object.assign(w,v)},{deep:!0}),_e(w,v=>{Object.keys(v).forEach(n=>{j("update-form",n,v[n])})},{deep:!0}),_e(()=>V.modelValue,v=>{v&&V.editMode&&r()});const J=dt({length:((_=V.formData.dimensions)==null?void 0:_.length)||null,width:((c=V.formData.dimensions)==null?void 0:c.width)||null,height:((q=V.formData.dimensions)==null?void 0:q.height)||null});_e(J,v=>{const n=v.length!==null||v.width!==null||v.height!==null;w.dimensions=n?{length:v.length!==null?v.length:void 0,width:v.width!==null?v.width:void 0,height:v.height!==null?v.height:void 0}:{}},{deep:!0});const re=[{title:"Draft",value:"draft"},{title:"Published",value:"published"},{title:"Archived",value:"archived"}],B=ee(()=>{if(!w.price||!w.cost||w.cost<=0)return 0;const v=(w.price-w.cost)/w.cost*100;return Math.ceil(v)}),R=v=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(v),b=v=>v<10?"error":v<25?"warning":v<50?"success":"info",z=v=>v<10?"tabler-trending-down":v<25?"tabler-trending-up":v<50?"tabler-trending-up-2":"tabler-trending-up-3",W=v=>!v||v===0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(v),Y=v=>{if(!v||v.trim()===""||v==="Rp 0")return 0;const u=v.replace(/[^\d,.-]/g,"").replace(/\./g,"").replace(",",".");return parseFloat(u)||0},K=O(!1),d=v=>{const n=Y(v);w.price=n},k=()=>{K.value=!0},i=()=>{K.value=!1},T=async()=>{var n;const{valid:v}=await((n=I.value)==null?void 0:n.validate());v&&j("submit",w)},Q=v=>{j("image-change",v)},x=()=>{j("remove-image")};return(v,n)=>($(),F(Le,{"model-value":v.modelValue,"max-width":"900px",persistent:"",scrollable:"","onUpdate:modelValue":n[25]||(n[25]=u=>v.$emit("update:modelValue",u))},{default:t(()=>[e(le,{class:"product-dialog coffee-dialog"},{default:t(()=>[e(Ve,{class:"d-flex align-center justify-space-between coffee-header"},{default:t(()=>[l("div",yo,[e(U,{icon:v.editMode?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),l("span",ho,p(v.editMode?"Edit Produk":"Tambah Produk Baru"),1)]),e(H,{icon:"tabler-x",variant:"text",color:"white",onClick:n[0]||(n[0]=u=>v.$emit("close"))})]),_:1}),e($e),e(ie,{class:"pa-6"},{default:t(()=>[e(Ra,{ref_key:"formRef",ref:I,onSubmit:xa(T,["prevent"])},{default:t(()=>[e(we,null,{default:t(()=>[e(M,{cols:"12"},{default:t(()=>[l("h6",Vo,[e(U,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),n[26]||(n[26]=h(" Informasi Dasar "))])]),_:1}),e(M,{cols:"12",md:"8"},{default:t(()=>[e(pe,{modelValue:w.name,"onUpdate:modelValue":n[1]||(n[1]=u=>w.name=u),label:"Nama Produk",placeholder:"Masukkan nama produk",rules:A(s),required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(M,{cols:"12",md:"4"},{default:t(()=>[e(pe,{modelValue:w.sku,"onUpdate:modelValue":n[2]||(n[2]=u=>w.sku=u),label:"SKU",placeholder:"Auto generate jika kosong",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12"},{default:t(()=>[e(Pt,{modelValue:w.description,"onUpdate:modelValue":n[3]||(n[3]=u=>w.description=u),label:"Deskripsi Produk",placeholder:"Masukkan deskripsi produk",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"6"},{default:t(()=>[e(Se,{"model-value":w.category_id,"onUpdate:modelValue":n[4]||(n[4]=u=>w.category_id=u),items:v.categories,"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Pilih kategori",rules:A(P),required:"",variant:"outlined"},null,8,["model-value","items","rules"])]),_:1}),e(M,{cols:"12",md:"6"},{default:t(()=>[e(pe,{modelValue:w.brand,"onUpdate:modelValue":n[5]||(n[5]=u=>w.brand=u),label:"Brand/Merek",placeholder:"Masukkan brand produk",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12"},{default:t(()=>[l("h6",xo,[e(U,{icon:"tabler-currency-dollar",size:"20",class:"coffee-icon"}),n[27]||(n[27]=h(" Harga & Biaya "))])]),_:1}),e(M,{cols:"12",md:"6"},{default:t(()=>[e(pe,{"model-value":W(w.price),"onUpdate:modelValue":n[6]||(n[6]=u=>d(u)),label:"Harga Jual",placeholder:"Rp 0",required:"",variant:"outlined",onFocus:k,onBlur:i},null,8,["model-value"])]),_:1}),e(M,{cols:"12",md:"6"},{default:t(()=>[l("div",Co,[e(pe,{"model-value":W(w.cost),label:"Harga Pokok Penjualan (HPP)",placeholder:"Auto-calculated dari bahan baku",variant:"outlined",readonly:"","append-inner-icon":"mdi-calculator",hint:"HPP dihitung otomatis berdasarkan harga bahan baku","persistent-hint":""},null,8,["model-value"]),v.editMode?($(),ne("div",Po,[e(oe,{color:m.value?"success":"warning",size:"small",variant:"tonal"},{default:t(()=>[e(U,{icon:m.value?"tabler-calculator":"tabler-alert-circle",size:"14",class:"me-1"},null,8,["icon"]),h(" "+p(m.value?"Auto HPP Active":"Setup Required"),1)]),_:1},8,["color"]),m.value?($(),F(H,{key:0,size:"small",variant:"outlined",color:"primary",onClick:o,loading:g.value},{default:t(()=>[e(U,{icon:"tabler-refresh",size:"14",class:"me-1"}),n[28]||(n[28]=h(" Update HPP "))]),_:1,__:[28]},8,["loading"])):($(),F(Pe,{key:1},{activator:t(({props:u})=>[e(oe,ue(u,{color:"warning",size:"small",variant:"tonal"}),{default:t(()=>[e(U,{icon:"tabler-alert-circle",size:"14",class:"me-1"}),n[29]||(n[29]=h(" Belum Ada Resep "))]),_:2,__:[29]},1040)]),default:t(()=>[n[30]||(n[30]=l("span",null,"Setup resep produk untuk menghitung HPP otomatis",-1))]),_:1,__:[30]}))])):N("",!0)])]),_:1}),v.editMode?($(),F(M,{key:0,cols:"12"},{default:t(()=>[m.value?($(),F(Me,{key:0,color:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[e(Ct,null,{default:t(()=>[e(U,{icon:"tabler-info-circle",class:"me-2"}),n[31]||(n[31]=h(" HPP Otomatis Aktif "))]),_:1,__:[31]}),n[32]||(n[32]=l("div",{class:"mt-2"}," HPP produk ini dihitung otomatis berdasarkan item/bahan yang digunakan. Untuk mengubah HPP, silakan update harga item di menu Item Management. ",-1))]),_:1,__:[32]})):($(),F(Me,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[e(Ct,null,{default:t(()=>[e(U,{icon:"tabler-alert-triangle",class:"me-2"}),n[33]||(n[33]=h(" HPP Manual "))]),_:1,__:[33]}),n[34]||(n[34]=l("div",{class:"mt-2"}," Produk ini menggunakan HPP manual. Untuk perhitungan otomatis, tambahkan item/bahan yang digunakan untuk produk ini. ",-1))]),_:1,__:[34]}))]),_:1})):N("",!0),e(M,{cols:"12"},{default:t(()=>[m.value&&v.editMode?($(),F(Me,{key:0,color:"success",variant:"tonal",class:"mb-4"},{default:t(()=>[l("div",wo,[e(U,{icon:"tabler-check-circle"}),n[35]||(n[35]=l("span",{class:"font-weight-medium"},"HPP Otomatis Aktif",-1))]),n[38]||(n[38]=l("div",{class:"text-body-2 mb-3"}," Produk ini sudah memiliki resep dan HPP dihitung otomatis berdasarkan harga bahan baku terkini. HPP akan update secara otomatis saat harga bahan baku berubah. ",-1)),l("div",So,[e(H,{size:"small",color:"primary",variant:"outlined",onClick:D},{default:t(()=>[e(U,{icon:"tabler-edit",size:"14",class:"me-1"}),n[36]||(n[36]=h(" Edit Resep "))]),_:1,__:[36]}),e(H,{size:"small",variant:"outlined",color:"info",onClick:o,loading:g.value},{default:t(()=>[e(U,{icon:"tabler-refresh",size:"14",class:"me-1"}),n[37]||(n[37]=h(" Refresh HPP "))]),_:1,__:[37]},8,["loading"])])]),_:1,__:[38]})):!m.value&&v.editMode?($(),F(Me,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[l("div",$o,[e(H,{size:"small",variant:"outlined",color:"info",onClick:n[7]||(n[7]=u=>A(f).push("/hpp-management"))},{default:t(()=>[e(U,{icon:"tabler-calculator",size:"14",class:"me-1"}),n[39]||(n[39]=h(" Lihat HPP Management "))]),_:1,__:[39]})])]),_:1})):N("",!0)]),_:1}),e(M,{cols:"12"},{default:t(()=>[w.price&&w.cost&&w.cost>0?($(),F(Me,{key:0,color:b(B.value),variant:"tonal",class:"mb-0"},{default:t(()=>[l("div",Io,[l("div",Do,[e(U,{icon:z(B.value)},null,8,["icon"]),n[40]||(n[40]=l("span",{class:"font-weight-medium"},"Profit Margin",-1))]),l("div",To,[l("div",zo,p(Math.round(B.value))+"%",1),l("div",Uo," Keuntungan: "+p(R(w.price-w.cost)),1)])])]),_:1},8,["color"])):N("",!0)]),_:1}),e(M,{cols:"12"},{default:t(()=>[l("h6",Mo,[e(U,{icon:"tabler-ruler",size:"20",class:"coffee-icon"}),n[41]||(n[41]=h(" Dimensi (cm) "))])]),_:1}),e(M,{cols:"12",md:"4"},{default:t(()=>[e(pe,{modelValue:J.length,"onUpdate:modelValue":n[8]||(n[8]=u=>J.length=u),modelModifiers:{number:!0},label:"Panjang",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"4"},{default:t(()=>[e(pe,{modelValue:J.width,"onUpdate:modelValue":n[9]||(n[9]=u=>J.width=u),modelModifiers:{number:!0},label:"Lebar",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"4"},{default:t(()=>[e(pe,{modelValue:J.height,"onUpdate:modelValue":n[10]||(n[10]=u=>J.height=u),modelModifiers:{number:!0},label:"Tinggi",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12"},{default:t(()=>[l("h6",Ao,[e(U,{icon:"tabler-photo",size:"20",class:"coffee-icon"}),n[42]||(n[42]=h(" Gambar Produk "))])]),_:1}),e(M,{cols:"12"},{default:t(()=>[l("div",Bo,[v.imagePreview?($(),ne("div",Eo,[e(Ka,{src:v.imagePreview,"max-width":"200","max-height":"200",class:"mx-auto rounded"},null,8,["src"]),l("div",Ro,[e(H,{size:"small",color:"error",variant:"outlined",onClick:x},{default:t(()=>n[43]||(n[43]=[h(" Hapus Gambar ")])),_:1,__:[43]})])])):N("",!0),e(La,{"model-value":v.selectedImage,"onUpdate:modelValue":n[11]||(n[11]=u=>Q(Array.isArray(u)?u:[u])),label:"Upload Gambar","prepend-icon":"tabler-camera",accept:"image/*",variant:"outlined"},null,8,["model-value"]),n[44]||(n[44]=l("div",{class:"text-caption text-medium-emphasis mt-1"}," Format: JPG, JPEG, PNG, GIF. Maksimal 2MB. ",-1))])]),_:1}),e(M,{cols:"12"},{default:t(()=>[l("h6",Ho,[e(U,{icon:"tabler-settings",size:"20",class:"coffee-icon"}),n[45]||(n[45]=h(" Pengaturan "))])]),_:1}),e(M,{cols:"12",md:"4"},{default:t(()=>[e(Se,{"model-value":w.status,"onUpdate:modelValue":n[12]||(n[12]=u=>w.status=u),items:re,label:"Status Publikasi",variant:"outlined"},null,8,["model-value"])]),_:1}),e(M,{cols:"12",md:"4"},{default:t(()=>[e(vt,{"model-value":w.active,"onUpdate:modelValue":n[13]||(n[13]=u=>w.active=u??!1),label:"Produk Aktif",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(M,{cols:"12",md:"4"},{default:t(()=>[e(vt,{"model-value":w.featured,"onUpdate:modelValue":n[14]||(n[14]=u=>w.featured=u??!1),label:"Produk Unggulan",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(M,{cols:"12"},{default:t(()=>[l("h6",Fo,[e(U,{icon:"tabler-seo",size:"20",class:"coffee-icon"}),n[46]||(n[46]=h(" SEO (Opsional) "))])]),_:1}),e(M,{cols:"12"},{default:t(()=>[e(pe,{modelValue:w.meta_title,"onUpdate:modelValue":n[15]||(n[15]=u=>w.meta_title=u),label:"Meta Title",placeholder:"Judul untuk SEO",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12"},{default:t(()=>[e(Pt,{modelValue:w.meta_description,"onUpdate:modelValue":n[16]||(n[16]=u=>w.meta_description=u),label:"Meta Description",placeholder:"Deskripsi untuk SEO",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12"},{default:t(()=>[e(pl,{"model-value":w.tags,"onUpdate:modelValue":n[17]||(n[17]=u=>w.tags=u),label:"Tags",placeholder:"Tambah tag dan tekan Enter",multiple:"",chips:"",variant:"outlined"},null,8,["model-value"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e($e),e(Oe,{class:"pa-6"},{default:t(()=>[e(et),e(H,{variant:"outlined",class:"coffee-secondary",onClick:n[18]||(n[18]=u=>v.$emit("close"))},{default:t(()=>n[47]||(n[47]=[h(" Batal ")])),_:1,__:[47]}),e(H,{color:"primary",class:"coffee-primary",loading:v.loading,onClick:T},{default:t(()=>[h(p(v.editMode?"Perbarui":"Simpan")+" Produk ",1)]),_:1},8,["loading"])]),_:1})]),_:1}),v.useDialogError?N("",!0):($(),F(Je,{key:0,"model-value":!!E.value,"onUpdate:modelValue":n[20]||(n[20]=u=>!u&&v.$emit("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500"},{actions:t(()=>[e(H,{icon:"tabler-x",size:"small",variant:"text",onClick:n[19]||(n[19]=u=>v.$emit("clear-error"))})]),default:t(()=>[l("div",Ko,[e(U,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),l("div",null,[n[48]||(n[48]=l("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),l("div",Lo,p(E.value),1)])])]),_:1},8,["model-value"])),v.useDialogError?($(),F(Le,{key:1,"model-value":!!E.value,"onUpdate:modelValue":n[22]||(n[22]=u=>!u&&v.$emit("clear-error")),"max-width":"400",persistent:"",class:"error-dialog"},{default:t(()=>[e(le,null,{default:t(()=>[e(Ve,{class:"d-flex align-center text-error"},{default:t(()=>[e(U,{icon:"tabler-alert-circle",class:"me-2"}),n[49]||(n[49]=h(" Error Occurred "))]),_:1,__:[49]}),e($e),e(ie,{class:"py-4"},{default:t(()=>[l("div",Oo,p(E.value),1)]),_:1}),e($e),e(Oe,{class:"justify-end pa-4"},{default:t(()=>[e(H,{color:"error",variant:"outlined",onClick:n[21]||(n[21]=u=>v.$emit("clear-error"))},{default:t(()=>n[50]||(n[50]=[h(" Close ")])),_:1,__:[50]})]),_:1})]),_:1})]),_:1},8,["model-value"])):N("",!0),e(Je,{"model-value":!!v.successMessage,"onUpdate:modelValue":n[24]||(n[24]=u=>!u&&v.$emit("clear-success")),color:"success",location:"top right",timeout:4e3,vertical:"","min-width":"320","max-width":"500"},{actions:t(()=>[e(H,{icon:"tabler-x",size:"small",variant:"text",onClick:n[23]||(n[23]=u=>v.$emit("clear-success"))})]),default:t(()=>[l("div",jo,[e(U,{icon:"tabler-check-circle",class:"me-3",size:"28"}),l("div",null,[n[51]||(n[51]=l("div",{class:"text-h6 font-weight-bold"},"Berhasil!",-1)),l("div",qo,p(v.successMessage),1)])])]),_:1},8,["model-value"])]),_:1},8,["model-value"]))}}),Wo=ze(No,[["__scopeId","data-v-66fc4b3b"]]),Go={key:0,class:"mt-4"},Xo={class:"d-flex align-center gap-2 mb-2"},Yo={class:"d-flex flex-wrap gap-2"},Jo=Te({__name:"ProductSearchFilters",props:{filters:{}},emits:["update:filters","search"],setup(a,{emit:C}){const f=a,s=C,{categories:P,loading:y,fetchCategories:g}=Oa(),m=O(!1),r=O("");Qe(()=>{g(),r.value=o.search||""});const o=dt({...f.filters});_e(()=>f.filters,R=>{Object.assign(o,R),r.value=R.search||""},{deep:!0}),Ca(r,R=>{console.log("ðŸ” Search query changed:",R),o.search=R,R.length>=3||R.length===0?(console.log("âœ… Triggering search with query:",R),m.value=!0,s("search",R),I(),setTimeout(()=>{m.value=!1},500)):console.log("â³ Query too short, waiting for more characters:",R.length)},{debounce:500,maxWait:1e3});const D=[{title:"Aktif",value:"active"},{title:"Tidak Aktif",value:"inactive"}],V=[{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],E=[{title:"Terbaru",value:"desc"},{title:"Terlama",value:"asc"}],j=ee(()=>!!(r.value||o.category_id||o.active||o.stock_status||o.featured!==null||o.min_price||o.max_price)),I=()=>{s("update:filters",{...o})},w=()=>{r.value="",Object.assign(o,{search:"",category_id:null,active:null,stock_status:null,featured:null,min_price:null,max_price:null,sort_by:"created_at",sort_order:"desc"}),I()},J=R=>{const b=P.value.find(z=>z.id_category===R);return(b==null?void 0:b.name)||"Unknown"},re=R=>{if(!R)return"Semua";const b=D.find(z=>z.value===R);return(b==null?void 0:b.title)||String(R)},B=R=>{const b=V.find(z=>z.value===R);return(b==null?void 0:b.title)||R};return(R,b)=>($(),F(le,{class:"mb-6"},{default:t(()=>[e(Ve,{class:"d-flex align-center gap-2"},{default:t(()=>[e(U,{icon:"tabler-filter",class:"coffee-icon"}),b[11]||(b[11]=h(" Filter & Pencarian Produk "))]),_:1,__:[11]}),e(ie,null,{default:t(()=>[e(we,null,{default:t(()=>[e(M,{cols:"12",md:"4"},{default:t(()=>[e(pe,{modelValue:r.value,"onUpdate:modelValue":b[0]||(b[0]=z=>r.value=z),label:"Cari produk...",placeholder:"Nama, SKU, atau deskripsi (min. 3 karakter)","prepend-inner-icon":"tabler-search",loading:m.value,clearable:"",variant:"outlined",hint:r.value.length>0&&r.value.length<3?`Ketik ${3-r.value.length} karakter lagi untuk mencari`:"","persistent-hint":""},null,8,["modelValue","loading","hint"])]),_:1}),e(M,{cols:"12",md:"3"},{default:t(()=>[e(Se,{modelValue:o.category_id,"onUpdate:modelValue":[b[1]||(b[1]=z=>o.category_id=z),I],items:A(P),"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Semua kategori","prepend-inner-icon":"tabler-category",loading:A(y),clearable:"",variant:"outlined"},null,8,["modelValue","items","loading"])]),_:1}),e(M,{cols:"12",md:"2"},{default:t(()=>[e(Se,{modelValue:o.active,"onUpdate:modelValue":[b[2]||(b[2]=z=>o.active=z),I],items:D,label:"Status",placeholder:"Semua status","prepend-inner-icon":"tabler-toggle-left",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"2"},{default:t(()=>[e(Se,{modelValue:o.stock_status,"onUpdate:modelValue":[b[3]||(b[3]=z=>o.stock_status=z),I],items:V,label:"Stok",placeholder:"Semua stok","prepend-inner-icon":"tabler-package",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"1",class:"d-flex align-center"},{default:t(()=>[e(H,{icon:"tabler-refresh",variant:"outlined",color:"coffee",onClick:w})]),_:1})]),_:1}),e(we,{class:"mt-3"},{default:t(()=>[e(M,{cols:"12",md:"3"},{default:t(()=>[e(pe,{modelValue:o.min_price,"onUpdate:modelValue":b[4]||(b[4]=z=>o.min_price=z),label:"Harga Minimum",placeholder:"0","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:I},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"3"},{default:t(()=>[e(pe,{modelValue:o.max_price,"onUpdate:modelValue":b[5]||(b[5]=z=>o.max_price=z),label:"Harga Maksimum",placeholder:"Tidak terbatas","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:I},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"2"},{default:t(()=>[e(Se,{modelValue:o.sort_order,"onUpdate:modelValue":[b[6]||(b[6]=z=>o.sort_order=z),I],items:E,label:"Urutan",placeholder:"Terbaru","prepend-inner-icon":"tabler-arrow-up",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),j.value?($(),ne("div",Go,[l("div",Xo,[e(U,{icon:"tabler-filter-check",size:"small",class:"coffee-icon"}),b[12]||(b[12]=l("span",{class:"text-sm font-weight-medium"},"Filter Aktif:",-1))]),l("div",Yo,[r.value?($(),F(oe,{key:0,closable:"",size:"small",color:"coffee","onClick:close":b[7]||(b[7]=z=>{r.value="",o.search="",I()})},{default:t(()=>[h(" Pencarian: "+p(r.value),1)]),_:1})):N("",!0),o.category_id?($(),F(oe,{key:1,closable:"",size:"small",color:"coffee","onClick:close":b[8]||(b[8]=z=>{o.category_id=null,I()})},{default:t(()=>[h(" Kategori: "+p(J(o.category_id)),1)]),_:1})):N("",!0),o.active?($(),F(oe,{key:2,closable:"",size:"small",color:"coffee","onClick:close":b[9]||(b[9]=z=>{o.active=null,I()})},{default:t(()=>[h(" Status: "+p(re(o.active)),1)]),_:1})):N("",!0),o.stock_status?($(),F(oe,{key:3,closable:"",size:"small",color:"coffee","onClick:close":b[10]||(b[10]=z=>{o.stock_status=null,I()})},{default:t(()=>[h(" Stok: "+p(B(o.stock_status)),1)]),_:1})):N("",!0)])])):N("",!0)]),_:1})]),_:1}))}}),Zo=ze(Jo,[["__scopeId","data-v-1afc3ae3"]]),Qo={class:"d-flex align-center gap-2"},es={class:"text-h6"},ts={class:"d-flex align-center gap-2"},as={class:"text-h6"},ls={class:"d-flex align-center gap-2"},os={class:"text-h6"},ss={class:"d-flex align-center gap-2"},ns={class:"text-h6"},is={class:"d-flex align-center gap-2"},rs={class:"text-h6"},us={class:"d-flex align-center gap-2"},ds={class:"text-h6"},cs={class:"d-flex align-center gap-2"},ms={class:"text-h6"},vs={class:"d-flex align-center gap-2"},fs={class:"text-h6"},ps=Te({__name:"ProductStatsCards",props:{stats:{}},setup(a){const C=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),f=s=>`${s.toFixed(1)}%`;return(s,P)=>($(),F(we,{class:"mb-6"},{default:t(()=>[e(M,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(le,{class:"stats-card"},{default:t(()=>[e(ie,{class:"d-flex align-center"},{default:t(()=>{var y;return[e(be,{size:"44",rounded:"",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[e(U,{icon:"tabler-package"})]),_:1}),l("div",null,[P[0]||(P[0]=l("span",{class:"text-sm text-medium-emphasis"},"Total Produk",-1)),l("div",Qo,[l("h6",es,p(((y=s.stats)==null?void 0:y.total_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(M,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(le,{class:"stats-card"},{default:t(()=>[e(ie,{class:"d-flex align-center"},{default:t(()=>{var y;return[e(be,{size:"44",rounded:"",color:"success",variant:"tonal",class:"me-3"},{default:t(()=>[e(U,{icon:"tabler-check"})]),_:1}),l("div",null,[P[1]||(P[1]=l("span",{class:"text-sm text-medium-emphasis"},"Produk Aktif",-1)),l("div",ts,[l("h6",as,p(((y=s.stats)==null?void 0:y.active_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(M,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(le,{class:"stats-card"},{default:t(()=>[e(ie,{class:"d-flex align-center"},{default:t(()=>{var y;return[e(be,{size:"44",rounded:"",color:"warning",variant:"tonal",class:"me-3"},{default:t(()=>[e(U,{icon:"tabler-star"})]),_:1}),l("div",null,[P[2]||(P[2]=l("span",{class:"text-sm text-medium-emphasis"},"Produk Unggulan",-1)),l("div",ls,[l("h6",os,p(((y=s.stats)==null?void 0:y.featured_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(M,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(le,{class:"stats-card"},{default:t(()=>[e(ie,{class:"d-flex align-center"},{default:t(()=>{var y;return[e(be,{size:"44",rounded:"",color:"error",variant:"tonal",class:"me-3"},{default:t(()=>[e(U,{icon:"tabler-alert-triangle"})]),_:1}),l("div",null,[P[3]||(P[3]=l("span",{class:"text-sm text-medium-emphasis"},"Stok Rendah",-1)),l("div",ss,[l("h6",ns,p(((y=s.stats)==null?void 0:y.low_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(M,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(le,{class:"stats-card"},{default:t(()=>[e(ie,{class:"d-flex align-center"},{default:t(()=>{var y;return[e(be,{size:"44",rounded:"",color:"info",variant:"tonal",class:"me-3"},{default:t(()=>[e(U,{icon:"tabler-currency-dollar"})]),_:1}),l("div",null,[P[4]||(P[4]=l("span",{class:"text-sm text-medium-emphasis"},"Nilai Stok",-1)),l("div",is,[l("h6",rs,p(C(((y=s.stats)==null?void 0:y.total_stock_value)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(M,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(le,{class:"stats-card"},{default:t(()=>[e(ie,{class:"d-flex align-center"},{default:t(()=>{var y;return[e(be,{size:"44",rounded:"",color:"secondary",variant:"tonal",class:"me-3"},{default:t(()=>[e(U,{icon:"tabler-chart-line"})]),_:1}),l("div",null,[P[5]||(P[5]=l("span",{class:"text-sm text-medium-emphasis"},"Harga Rata-rata",-1)),l("div",us,[l("h6",ds,p(C(((y=s.stats)==null?void 0:y.average_price)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(M,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(le,{class:"stats-card"},{default:t(()=>[e(ie,{class:"d-flex align-center"},{default:t(()=>{var y;return[e(be,{size:"44",rounded:"",color:"coffee",variant:"tonal",class:"me-3"},{default:t(()=>[e(U,{icon:"tabler-trending-up"})]),_:1}),l("div",null,[P[6]||(P[6]=l("span",{class:"text-sm text-medium-emphasis"},"Margin Rata-rata",-1)),l("div",cs,[l("h6",ms,p(f(((y=s.stats)==null?void 0:y.average_margin)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(M,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(le,{class:"stats-card"},{default:t(()=>[e(ie,{class:"d-flex align-center"},{default:t(()=>{var y;return[e(be,{size:"44",rounded:"",color:"surface",variant:"tonal",class:"me-3"},{default:t(()=>[e(U,{icon:"tabler-x-circle"})]),_:1}),l("div",null,[P[7]||(P[7]=l("span",{class:"text-sm text-medium-emphasis"},"Stok Habis",-1)),l("div",vs,[l("h6",fs,p(((y=s.stats)==null?void 0:y.out_of_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1})]),_:1}))}}),gs=ze(ps,[["__scopeId","data-v-124783ae"]]),ks={class:"d-flex align-center gap-2"},bs={class:"d-flex align-center gap-2"},_s={class:"text-center py-8"},ys={class:"d-flex align-center gap-3 py-2"},hs={class:"font-weight-medium"},Vs={class:"text-caption text-medium-emphasis"},xs={class:"text-end"},Cs={class:"font-weight-medium"},Ps={key:0,class:"text-caption text-medium-emphasis"},ws={class:"text-center profit-margin-container"},Ss={class:"text-center"},$s={key:0,class:"text-caption text-medium-emphasis mt-1"},Is={class:"d-flex align-center gap-2"},Ds={class:"text-body-2"},Ts={class:"text-caption text-medium-emphasis"},zs={class:"d-flex align-center gap-1"},Us=Te({__name:"ProductTable",props:{products:{},totalItems:{},loading:{type:Boolean},currentPage:{},itemsPerPage:{},selectedProducts:{},toggleLoading:{}},emits:["add-product","view-product","edit-product","manage-recipes","open-recipe-dialog","open-composition-dialog","open-variant-dialog","delete-product","toggle-active","toggle-featured","bulk-delete","update:page","update:items-per-page","update:sort-by","update:selected-products"],setup(a){const C=[{title:"Produk",key:"name",sortable:!0,width:"250px"},{title:"Kategori",key:"category",sortable:!1,width:"120px"},{title:"Harga",key:"price",sortable:!0,align:"end",width:"130px"},{title:"Margin",key:"profit_margin",sortable:!0,align:"center",width:"100px"},{title:"Stok",key:"stock",sortable:!0,align:"center",width:"100px"},{title:"Status",key:"active",sortable:!0,width:"140px"},{title:"Dibuat",key:"created_at",sortable:!0,width:"120px"},{title:"Aksi",key:"actions",sortable:!1,align:"center",width:"200px"}],f=m=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(m),s=m=>new Date(m).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),P=m=>new Date(m).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),y=(m,r)=>m<=0?"error":r&&m<=r?"warning":"success",g=m=>m<10?"error":m<25?"warning":m<50?"success":"info";return(m,r)=>($(),F(le,null,{default:t(()=>[e(Ve,{class:"d-flex align-center justify-space-between"},{default:t(()=>[l("div",ks,[e(U,{icon:"tabler-list",class:"coffee-icon"}),r[7]||(r[7]=h(" Data Produk ")),m.totalItems?($(),F(oe,{key:0,size:"small",color:"coffee",variant:"tonal"},{default:t(()=>[h(p(m.totalItems)+" item ",1)]),_:1})):N("",!0)]),l("div",bs,[m.selectedProducts.length>0?($(),F(H,{key:0,"prepend-icon":"tabler-trash",color:"error",variant:"outlined",onClick:r[0]||(r[0]=o=>m.$emit("bulk-delete"))},{default:t(()=>[h(" Hapus Terpilih ("+p(m.selectedProducts.length)+") ",1)]),_:1})):N("",!0),e(H,{"prepend-icon":"tabler-plus",color:"coffee",onClick:r[1]||(r[1]=o=>m.$emit("add-product"))},{default:t(()=>r[8]||(r[8]=[h(" Tambah Produk ")])),_:1,__:[8]})])]),_:1}),e($e),e(Ja,{"model-value":m.selectedProducts,"onUpdate:modelValue":r[3]||(r[3]=o=>m.$emit("update:selected-products",o)),headers:C,items:m.products,"items-length":m.totalItems,loading:m.loading,"items-per-page":m.itemsPerPage,page:m.currentPage,"show-select":"","item-value":"id",class:"products-table","onUpdate:page":r[4]||(r[4]=o=>m.$emit("update:page",o)),"onUpdate:itemsPerPage":r[5]||(r[5]=o=>m.$emit("update:items-per-page",o)),"onUpdate:sortBy":r[6]||(r[6]=o=>m.$emit("update:sort-by",o))},{loading:t(()=>[e(Za,{type:"table-row@10"})]),"no-data":t(()=>[l("div",_s,[e(U,{icon:"tabler-package-off",size:"64",class:"mb-4 text-disabled"}),r[10]||(r[10]=l("h6",{class:"text-h6 mb-2"}," Tidak ada produk ",-1)),r[11]||(r[11]=l("p",{class:"text-body-2 text-medium-emphasis mb-4"}," Belum ada produk yang ditambahkan atau sesuai dengan filter yang dipilih. ",-1)),e(H,{"prepend-icon":"tabler-plus",color:"coffee",onClick:r[2]||(r[2]=o=>m.$emit("add-product"))},{default:t(()=>r[9]||(r[9]=[h(" Tambah Produk Pertama ")])),_:1,__:[9]})])]),"item.name":t(({item:o})=>[l("div",ys,[e(be,{image:o.image_url,size:"40",rounded:"",class:"product-avatar"},{default:t(()=>[o.image_url?N("",!0):($(),F(U,{key:0,icon:"tabler-package"}))]),_:2},1032,["image"]),l("div",null,[l("div",hs,p(o.name),1),l("div",Vs," SKU: "+p(o.sku||"-"),1)])])]),"item.category":t(({item:o})=>[e(oe,{color:"coffee",size:"small",variant:"tonal"},{default:t(()=>{var D;return[h(p(((D=o.category)==null?void 0:D.name)||"-"),1)]}),_:2},1024)]),"item.price":t(({item:o})=>[l("div",xs,[l("div",Cs,p(f(o.price)),1),o.cost?($(),ne("div",Ps," HPP: "+p(f(o.cost)),1)):N("",!0)])]),"item.profit_margin":t(({item:o})=>[l("div",ws,[o.cost&&o.cost>0&&o.profit_margin!==void 0?($(),F(oe,{key:0,color:g(o.profit_margin),size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>[h(p(Math.round(o.profit_margin))+"% ",1)]),_:2},1032,["color"])):($(),F(oe,{key:1,color:"grey",size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>r[12]||(r[12]=[h(" - ")])),_:1,__:[12]}))])]),"item.stock":t(({item:o})=>[l("div",Ss,[e(oe,{color:y(o.stock,o.min_stock),size:"small",variant:"tonal"},{default:t(()=>[h(p(o.stock)+" "+p(o.unit||"pcs"),1)]),_:2},1032,["color"]),o.min_stock?($(),ne("div",$s," Min: "+p(o.min_stock),1)):N("",!0)])]),"item.active":t(({item:o})=>[l("div",Is,[e(oe,{color:o.active?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[h(p(o.active?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["color"]),o.featured?($(),F(Pe,{key:0,text:"Produk Unggulan"},{activator:t(({props:D})=>[e(U,ue(D,{icon:"tabler-star-filled",color:"warning",size:"small"}),null,16)]),_:1})):N("",!0)])]),"item.created_at":t(({item:o})=>[l("div",Ds,p(s(o.created_at??"")),1),l("div",Ts,p(P((o==null?void 0:o.created_at)??"")),1)]),"item.actions":t(({item:o})=>[l("div",zs,[e(Pe,{text:"Kelola Komposisi"},{activator:t(({props:D})=>[e(H,ue(D,{icon:"tabler-chef-hat",size:"small",variant:"text",color:"primary",onClick:V=>m.$emit("open-composition-dialog",o)}),null,16,["onClick"])]),_:2},1024),e(Pe,{text:"Kelola Variant"},{activator:t(({props:D})=>[e(H,ue(D,{icon:"tabler-versions",size:"small",variant:"text",color:"secondary",onClick:V=>m.$emit("open-variant-dialog",o)}),null,16,["onClick"])]),_:2},1024),e(Pe,{text:"Edit Produk"},{activator:t(({props:D})=>[e(H,ue(D,{icon:"tabler-edit",size:"small",variant:"text",color:"coffee",onClick:V=>m.$emit("edit-product",o)}),null,16,["onClick"])]),_:2},1024),e(Pe,{text:o.active?"Nonaktifkan":"Aktifkan"},{activator:t(({props:D})=>{var V;return[e(H,ue(D,{icon:o.active?"tabler-toggle-right":"tabler-toggle-left",size:"small",variant:"text",color:o.active?"success":"error",loading:((V=m.toggleLoading)==null?void 0:V[o.id_product])||!1,onClick:E=>m.$emit("toggle-active",o)}),null,16,["icon","color","loading","onClick"])]}),_:2},1032,["text"]),e(Pe,{text:o.featured?"Hapus dari Unggulan":"Jadikan Unggulan"},{activator:t(({props:D})=>[e(H,ue(D,{icon:o.featured?"tabler-star-filled":"tabler-star",size:"small",variant:"text",color:o.featured?"warning":"default",onClick:V=>m.$emit("toggle-featured",o)}),null,16,["icon","color","onClick"])]),_:2},1032,["text"]),e(Pe,{text:"Hapus Produk"},{activator:t(({props:D})=>[e(H,ue(D,{icon:"tabler-trash",size:"small",variant:"text",color:"error",onClick:V=>m.$emit("delete-product",o)}),null,16,["onClick"])]),_:2},1024)])]),_:1},8,["model-value","items","items-length","loading","items-per-page","page"])]),_:1}))}}),Ms=ze(Us,[["__scopeId","data-v-bbf8f372"]]),As={class:"variant-table"},Bs={class:"d-flex align-center gap-2"},Es={class:"text-h5 font-weight-bold"},Rs={class:"text-body-2 text-medium-emphasis"},Hs={class:"d-flex gap-2"},Fs={class:"d-flex align-center gap-2"},Ks={key:0,class:"text-center pa-12"},Ls={class:"text-h5 font-weight-bold mb-4"},Os={class:"text-body-1 text-medium-emphasis mb-6"},js={class:"d-flex align-center gap-3"},qs={class:"text-h6 font-weight-medium"},Ns={class:"text-sm text-medium-emphasis"},Ws={class:"text-high-emphasis font-weight-medium"},Gs={class:"d-flex gap-1"},Xs=Te({__name:"ProductVariantTable",props:{variants:{},product:{},loading:{type:Boolean}},emits:["refresh","create-variant","edit-variant","delete-variant"],setup(a,{emit:C}){const f=a,s=C,P=O(!1),y=O(!1),g=O(!1),m=O(!1),r=O(null),o=O(!1),D=O({search:"",status:null,stockStatus:"",sortBy:"name_asc"}),V=[{title:"Variant",key:"name",sortable:!0},{title:"Harga",key:"price",sortable:!0},{title:"Stok",key:"current_stock",sortable:!0},{title:"Status",key:"is_active",sortable:!0},{title:"Komposisi",key:"composition",sortable:!1},{title:"Aksi",key:"actions",sortable:!1}],E=[{title:"Aktif",value:!0},{title:"Tidak Aktif",value:!1}],j=[{title:"Stok Aman",value:"safe"},{title:"Stok Rendah",value:"low"},{title:"Stok Habis",value:"out"}],I=[{title:"Nama (A-Z)",value:"name_asc"},{title:"Nama (Z-A)",value:"name_desc"},{title:"Harga (Rendah-Tinggi)",value:"price_asc"},{title:"Harga (Tinggi-Rendah)",value:"price_desc"},{title:"Stok (Rendah-Tinggi)",value:"stock_asc"},{title:"Stok (Tinggi-Rendah)",value:"stock_desc"}],w=ee(()=>!!(D.value.search||D.value.status!==null||D.value.stockStatus||D.value.sortBy!=="name_asc")),J=ee(()=>{let i=0;return D.value.search&&i++,D.value.status!==null&&i++,D.value.stockStatus&&i++,D.value.sortBy!=="name_asc"&&i++,i}),re=ee(()=>{let i=[...f.variants];if(D.value.search){const T=D.value.search.toLowerCase();i=i.filter(Q=>Q.name.toLowerCase().includes(T)||Q.sku.toLowerCase().includes(T))}if(D.value.status!==null&&(i=i.filter(T=>T.is_active===D.value.status)),D.value.stockStatus&&(i=i.filter(T=>B(T).value===D.value.stockStatus)),D.value.sortBy){const[T,Q]=D.value.sortBy.split("_");i.sort((x,_)=>{let c,q;switch(T){case"name":c=x.name.toLowerCase(),q=_.name.toLowerCase();break;case"price":c=x.price,q=_.price;break;case"stock":c=x.current_stock,q=_.current_stock;break;default:return 0}return Q==="asc"?c<q?-1:c>q?1:0:c>q?-1:c<q?1:0})}return i}),B=i=>i.current_stock<=0?{text:"Stok Habis",color:"error",value:"out"}:i.current_stock<=i.min_stock?{text:"Stok Rendah",color:"warning",value:"low"}:{text:"Stok Aman",color:"success",value:"safe"},R=i=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(i),b=()=>{D.value={search:"",status:null,stockStatus:"",sortBy:"name_asc"}},z=()=>{r.value=null,o.value=!1,P.value=!0},W=i=>{r.value={...i},o.value=!0,P.value=!0},Y=i=>{r.value=i,g.value=!0},K=i=>{r.value=i,y.value=!0},d=()=>{P.value=!1,s("refresh")},k=()=>{y.value=!1,s("refresh")};return(i,T)=>{var Q;return $(),ne("div",As,[e(le,{class:"mb-6"},{default:t(()=>[e(Ve,{class:"d-flex align-center justify-between"},{default:t(()=>{var x,_;return[l("div",Bs,[e(U,{icon:"mdi-package-variant",class:"coffee-icon"}),l("div",null,[l("h2",Es,"Variant Produk - "+p((x=i.product)==null?void 0:x.name),1),l("p",Rs," Kelola variant dan komposisi untuk produk "+p((_=i.product)==null?void 0:_.name),1)]),i.variants.length?($(),F(oe,{key:0,size:"small",color:"primary",variant:"tonal"},{default:t(()=>[h(p(i.variants.length)+" variant ",1)]),_:1})):N("",!0)]),l("div",Hs,[e(H,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:T[0]||(T[0]=c=>s("refresh")),loading:i.loading},{default:t(()=>T[10]||(T[10]=[h(" Refresh ")])),_:1,__:[10]},8,["loading"]),e(H,{color:"primary","prepend-icon":"mdi-plus",onClick:z},{default:t(()=>T[11]||(T[11]=[h(" Tambah Variant ")])),_:1,__:[11]})])]}),_:1})]),_:1}),e(le,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(ie,null,{default:t(()=>[e(we,null,{default:t(()=>[e(M,{cols:"12",md:"3"},{default:t(()=>[e(pe,{modelValue:D.value.search,"onUpdate:modelValue":T[1]||(T[1]=x=>D.value.search=x),label:"Cari Variant",placeholder:"Nama variant atau SKU...",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"2"},{default:t(()=>[e(Se,{modelValue:D.value.status,"onUpdate:modelValue":T[2]||(T[2]=x=>D.value.status=x),items:E,label:"Status",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-toggle-switch","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"2"},{default:t(()=>[e(Se,{modelValue:D.value.stockStatus,"onUpdate:modelValue":T[3]||(T[3]=x=>D.value.stockStatus=x),items:j,label:"Status Stok",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-chart-line","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"3"},{default:t(()=>[e(Se,{modelValue:D.value.sortBy,"onUpdate:modelValue":T[4]||(T[4]=x=>D.value.sortBy=x),items:I,label:"Urutkan",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-sort","hide-details":""},null,8,["modelValue"])]),_:1}),e(M,{cols:"12",md:"2"},{default:t(()=>[l("div",Fs,[w.value?($(),F(H,{key:0,variant:"outlined",color:"secondary",onClick:b,block:""},{default:t(()=>[h(" Reset ("+p(J.value)+") ",1)]),_:1})):N("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}),i.loading?($(),ne("div",Ks,[e(Mt,{indeterminate:"",size:"64",color:"primary"}),T[12]||(T[12]=l("p",{class:"text-h6 mt-4"},"Memuat variant...",-1))])):re.value.length===0?($(),F(le,{key:1,class:"text-center pa-12"},{default:t(()=>{var x;return[e(U,{icon:"mdi-package-variant-closed",size:"96",class:"text-disabled mb-6"}),l("h3",Ls,p(i.variants.length===0?"Belum Ada Variant":"Tidak Ada Variant Ditemukan"),1),l("p",Os,p(i.variants.length===0?`Buat variant untuk produk ${(x=i.product)==null?void 0:x.name} agar dapat melihat berbagai varian yang tersedia`:"Coba ubah filter pencarian untuk menemukan variant yang Anda cari"),1),i.variants.length===0?($(),F(H,{key:0,color:"primary",size:"large","prepend-icon":"mdi-plus",onClick:z},{default:t(()=>T[13]||(T[13]=[h(" Buat Variant Pertama ")])),_:1,__:[13]})):N("",!0)]}),_:1})):($(),F(le,{key:2},{default:t(()=>[e(ll,{headers:V,items:re.value,loading:i.loading,"item-value":"id","show-select":"",class:"text-no-wrap"},{"item.name":t(({item:x})=>{var _;return[l("div",js,[e(be,{image:(_=i.product)==null?void 0:_.image_url,size:"38",variant:"tonal",color:"primary"},{default:t(()=>{var c;return[(c=i.product)!=null&&c.image_url?N("",!0):($(),F(U,{key:0,icon:"mdi-package-variant",size:"20"}))]}),_:1},8,["image"]),l("div",null,[l("h6",qs,p(x.name),1),l("span",Ns,p(x.sku),1)])])]}),"item.price":t(({item:x})=>[l("span",Ws,p(R(x.price)),1)]),"item.current_stock":t(({item:x})=>[e(oe,{color:B(x).color,size:"small",variant:"tonal"},{default:t(()=>[h(p(x.current_stock||0)+" unit ",1)]),_:2},1032,["color"])]),"item.is_active":t(({item:x})=>[e(oe,{color:x.is_active?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[h(p(x.is_active?"Aktif":"Nonaktif"),1)]),_:2},1032,["color"])]),"item.composition":t(({item:x})=>[x.variant_items_count>0?($(),F(oe,{key:0,color:"success",size:"small",variant:"tonal",onClick:_=>K(x),class:"cursor-pointer"},{default:t(()=>[h(p(x.variant_items_count)+" Item ",1)]),_:2},1032,["onClick"])):($(),F(oe,{key:1,color:"warning",size:"small",variant:"tonal"},{default:t(()=>T[14]||(T[14]=[h(" Belum ada ")])),_:1,__:[14]}))]),"item.actions":t(({item:x})=>[l("div",Gs,[e(Pe,{text:"Lihat Detail"},{activator:t(({props:_})=>[e(H,ue(_,{icon:"mdi-eye",size:"small",variant:"text",color:"info",onClick:c=>Y(x)}),null,16,["onClick"])]),_:2},1024),e(Pe,{text:"Kelola Komposisi"},{activator:t(({props:_})=>[e(H,ue(_,{icon:"mdi-puzzle",size:"small",variant:"text",color:"primary",onClick:c=>K(x)}),null,16,["onClick"])]),_:2},1024),e(Pe,{text:"Edit Variant"},{activator:t(({props:_})=>[e(H,ue(_,{icon:"mdi-pencil",size:"small",variant:"text",color:"secondary",onClick:c=>W(x)}),null,16,["onClick"])]),_:2},1024),e(Pe,{text:"Hapus Variant"},{activator:t(({props:_})=>[e(H,ue(_,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:c=>s("delete-variant",x)}),null,16,["onClick"])]),_:2},1024)])]),_:1},8,["items","loading"])]),_:1})),P.value&&i.product?($(),F(Qa,{key:3,modelValue:P.value,"onUpdate:modelValue":T[5]||(T[5]=x=>P.value=x),variant:o.value?r.value:null,products:i.product?[i.product]:[],"product-id":(Q=i.product)==null?void 0:Q.id,onSave:d,ref:"variantFormDialogRef"},null,8,["modelValue","variant","products","product-id"])):N("",!0),e(el,{modelValue:y.value,"onUpdate:modelValue":T[6]||(T[6]=x=>y.value=x),variant:r.value,onSave:k},null,8,["modelValue","variant"]),e(tl,{modelValue:g.value,"onUpdate:modelValue":T[7]||(T[7]=x=>g.value=x),variant:r.value},null,8,["modelValue","variant"]),e(al,{modelValue:m.value,"onUpdate:modelValue":T[8]||(T[8]=x=>m.value=x),product:i.product,onRefresh:T[9]||(T[9]=x=>s("refresh"))},null,8,["modelValue","product"])])}}}),Ys=ze(Xs,[["__scopeId","data-v-0e3ad822"]]),Js={class:"product-variant-tab"},Zs=Te({__name:"ProductVariantTab",props:{product:{}},setup(a){const C=a,f=O(!1),s=O([]),P=O(!1),y=O(!1),g=O(null),m=(V,E="success")=>{console.log(`${E.toUpperCase()}: ${V}`)},r=async()=>{var E,j,I,w,J,re,B;console.log("ðŸ“‹ ProductVariantTab - loadVariants called with product:",C.product),console.log("ðŸ“‹ ProductVariantTab - Product keys:",Object.keys(C.product||{})),console.log("ðŸ“‹ ProductVariantTab - Product id:",(E=C.product)==null?void 0:E.id),console.log("ðŸ“‹ ProductVariantTab - Product id_product:",(j=C.product)==null?void 0:j.id_product);const V=((I=C.product)==null?void 0:I.id_product)||((w=C.product)==null?void 0:w.id);if(console.log("ðŸ“‹ ProductVariantTab - Using productId:",V),!V){console.error("No product ID provided to loadVariants");return}f.value=!0;try{const R={product_id:V,per_page:100,page:1};console.log("Loading variants for product:",V,"with params:",R);const b=await Vt.get("/api/variants",{params:R});if(b.data.success===!1)throw new Error(b.data.message||"Failed to load variants");const z=((J=b.data.data)==null?void 0:J.data)||b.data.data||b.data||[];console.log("Raw variants received:",z),s.value=z.map(W=>({...W,is_active:W.active,id:W.id_variant||W.id,product_id:W.id_product||W.product_id})),console.log("Mapped variants:",s.value),console.log("Loaded variants:",s.value.length)}catch(R){const b=((B=(re=R.response)==null?void 0:re.data)==null?void 0:B.message)||R.message||"Gagal memuat data variant";m(b,"error"),console.error("Error loading variants:",R),s.value=[]}finally{f.value=!1}},o=V=>{g.value=V,P.value=!0},D=async()=>{if(g.value){y.value=!0;try{await Vt.delete(`/api/variants/${g.value.id}`),m("Variant berhasil dihapus"),P.value=!1,r()}catch{m("Gagal menghapus variant","error")}finally{y.value=!1}}};return Qe(()=>{r()}),(V,E)=>{var j;return $(),ne("div",Js,[e(Ys,{variants:s.value,product:C.product,loading:f.value,onRefresh:r,onDeleteVariant:o},null,8,["variants","product","loading"]),e(wt,{modelValue:P.value,"onUpdate:modelValue":E[0]||(E[0]=I=>P.value=I),title:"Konfirmasi Hapus Variant","item-name":(j=g.value)==null?void 0:j.name,loading:y.value,"confirm-text":"Hapus Variant",onConfirm:D,onCancel:E[1]||(E[1]=I=>P.value=!1)},null,8,["modelValue","item-name","loading"])])}}}),Qs=ze(Zs,[["__scopeId","data-v-8b8f7180"]]),en={class:"product-management"},tn={class:"d-flex justify-space-between align-center mb-6"},an={class:"d-flex gap-3 align-center"},ln={key:0,class:"d-flex gap-2"},on={class:"d-flex align-center"},sn=Te({__name:"products-management",setup(a){At();const{productsList:C,categories:f,loading:s,saveLoading:P,deleteLoading:y,toggleLoading:g,stats:m,dialog:r,deleteDialog:o,editMode:D,selectedProduct:V,selectedProducts:E,currentPage:j,totalItems:I,itemsPerPage:w,filters:J,errorMessage:re,successMessage:B,modalErrorMessage:R,formData:b,selectedImage:z,imagePreview:W,canCreateEdit:Y,hasSelectedProducts:K,fetchProductsList:d,fetchCategories:k,fetchStats:i,saveProduct:T,deleteProduct:Q,bulkDeleteProducts:x,toggleActiveStatus:_,toggleFeaturedStatus:c,openCreateDialog:q,openEditDialog:v,openDeleteDialog:n,closeDialog:u,handleImageUpload:ge,clearModalError:te,onPageChange:ye}=Bt(),{dialog:ve,editMode:he,formData:tt,availableItems:xe,saveLoading:at,modalErrorMessage:lt,openCreateDialog:ot,closeDialog:qe,saveRecipe:S,clearModalError:G,fetchAvailableItems:de}=Ba(),{productItemsList:X,loading:ce,fetchProductItemsForComposition:ke}=Yt(),fe=O("products"),Z=O(!1),Ce=O(null),me=O(!1),Ae=O(null),Ne=async()=>{await Q()},He=async()=>{await x()},st=se=>{console.log("ðŸ³ Opening komposisi dialog for product:",se.name);const L=se.id_product||se.id;ot(L)},jt=async se=>{console.log("ðŸ§‘â€ðŸ³ Opening composition dialog for product:",se.name),Ce.value=se;try{await ke({page:1,per_page:50,critical_only:!1})}catch(L){console.error("Error fetching composition items:",L)}Z.value=!0},qt=se=>{console.log("ðŸ”„ Opening variant dialog for product:",se.name),console.log("ðŸ”„ Product object:",se),console.log("ðŸ”„ Product ID (id):",se.id),console.log("ðŸ”„ Product ID (id_product):",se.id_product),console.log("ðŸ”„ Product keys:",Object.keys(se)),Ae.value=se,me.value=!0},Nt=se=>{if(!se)return[];const L=se.id_product||se.id;return X.value.filter(Fe=>{var ae;return((ae=Fe.product)==null?void 0:ae.id_product)===L||Fe.product_id===L})||[]},Wt=se=>{console.log("ðŸ“ Filters updated:",se),Object.assign(J,se),d()},Gt=se=>{console.log("ðŸ” Search triggered with query:",se),J.search=se,d()},Xt=()=>{z.value=null,W.value&&(W.value="")};return _e(fe,async se=>{console.log("ðŸ”„ Tab changed to:",se),se==="compositions"&&(console.log("ðŸ§‘â€ðŸ³ Loading composition data..."),await ke({page:1,per_page:15,critical_only:!1}))},{immediate:!1}),Qe(()=>{d(),k(),i(),de()}),(se,L)=>{var Fe;return $(),ne("div",en,[l("div",tn,[L[19]||(L[19]=l("div",null,[l("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Produk & Komposisi"),l("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola produk dan komposisi untuk coffee shop Anda")],-1)),l("div",an,[A(K)&&fe.value==="products"?($(),ne("div",ln,[e(oe,{color:"primary",size:"small"},{default:t(()=>[h(p(A(E).length)+" dipilih ",1)]),_:1}),e(H,{color:"error",variant:"outlined",size:"small","prepend-icon":"mdi-delete",onClick:He},{default:t(()=>L[17]||(L[17]=[h(" Hapus Terpilih ")])),_:1,__:[17]})])):N("",!0),A(Y)&&fe.value==="products"?($(),F(H,{key:1,color:"primary","prepend-icon":"mdi-plus",class:"coffee-btn",onClick:A(q)},{default:t(()=>L[18]||(L[18]=[h(" Tambah Produk ")])),_:1,__:[18]},8,["onClick"])):N("",!0)])]),e(xl,{modelValue:fe.value,"onUpdate:modelValue":L[0]||(L[0]=ae=>fe.value=ae),class:"mb-6"},{default:t(()=>[e(pt,{value:"products"},{default:t(()=>[e(U,{icon:"mdi-coffee",class:"me-2"}),L[20]||(L[20]=h(" Produk "))]),_:1,__:[20]}),e(pt,{value:"compositions"},{default:t(()=>[e(U,{icon:"mdi-chef-hat",class:"me-2"}),L[21]||(L[21]=h(" Komposisi Produk "))]),_:1,__:[21]})]),_:1},8,["modelValue"]),A(re)?($(),F(Me,{key:0,type:"error",variant:"outlined",class:"mb-4",text:A(re),closable:"","onClick:close":L[1]||(L[1]=ae=>re.value="")},null,8,["text"])):N("",!0),A(B)?($(),F(Me,{key:1,type:"success",variant:"outlined",class:"mb-4",text:A(B),closable:"","onClick:close":L[2]||(L[2]=ae=>B.value="")},null,8,["text"])):N("",!0),e(ft,{modelValue:fe.value,"onUpdate:modelValue":L[4]||(L[4]=ae=>fe.value=ae)},{default:t(()=>[e(Ze,{value:"products"},{default:t(()=>[e(gs,{stats:A(m)},null,8,["stats"]),e(Zo,{filters:A(J),"onUpdate:filters":Wt,onSearch:Gt},null,8,["filters"]),e(Ms,{products:A(C),loading:A(s),"current-page":A(j),"total-items":A(I),"items-per-page":A(w),"selected-products":A(E),"toggle-loading":A(g),"onUpdate:page":A(ye),onAddProduct:A(q),onEditProduct:A(v),onOpenRecipeDialog:st,onOpenCompositionDialog:jt,onOpenVariantDialog:qt,onDeleteProduct:A(n),onToggleActive:A(_),onToggleFeatured:A(c),"onUpdate:selectedProducts":L[3]||(L[3]=ae=>E.value=ae)},null,8,["products","loading","current-page","total-items","items-per-page","selected-products","toggle-loading","onUpdate:page","onAddProduct","onEditProduct","onDeleteProduct","onToggleActive","onToggleFeatured"])]),_:1}),e(Ze,{value:"compositions"},{default:t(()=>[e(_o,{"product-items":A(X),loading:A(ce),onRefresh:A(ke)},null,8,["product-items","loading","onRefresh"])]),_:1})]),_:1},8,["modelValue"]),e(Wo,{modelValue:A(r),"onUpdate:modelValue":[L[5]||(L[5]=ae=>nt(r)?r.value=ae:null),L[6]||(L[6]=ae=>r.value=ae)],"edit-mode":A(D),"form-data":A(b),categories:A(f),loading:A(P),"error-message":A(R),"selected-image":A(z)?[A(z)]:[],"image-preview":A(W),onClose:A(u),onSubmit:A(T),onImageChange:A(ge),onRemoveImage:Xt,onClearError:A(te),onUpdateForm:L[7]||(L[7]=(ae,_t)=>A(b)[ae]=_t)},null,8,["modelValue","edit-mode","form-data","categories","loading","error-message","selected-image","image-preview","onClose","onSubmit","onImageChange","onClearError"]),e(Ea,{modelValue:A(ve),"onUpdate:modelValue":[L[8]||(L[8]=ae=>nt(ve)?ve.value=ae:null),L[9]||(L[9]=ae=>ve.value=ae)],"edit-mode":A(he),"form-data":A(tt),"available-items":A(xe),loading:A(at),"error-message":A(lt),onClose:A(qe),onSave:A(S),onClearError:A(G)},null,8,["modelValue","edit-mode","form-data","available-items","loading","error-message","onClose","onSave","onClearError"]),e(wt,{modelValue:A(o),"onUpdate:modelValue":L[10]||(L[10]=ae=>nt(o)?o.value=ae:null),title:"Konfirmasi Hapus Produk","item-name":(Fe=A(V))==null?void 0:Fe.name,loading:A(y),"confirm-text":"Hapus Produk",onConfirm:Ne,onCancel:L[11]||(L[11]=ae=>o.value=!1)},null,8,["modelValue","item-name","loading"]),e(Ot,{modelValue:Z.value,"onUpdate:modelValue":L[12]||(L[12]=ae=>Z.value=ae),product:Ce.value,items:Nt(Ce.value),onSave:L[13]||(L[13]=()=>{A(d)(),Z.value=!1}),onRefresh:A(d)},null,8,["modelValue","product","items","onRefresh"]),e(Le,{modelValue:me.value,"onUpdate:modelValue":L[16]||(L[16]=ae=>me.value=ae),"max-width":"1400px",persistent:""},{default:t(()=>[e(le,null,{default:t(()=>[e(Ve,{class:"d-flex justify-between align-center"},{default:t(()=>{var ae;return[l("div",on,[e(U,{icon:"tabler-versions",class:"me-2"}),h(" Kelola Variant - "+p((ae=Ae.value)==null?void 0:ae.name),1)]),e(H,{icon:"tabler-x",variant:"text",onClick:L[14]||(L[14]=_t=>me.value=!1)})]}),_:1}),e($e),e(ie,{class:"pa-0"},{default:t(()=>[Ae.value?($(),F(Qs,{key:0,product:Ae.value},null,8,["product"])):N("",!0)]),_:1}),e($e),e(Oe,null,{default:t(()=>[e(et),e(H,{color:"grey-darken-1",variant:"outlined",onClick:L[15]||(L[15]=ae=>me.value=!1)},{default:t(()=>[e(U,{icon:"mdi-close",class:"me-1"}),L[22]||(L[22]=h(" Tutup "))]),_:1,__:[22]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),ai=ze(sn,[["__scopeId","data-v-eaa3bff4"]]);export{ai as default};
