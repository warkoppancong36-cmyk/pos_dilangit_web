import{aA as re,d as et,r as p,V as K,w as tt,g as E,f as a,b as e,s as _,X as R,t as u,l as C,c as ne,e as r,aw as at,a0 as M,o as x,ax as Ye,aW as ot,D as lt,m as t,a5 as ye,F as rt,i as nt,p as Ie,$ as Te}from"./main-DPnUv1pd.js";import{V as be}from"./VDialog-CV047xyL.js";import{b as me,c as $e,V as q}from"./VCard-DMGKoj4B.js";import{V as Z}from"./VDivider-DAg0iMzJ.js";import{V as z}from"./VCardText-PNx04gNG.js";import{V as se}from"./VAlert-Cly6P1Ns.js";import{V as it}from"./VDataTable-X8F_vP3L.js";import{V as Q}from"./VChip-DV0mFc61.js";import{V as he}from"./VSpacer-DFA1b6Ee.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as ut}from"./ItemsApi-CrBb1LeZ.js";import{V as te,a as V}from"./VRow-CD70GY5_.js";import{V as W}from"./VTextField-diQmJiiS.js";import{V as je}from"./VSelect-CcSCAPQw.js";import{V as ct}from"./VDataTableServer-BgYGSBIO.js";import{V as Re}from"./VTooltip-Dr9ifrtU.js";import{V as Ee}from"./VForm-BMP28L9T.js";import{V as Ne}from"./VTextarea-BbxSx2ZR.js";import{V as dt}from"./VAvatar-BwEz21qJ.js";import"./VOverlay-KX6BHFyq.js";import"./forwardRefs-B931MWyl.js";import"./VImg-F_6PKd_y.js";import"./VCheckboxBtn-D9wQdPEj.js";import"./VTable-DaapctvA.js";import"./filter-C7g-yH30.js";/* empty css              */import"./VList-CHKWSJvZ.js";import"./VMenu-0r3gixm4.js";const ae="/api/inventory";class J{static async getAll(i){var c;try{return(await re.get(ae,{params:i})).data}catch(m){throw((c=m.response)==null?void 0:c.data)||this.handleError(m)}}static async getById(i){var c;try{return(await re.get(`${ae}/${i}`)).data}catch(m){throw((c=m.response)==null?void 0:c.data)||this.handleError(m)}}static async getStats(){var i;try{return(await re.get(`${ae}/stats`)).data}catch(c){throw((i=c.response)==null?void 0:i.data)||this.handleError(c)}}static async getLowStockAlerts(){var i;try{return(await re.get(`${ae}/low-stock-alerts`)).data}catch(c){throw((i=c.response)==null?void 0:i.data)||this.handleError(c)}}static async updateStock(i,c){var m;try{return(await re.post(`${ae}/${i}/update-stock`,c)).data}catch(y){throw((m=y.response)==null?void 0:m.data)||this.handleError(y)}}static async bulkUpdateStock(i){var c;try{return(await re.post(`${ae}/bulk-update-stock`,i)).data}catch(m){throw((c=m.response)==null?void 0:c.data)||this.handleError(m)}}static async setReorderLevel(i,c){var m;try{return(await re.post(`${ae}/${i}/reorder-level`,c)).data}catch(y){throw((m=y.response)==null?void 0:m.data)||this.handleError(y)}}static async getMovements(i){var c;try{const m=i!=null&&i.id_inventory?`${ae}/${i.id_inventory}/movements`:`${ae}/movements`;return(await re.get(m,{params:i})).data}catch(m){throw((c=m.response)==null?void 0:c.data)||this.handleError(m)}}static handleError(i){var c,m;return i.response?{message:((c=i.response.data)==null?void 0:c.message)||"Terjadi kesalahan pada server",success:!1,errors:(m=i.response.data)==null?void 0:m.errors}:i.request?{message:"Tidak dapat terhubung ke server",success:!1}:{message:i.message||"Terjadi kesalahan yang tidak diketahui",success:!1}}static formatError(i){return i.errors?Object.values(i.errors).flat().join(", "):i.message||"Terjadi kesalahan yang tidak diketahui"}static isValidationError(i){return i.errors&&typeof i.errors=="object"}static getFieldError(i,c){return i.errors&&i.errors[c]?Array.isArray(i.errors[c])?i.errors[c][0]:i.errors[c]:null}static getMovementTypes(){return[{value:"stock_in",label:"Stock Masuk",color:"success"},{value:"stock_out",label:"Stock Keluar",color:"warning"},{value:"adjustment",label:"Penyesuaian",color:"info"},{value:"transfer",label:"Transfer",color:"primary"},{value:"return",label:"Retur",color:"success"},{value:"damaged",label:"Rusak",color:"error"},{value:"expired",label:"Kadaluarsa",color:"error"}]}static getStockStatusOptions(){return[{value:"all",label:"Semua Status"},{value:"in_stock",label:"Tersedia"},{value:"low_stock",label:"Stok Menipis"},{value:"out_of_stock",label:"Habis"},{value:"overstock",label:"Stok Berlebih"}]}}const mt={key:1,class:"text-center py-8"},pt={class:"font-weight-medium"},vt={class:"text-medium-emphasis"},_t={class:"text-center"},ft={class:"text-center font-weight-medium"},kt={class:"text-center font-weight-bold text-primary"},gt={class:"text-end"},yt={class:"text-end font-weight-medium text-success"},bt={class:"max-width-200"},ht={class:"font-weight-medium"},xt={key:0,class:"text-medium-emphasis"},St={key:1,class:"d-block text-caption"},wt={key:2,class:"text-info d-block"},Vt={class:"text-center py-8"},Mt=et({__name:"InventoryMovementsDialog",props:{modelValue:{type:Boolean},inventoryId:{},inventoryName:{}},emits:["update:modelValue"],setup(F,{emit:i}){const c=F,m=i,y=p([]),$=p(!1),L=p(""),I=K({get:()=>c.modelValue,set:k=>m("update:modelValue",k)}),O=async()=>{var k,v,n,T;if(c.inventoryId)try{$.value=!0,L.value="";const h=await J.getMovements({id_inventory:parseInt(c.inventoryId),page:1,per_page:50});h.data&&Array.isArray(h.data)?y.value=h.data:h.data&&((k=h==null?void 0:h.data)!=null&&k.data)&&Array.isArray((v=h==null?void 0:h.data)==null?void 0:v.data)?y.value=h.data.data:y.value=[]}catch(h){console.error("Error fetching movements:",h),L.value=((T=(n=h.response)==null?void 0:n.data)==null?void 0:T.message)||"Gagal memuat riwayat pergerakan"}finally{$.value=!1}},B=k=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(k),N=k=>({in:"success",out:"error",stock_in:"success",stock_out:"error",adjustment:"warning",transfer:"info",return:"secondary"})[k]||"primary",A=k=>({in:"Stock Masuk",out:"Stock Keluar",stock_in:"Stock Masuk",stock_out:"Stock Keluar",adjustment:"Penyesuaian",transfer:"Transfer",return:"Retur"})[k]||k,f=k=>({in:"tabler-plus",out:"tabler-minus",stock_in:"tabler-plus",stock_out:"tabler-minus",adjustment:"tabler-edit",transfer:"tabler-arrows-exchange",return:"tabler-arrow-back"})[k]||"tabler-package";return tt(I,k=>{k&&c.inventoryId?O():(y.value=[],L.value="")}),(k,v)=>(x(),E(be,{modelValue:I.value,"onUpdate:modelValue":v[1]||(v[1]=n=>I.value=n),"max-width":"900px",scrollable:""},{default:a(()=>[e(q,null,{default:a(()=>[e(me,{class:"d-flex align-center"},{default:a(()=>[e(R,{icon:"tabler-history",class:"me-2"}),_(" Riwayat Pergerakan - "+u(k.inventoryName),1)]),_:1}),e(Z),e(z,{class:"pa-0"},{default:a(()=>[L.value?(x(),E(se,{key:0,type:"error",variant:"tonal",class:"ma-4"},{default:a(()=>[_(u(L.value),1)]),_:1})):C("",!0),$.value?(x(),ne("div",mt,[e(at,{indeterminate:"",color:"primary",size:"40"}),v[2]||(v[2]=r("div",{class:"mt-4 text-medium-emphasis"}," Memuat riwayat pergerakan... ",-1))])):(x(),E(it,{key:2,headers:[{title:"Tanggal",key:"created_at",sortable:!1},{title:"Jenis",key:"movement_type",sortable:!1},{title:"Kuantitas",key:"quantity",sortable:!1},{title:"Stok Sebelum",key:"stock_before",sortable:!1},{title:"Stok Sesudah",key:"stock_after",sortable:!1},{title:"Harga/Unit",key:"unit_cost",sortable:!1},{title:"Total Nilai",key:"total_cost",sortable:!1},{title:"Catatan",key:"notes",sortable:!1}],items:y.value,loading:$.value,class:"text-no-wrap","items-per-page":"15",height:"500","fixed-header":""},{"item.created_at":a(({item:n})=>[r("div",null,[r("div",pt,u(new Date(n.created_at).toLocaleDateString("id-ID")),1),r("small",vt,u(new Date(n.created_at).toLocaleTimeString("id-ID")),1)])]),"item.movement_type":a(({item:n})=>[e(Q,{color:N(n.movement_type),variant:"tonal",size:"small","prepend-icon":f(n.movement_type)},{default:a(()=>[_(u(A(n.movement_type)),1)]),_:2},1032,["color","prepend-icon"])]),"item.quantity":a(({item:n})=>[r("div",_t,[e(Q,{color:n.movement_type==="in"||n.movement_type==="stock_in"?"success":"error",variant:"outlined",size:"small"},{default:a(()=>[_(u(n.movement_type==="in"||n.movement_type==="stock_in"?"+":"-")+u(Math.abs(n.quantity)),1)]),_:2},1032,["color"])])]),"item.stock_before":a(({item:n})=>[r("div",ft,u(n.stock_before),1)]),"item.stock_after":a(({item:n})=>[r("div",kt,u(n.stock_after),1)]),"item.unit_cost":a(({item:n})=>[r("div",gt,u(n.unit_cost?B(n.unit_cost):"-"),1)]),"item.total_cost":a(({item:n})=>[r("div",yt,u(n.total_cost?B(n.total_cost):"-"),1)]),"item.notes":a(({item:n})=>[r("div",bt,[r("div",ht,u(n.notes||"-"),1),n.reference_type&&n.reference_id?(x(),ne("small",xt," Ref: "+u(n.reference_type)+"-"+u(n.reference_id),1)):C("",!0),n.batch_number?(x(),ne("small",St," Batch: "+u(n.batch_number),1)):C("",!0),n.user?(x(),ne("small",wt," oleh: "+u(n.user.name),1)):C("",!0)])]),"no-data":a(()=>[r("div",Vt,[e(R,{icon:"tabler-history-off",size:"48",class:"text-medium-emphasis mb-4"}),v[3]||(v[3]=r("div",{class:"text-h6 text-medium-emphasis mb-2"}," Belum ada riwayat pergerakan ",-1)),v[4]||(v[4]=r("div",{class:"text-body-2 text-medium-emphasis"}," Riwayat akan muncul setelah ada pergerakan stok ",-1))])]),_:1},8,["items","loading"]))]),_:1}),e(Z),e($e,{class:"pa-4"},{default:a(()=>[e(he),e(M,{variant:"outlined",onClick:v[0]||(v[0]=n=>I.value=!1)},{default:a(()=>v[5]||(v[5]=[_(" Tutup ")])),_:1,__:[5]}),e(M,{color:"primary","prepend-icon":"tabler-refresh",onClick:O},{default:a(()=>v[6]||(v[6]=[_(" Refresh ")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ct=st(Mt,[["__scopeId","data-v-ca0277a4"]]),Pt=()=>{const F=p([]),i=p(!1),c=p(!1),m=p({total_items:0,low_stock_items:0,out_of_stock_items:0,overstock_items:0,total_stock_value:0,total_stock_quantity:0,total_reserved_stock:0,items_need_restock:0}),y=p([]),$=p(!1),L=p([]),I=p(!1),O=p(!1),B=p(!1),N=p(!1),A=p(!1),f=p(null),k=p([]),v=p(1),n=p(0),T=p(15),h=p({search:"",stock_status:"all",category_id:void 0,supplier_id:void 0,sort_by:"current_stock",sort_order:"asc"}),X=p(""),P=p(""),j=p(""),ie=p({movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:void 0,notes:""}),H=p({reorder_level:0,max_stock_level:0}),ke=K(()=>k.value.length>0),pe=K(()=>m.value.total_stock_value),ue=K(()=>m.value.low_stock_items),ce=K(()=>m.value.out_of_stock_items),Y=K(()=>Math.ceil(n.value/T.value)),ve=K(()=>v.value<Y.value),de=K(()=>v.value>1),xe=K(()=>({currentPage:v.value,totalPages:Y.value,totalItems:n.value,itemsPerPage:T.value,hasNext:ve.value,hasPrev:de.value})),Se=[l=>l>0||"Kuantitas harus lebih dari 0",l=>Number.isInteger(l)||"Kuantitas harus berupa bilangan bulat"],we=[l=>!!l||"Alasan wajib diisi",l=>l&&l.length>=3||"Alasan minimal 3 karakter"],d=[l=>!l||l>=0||"Harga harus lebih dari atau sama dengan 0"],D=[{title:"Stock Masuk",value:"stock_in",color:"success"},{title:"Stock Keluar",value:"stock_out",color:"warning"},{title:"Penyesuaian",value:"adjustment",color:"info"},{title:"Transfer",value:"transfer",color:"primary"},{title:"Retur",value:"return",color:"success"}],S=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Menipis",value:"low_stock"},{title:"Habis",value:"out_of_stock"},{title:"Stok Berlebih",value:"overstock"}],oe=async()=>{i.value=!0,X.value="";try{const l={...h.value,page:v.value,per_page:T.value};Object.keys(l).forEach(Ue=>{const g=l[Ue];(g===""||g===void 0||g===null||g==="all")&&delete l[Ue]}),console.log("Fetching inventory with params:",l);const w=await J.getAll(l);if(console.log("ðŸ” Full Inventory API Response:",w),console.log("ðŸ“„ Response Data Structure:",w.data),w.success)F.value=w.data.data||[],n.value=w.data.total||0,w.data.current_page&&(v.value=w.data.current_page),console.log("Inventory data loaded:",{total:w.data.total,current_page:w.data.current_page,per_page:w.data.per_page,last_page:w.data.last_page,itemsLength:F.value.length}),console.log("ðŸ“Š Final Inventory State Values:",{inventoryListLength:F.value.length,totalItemsValue:n.value,currentPageValue:v.value,itemsPerPageValue:T.value});else throw new Error(w.message||"Gagal mengambil data inventory")}catch(l){console.error("Error fetching inventory:",l),X.value=J.formatError(l)||"Gagal mengambil data inventory",F.value=[],n.value=0}finally{i.value=!1}},Ve=async()=>{try{const l=await J.getStats();l.success&&(m.value=l.data)}catch(l){console.error("Error fetching inventory stats:",l)}},le=async()=>{I.value=!0;try{const l=await J.getLowStockAlerts();l.success&&(L.value=l.data.data||[])}catch(l){console.error("Error fetching low stock alerts:",l),L.value=[]}finally{I.value=!1}},_e=async l=>{$.value=!0;try{const w=await J.getMovements({id_inventory:l,page:1,per_page:20});w.success&&(y.value=w.data)}catch(w){console.error("Error fetching movements:",w)}finally{$.value=!1}},Ae=async()=>{if(f.value){c.value=!0,j.value="";try{const l=await J.updateStock(f.value.id_inventory,ie.value);if(l.success)P.value="Stock berhasil diperbarui",fe(),await oe(),await Ve(),await le();else throw new Error(l.message||"Gagal memperbarui stock")}catch(l){console.error("Error updating stock:",l),j.value=J.formatError(l)||"Gagal memperbarui stock"}finally{c.value=!1}}},Le=async()=>{if(f.value){c.value=!0,j.value="";try{const l=await J.setReorderLevel(f.value.id_inventory,H.value);if(l.success)P.value="Reorder level berhasil diperbarui",Me(),await oe();else throw new Error(l.message||"Gagal memperbarui reorder level")}catch(l){console.error("Error setting reorder level:",l),j.value=J.formatError(l)||"Gagal memperbarui reorder level"}finally{c.value=!1}}},Fe=l=>{f.value=l,ie.value={movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:l.average_cost||void 0,notes:""},j.value="",O.value=!0},qe=l=>{f.value=l,H.value={reorder_level:l.reorder_level||0,max_stock_level:l.max_stock_level||0},j.value="",A.value=!0},ze=l=>{f.value=l,_e(l.id_inventory),N.value=!0},fe=()=>{O.value=!1,setTimeout(()=>{f.value=null,j.value=""},300)},Me=()=>{A.value=!1,setTimeout(()=>{f.value=null,j.value=""},300)};return{inventoryList:F,loading:i,saveLoading:c,stats:m,movementsList:y,movementsLoading:$,lowStockItems:L,alertsLoading:I,stockUpdateDialog:O,bulkUpdateDialog:B,movementsDialog:N,reorderDialog:A,selectedInventory:f,selectedItems:k,currentPage:v,totalItems:n,itemsPerPage:T,filters:h,errorMessage:X,successMessage:P,modalErrorMessage:j,stockUpdateForm:ie,reorderForm:H,hasSelectedItems:ke,totalStockValue:pe,lowStockCount:ue,outOfStockCount:ce,quantityRules:Se,reasonRules:we,costRules:d,movementTypeOptions:D,stockStatusOptions:S,fetchInventoryList:oe,fetchStats:Ve,fetchLowStockAlerts:le,fetchMovements:_e,updateStock:Ae,setReorderLevel:Le,openStockUpdateDialog:Fe,openReorderDialog:qe,openMovementsDialog:ze,closeStockUpdateDialog:fe,closeReorderDialog:Me,closeMovementsDialog:()=>{N.value=!1,setTimeout(()=>{f.value=null,y.value=[]},300)},clearModalError:()=>{j.value=""},onPageChange:l=>{console.log("Page changed to:",l,"Current total items:",n.value),l!==v.value&&(v.value=l,oe())},onItemsPerPageChange:l=>{console.log("Items per page changed to:",l),l!==T.value&&(T.value=l,v.value=1,oe())},handleFiltersUpdate:l=>{h.value={...h.value,...l},v.value=1,oe()},formatCurrency:l=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),getStockStatusColor:l=>l.current_stock===0?"error":l.is_low_stock?"warning":"success",getStockStatusText:l=>l.current_stock===0?"Habis":l.reorder_level>0&&l.current_stock<=l.reorder_level?"Menipis":l.max_stock_level&&l.current_stock>l.max_stock_level?"Berlebih":"Tersedia",getMovementTypeColor:l=>({stock_in:"success",stock_out:"warning",adjustment:"info",transfer:"primary",return:"success",damaged:"error",expired:"error"})[l]||"grey",totalPages:Y,hasNextPage:ve,hasPrevPage:de,paginationInfo:xe}};function Dt(){const F=p([]),i=p([]),c=p(!1),m=p(!1),y=p({total_items:0,total_value:0,low_stock_items:0,out_of_stock_items:0,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}),$=p(1),L=p(0),I=p(10),O=Ye({search:"",stock_status:"all",movement_type:"",date_from:"",date_to:"",item_id:void 0}),B=p(!1),N=p(!1),A=p(null),f=Ye({item_id:0,type:"in",quantity:0,notes:"",cost_per_unit:0}),k=p(""),v=p(""),n=p(""),T=K(()=>!0),h=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],X=[{title:"Masuk",value:"in",color:"success",icon:"tabler-plus"},{title:"Keluar",value:"out",color:"error",icon:"tabler-minus"},{title:"Penyesuaian",value:"adjustment",color:"warning",icon:"tabler-adjustments"}],P=[{title:"Pembelian",value:"purchase"},{title:"Penjualan",value:"sale"},{title:"Produksi",value:"production"},{title:"Penyesuaian",value:"adjustment"},{title:"Kerusakan",value:"waste"}],j=d=>d.current_stock<=0?{status:"out_of_stock",color:"error",text:"Habis",icon:"tabler-x"}:d.current_stock<=d.minimum_stock?{status:"low_stock",color:"warning",text:"Rendah",icon:"tabler-alert-triangle"}:{status:"in_stock",color:"success",text:"Tersedia",icon:"tabler-check"},ie=d=>!d.maximum_stock||d.maximum_stock<=0?100:Math.round(d.current_stock/d.maximum_stock*100),H=async()=>{c.value=!0;try{await new Promise(d=>setTimeout(d,1e3)),F.value=await ut.getAll(),L.value=F.value.length,v.value=""}catch{k.value="Gagal memuat data items"}finally{c.value=!1}},ke=async d=>{c.value=!0;try{const D=await J.getMovements({id_inventory:d,page:$.value,per_page:I.value});i.value=D.data.map(S=>({id:S.id_movement,item_id:S.id_inventory,type:S.movement_type,quantity:S.quantity,unit:"pcs",reference_id:S.reference_number?parseInt(S.reference_number):void 0,reference_type:S.reason,notes:S.notes,cost_per_unit:S.cost_per_unit,total_cost:S.total_cost,created_by:S.created_by,created_at:S.created_at,creator:S.user})),L.value=D.total}catch(D){console.error("Failed to fetch stock movements:",D),i.value=[]}finally{c.value=!1}},pe=async()=>{try{await H();const d=F.value;y.value={total_items:d.length,total_value:d.reduce((D,S)=>D+S.current_stock*S.cost_per_unit,0),low_stock_items:d.filter(D=>D.current_stock<=D.minimum_stock&&D.current_stock>0).length,out_of_stock_items:d.filter(D=>D.current_stock<=0).length,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}}catch(d){console.error("Failed to fetch stats:",d)}},ue=async()=>{m.value=!0,n.value="";try{const d=await fetch("/api/inventory/movement",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({item_id:f.item_id,movement_type:f.type,quantity:f.quantity,notes:f.notes,cost_per_unit:f.cost_per_unit})});if(!d.ok){const D=await d.json();throw new Error(D.message||"Gagal mencatat pergerakan stok")}v.value=`Stock ${f.type==="in"?"masuk":f.type==="out"?"keluar":"disesuaikan"} berhasil dicatat`,de(),await H(),await pe()}catch(d){n.value=d.message||"Gagal mencatat pergerakan stok"}finally{m.value=!1}},ce=d=>{A.value=d,Object.assign(f,{item_id:d.id_item,type:"in",quantity:0,notes:"",cost_per_unit:d.cost_per_unit}),B.value=!0},Y=d=>{A.value=d,Object.assign(f,{item_id:d.id_item,type:"out",quantity:0,notes:"",cost_per_unit:d.cost_per_unit}),B.value=!0},ve=d=>{A.value=d,Object.assign(f,{item_id:d.id_item,type:"adjustment",quantity:d.current_stock,notes:"",cost_per_unit:d.cost_per_unit}),N.value=!0},de=()=>{B.value=!1,N.value=!1,n.value="",A.value=null};return{itemsList:F,stockMovements:i,loading:c,saveLoading:m,stats:y,currentPage:$,totalItems:L,itemsPerPage:I,filters:O,movementDialog:B,adjustmentDialog:N,selectedItem:A,movementFormData:f,errorMessage:k,successMessage:v,modalErrorMessage:n,canManageStock:T,stockStatusOptions:h,movementTypeOptions:X,referenceTypeOptions:P,getStockStatus:j,getStockPercentage:ie,fetchItems:H,fetchStockMovements:ke,fetchStats:pe,recordStockMovement:ue,openStockInDialog:ce,openStockOutDialog:Y,openAdjustmentDialog:ve,closeMovementDialog:de,clearModalError:()=>{n.value=""},onPageChange:d=>{$.value=d,H()},handleFiltersUpdate:d=>{Object.assign(O,d),$.value=1,H()}}}const Ut={class:"inventory-management"},It={class:"d-flex justify-space-between align-center mb-6"},Tt={class:"d-flex gap-3 align-center"},jt={class:"d-flex align-center justify-space-between"},Rt={class:"text-h4 font-weight-bold text-primary"},Et={class:"d-flex align-center justify-space-between"},$t={class:"text-h4 font-weight-bold text-warning"},At={class:"d-flex align-center justify-space-between"},Lt={class:"text-h4 font-weight-bold text-error"},Ft={class:"d-flex align-center justify-space-between"},qt={class:"text-h4 font-weight-bold text-success"},zt={class:"d-flex align-center justify-space-between"},Ot={class:"d-flex align-center gap-3"},Bt={class:"d-flex gap-2"},Nt={class:"d-flex flex-wrap gap-2"},Kt={class:"d-flex align-center"},Ht={class:"font-weight-medium"},Gt={class:"text-medium-emphasis"},Jt={class:"text-center"},Xt={class:"text-h6 font-weight-bold"},Wt={key:0,class:"text-warning"},Zt={class:"text-center"},Qt={class:"text-center"},Yt={class:"text-end"},ea={class:"text-end font-weight-medium text-success"},ta={class:"d-flex align-center gap-1"},aa={class:"text-center py-12"},sa={class:"d-flex justify-center gap-3"},oa={class:"text-center py-8"},la={key:0},ra={class:"text-xs text-info"},na={class:"d-flex align-center gap-2"},ia={class:"d-flex align-center gap-3"},ua={class:"font-weight-bold"},ca={class:"text-caption"},da={class:"text-caption"},ma={class:"d-flex gap-3 justify-end"},pa={class:"d-flex align-center gap-2"},va={class:"text-white"},_a={class:"d-flex align-center gap-3"},fa={class:"font-weight-bold"},ka={class:"text-caption"},ga=et({__name:"inventory-management",setup(F){const{xs:i}=ot(),c=()=>{ue(),ce(),Y()},{inventoryList:m,loading:y,saveLoading:$,stats:L,lowStockItems:I,stockUpdateDialog:O,reorderDialog:B,movementsDialog:N,selectedInventory:A,currentPage:f,totalItems:k,itemsPerPage:v,filters:n,errorMessage:T,successMessage:h,modalErrorMessage:X,stockUpdateForm:P,reorderForm:j,totalStockValue:ie,lowStockCount:H,outOfStockCount:ke,stockStatusOptions:pe,fetchInventoryList:ue,fetchStats:ce,fetchLowStockAlerts:Y,updateStock:ve,setReorderLevel:de,openStockUpdateDialog:xe,openReorderDialog:Se,openMovementsDialog:we,closeStockUpdateDialog:d,closeReorderDialog:D,clearModalError:S,onPageChange:oe,onItemsPerPageChange:Ve,handleFiltersUpdate:le,formatCurrency:_e,getStockStatusColor:Ae,getStockStatusText:Le,totalPages:Fe,hasNextPage:qe,hasPrevPage:ze}=Pt(),{recordStockMovement:fe,openAdjustmentDialog:Me,movementDialog:Ce,adjustmentDialog:Pe,selectedItem:G,movementFormData:U,saveLoading:Oe,closeMovementDialog:ge,successMessage:De,modalErrorMessage:Be,clearModalError:Ke}=Dt(),l=g=>g.item?{id_item:g.item.id_item,item_code:g.item.item_code,name:g.item.name,description:g.item.description||"",unit:g.item.unit,cost_per_unit:parseFloat(g.item.cost_per_unit),current_stock:g.current_stock,minimum_stock:g.reorder_level||0,active:!0,storage_location:g.item.storage_location||"",expiry_date:g.item.expiry_date||null,properties:g.item.properties||null,created_by:g.item.created_by||null,updated_by:g.item.updated_by||null,created_at:g.item.created_at,updated_at:g.item.updated_at,deleted_at:g.item.deleted_at||null}:null,w=g=>{const s=l(g);s&&Me(s)},Ue=K(()=>L.value);return K(()=>m.value),K(()=>y.value),lt(()=>{ue(),ce(),Y()}),tt(k,(g,s)=>{console.log("ðŸ” totalItems changed:",{oldValue:s,newValue:g}),console.log("ðŸ“Š VDataTable will receive server-items-length:",g)},{immediate:!0}),(g,s)=>{var He,Ge,Je,Xe;return x(),ne("div",Ut,[r("div",It,[s[32]||(s[32]=r("div",null,[r("h1",{class:"text-h4 font-weight-bold inventory-title"}," Kelola Inventory "),r("p",{class:"text-body-1 text-medium-emphasis inventory-subtitle"}," Kelola stok barang dan pergerakan inventory ")],-1)),r("div",Tt,[e(M,{color:"primary","prepend-icon":"tabler-refresh",variant:"outlined",onClick:c},{default:a(()=>s[31]||(s[31]=[_(" Refresh Data ")])),_:1,__:[31]})])]),t(T)?(x(),E(se,{key:0,type:"error",variant:"outlined",class:"mb-4",text:t(T),closable:"","onClick:close":s[0]||(s[0]=o=>T.value="")},null,8,["text"])):C("",!0),t(h)?(x(),E(se,{key:1,type:"success",variant:"outlined",class:"mb-4",text:t(h),closable:"","onClick:close":s[1]||(s[1]=o=>h.value="")},null,8,["text"])):C("",!0),t(De)?(x(),E(se,{key:2,type:"success",variant:"outlined",class:"mb-4",text:t(De),closable:"","onClick:close":s[2]||(s[2]=o=>De.value="")},null,8,["text"])):C("",!0),e(te,{class:"mb-6"},{default:a(()=>[e(V,{cols:"12",md:"3"},{default:a(()=>[e(q,{class:"stats-card"},{default:a(()=>[e(z,null,{default:a(()=>[r("div",jt,[r("div",null,[r("div",Rt,u(Ue.value.total_items||0),1),s[33]||(s[33]=r("div",{class:"text-caption text-medium-emphasis"}," Total Produk ",-1))]),e(R,{icon:"tabler-package",size:"48",class:"text-primary opacity-50"})])]),_:1})]),_:1})]),_:1}),e(V,{cols:"12",md:"3"},{default:a(()=>[e(q,{class:"stats-card"},{default:a(()=>[e(z,null,{default:a(()=>[r("div",Et,[r("div",null,[r("div",$t,u(t(H)||0),1),s[34]||(s[34]=r("div",{class:"text-caption text-medium-emphasis"}," Stok Menipis ",-1))]),e(R,{icon:"tabler-alert-triangle",size:"48",class:"text-warning opacity-50"})])]),_:1})]),_:1})]),_:1}),e(V,{cols:"12",md:"3"},{default:a(()=>[e(q,{class:"stats-card"},{default:a(()=>[e(z,null,{default:a(()=>[r("div",At,[r("div",null,[r("div",Lt,u(t(ke)||0),1),s[35]||(s[35]=r("div",{class:"text-caption text-medium-emphasis"}," Stok Habis ",-1))]),e(R,{icon:"tabler-x-circle",size:"48",class:"text-error opacity-50"})])]),_:1})]),_:1})]),_:1}),e(V,{cols:"12",md:"3"},{default:a(()=>[e(q,{class:"stats-card"},{default:a(()=>[e(z,null,{default:a(()=>[r("div",Ft,[r("div",null,[r("div",qt,u(t(_e)(t(ie)||0)),1),s[36]||(s[36]=r("div",{class:"text-caption text-medium-emphasis"}," Nilai Stok ",-1))]),e(R,{icon:"tabler-currency-dollar",size:"48",class:"text-success opacity-50"})])]),_:1})]),_:1})]),_:1})]),_:1}),e(q,{class:"mb-6 info-card",color:"info",variant:"tonal"},{default:a(()=>[e(z,null,{default:a(()=>[r("div",zt,[r("div",Ot,[e(R,{icon:"tabler-info-circle",size:"32",class:"text-info"}),s[37]||(s[37]=r("div",null,[r("div",{class:"text-subtitle-1 font-weight-medium text-info"}," Sistem Stock Movement Otomatis "),r("div",{class:"text-body-2 text-medium-emphasis"},[_(" Stok akan bertambah otomatis saat purchasing dan berkurang saat penjualan POS. Gunakan tombol "),r("strong",null,"Penyesuaian"),_(" untuk koreksi manual jika diperlukan. ")])],-1))]),r("div",Bt,[e(Q,{color:"success",variant:"tonal",size:"small"},{default:a(()=>[e(R,{icon:"tabler-shopping-cart",class:"me-1"}),s[38]||(s[38]=_(" Purchase â†’ Stok + "))]),_:1,__:[38]}),e(Q,{color:"error",variant:"tonal",size:"small"},{default:a(()=>[e(R,{icon:"tabler-cash",class:"me-1"}),s[39]||(s[39]=_(" POS Sale â†’ Stok - "))]),_:1,__:[39]})])])]),_:1})]),_:1}),t(I).length>0?(x(),E(q,{key:3,class:"mb-6 low-stock-alert"},{default:a(()=>[e(me,{class:"d-flex align-center"},{default:a(()=>[e(R,{icon:"tabler-alert-triangle",class:"text-warning me-2"}),_(" Peringatan Stok Menipis ("+u(t(I).length)+" produk) ",1)]),_:1}),e(z,null,{default:a(()=>[r("div",Nt,[(x(!0),ne(rt,null,nt(t(I).slice(0,10),o=>(x(),E(Q,{key:o.id_inventory,color:"warning",variant:"outlined",size:"small"},{default:a(()=>{var b;return[_(u((b=o.product)==null?void 0:b.name)+" ("+u(o.current_stock)+"/"+u(o.reorder_level)+") ",1)]}),_:2},1024))),128)),t(I).length>10?(x(),E(Q,{key:0,color:"warning",variant:"tonal",size:"small"},{default:a(()=>[_(" +"+u(t(I).length-10)+" lainnya ",1)]),_:1})):C("",!0)])]),_:1})]),_:1})):C("",!0),!t(y)&&t(m).length===0&&!t(T)?(x(),E(q,{key:4,class:"mb-6"},{default:a(()=>[e(z,{class:"text-center py-6"},{default:a(()=>[e(R,{icon:"tabler-info-circle",size:"48",class:"text-info mb-3"}),s[40]||(s[40]=r("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),s[41]||(s[41]=r("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[40,41]})]),_:1})):C("",!0),t(y)||t(m).length>0?(x(),E(q,{key:5,class:"mb-6"},{default:a(()=>[e(z,null,{default:a(()=>[e(te,null,{default:a(()=>[e(V,{cols:"12",md:"4"},{default:a(()=>[e(W,{modelValue:t(n).search,"onUpdate:modelValue":[s[3]||(s[3]=o=>t(n).search=o),s[4]||(s[4]=o=>t(le)({search:o}))],label:"Cari inventory produk...",placeholder:"Nama produk, SKU, atau variant","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"3"},{default:a(()=>[e(je,{modelValue:t(n).stock_status,"onUpdate:modelValue":[s[5]||(s[5]=o=>t(n).stock_status=o),s[6]||(s[6]=o=>t(le)({stock_status:o}))],label:"Status Stok",items:t(pe),clearable:"",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(V,{cols:"12",md:"2"},{default:a(()=>[e(je,{modelValue:t(n).sort_by,"onUpdate:modelValue":[s[7]||(s[7]=o=>t(n).sort_by=o),s[8]||(s[8]=o=>t(le)({sort_by:o}))],label:"Urutkan",items:[{title:"Stok Tersedia",value:"current_stock"},{title:"Nama Produk",value:"product_name"},{title:"Terakhir Diperbarui",value:"updated_at"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"2"},{default:a(()=>[e(je,{modelValue:t(n).sort_order,"onUpdate:modelValue":[s[9]||(s[9]=o=>t(n).sort_order=o),s[10]||(s[10]=o=>t(le)({sort_order:o}))],label:"Urutan",items:[{title:"A-Z / 0-9",value:"asc"},{title:"Z-A / 9-0",value:"desc"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"1"},{default:a(()=>[e(M,{variant:"outlined",color:"secondary",block:"",onClick:s[11]||(s[11]=o=>t(le)({search:"",stock_status:"all",sort_by:"current_stock",sort_order:"asc"}))},{default:a(()=>s[42]||(s[42]=[_(" Reset ")])),_:1,__:[42]})]),_:1})]),_:1})]),_:1})]),_:1})):C("",!0),e(q,{class:"products-inventory-table"},{default:a(()=>[e(me,{class:"d-flex align-center gap-2 coffee-header"},{default:a(()=>[e(R,{icon:"tabler-package",class:"text-white"}),s[43]||(s[43]=r("span",{class:"text-white"},"Inventory Produk",-1)),e(he),e(Q,{color:"white",size:"small",variant:"tonal"},{default:a(()=>[_(u(t(k))+" Produk ",1)]),_:1})]),_:1,__:[43]}),e(Z),e(ct,{headers:[{title:"Produk/Variant",key:"item_name",sortable:!1},{title:"SKU",key:"sku",sortable:!1},{title:"Stok Saat Ini",key:"current_stock",sortable:!1},{title:"Stok Tersedia",key:"available_stock",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Reorder Level",key:"reorder_level",sortable:!1},{title:"Harga Rata-rata",key:"average_cost",sortable:!1},{title:"Nilai Stok",key:"stock_value",sortable:!1},{title:"Aksi",key:"actions",sortable:!1}],items:t(m),loading:t(y),"items-length":t(k),"items-per-page":t(v),page:t(f),"items-per-page-options":[10,15,25,50,100],"items-per-page-text":"Items per page:","page-text":"{0}-{1} of {2}","no-data-text":"Tidak ada data inventory",class:"text-no-wrap","onUpdate:page":t(oe),"onUpdate:itemsPerPage":t(Ve)},{"item.item_name":a(({item:o})=>{var b,ee,We,Ze,Qe;return[r("div",Kt,[r("div",null,[r("div",Ht,u(((b=o.item)==null?void 0:b.name)||((ee=o.product)==null?void 0:ee.name)||"Unknown Item"),1),r("small",Gt,u(((We=o.item)==null?void 0:We.description)||((Qe=(Ze=o.product)==null?void 0:Ze.category)==null?void 0:Qe.name)||"-"),1)])])]}),"item.sku":a(({item:o})=>[e(Q,{variant:"outlined",size:"small",color:"primary"},{default:a(()=>{var b,ee;return[_(u(((b=o.item)==null?void 0:b.item_code)||((ee=o.product)==null?void 0:ee.sku)||"N/A"),1)]}),_:2},1024)]),"item.current_stock":a(({item:o})=>[r("div",Jt,[r("div",Xt,u(o.current_stock),1),o.reserved_stock>0?(x(),ne("small",Wt," ("+u(o.reserved_stock)+" reserved) ",1)):C("",!0)])]),"item.available_stock":a(({item:o})=>[r("div",Zt,[e(Q,{color:o.available_stock>0?"success":"error",variant:"tonal",size:"small"},{default:a(()=>[_(u(o.available_stock),1)]),_:2},1032,["color"])])]),"item.status":a(({item:o})=>[e(Q,{color:t(Ae)(o),variant:"tonal",size:"small"},{default:a(()=>[_(u(t(Le)(o)),1)]),_:2},1032,["color"])]),"item.reorder_level":a(({item:o})=>[r("div",Qt,u(o.reorder_level||"-"),1)]),"item.average_cost":a(({item:o})=>[r("div",Yt,u(t(_e)(o.average_cost)),1)]),"item.stock_value":a(({item:o})=>[r("div",ea,u(t(_e)(o.current_stock*o.average_cost)),1)]),"item.actions":a(({item:o})=>[r("div",ta,[e(Re,{text:"Penyesuaian Stok"},{activator:a(({props:b})=>[e(M,Ie(b,{icon:"tabler-adjustments",color:"warning",variant:"text",size:"small",disabled:!o.item,onClick:ee=>w(o)}),null,16,["disabled","onClick"])]),_:2},1024),e(Re,{text:"Update Stok"},{activator:a(({props:b})=>[e(M,Ie(b,{icon:"tabler-edit",color:"primary",variant:"text",size:"small",onClick:ee=>t(xe)(o)}),null,16,["onClick"])]),_:2},1024),e(Re,{text:"Set Reorder Level"},{activator:a(({props:b})=>[e(M,Ie(b,{icon:"tabler-settings",color:"info",variant:"text",size:"small",onClick:ee=>t(Se)(o)}),null,16,["onClick"])]),_:2},1024),e(Re,{text:"Lihat Riwayat"},{activator:a(({props:b})=>[e(M,Ie(b,{icon:"tabler-history",color:"secondary",variant:"text",size:"small",onClick:ee=>t(we)(o)}),null,16,["onClick"])]),_:2},1024)])]),"no-data":a(()=>[r("div",aa,[e(R,{icon:"tabler-package-off",size:"64",class:"text-medium-emphasis mb-4"}),s[46]||(s[46]=r("div",{class:"text-h5 text-medium-emphasis mb-2"}," Belum Ada Data Inventory ",-1)),s[47]||(s[47]=r("div",{class:"text-body-1 text-medium-emphasis mb-4"},[_(" Data inventory akan muncul setelah produk dan variant dibuat."),r("br"),_(" Silakan buat produk terlebih dahulu di menu "),r("strong",null,"Kelola Produk"),_(". ")],-1)),r("div",sa,[e(M,{color:"primary","prepend-icon":"tabler-plus",to:"/products-management"},{default:a(()=>s[44]||(s[44]=[_(" Buat Produk Baru ")])),_:1,__:[44]}),e(M,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:s[12]||(s[12]=o=>{t(ue)(),t(ce)(),t(Y)()})},{default:a(()=>s[45]||(s[45]=[_(" Refresh Data ")])),_:1,__:[45]})])])]),loading:a(()=>[r("div",oa,[e(at,{indeterminate:"",color:"primary",size:"40"}),s[48]||(s[48]=r("div",{class:"mt-4 text-medium-emphasis"}," Memuat data inventory... ",-1))])]),_:1},8,["items","loading","items-length","items-per-page","page","onUpdate:page","onUpdate:itemsPerPage"]),!t(y)&&t(m).length>0?(x(),E(z,{key:0,class:"text-center py-2 text-caption text-medium-emphasis"},{default:a(()=>[_(" Menampilkan "+u(t(m).length)+" dari "+u(t(k))+" total produk inventory ",1),t(n).search||t(n).stock_status!=="all"?(x(),ne("span",la," (hasil pencarian/filter) ")):C("",!0),s[49]||(s[49]=r("br",null,null,-1)),r("small",ra," Debug: Page "+u(t(f))+"/"+u(t(Fe))+" | Items per page: "+u(t(v))+" | Has Next: "+u(t(qe))+" | Has Prev: "+u(t(ze)),1)]),_:1,__:[49]})):C("",!0)]),_:1}),e(be,{modelValue:t(O),"onUpdate:modelValue":s[19]||(s[19]=o=>ye(O)?O.value=o:null),"max-width":"800px",fullscreen:t(i),persistent:"",class:"stock-dialog"},{default:a(()=>[e(q,null,{default:a(()=>[e(me,null,{default:a(()=>{var o,b;return[_(" Update Stok - "+u((b=(o=t(A))==null?void 0:o.product)==null?void 0:b.name),1)]}),_:1}),e(Z),e(Ee,{onSubmit:Te(t(ve),["prevent"])},{default:a(()=>[e(z,null,{default:a(()=>[t(X)?(x(),E(se,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":t(S)},{default:a(()=>[_(u(t(X)),1)]),_:1},8,["onClick:close"])):C("",!0),e(te,null,{default:a(()=>[e(V,{cols:"12",md:"6"},{default:a(()=>[e(je,{modelValue:t(P).movement_type,"onUpdate:modelValue":s[13]||(s[13]=o=>t(P).movement_type=o),label:"Jenis Pergerakan *",items:[{title:"Stock Masuk",value:"stock_in"},{title:"Stock Keluar",value:"stock_out"},{title:"Penyesuaian",value:"adjustment"},{title:"Transfer",value:"transfer"},{title:"Retur",value:"return"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(W,{modelValue:t(P).quantity,"onUpdate:modelValue":s[14]||(s[14]=o=>t(P).quantity=o),modelModifiers:{number:!0},label:"Kuantitas *",type:"number",min:"1",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(te,null,{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[e(W,{modelValue:t(P).reason,"onUpdate:modelValue":s[15]||(s[15]=o=>t(P).reason=o),label:"Alasan *",placeholder:"Contoh: Pembelian dari supplier, Penjualan, dll",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(te,null,{default:a(()=>[e(V,{cols:"12",md:"6"},{default:a(()=>[e(W,{modelValue:t(P).reference_number,"onUpdate:modelValue":s[16]||(s[16]=o=>t(P).reference_number=o),label:"Nomor Referensi",placeholder:"PO-001, SO-001, dll",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(W,{modelValue:t(P).cost_per_unit,"onUpdate:modelValue":s[17]||(s[17]=o=>t(P).cost_per_unit=o),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",min:"0",step:"0.01",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(te,null,{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[e(Ne,{modelValue:t(P).notes,"onUpdate:modelValue":s[18]||(s[18]=o=>t(P).notes=o),label:"Catatan",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Z),e($e,{class:"pa-4"},{default:a(()=>[e(he),e(M,{variant:"outlined",onClick:t(d)},{default:a(()=>s[50]||(s[50]=[_(" Batal ")])),_:1,__:[50]},8,["onClick"]),e(M,{type:"submit",color:"primary",loading:t($)},{default:a(()=>s[51]||(s[51]=[_(" Update Stok ")])),_:1,__:[51]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),e(be,{modelValue:t(B),"onUpdate:modelValue":s[22]||(s[22]=o=>ye(B)?B.value=o:null),"max-width":"600px",fullscreen:t(i),persistent:"",class:"stock-dialog"},{default:a(()=>[e(q,null,{default:a(()=>[e(me,null,{default:a(()=>{var o,b;return[_(" Set Reorder Level - "+u((b=(o=t(A))==null?void 0:o.product)==null?void 0:b.name),1)]}),_:1}),e(Z),e(Ee,{onSubmit:Te(t(de),["prevent"])},{default:a(()=>[e(z,null,{default:a(()=>[t(X)?(x(),E(se,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":t(S)},{default:a(()=>[_(u(t(X)),1)]),_:1},8,["onClick:close"])):C("",!0),e(te,null,{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[e(W,{modelValue:t(j).reorder_level,"onUpdate:modelValue":s[20]||(s[20]=o=>t(j).reorder_level=o),modelModifiers:{number:!0},label:"Reorder Level *",type:"number",min:"0",hint:"Stok minimum sebelum perlu restock","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),e(te,null,{default:a(()=>[e(V,{cols:"12"},{default:a(()=>[e(W,{modelValue:t(j).max_stock_level,"onUpdate:modelValue":s[21]||(s[21]=o=>t(j).max_stock_level=o),modelModifiers:{number:!0},label:"Max Stock Level",type:"number",min:"0",hint:"Stok maksimum yang diizinkan","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Z),e($e,{class:"pa-4"},{default:a(()=>[e(he),e(M,{variant:"outlined",onClick:t(D)},{default:a(()=>s[52]||(s[52]=[_(" Batal ")])),_:1,__:[52]},8,["onClick"]),e(M,{type:"submit",color:"primary",loading:t($)},{default:a(()=>s[53]||(s[53]=[_(" Simpan ")])),_:1,__:[53]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),e(Ct,{modelValue:t(N),"onUpdate:modelValue":s[23]||(s[23]=o=>ye(N)?N.value=o:null),"inventory-id":(Ge=(He=t(A))==null?void 0:He.id_inventory)==null?void 0:Ge.toString(),"inventory-name":(Xe=(Je=t(A))==null?void 0:Je.item)==null?void 0:Xe.name},null,8,["modelValue","inventory-id","inventory-name"]),e(be,{modelValue:t(Pe),"onUpdate:modelValue":s[26]||(s[26]=o=>ye(Pe)?Pe.value=o:null),"max-width":"600px",fullscreen:t(i),persistent:"",class:"stock-dialog"},{default:a(()=>[e(q,{class:"stock-movement-dialog coffee-dialog"},{default:a(()=>[e(me,{class:"d-flex align-center justify-space-between coffee-header"},{default:a(()=>[r("div",na,[e(R,{icon:"tabler-adjustments",class:"text-white"}),s[54]||(s[54]=r("span",{class:"text-white"}," Penyesuaian Stok ",-1))]),e(M,{icon:"tabler-x",variant:"text",color:"white",onClick:t(ge)},null,8,["onClick"])]),_:1}),e(Z),e(z,{class:"pa-6"},{default:a(()=>[e(Ee,{onSubmit:Te(t(fe),["prevent"])},{default:a(()=>{var o;return[t(G)?(x(),E(se,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:a(()=>[r("div",ia,[e(R,{icon:"tabler-package"}),r("div",null,[r("div",ua,u(t(G).name),1),r("div",ca,u(t(G).item_code),1),r("div",da,"Stok Saat Ini: "+u(t(G).current_stock)+" "+u(t(G).unit),1)])])]),_:1})):C("",!0),t(Be)?(x(),E(se,{key:1,type:"error",variant:"outlined",class:"mb-4",text:t(Be),closable:"","onClick:close":t(Ke)},null,8,["text","onClick:close"])):C("",!0),e(W,{modelValue:t(U).quantity,"onUpdate:modelValue":s[24]||(s[24]=b=>t(U).quantity=b),modelModifiers:{number:!0},label:"Stok Baru",type:"number",min:"0",step:"0.001",variant:"outlined",suffix:(o=t(G))==null?void 0:o.unit,class:"mb-4",required:""},null,8,["modelValue","suffix"]),e(Ne,{modelValue:t(U).notes,"onUpdate:modelValue":s[25]||(s[25]=b=>t(U).notes=b),label:"Catatan (opsional)",variant:"outlined",rows:"3",class:"mb-4"},null,8,["modelValue"]),r("div",ma,[e(M,{variant:"outlined",onClick:t(ge)},{default:a(()=>s[55]||(s[55]=[_(" Batal ")])),_:1,__:[55]},8,["onClick"]),e(M,{type:"submit",color:"primary",class:"coffee-primary",loading:t(Oe)},{default:a(()=>s[56]||(s[56]=[_(" Simpan Penyesuaian ")])),_:1,__:[56]},8,["loading"])])]}),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),e(be,{modelValue:t(Ce),"onUpdate:modelValue":s[30]||(s[30]=o=>ye(Ce)?Ce.value=o:null),"max-width":"800px",fullscreen:t(i),persistent:"",class:"stock-dialog"},{default:a(()=>[e(q,{class:"stock-movement-dialog coffee-dialog"},{default:a(()=>[e(me,{class:"d-flex align-center justify-space-between coffee-header"},{default:a(()=>[r("div",pa,[e(R,{icon:t(U).type==="in"?"tabler-plus":"tabler-minus",class:"text-white"},null,8,["icon"]),r("span",va,u(t(U).type==="in"?"Stok Masuk":t(U).type==="out"?"Stok Keluar":"Penyesuaian Stok"),1)]),e(M,{icon:"tabler-x",variant:"text",color:"white",onClick:t(ge)},null,8,["onClick"])]),_:1}),e(Z),e(z,{class:"pa-6"},{default:a(()=>[e(Ee,{onSubmit:Te(t(fe),["prevent"])},{default:a(()=>[t(G)?(x(),E(se,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:a(()=>[r("div",_a,[e(dt,{color:"primary",size:"40",variant:"tonal"},{default:a(()=>[e(R,{icon:"tabler-package"})]),_:1}),r("div",null,[r("div",fa,u(t(G).name),1),r("div",ka," Stok saat ini: "+u(t(G).current_stock)+" "+u(t(G).unit),1)])])]),_:1})):C("",!0),e(te,null,{default:a(()=>[e(V,{cols:"12",md:"6"},{default:a(()=>[e(W,{modelValue:t(U).quantity,"onUpdate:modelValue":s[27]||(s[27]=o=>t(U).quantity=o),modelModifiers:{number:!0},label:`Jumlah ${t(U).type==="in"?"Masuk":t(U).type==="out"?"Keluar":"Akhir"}`,type:"number",variant:"outlined",required:"",min:t(U).type==="adjustment"?0:1,rules:[o=>o>0||"Jumlah harus lebih dari 0"]},null,8,["modelValue","label","min","rules"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(W,{modelValue:t(U).cost_per_unit,"onUpdate:modelValue":s[28]||(s[28]=o=>t(U).cost_per_unit=o),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",variant:"outlined",prefix:"Rp",readonly:t(U).type!=="in"},null,8,["modelValue","readonly"])]),_:1}),e(V,{cols:"12"},{default:a(()=>[e(Ne,{modelValue:t(U).notes,"onUpdate:modelValue":s[29]||(s[29]=o=>t(U).notes=o),label:"Catatan",placeholder:"Masukkan catatan untuk pergerakan stok...",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e(Z),e($e,{class:"pa-6"},{default:a(()=>[e(he),e(M,{variant:"outlined",class:"coffee-secondary",onClick:t(ge)},{default:a(()=>s[57]||(s[57]=[_(" Batal ")])),_:1,__:[57]},8,["onClick"]),e(M,{color:"primary",class:"coffee-primary",loading:t(Oe),onClick:t(fe)},{default:a(()=>s[58]||(s[58]=[_(" Simpan ")])),_:1,__:[58]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}}),Ga=st(ga,[["__scopeId","data-v-982f2d14"]]);export{Ga as default};
