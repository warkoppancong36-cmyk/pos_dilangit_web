import{D as Ae}from"./DeleteConfirmationDialog-C3SR5WIm.js";import{d as J,r as y,g as R,f as a,b as e,s as p,X as w,t as g,a0 as Fe,l as L,at as Ve,a1 as E,o as D,V as G,e as c,aI as Oe,c as te,au as N,D as Ne,m as r,a3 as Pe,_ as je}from"./main-mVb2Zi2r.js";import{V as Ee}from"./VDialog-BhHbwSp-.js";import{b as W,c as Se,V as z}from"./VCard-KdKd0_zs.js";import{V as X}from"./VDivider-Dg-qwhzs.js";import{V as qe}from"./VForm-Crx42ANL.js";import{V as A}from"./VCardText-C6cQ2YPR.js";import{V as Y,a as V}from"./VRow-BmgHKxKl.js";import{V as x}from"./VTextField-BbvOAUmR.js";import{V as le}from"./VSelect-DaQg8yMC.js";import{V as Ke}from"./VSwitch-BrRftdBW.js";import{V as se}from"./VSpacer-DKRYQo20.js";import{V as xe}from"./VContainer-Du07OJ9E.js";import{V as H}from"./VAvatar-CPl1Rs8l.js";import{V as oe}from"./VChip-DfcpfFlX.js";import{V as Re,a as j,b as q,d as K}from"./VList-B7SLC7Gv.js";import{V as Ge,a as He}from"./VDataTable-CBL58a2p.js";import"./VOverlay-Q1I2eFOg.js";import"./forwardRefs-B931MWyl.js";import"./VImg-DDUr8xsk.js";/* empty css              */import"./VMenu-MXx5zkZ-.js";import"./VCheckboxBtn-Bjfx1eIL.js";import"./VTable-COTb2rj8.js";import"./filter-BpN1xjbh.js";const Xe=J({__name:"UserDialog",props:{modelValue:{type:Boolean},editMode:{type:Boolean},formData:{},loading:{type:Boolean},errorMessage:{},roleOptions:{},nameRules:{},usernameRules:{},emailRules:{},passwordRules:{},roleRules:{}},emits:["update:modelValue","save","cancel","clear-error"],setup(S,{emit:k}){const u=k,d=y(),m=y(!1),f=async()=>{const{valid:t}=await d.value.validate();t&&u("save")};return(t,o)=>(D(),R(Ee,{"model-value":t.modelValue,"max-width":"600px",persistent:"","onUpdate:modelValue":o[10]||(o[10]=l=>t.$emit("update:modelValue",l))},{default:a(()=>[e(z,null,{default:a(()=>[e(W,{class:"text-h5 pa-6 pb-4"},{default:a(()=>[e(w,{icon:t.editMode?"tabler-edit":"tabler-plus",class:"me-3"},null,8,["icon"]),p(" "+g(t.editMode?"Edit Pengguna":"Tambah Pengguna Baru"),1)]),_:1}),e(X),e(qe,{ref_key:"formRef",ref:d,onSubmit:Fe(f,["prevent"])},{default:a(()=>[e(A,{class:"pa-6"},{default:a(()=>[t.errorMessage?(D(),R(Ve,{key:0,type:"error",variant:"outlined",class:"mb-4",text:t.errorMessage,closable:"","onClick:close":o[0]||(o[0]=l=>t.$emit("clear-error"))},null,8,["text"])):L("",!0),e(Y,null,{default:a(()=>[e(V,{cols:"12",md:"6"},{default:a(()=>[e(x,{modelValue:t.formData.name,"onUpdate:modelValue":o[1]||(o[1]=l=>t.formData.name=l),label:"Nama Lengkap",variant:"outlined","prepend-inner-icon":"tabler-user",rules:t.nameRules,required:""},null,8,["modelValue","rules"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(x,{modelValue:t.formData.username,"onUpdate:modelValue":o[2]||(o[2]=l=>t.formData.username=l),label:"Username",variant:"outlined","prepend-inner-icon":"tabler-at",rules:t.usernameRules,required:""},null,8,["modelValue","rules"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(x,{modelValue:t.formData.email,"onUpdate:modelValue":o[3]||(o[3]=l=>t.formData.email=l),label:"Email",type:"email",variant:"outlined","prepend-inner-icon":"tabler-mail",rules:t.emailRules,required:""},null,8,["modelValue","rules"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(x,{modelValue:t.formData.phone,"onUpdate:modelValue":o[4]||(o[4]=l=>t.formData.phone=l),label:"Nomor Telepon",variant:"outlined","prepend-inner-icon":"tabler-phone"},null,8,["modelValue"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(x,{modelValue:t.formData.password,"onUpdate:modelValue":o[5]||(o[5]=l=>t.formData.password=l),label:t.editMode?"Password Baru (kosongkan jika tidak diubah)":"Password",type:m.value?"text":"password",variant:"outlined","prepend-inner-icon":"tabler-lock","append-inner-icon":m.value?"tabler-eye-off":"tabler-eye",rules:t.passwordRules,required:!t.editMode,"onClick:appendInner":o[6]||(o[6]=l=>m.value=!m.value)},null,8,["modelValue","label","type","append-inner-icon","rules","required"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(le,{modelValue:t.formData.role_id,"onUpdate:modelValue":o[7]||(o[7]=l=>t.formData.role_id=l),label:"Role",variant:"outlined","prepend-inner-icon":"tabler-shield",items:t.roleOptions,"item-title":"name","item-value":"id",rules:t.roleRules,required:""},null,8,["modelValue","items","rules"])]),_:1}),e(V,{cols:"12"},{default:a(()=>[e(Ke,{modelValue:t.formData.is_active,"onUpdate:modelValue":o[8]||(o[8]=l=>t.formData.is_active=l),label:"Pengguna Aktif",color:"success",inset:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(X),e(Se,{class:"pa-6"},{default:a(()=>[e(se),e(E,{variant:"outlined",onClick:o[9]||(o[9]=l=>t.$emit("cancel"))},{default:a(()=>o[11]||(o[11]=[p(" Batal ")])),_:1,__:[11]}),e(E,{type:"submit",color:"primary",variant:"elevated",loading:t.loading,"prepend-icon":t.editMode?"tabler-check":"tabler-plus"},{default:a(()=>[p(g(t.editMode?"Perbarui":"Simpan"),1)]),_:1},8,["loading","prepend-icon"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["model-value"]))}}),Je={class:"d-flex align-center"},Qe={class:"flex-grow-1"},We={class:"text-h4 font-weight-bold"},Ye={class:"text-body-1 text-medium-emphasis mb-2"},Ze=J({__name:"UserDetailsDialog",props:{show:{type:Boolean},user:{}},emits:["update:show","edit","delete"],setup(S,{emit:k}){const u=S,d=k,m=G({get:()=>u.show,set:n=>d("update:show",n)}),f=()=>{d("update:show",!1)},t=()=>{u.user&&(d("edit",u.user),f())},o=()=>{u.user&&(d("delete",u.user),f())},l=n=>{switch(n==null?void 0:n.toLowerCase()){case"admin":return"error";case"manager":return"warning";case"cashier":return"primary";case"staff":return"info";default:return"secondary"}},h=n=>n?new Date(n).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}):"-",$=n=>n?new Date(n).toLocaleString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return(n,i)=>(D(),R(Ee,{modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=M=>m.value=M),"max-width":"800px",scrollable:""},{default:a(()=>[n.user?(D(),R(z,{key:0},{default:a(()=>[e(W,{class:"text-h5 pa-6 pb-4"},{default:a(()=>[e(w,{icon:"tabler-user",class:"me-3 text-primary"}),i[2]||(i[2]=p(" Detail Pengguna ")),e(se),e(E,{icon:"",variant:"text",onClick:f},{default:a(()=>[e(w,null,{default:a(()=>i[1]||(i[1]=[p("tabler-x")])),_:1,__:[1]})]),_:1})]),_:1,__:[2]}),e(X),e(A,{class:"pa-0"},{default:a(()=>[e(xe,{class:"pa-6"},{default:a(()=>[e(Y,{class:"mb-6"},{default:a(()=>[e(V,{cols:"12"},{default:a(()=>{var M;return[c("div",Je,[e(H,{size:"80",color:n.user.is_active?"primary":"secondary",class:"me-4"},{default:a(()=>[e(w,{icon:n.user.is_active?"tabler-user":"tabler-user-off",size:"40"},null,8,["icon"])]),_:1},8,["color"]),c("div",Qe,[c("h2",We,g(n.user.name),1),c("p",Ye,"@"+g(n.user.username),1),e(oe,{color:n.user.is_active?"success":"error","prepend-icon":n.user.is_active?"tabler-check":"tabler-x",variant:"tonal",size:"small"},{default:a(()=>[p(g(n.user.is_active?"Aktif":"Nonaktif"),1)]),_:1},8,["color","prepend-icon"]),e(oe,{color:l((M=n.user.role)==null?void 0:M.name),variant:"tonal",size:"small",class:"ms-2"},{default:a(()=>{var _;return[p(g(((_=n.user.role)==null?void 0:_.name)||"No Role"),1)]}),_:1},8,["color"])])])]}),_:1})]),_:1}),e(Y,null,{default:a(()=>[e(V,{cols:"12",md:"6"},{default:a(()=>[e(z,{variant:"outlined",class:"h-100"},{default:a(()=>[e(W,{class:"text-h6 pa-4 pb-2"},{default:a(()=>[e(w,{icon:"tabler-info-circle",class:"me-2"}),i[3]||(i[3]=p(" Informasi Kontak "))]),_:1,__:[3]}),e(A,{class:"pa-4 pt-2"},{default:a(()=>[e(Re,{density:"compact",class:"pa-0"},{default:a(()=>[e(j,null,{prepend:a(()=>[e(w,{icon:"tabler-mail",class:"me-3"})]),default:a(()=>[e(q,{class:"text-body-2 text-medium-emphasis"},{default:a(()=>i[4]||(i[4]=[p("Email")])),_:1,__:[4]}),e(K,{class:"font-weight-bold"},{default:a(()=>[p(g(n.user.email),1)]),_:1})]),_:1}),n.user.phone?(D(),R(j,{key:0},{prepend:a(()=>[e(w,{icon:"tabler-phone",class:"me-3"})]),default:a(()=>[e(q,{class:"text-body-2 text-medium-emphasis"},{default:a(()=>i[5]||(i[5]=[p("Telepon")])),_:1,__:[5]}),e(K,{class:"font-weight-bold"},{default:a(()=>[p(g(n.user.phone),1)]),_:1})]),_:1})):L("",!0),e(j,null,{prepend:a(()=>[e(w,{icon:"tabler-shield",class:"me-3"})]),default:a(()=>[e(q,{class:"text-body-2 text-medium-emphasis"},{default:a(()=>i[6]||(i[6]=[p("Role")])),_:1,__:[6]}),e(K,{class:"font-weight-bold"},{default:a(()=>{var M;return[p(g(((M=n.user.role)==null?void 0:M.name)||"No Role"),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(z,{variant:"outlined",class:"h-100"},{default:a(()=>[e(W,{class:"text-h6 pa-4 pb-2"},{default:a(()=>[e(w,{icon:"tabler-clock",class:"me-2"}),i[7]||(i[7]=p(" Aktivitas "))]),_:1,__:[7]}),e(A,{class:"pa-4 pt-2"},{default:a(()=>[e(Re,{density:"compact",class:"pa-0"},{default:a(()=>[e(j,null,{prepend:a(()=>[e(w,{icon:"tabler-calendar-plus",class:"me-3"})]),default:a(()=>[e(q,{class:"text-body-2 text-medium-emphasis"},{default:a(()=>i[8]||(i[8]=[p("Tanggal Bergabung")])),_:1,__:[8]}),e(K,{class:"font-weight-bold"},{default:a(()=>[p(g(h(n.user.created_at)),1)]),_:1})]),_:1}),e(j,null,{prepend:a(()=>[e(w,{icon:"tabler-login",class:"me-3"})]),default:a(()=>[e(q,{class:"text-body-2 text-medium-emphasis"},{default:a(()=>i[9]||(i[9]=[p("Terakhir Login")])),_:1,__:[9]}),e(K,{class:"font-weight-bold"},{default:a(()=>[p(g(n.user.last_login_at?$(n.user.last_login_at):"Belum pernah login"),1)]),_:1})]),_:1}),e(j,null,{prepend:a(()=>[e(w,{icon:"tabler-edit",class:"me-3"})]),default:a(()=>[e(q,{class:"text-body-2 text-medium-emphasis"},{default:a(()=>i[10]||(i[10]=[p("Terakhir Diperbarui")])),_:1,__:[10]}),e(K,{class:"font-weight-bold"},{default:a(()=>[p(g($(n.user.updated_at)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(X),e(Se,{class:"pa-6"},{default:a(()=>[e(se),e(E,{variant:"outlined","prepend-icon":"tabler-edit",color:"primary",onClick:t},{default:a(()=>i[11]||(i[11]=[p(" Edit Pengguna ")])),_:1,__:[11]}),e(E,{variant:"outlined","prepend-icon":"tabler-trash",color:"error",onClick:o},{default:a(()=>i[12]||(i[12]=[p(" Hapus ")])),_:1,__:[12]}),e(E,{variant:"text",onClick:f},{default:a(()=>i[13]||(i[13]=[p(" Tutup ")])),_:1,__:[13]})]),_:1})]),_:1})):L("",!0)]),_:1},8,["modelValue"]))}}),ea={class:"d-flex gap-2"},aa=J({__name:"UserSearchFilters",props:{searchValue:{},statusFilter:{},roleFilter:{},sortBy:{},sortOrder:{},roleOptions:{}},emits:["update:search","update:status-filter","update:role-filter","update:sort-by","update:sort-order","search","refresh"],setup(S){const k=[{title:"Semua Status",value:"all"},{title:"Aktif",value:"active"},{title:"Nonaktif",value:"inactive"}],u=[{title:"Tanggal Dibuat",value:"created_at"},{title:"Nama",value:"name"},{title:"Username",value:"username"},{title:"Email",value:"email"},{title:"Terakhir Login",value:"last_login_at"},{title:"Status",value:"is_active"}];return(d,m)=>(D(),R(z,{class:"mb-6"},{default:a(()=>[e(A,{class:"pa-6"},{default:a(()=>[e(Y,null,{default:a(()=>[e(V,{cols:"12",md:"4"},{default:a(()=>[e(x,{"model-value":d.searchValue,label:"Cari pengguna...",placeholder:"Nama, username, email, atau phone",variant:"outlined","prepend-inner-icon":"tabler-search",clearable:"","onUpdate:modelValue":m[0]||(m[0]=f=>d.$emit("update:search",f)),onKeyup:m[1]||(m[1]=Oe(f=>d.$emit("search"),["enter"]))},null,8,["model-value"])]),_:1}),e(V,{cols:"12",md:"2"},{default:a(()=>[e(le,{"model-value":d.statusFilter,label:"Status",variant:"outlined",items:k,"onUpdate:modelValue":m[2]||(m[2]=f=>d.$emit("update:status-filter",f))},null,8,["model-value"])]),_:1}),e(V,{cols:"12",md:"2"},{default:a(()=>[e(le,{"model-value":d.roleFilter,label:"Role",variant:"outlined",items:d.roleOptions,"item-title":"name","item-value":"id",clearable:"","onUpdate:modelValue":m[3]||(m[3]=f=>d.$emit("update:role-filter",f))},null,8,["model-value","items"])]),_:1}),e(V,{cols:"12",md:"2"},{default:a(()=>[e(le,{"model-value":d.sortBy,label:"Urutkan",variant:"outlined",items:u,"onUpdate:modelValue":m[4]||(m[4]=f=>d.$emit("update:sort-by",f))},null,8,["model-value"])]),_:1}),e(V,{cols:"12",md:"1"},{default:a(()=>[e(E,{icon:d.sortOrder==="asc"?"tabler-sort-ascending":"tabler-sort-descending",variant:"outlined",color:"primary",onClick:m[5]||(m[5]=f=>d.$emit("update:sort-order",d.sortOrder==="asc"?"desc":"asc"))},null,8,["icon"])]),_:1}),e(V,{cols:"12",md:"1"},{default:a(()=>[c("div",ea,[e(E,{icon:"tabler-refresh",variant:"outlined",onClick:m[6]||(m[6]=f=>d.$emit("refresh"))})])]),_:1})]),_:1})]),_:1})]),_:1}))}}),ta={class:"text-h4 font-weight-bold"},la={class:"text-h4 font-weight-bold"},sa={class:"text-h4 font-weight-bold"},oa={class:"text-h4 font-weight-bold"},ra=J({__name:"UserStatsCards",props:{totalUsers:{},activeUsers:{},inactiveUsers:{},totalRoles:{}},setup(S){return(k,u)=>(D(),R(Y,{class:"mb-6"},{default:a(()=>[e(V,{cols:"12",md:"3"},{default:a(()=>[e(z,null,{default:a(()=>[e(A,{class:"text-center pa-6"},{default:a(()=>[e(H,{size:"56",color:"primary",class:"mb-4"},{default:a(()=>[e(w,{icon:"tabler-users",size:"28"})]),_:1}),c("div",ta,g(k.totalUsers),1),u[0]||(u[0]=c("div",{class:"text-subtitle-2 text-medium-emphasis"},"Total Pengguna",-1))]),_:1,__:[0]})]),_:1})]),_:1}),e(V,{cols:"12",md:"3"},{default:a(()=>[e(z,null,{default:a(()=>[e(A,{class:"text-center pa-6"},{default:a(()=>[e(H,{size:"56",color:"success",class:"mb-4"},{default:a(()=>[e(w,{icon:"tabler-user-check",size:"28"})]),_:1}),c("div",la,g(k.activeUsers),1),u[1]||(u[1]=c("div",{class:"text-subtitle-2 text-medium-emphasis"},"Pengguna Aktif",-1))]),_:1,__:[1]})]),_:1})]),_:1}),e(V,{cols:"12",md:"3"},{default:a(()=>[e(z,null,{default:a(()=>[e(A,{class:"text-center pa-6"},{default:a(()=>[e(H,{size:"56",color:"warning",class:"mb-4"},{default:a(()=>[e(w,{icon:"tabler-user-x",size:"28"})]),_:1}),c("div",sa,g(k.inactiveUsers),1),u[2]||(u[2]=c("div",{class:"text-subtitle-2 text-medium-emphasis"},"Pengguna Nonaktif",-1))]),_:1,__:[2]})]),_:1})]),_:1}),e(V,{cols:"12",md:"3"},{default:a(()=>[e(z,null,{default:a(()=>[e(A,{class:"text-center pa-6"},{default:a(()=>[e(H,{size:"56",color:"info",class:"mb-4"},{default:a(()=>[e(w,{icon:"tabler-shield-lock",size:"28"})]),_:1}),c("div",oa,g(k.totalRoles),1),u[3]||(u[3]=c("div",{class:"text-subtitle-2 text-medium-emphasis"},"Total Role",-1))]),_:1,__:[3]})]),_:1})]),_:1})]),_:1}))}}),na={class:"d-flex align-center py-3"},ia={class:"font-weight-bold"},ua={class:"text-caption text-medium-emphasis"},da={class:"text-body-2"},ma={key:0,class:"text-caption text-medium-emphasis"},pa={key:0,class:"text-body-2"},ca={key:1,class:"text-caption text-medium-emphasis"},ga={class:"d-flex gap-1"},fa={class:"text-center py-8"},va={class:"pa-4 d-flex justify-space-between align-center"},ba={class:"text-body-2 text-medium-emphasis"},ha=J({__name:"UserTable",props:{userList:{},loading:{type:Boolean},currentPage:{},totalItems:{},itemsPerPage:{},canCreateEdit:{type:Boolean},canDelete:{type:Boolean},toggleLoading:{}},emits:["page-change","view","edit","delete","toggle","bulk-delete"],setup(S){const k=y([]),u=G(()=>1),d=[{title:"Pengguna",key:"user_info",sortable:!1},{title:"Kontak",key:"contact",sortable:!1},{title:"Role",key:"role",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Terakhir Login",key:"last_login",sortable:!1},{title:"Aksi",key:"actions",sortable:!1,align:"center"}],m=t=>{switch(t==null?void 0:t.toLowerCase()){case"admin":return"error";case"manager":return"warning";case"cashier":return"primary";case"staff":return"info";default:return"secondary"}},f=t=>t?new Date(t).toLocaleString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-";return(t,o)=>(D(),R(z,null,{default:a(()=>[e(W,{class:"d-flex align-center pa-6 pb-4"},{default:a(()=>[e(w,{icon:"tabler-users",class:"me-3"}),o[4]||(o[4]=p(" Daftar Pengguna ")),e(se),k.value.length>0?(D(),R(E,{key:0,color:"error",variant:"outlined","prepend-icon":"tabler-trash",onClick:o[0]||(o[0]=l=>t.$emit("bulk-delete",k.value.map(h=>h.id)))},{default:a(()=>[p(" Hapus Terpilih ("+g(k.value.length)+") ",1)]),_:1})):L("",!0)]),_:1,__:[4]}),e(X),e(Ge,{modelValue:k.value,"onUpdate:modelValue":o[1]||(o[1]=l=>k.value=l),headers:d,items:t.userList,loading:t.loading,"items-per-page":t.itemsPerPage,page:t.currentPage,class:"text-no-wrap","show-select":"","onUpdate:page":o[2]||(o[2]=l=>t.$emit("page-change",l))},{"item.user_info":a(({item:l})=>[c("div",na,[e(H,{size:"40",color:l.is_active?"primary":"secondary",class:"me-3"},{default:a(()=>[e(w,{icon:l.is_active?"tabler-user":"tabler-user-off",size:"20"},null,8,["icon"])]),_:2},1032,["color"]),c("div",null,[c("div",ia,g(l.name),1),c("div",ua,"@"+g(l.username),1)])])]),"item.contact":a(({item:l})=>[c("div",null,[c("div",da,g(l.email),1),l.phone?(D(),te("div",ma,g(l.phone),1)):L("",!0)])]),"item.role":a(({item:l})=>{var h;return[e(oe,{color:m((h=l.role)==null?void 0:h.name),variant:"tonal",size:"small"},{default:a(()=>{var $;return[p(g((($=l.role)==null?void 0:$.name)||"No Role"),1)]}),_:2},1032,["color"])]}),"item.status":a(({item:l})=>[e(oe,{color:l.is_active?"success":"error","prepend-icon":l.is_active?"tabler-check":"tabler-x",variant:"tonal",size:"small"},{default:a(()=>[p(g(l.is_active?"Aktif":"Nonaktif"),1)]),_:2},1032,["color","prepend-icon"])]),"item.last_login":a(({item:l})=>[l.last_login_at?(D(),te("div",pa,g(f(l.last_login_at)),1)):(D(),te("div",ca," Belum pernah login "))]),"item.actions":a(({item:l})=>[c("div",ga,[e(E,{icon:"tabler-eye",size:"small",variant:"text",onClick:h=>t.$emit("view",l)},null,8,["onClick"]),t.canCreateEdit?(D(),R(E,{key:0,icon:"tabler-edit",size:"small",variant:"text",color:"primary",onClick:h=>t.$emit("edit",l)},null,8,["onClick"])):L("",!0),t.canDelete&&l.id!==u.value?(D(),R(E,{key:1,icon:l.is_active?"tabler-user-off":"tabler-user-check",size:"small",variant:"text",color:l.is_active?"warning":"success",loading:t.toggleLoading[l.id],onClick:h=>t.$emit("toggle",l)},null,8,["icon","color","loading","onClick"])):L("",!0),t.canDelete&&l.id!==u.value?(D(),R(E,{key:2,icon:"tabler-trash",size:"small",variant:"text",color:"error",onClick:h=>t.$emit("delete",l)},null,8,["onClick"])):L("",!0)])]),"no-data":a(()=>[c("div",fa,[e(w,{icon:"tabler-users-off",size:"48",class:"text-disabled mb-4"}),o[5]||(o[5]=c("div",{class:"text-h6 text-disabled"},"Tidak ada data pengguna",-1)),o[6]||(o[6]=c("div",{class:"text-body-2 text-disabled"},"Tambahkan pengguna pertama untuk memulai",-1))])]),_:1},8,["modelValue","items","loading","items-per-page","page"]),e(X),c("div",va,[c("div",ba," Menampilkan "+g(Math.min((t.currentPage-1)*t.itemsPerPage+1,t.totalItems))+" sampai "+g(Math.min(t.currentPage*t.itemsPerPage,t.totalItems))+" dari "+g(t.totalItems)+" hasil ",1),e(He,{"model-value":t.currentPage,length:Math.ceil(t.totalItems/t.itemsPerPage),"total-visible":5,"onUpdate:modelValue":o[3]||(o[3]=l=>t.$emit("page-change",l))},null,8,["model-value","length"])])]),_:1}))}}),ya=()=>{const S=y([]),k=y([]),u=y(!1),d=y(!1),m=y(!1),f=y({}),t=y(!1),o=y(!1),l=y(!1),h=y(null),$=y(1),n=y(0),i=y(15),M=y({search:"",status:"all",role_id:void 0,sort_by:"created_at",sort_order:"desc",page:1,per_page:15}),_=y(""),I=y(""),T=y(""),O=y({name:"",username:"",email:"",phone:"",password:"",role_id:null,is_active:!0}),re=[s=>!!s||"Nama wajib diisi",s=>s.length>=2||"Nama minimal 2 karakter"],ne=[s=>!!s||"Username wajib diisi",s=>s.length>=3||"Username minimal 3 karakter"],ie=[s=>!!s||"Email wajib diisi",s=>/.+@.+\..+/.test(s)||"Email harus valid"],ue=[s=>l.value&&!s?!0:!!s||"Password wajib diisi",s=>l.value&&!s?!0:s.length>=6||"Password minimal 6 karakter"],de=[s=>!!s||"Role wajib dipilih"],me=G(()=>!0),Z=G(()=>!0),pe=G(()=>S.value.filter(s=>s.is_active).length),ce=G(()=>S.value.filter(s=>!s.is_active).length),B=async()=>{var s,U;try{u.value=!0,_.value="";const v={...M.value,page:$.value,per_page:i.value},b=await N.get("/api/users",{params:v});b.data.success&&(S.value=b.data.data.data||b.data.data,n.value=b.data.data.total||S.value.length,b.data.data.current_page&&($.value=b.data.data.current_page))}catch(v){console.error("Error fetching users:",v),_.value=((U=(s=v.response)==null?void 0:s.data)==null?void 0:U.message)||"Gagal memuat data pengguna",S.value=[]}finally{u.value=!1}},ee=async()=>{try{const s=await N.get("/api/users/roles");s.data.success&&(k.value=s.data.data)}catch(s){console.error("Error fetching roles:",s)}},ge=async()=>{var s,U;try{d.value=!0,T.value="";const v={...O.value};l.value&&!v.password&&delete v.password;let b;l.value&&h.value?b=await N.put(`/api/users/${h.value.id}`,v):b=await N.post("/api/users",v),b.data.success&&(I.value=l.value?"Pengguna berhasil diperbarui":"Pengguna berhasil ditambahkan",Q(),await B())}catch(v){console.error("Error saving user:",v),T.value=((U=(s=v.response)==null?void 0:s.data)==null?void 0:U.message)||"Gagal menyimpan pengguna"}finally{d.value=!1}},fe=async()=>{var s,U;if(h.value)try{m.value=!0,(await N.delete(`/api/users/${h.value.id}`)).data.success&&(I.value="Pengguna berhasil dihapus",o.value=!1,h.value=null,await B())}catch(v){console.error("Error deleting user:",v),_.value=((U=(s=v.response)==null?void 0:s.data)==null?void 0:U.message)||"Gagal menghapus pengguna"}finally{m.value=!1}},ve=async s=>{var U,v;try{f.value[s.id]=!0;const b=await N.post(`/api/users/${s.id}/toggle-active`);if(b.data.success){const _e=b.data.data.is_active?"diaktifkan":"dinonaktifkan";I.value=`Pengguna berhasil ${_e}`,await B()}}catch(b){console.error("Error toggling user status:",b),_.value=((v=(U=b.response)==null?void 0:U.data)==null?void 0:v.message)||"Gagal mengubah status pengguna"}finally{f.value[s.id]=!1}},be=async s=>{var U,v;try{u.value=!0;const b=await N.post("/api/users/bulk-delete",{user_ids:s});b.data.success&&(I.value=`${b.data.data.deleted_count} pengguna berhasil dihapus`,await B())}catch(b){console.error("Error bulk deleting users:",b),_.value=((v=(U=b.response)==null?void 0:U.data)==null?void 0:v.message)||"Gagal menghapus pengguna"}finally{u.value=!1}},he=()=>{l.value=!1,h.value=null,O.value={name:"",username:"",email:"",phone:"",password:"",role_id:null,is_active:!0},T.value="",t.value=!0},ye=s=>{l.value=!0,h.value=s,O.value={name:s.name,username:s.username,email:s.email,phone:s.phone||"",password:"",role_id:s.role_id,is_active:s.is_active},T.value="",t.value=!0},ae=s=>{h.value=s,o.value=!0},Q=()=>{t.value=!1,l.value=!1,h.value=null,T.value="",O.value={name:"",username:"",email:"",phone:"",password:"",role_id:null,is_active:!0}};return{users:S,roles:k,loading:u,saveLoading:d,deleteLoading:m,toggleLoading:f,dialog:t,deleteDialog:o,editMode:l,selectedUser:h,currentPage:$,totalItems:n,itemsPerPage:i,filters:M,errorMessage:_,successMessage:I,modalErrorMessage:T,formData:O,nameRules:re,usernameRules:ne,emailRules:ie,passwordRules:ue,roleRules:de,canCreateEdit:me,canDelete:Z,totalActiveUsers:pe,totalInactiveUsers:ce,fetchUsers:B,fetchRoles:ee,saveUser:ge,deleteUser:fe,toggleActiveStatus:ve,bulkDeleteUsers:be,openCreateDialog:he,openEditDialog:ye,openDeleteDialog:ae,closeDialog:Q,clearModalError:()=>{T.value=""},onPageChange:s=>{$.value=s,B()},onSearch:()=>{$.value=1,B()},onFilterChange:()=>{$.value=1,B()},onSortChange:()=>{$.value=1,B()}}},ka={class:"user-management"},_a={class:"d-flex justify-space-between align-center mb-6"},Va=J({__name:"user-management",setup(S){const{users:k,roles:u,loading:d,saveLoading:m,deleteLoading:f,toggleLoading:t,dialog:o,deleteDialog:l,editMode:h,selectedUser:$,currentPage:n,totalItems:i,itemsPerPage:M,filters:_,errorMessage:I,successMessage:T,modalErrorMessage:O,formData:re,nameRules:ne,usernameRules:ie,emailRules:ue,passwordRules:de,roleRules:me,canCreateEdit:Z,canDelete:pe,totalActiveUsers:ce,totalInactiveUsers:B,fetchUsers:ee,fetchRoles:ge,saveUser:fe,deleteUser:ve,toggleActiveStatus:be,bulkDeleteUsers:he,openCreateDialog:ye,openEditDialog:ae,openDeleteDialog:Q,closeDialog:we,clearModalError:De,onPageChange:Ue,onSearch:Ce,onFilterChange:ke,onSortChange:s}=ya(),U=y(!1),v=y(null),b=P=>{_.value.search=P},_e=P=>{_.value.status=P,ke()},Me=P=>{_.value.role_id=P,ke()},Te=P=>{_.value.sort_by=P,s()},Be=P=>{_.value.sort_order=P,s()},Le=P=>{v.value=P,U.value=!0},ze=async()=>{await ve()},Ie=async P=>{confirm(`Apakah Anda yakin ingin menghapus ${P.length} pengguna yang dipilih?`)&&await he(P)};return Ne(async()=>{await ge(),await ee()}),(P,C)=>{var $e;return D(),te("div",ka,[c("div",_a,[C[7]||(C[7]=c("div",null,[c("h1",{class:"text-h4 font-weight-bold coffee-title"},"User Management"),c("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola pengguna sistem dan hak akses mereka")],-1)),r(Z)?(D(),R(E,{key:0,color:"primary","prepend-icon":"tabler-plus",class:"coffee-btn",onClick:r(ye)},{default:a(()=>C[6]||(C[6]=[p(" Tambah Pengguna Baru ")])),_:1,__:[6]},8,["onClick"])):L("",!0)]),r(I)?(D(),R(Ve,{key:0,type:"error",variant:"outlined",class:"mb-4",text:r(I),closable:"","onClick:close":C[0]||(C[0]=F=>I.value="")},null,8,["text"])):L("",!0),r(T)?(D(),R(Ve,{key:1,type:"success",variant:"outlined",class:"mb-4",text:r(T),closable:"","onClick:close":C[1]||(C[1]=F=>T.value="")},null,8,["text"])):L("",!0),e(ra,{"total-users":r(k).length,"active-users":r(ce),"inactive-users":r(B),"total-roles":r(u).length},null,8,["total-users","active-users","inactive-users","total-roles"]),e(aa,{"search-value":r(_).search||"","status-filter":r(_).status||"all","role-filter":r(_).role_id,"sort-by":r(_).sort_by||"created_at","sort-order":r(_).sort_order||"desc","role-options":r(u),"onUpdate:search":b,"onUpdate:statusFilter":_e,"onUpdate:roleFilter":Me,"onUpdate:sortBy":Te,"onUpdate:sortOrder":Be,onSearch:r(Ce),onRefresh:r(ee)},null,8,["search-value","status-filter","role-filter","sort-by","sort-order","role-options","onSearch","onRefresh"]),e(ha,{"user-list":r(k),loading:r(d),"current-page":r(n),"total-items":r(i),"items-per-page":r(M),"can-create-edit":r(Z),"can-delete":r(pe),"toggle-loading":r(t),onPageChange:r(Ue),onView:Le,onEdit:r(ae),onDelete:r(Q),onToggle:r(be),onBulkDelete:Ie},null,8,["user-list","loading","current-page","total-items","items-per-page","can-create-edit","can-delete","toggle-loading","onPageChange","onEdit","onDelete","onToggle"]),e(Xe,{modelValue:r(o),"onUpdate:modelValue":C[2]||(C[2]=F=>Pe(o)?o.value=F:null),"edit-mode":r(h),"form-data":r(re),loading:r(m),"error-message":r(O),"role-options":r(u),"name-rules":r(ne),"username-rules":r(ie),"email-rules":r(ue),"password-rules":r(de),"role-rules":r(me),onSave:r(fe),onCancel:r(we),onClearError:r(De)},null,8,["modelValue","edit-mode","form-data","loading","error-message","role-options","name-rules","username-rules","email-rules","password-rules","role-rules","onSave","onCancel","onClearError"]),e(Ze,{show:U.value,"onUpdate:show":C[3]||(C[3]=F=>U.value=F),user:v.value,onEdit:r(ae),onDelete:r(Q)},null,8,["show","user","onEdit","onDelete"]),e(Ae,{modelValue:r(l),"onUpdate:modelValue":C[4]||(C[4]=F=>Pe(l)?l.value=F:null),title:"Konfirmasi Hapus Pengguna","item-name":($e=r($))==null?void 0:$e.name,loading:r(f),"confirm-text":"Hapus Pengguna",onConfirm:ze,onCancel:C[5]||(C[5]=F=>l.value=!1)},null,8,["modelValue","item-name","loading"])])}}}),Xa=je(Va,[["__scopeId","data-v-cd5323e9"]]);export{Xa as default};
