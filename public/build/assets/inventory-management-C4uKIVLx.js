import{aA as ie,d as et,r as v,V as H,w as tt,g as C,f as s,b as t,s as p,X as j,t as i,l as S,c as K,e as o,aw as at,a0 as w,o as f,ax as Ye,aW as lt,D as ot,m as e,a5 as ye,F as rt,i as nt,p as Te,$ as Ue}from"./main-lGRC2_md.js";import{V as be}from"./VDialog-DHNAo10Q.js";import{b as pe,c as $e,V as F}from"./VCard-rnISyUPc.js";import{V as Z}from"./VDivider-zuhv8y0T.js";import{V as z}from"./VCardText-BFUyrMOb.js";import{V as le}from"./VAlert-BqdLMGE4.js";import{V as it}from"./VDataTable-Dy4knWha.js";import{V as ee}from"./VChip-ClPn_Ejq.js";import{V as he}from"./VSpacer-C9_GxL4_.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as ut}from"./ItemsApi-DAbRY4uI.js";import{V as ae,a as U}from"./VRow-Cc2Osqzv.js";import{V as Y}from"./VTextField-DjEmgdRR.js";import{V as Ze}from"./VSelect-CjnJ6FDt.js";import{V as ct}from"./VDataTableServer-A4rIJ3NQ.js";import{V as je}from"./VTooltip-_zmoJ9V5.js";import{V as Re}from"./VForm-x5uoCFgi.js";import{V as Oe}from"./VTextarea-B1TS9VaR.js";import{V as dt}from"./VAvatar-BS4OljKZ.js";import"./VOverlay-DXj9eLjH.js";import"./forwardRefs-B931MWyl.js";import"./VImg-BsdJ_A-V.js";import"./VCheckboxBtn-BaRylw8P.js";import"./VTable-BjpOk_gr.js";import"./filter-BpVfB8yU.js";/* empty css              */import"./VList-CAtmzsmk.js";import"./VMenu--VVjQ239.js";const se="/api/inventory";class X{static async getAll(u){var c;try{return(await ie.get(se,{params:u})).data}catch(m){throw((c=m.response)==null?void 0:c.data)||this.handleError(m)}}static async getById(u){var c;try{return(await ie.get(`${se}/${u}`)).data}catch(m){throw((c=m.response)==null?void 0:c.data)||this.handleError(m)}}static async getStats(){var u;try{return(await ie.get(`${se}/stats`)).data}catch(c){throw((u=c.response)==null?void 0:u.data)||this.handleError(c)}}static async getLowStockAlerts(){var u;try{return(await ie.get(`${se}/low-stock-alerts`)).data}catch(c){throw((u=c.response)==null?void 0:u.data)||this.handleError(c)}}static async updateStock(u,c){var m;try{return(await ie.post(`${se}/${u}/update-stock`,c)).data}catch(h){throw((m=h.response)==null?void 0:m.data)||this.handleError(h)}}static async bulkUpdateStock(u){var c;try{return(await ie.post(`${se}/bulk-update-stock`,u)).data}catch(m){throw((c=m.response)==null?void 0:c.data)||this.handleError(m)}}static async setReorderLevel(u,c){var m;try{return(await ie.post(`${se}/${u}/reorder-level`,c)).data}catch(h){throw((m=h.response)==null?void 0:m.data)||this.handleError(h)}}static async getMovements(u){var c;try{const m=u!=null&&u.id_inventory?`${se}/${u.id_inventory}/movements`:`${se}/movements`;return(await ie.get(m,{params:u})).data}catch(m){throw((c=m.response)==null?void 0:c.data)||this.handleError(m)}}static handleError(u){var c,m;return u.response?{message:((c=u.response.data)==null?void 0:c.message)||"Terjadi kesalahan pada server",success:!1,errors:(m=u.response.data)==null?void 0:m.errors}:u.request?{message:"Tidak dapat terhubung ke server",success:!1}:{message:u.message||"Terjadi kesalahan yang tidak diketahui",success:!1}}static formatError(u){return u.errors?Object.values(u.errors).flat().join(", "):u.message||"Terjadi kesalahan yang tidak diketahui"}static isValidationError(u){return u.errors&&typeof u.errors=="object"}static getFieldError(u,c){return u.errors&&u.errors[c]?Array.isArray(u.errors[c])?u.errors[c][0]:u.errors[c]:null}static getMovementTypes(){return[{value:"stock_in",label:"Stock Masuk",color:"success"},{value:"stock_out",label:"Stock Keluar",color:"warning"},{value:"adjustment",label:"Penyesuaian",color:"info"},{value:"transfer",label:"Transfer",color:"primary"},{value:"return",label:"Retur",color:"success"},{value:"damaged",label:"Rusak",color:"error"},{value:"expired",label:"Kadaluarsa",color:"error"}]}static getStockStatusOptions(){return[{value:"all",label:"Semua Status"},{value:"in_stock",label:"Tersedia"},{value:"low_stock",label:"Stok Menipis"},{value:"out_of_stock",label:"Habis"},{value:"overstock",label:"Stok Berlebih"}]}}const mt={key:1,class:"text-center py-8"},pt={class:"font-weight-medium"},vt={class:"text-medium-emphasis"},_t={class:"text-center"},ft={class:"text-center font-weight-medium"},kt={class:"text-center font-weight-bold text-primary"},gt={class:"text-end"},yt={class:"text-end font-weight-medium text-success"},bt={class:"max-width-200"},ht={class:"font-weight-medium"},xt={key:0,class:"text-medium-emphasis"},St={key:1,class:"d-block text-caption"},wt={key:2,class:"text-info d-block"},Vt={class:"text-center py-8"},Mt=et({__name:"InventoryMovementsDialog",props:{modelValue:{type:Boolean},inventoryId:{},inventoryName:{}},emits:["update:modelValue"],setup(q,{emit:u}){const c=q,m=u,h=v([]),E=v(!1),A=v(""),R=H({get:()=>c.modelValue,set:y=>m("update:modelValue",y)}),B=async()=>{var y,_,n,P;if(c.inventoryId)try{E.value=!0,A.value="";const x=await X.getMovements({id_inventory:parseInt(c.inventoryId),page:1,per_page:50});x.data&&Array.isArray(x.data)?h.value=x.data:x.data&&((y=x==null?void 0:x.data)!=null&&y.data)&&Array.isArray((_=x==null?void 0:x.data)==null?void 0:_.data)?h.value=x.data.data:h.value=[]}catch(x){console.error("Error fetching movements:",x),A.value=((P=(n=x.response)==null?void 0:n.data)==null?void 0:P.message)||"Gagal memuat riwayat pergerakan"}finally{E.value=!1}},O=y=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(y),N=y=>({in:"success",out:"error",stock_in:"success",stock_out:"error",adjustment:"warning",transfer:"info",return:"secondary"})[y]||"primary",L=y=>({in:"Stock Masuk",out:"Stock Keluar",stock_in:"Stock Masuk",stock_out:"Stock Keluar",adjustment:"Penyesuaian",transfer:"Transfer",return:"Retur"})[y]||y,g=y=>({in:"tabler-plus",out:"tabler-minus",stock_in:"tabler-plus",stock_out:"tabler-minus",adjustment:"tabler-edit",transfer:"tabler-arrows-exchange",return:"tabler-arrow-back"})[y]||"tabler-package";return tt(R,y=>{y&&c.inventoryId?B():(h.value=[],A.value="")}),(y,_)=>(f(),C(be,{modelValue:R.value,"onUpdate:modelValue":_[1]||(_[1]=n=>R.value=n),"max-width":"900px",scrollable:""},{default:s(()=>[t(F,null,{default:s(()=>[t(pe,{class:"d-flex align-center"},{default:s(()=>[t(j,{icon:"tabler-history",class:"me-2"}),p(" Riwayat Pergerakan - "+i(y.inventoryName),1)]),_:1}),t(Z),t(z,{class:"pa-0"},{default:s(()=>[A.value?(f(),C(le,{key:0,type:"error",variant:"tonal",class:"ma-4"},{default:s(()=>[p(i(A.value),1)]),_:1})):S("",!0),E.value?(f(),K("div",mt,[t(at,{indeterminate:"",color:"primary",size:"40"}),_[2]||(_[2]=o("div",{class:"mt-4 text-medium-emphasis"}," Memuat riwayat pergerakan... ",-1))])):(f(),C(it,{key:2,headers:[{title:"Tanggal",key:"created_at",sortable:!1},{title:"Jenis",key:"movement_type",sortable:!1},{title:"Kuantitas",key:"quantity",sortable:!1},{title:"Stok Sebelum",key:"stock_before",sortable:!1},{title:"Stok Sesudah",key:"stock_after",sortable:!1},{title:"Harga/Unit",key:"unit_cost",sortable:!1},{title:"Total Nilai",key:"total_cost",sortable:!1},{title:"Catatan",key:"notes",sortable:!1}],items:h.value,loading:E.value,class:"text-no-wrap","items-per-page":"15",height:"500","fixed-header":""},{"item.created_at":s(({item:n})=>[o("div",null,[o("div",pt,i(new Date(n.created_at).toLocaleDateString("id-ID")),1),o("small",vt,i(new Date(n.created_at).toLocaleTimeString("id-ID")),1)])]),"item.movement_type":s(({item:n})=>[t(ee,{color:N(n.movement_type),variant:"tonal",size:"small","prepend-icon":g(n.movement_type)},{default:s(()=>[p(i(L(n.movement_type)),1)]),_:2},1032,["color","prepend-icon"])]),"item.quantity":s(({item:n})=>[o("div",_t,[t(ee,{color:n.movement_type==="in"||n.movement_type==="stock_in"?"success":"error",variant:"outlined",size:"small"},{default:s(()=>[p(i(n.movement_type==="in"||n.movement_type==="stock_in"?"+":"-")+i(Math.abs(n.quantity)),1)]),_:2},1032,["color"])])]),"item.stock_before":s(({item:n})=>[o("div",ft,i(n.stock_before),1)]),"item.stock_after":s(({item:n})=>[o("div",kt,i(n.stock_after),1)]),"item.unit_cost":s(({item:n})=>[o("div",gt,i(n.unit_cost?O(n.unit_cost):"-"),1)]),"item.total_cost":s(({item:n})=>[o("div",yt,i(n.total_cost?O(n.total_cost):"-"),1)]),"item.notes":s(({item:n})=>[o("div",bt,[o("div",ht,i(n.notes||"-"),1),n.reference_type&&n.reference_id?(f(),K("small",xt," Ref: "+i(n.reference_type)+"-"+i(n.reference_id),1)):S("",!0),n.batch_number?(f(),K("small",St," Batch: "+i(n.batch_number),1)):S("",!0),n.user?(f(),K("small",wt," oleh: "+i(n.user.name),1)):S("",!0)])]),"no-data":s(()=>[o("div",Vt,[t(j,{icon:"tabler-history-off",size:"48",class:"text-medium-emphasis mb-4"}),_[3]||(_[3]=o("div",{class:"text-h6 text-medium-emphasis mb-2"}," Belum ada riwayat pergerakan ",-1)),_[4]||(_[4]=o("div",{class:"text-body-2 text-medium-emphasis"}," Riwayat akan muncul setelah ada pergerakan stok ",-1))])]),_:1},8,["items","loading"]))]),_:1}),t(Z),t($e,{class:"pa-4"},{default:s(()=>[t(he),t(w,{variant:"outlined",onClick:_[0]||(_[0]=n=>R.value=!1)},{default:s(()=>_[5]||(_[5]=[p(" Tutup ")])),_:1,__:[5]}),t(w,{color:"primary","prepend-icon":"tabler-refresh",onClick:B},{default:s(()=>_[6]||(_[6]=[p(" Refresh ")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ct=st(Mt,[["__scopeId","data-v-ca0277a4"]]),Pt=()=>{const q=v([]),u=v(!1),c=v(!1),m=v({total_items:0,low_stock_items:0,out_of_stock_items:0,overstock_items:0,total_stock_value:0,total_stock_quantity:0,total_reserved_stock:0,items_need_restock:0}),h=v([]),E=v(!1),A=v([]),R=v(!1),B=v(!1),O=v(!1),N=v(!1),L=v(!1),g=v(null),y=v([]),_=v(1),n=v(0),P=v(15),x=v({search:"",stock_status:"all",category_id:void 0,supplier_id:void 0,sort_by:"current_stock",sort_order:"asc"}),W=v(""),D=v(""),$=v(""),ue=v({movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:void 0,notes:""}),G=v({reorder_level:0,max_stock_level:0}),ke=H(()=>y.value.length>0),ce=H(()=>m.value.total_stock_value),oe=H(()=>m.value.low_stock_items),re=H(()=>m.value.out_of_stock_items),Q=H(()=>Math.ceil(n.value/P.value)),ve=H(()=>_.value<Q.value),de=H(()=>_.value>1),xe=H(()=>({currentPage:_.value,totalPages:Q.value,totalItems:n.value,itemsPerPage:P.value,hasNext:ve.value,hasPrev:de.value})),Se=[r=>r>0||"Kuantitas harus lebih dari 0",r=>Number.isInteger(r)||"Kuantitas harus berupa bilangan bulat"],we=[r=>!!r||"Alasan wajib diisi",r=>r&&r.length>=3||"Alasan minimal 3 karakter"],d=[r=>!r||r>=0||"Harga harus lebih dari atau sama dengan 0"],I=[{title:"Stock Masuk",value:"stock_in",color:"success"},{title:"Stock Keluar",value:"stock_out",color:"warning"},{title:"Penyesuaian",value:"adjustment",color:"info"},{title:"Transfer",value:"transfer",color:"primary"},{title:"Retur",value:"return",color:"success"}],V=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Menipis",value:"low_stock"},{title:"Habis",value:"out_of_stock"},{title:"Stok Berlebih",value:"overstock"}],ne=async()=>{u.value=!0,W.value="";try{const r={...x.value,page:_.value,per_page:P.value};Object.keys(r).forEach(Ie=>{const b=r[Ie];(b===""||b===void 0||b===null||b==="all")&&delete r[Ie]}),console.log("Fetching inventory with params:",r);const M=await X.getAll(r);if(console.log("ðŸ” Full Inventory API Response:",M),console.log("ðŸ“„ Response Data Structure:",M.data),M.success)q.value=M.data.data||[],n.value=M.data.total||0,M.data.current_page&&(_.value=M.data.current_page),console.log("Inventory data loaded:",{total:M.data.total,current_page:M.data.current_page,per_page:M.data.per_page,last_page:M.data.last_page,itemsLength:q.value.length}),console.log("ðŸ“Š Final Inventory State Values:",{inventoryListLength:q.value.length,totalItemsValue:n.value,currentPageValue:_.value,itemsPerPageValue:P.value});else throw new Error(M.message||"Gagal mengambil data inventory")}catch(r){console.error("Error fetching inventory:",r),W.value=X.formatError(r)||"Gagal mengambil data inventory",q.value=[],n.value=0}finally{u.value=!1}},Ve=async()=>{try{const r=await X.getStats();r.success&&(m.value=r.data)}catch(r){console.error("Error fetching inventory stats:",r)}},me=async()=>{R.value=!0;try{const r=await X.getLowStockAlerts();r.success&&(A.value=r.data.data||[])}catch(r){console.error("Error fetching low stock alerts:",r),A.value=[]}finally{R.value=!1}},_e=async r=>{E.value=!0;try{const M=await X.getMovements({id_inventory:r,page:1,per_page:20});M.success&&(h.value=M.data)}catch(M){console.error("Error fetching movements:",M)}finally{E.value=!1}},Ee=async()=>{if(g.value){c.value=!0,$.value="";try{const r=await X.updateStock(g.value.id_inventory,ue.value);if(r.success)D.value="Stock berhasil diperbarui",fe(),await ne(),await Ve(),await me();else throw new Error(r.message||"Gagal memperbarui stock")}catch(r){console.error("Error updating stock:",r),$.value=X.formatError(r)||"Gagal memperbarui stock"}finally{c.value=!1}}},Le=async()=>{if(g.value){c.value=!0,$.value="";try{const r=await X.setReorderLevel(g.value.id_inventory,G.value);if(r.success)D.value="Reorder level berhasil diperbarui",Me(),await ne();else throw new Error(r.message||"Gagal memperbarui reorder level")}catch(r){console.error("Error setting reorder level:",r),$.value=X.formatError(r)||"Gagal memperbarui reorder level"}finally{c.value=!1}}},Ae=r=>{g.value=r,ue.value={movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:r.average_cost||void 0,notes:""},$.value="",B.value=!0},Fe=r=>{g.value=r,G.value={reorder_level:r.reorder_level||0,max_stock_level:r.max_stock_level||0},$.value="",L.value=!0},ze=r=>{g.value=r,_e(r.id_inventory),N.value=!0},fe=()=>{B.value=!1,setTimeout(()=>{g.value=null,$.value=""},300)},Me=()=>{L.value=!1,setTimeout(()=>{g.value=null,$.value=""},300)};return{inventoryList:q,loading:u,saveLoading:c,stats:m,movementsList:h,movementsLoading:E,lowStockItems:A,alertsLoading:R,stockUpdateDialog:B,bulkUpdateDialog:O,movementsDialog:N,reorderDialog:L,selectedInventory:g,selectedItems:y,currentPage:_,totalItems:n,itemsPerPage:P,filters:x,errorMessage:W,successMessage:D,modalErrorMessage:$,stockUpdateForm:ue,reorderForm:G,hasSelectedItems:ke,totalStockValue:ce,lowStockCount:oe,outOfStockCount:re,quantityRules:Se,reasonRules:we,costRules:d,movementTypeOptions:I,stockStatusOptions:V,fetchInventoryList:ne,fetchStats:Ve,fetchLowStockAlerts:me,fetchMovements:_e,updateStock:Ee,setReorderLevel:Le,openStockUpdateDialog:Ae,openReorderDialog:Fe,openMovementsDialog:ze,closeStockUpdateDialog:fe,closeReorderDialog:Me,closeMovementsDialog:()=>{N.value=!1,setTimeout(()=>{g.value=null,h.value=[]},300)},clearModalError:()=>{$.value=""},onPageChange:r=>{console.log("Page changed to:",r,"Current total items:",n.value),r!==_.value&&(_.value=r,ne())},onItemsPerPageChange:r=>{console.log("Items per page changed to:",r),r!==P.value&&(P.value=r,_.value=1,ne())},handleFiltersUpdate:r=>{x.value={...x.value,...r},_.value=1,ne()},formatCurrency:r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),getStockStatusColor:r=>r.current_stock===0?"error":r.is_low_stock?"warning":"success",getStockStatusText:r=>r.current_stock===0?"Habis":r.reorder_level>0&&r.current_stock<=r.reorder_level?"Menipis":r.max_stock_level&&r.current_stock>r.max_stock_level?"Berlebih":"Tersedia",getMovementTypeColor:r=>({stock_in:"success",stock_out:"warning",adjustment:"info",transfer:"primary",return:"success",damaged:"error",expired:"error"})[r]||"grey",totalPages:Q,hasNextPage:ve,hasPrevPage:de,paginationInfo:xe}};function Dt(){const q=v([]),u=v([]),c=v(!1),m=v(!1),h=v({total_items:0,total_value:0,low_stock_items:0,out_of_stock_items:0,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}),E=v(1),A=v(0),R=v(10),B=Ye({search:"",stock_status:"all",movement_type:"",date_from:"",date_to:"",item_id:void 0}),O=v(!1),N=v(!1),L=v(null),g=Ye({item_id:0,type:"in",quantity:0,notes:"",cost_per_unit:0}),y=v(""),_=v(""),n=v(""),P=H(()=>!0),x=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],W=[{title:"Masuk",value:"in",color:"success",icon:"tabler-plus"},{title:"Keluar",value:"out",color:"error",icon:"tabler-minus"},{title:"Penyesuaian",value:"adjustment",color:"warning",icon:"tabler-adjustments"}],D=[{title:"Pembelian",value:"purchase"},{title:"Penjualan",value:"sale"},{title:"Produksi",value:"production"},{title:"Penyesuaian",value:"adjustment"},{title:"Kerusakan",value:"waste"}],$=d=>d.current_stock<=0?{status:"out_of_stock",color:"error",text:"Habis",icon:"tabler-x"}:d.current_stock<=d.minimum_stock?{status:"low_stock",color:"warning",text:"Rendah",icon:"tabler-alert-triangle"}:{status:"in_stock",color:"success",text:"Tersedia",icon:"tabler-check"},ue=d=>!d.maximum_stock||d.maximum_stock<=0?100:Math.round(d.current_stock/d.maximum_stock*100),G=async()=>{c.value=!0;try{await new Promise(d=>setTimeout(d,1e3)),q.value=await ut.getAll(),A.value=q.value.length,_.value=""}catch{y.value="Gagal memuat data items"}finally{c.value=!1}},ke=async d=>{c.value=!0;try{const I=await X.getMovements({id_inventory:d,page:E.value,per_page:R.value});u.value=I.data.map(V=>({id:V.id_movement,item_id:V.id_inventory,type:V.movement_type,quantity:V.quantity,unit:"pcs",reference_id:V.reference_number?parseInt(V.reference_number):void 0,reference_type:V.reason,notes:V.notes,cost_per_unit:V.cost_per_unit,total_cost:V.total_cost,created_by:V.created_by,created_at:V.created_at,creator:V.user})),A.value=I.total}catch(I){console.error("Failed to fetch stock movements:",I),u.value=[]}finally{c.value=!1}},ce=async()=>{try{await G();const d=q.value;h.value={total_items:d.length,total_value:d.reduce((I,V)=>I+V.current_stock*V.cost_per_unit,0),low_stock_items:d.filter(I=>I.current_stock<=I.minimum_stock&&I.current_stock>0).length,out_of_stock_items:d.filter(I=>I.current_stock<=0).length,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}}catch(d){console.error("Failed to fetch stats:",d)}},oe=async()=>{m.value=!0,n.value="";try{const d=await fetch("/api/inventory/movement",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({item_id:g.item_id,movement_type:g.type,quantity:g.quantity,notes:g.notes,cost_per_unit:g.cost_per_unit})});if(!d.ok){const I=await d.json();throw new Error(I.message||"Gagal mencatat pergerakan stok")}_.value=`Stock ${g.type==="in"?"masuk":g.type==="out"?"keluar":"disesuaikan"} berhasil dicatat`,de(),await G(),await ce()}catch(d){n.value=d.message||"Gagal mencatat pergerakan stok"}finally{m.value=!1}},re=d=>{L.value=d,Object.assign(g,{item_id:d.id_item,type:"in",quantity:0,notes:"",cost_per_unit:d.cost_per_unit}),O.value=!0},Q=d=>{L.value=d,Object.assign(g,{item_id:d.id_item,type:"out",quantity:0,notes:"",cost_per_unit:d.cost_per_unit}),O.value=!0},ve=d=>{L.value=d,Object.assign(g,{item_id:d.id_item,type:"adjustment",quantity:d.current_stock,notes:"",cost_per_unit:d.cost_per_unit}),N.value=!0},de=()=>{O.value=!1,N.value=!1,n.value="",L.value=null};return{itemsList:q,stockMovements:u,loading:c,saveLoading:m,stats:h,currentPage:E,totalItems:A,itemsPerPage:R,filters:B,movementDialog:O,adjustmentDialog:N,selectedItem:L,movementFormData:g,errorMessage:y,successMessage:_,modalErrorMessage:n,canManageStock:P,stockStatusOptions:x,movementTypeOptions:W,referenceTypeOptions:D,getStockStatus:$,getStockPercentage:ue,fetchItems:G,fetchStockMovements:ke,fetchStats:ce,recordStockMovement:oe,openStockInDialog:re,openStockOutDialog:Q,openAdjustmentDialog:ve,closeMovementDialog:de,clearModalError:()=>{n.value=""},onPageChange:d=>{E.value=d,G()},handleFiltersUpdate:d=>{Object.assign(B,d),E.value=1,G()}}}const It={class:"inventory-management"},Tt={class:"d-flex justify-space-between align-center mb-6"},Ut={class:"d-flex gap-3 align-center"},jt={class:"d-flex align-center justify-space-between"},Rt={class:"text-h4 font-weight-bold text-primary"},$t={class:"d-flex align-center justify-space-between"},Et={class:"text-h4 font-weight-bold text-warning"},Lt={class:"d-flex align-center justify-space-between"},At={class:"text-h4 font-weight-bold text-error"},Ft={class:"d-flex align-center justify-space-between"},zt={class:"text-h4 font-weight-bold text-success"},qt={class:"d-flex align-center justify-space-between"},Bt={class:"d-flex align-center gap-3"},Ot={class:"d-flex gap-2"},Nt={class:"d-flex flex-wrap gap-2"},Kt={class:"d-flex align-center"},Ht={class:"font-weight-medium"},Gt={class:"text-medium-emphasis"},Jt={class:"text-center"},Xt={class:"text-h6 font-weight-bold"},Wt={key:0,class:"text-warning"},Qt={class:"text-center"},Yt={class:"text-center"},Zt={class:"text-end"},ea={class:"text-end font-weight-medium text-success"},ta={class:"d-flex align-center gap-1"},aa={class:"text-center py-12"},sa={class:"text-h5 text-medium-emphasis mb-2"},la={class:"text-body-1 text-medium-emphasis mb-4"},oa={key:0},ra={key:0},na={key:1},ia={key:2},ua={key:1},ca={class:"d-flex justify-center gap-3"},da={class:"text-center py-8"},ma={key:0},pa={class:"text-xs text-info"},va={class:"d-flex align-center gap-2"},_a={class:"d-flex align-center gap-3"},fa={class:"font-weight-bold"},ka={class:"text-caption"},ga={class:"text-caption"},ya={class:"d-flex gap-3 justify-end"},ba={class:"d-flex align-center gap-2"},ha={class:"text-white"},xa={class:"d-flex align-center gap-3"},Sa={class:"font-weight-bold"},wa={class:"text-caption"},Va=et({__name:"inventory-management",setup(q){const{xs:u}=lt(),c=()=>{oe(),re(),Q()},{inventoryList:m,loading:h,saveLoading:E,stats:A,lowStockItems:R,stockUpdateDialog:B,reorderDialog:O,movementsDialog:N,selectedInventory:L,currentPage:g,totalItems:y,itemsPerPage:_,filters:n,errorMessage:P,successMessage:x,modalErrorMessage:W,stockUpdateForm:D,reorderForm:$,totalStockValue:ue,lowStockCount:G,outOfStockCount:ke,stockStatusOptions:ce,fetchInventoryList:oe,fetchStats:re,fetchLowStockAlerts:Q,updateStock:ve,setReorderLevel:de,openStockUpdateDialog:xe,openReorderDialog:Se,openMovementsDialog:we,closeStockUpdateDialog:d,closeReorderDialog:I,clearModalError:V,onPageChange:ne,onItemsPerPageChange:Ve,handleFiltersUpdate:me,formatCurrency:_e,getStockStatusColor:Ee,getStockStatusText:Le,totalPages:Ae,hasNextPage:Fe,hasPrevPage:ze}=Pt(),{recordStockMovement:fe,openAdjustmentDialog:Me,movementDialog:Ce,adjustmentDialog:Pe,selectedItem:J,movementFormData:T,saveLoading:qe,closeMovementDialog:ge,successMessage:De,modalErrorMessage:Be,clearModalError:Ne}=Dt(),r=b=>b.item?{id_item:b.item.id_item,item_code:b.item.item_code,name:b.item.name,description:b.item.description||"",unit:b.item.unit,cost_per_unit:parseFloat(b.item.cost_per_unit),current_stock:b.current_stock,minimum_stock:b.reorder_level||0,active:!0,storage_location:b.item.storage_location||"",expiry_date:b.item.expiry_date||null,properties:b.item.properties||null,created_by:b.item.created_by||null,updated_by:b.item.updated_by||null,created_at:b.item.created_at,updated_at:b.item.updated_at,deleted_at:b.item.deleted_at||null}:null,M=b=>{const a=r(b);a&&Me(a)},Ie=H(()=>A.value);return H(()=>m.value),H(()=>h.value),ot(()=>{oe(),re(),Q()}),tt(y,(b,a)=>{console.log("ðŸ” totalItems changed:",{oldValue:a,newValue:b}),console.log("ðŸ“Š VDataTable will receive server-items-length:",b)},{immediate:!0}),(b,a)=>{var Ke,He,Ge,Je;return f(),K("div",It,[o("div",Tt,[a[30]||(a[30]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold inventory-title"}," Kelola Inventory "),o("p",{class:"text-body-1 text-medium-emphasis inventory-subtitle"}," Kelola stok barang dan pergerakan inventory ")],-1)),o("div",Ut,[t(w,{color:"primary","prepend-icon":"tabler-refresh",variant:"outlined",onClick:c},{default:s(()=>a[29]||(a[29]=[p(" Refresh Data ")])),_:1,__:[29]})])]),e(P)?(f(),C(le,{key:0,type:"error",variant:"outlined",class:"mb-4",text:e(P),closable:"","onClick:close":a[0]||(a[0]=l=>P.value="")},null,8,["text"])):S("",!0),e(x)?(f(),C(le,{key:1,type:"success",variant:"outlined",class:"mb-4",text:e(x),closable:"","onClick:close":a[1]||(a[1]=l=>x.value="")},null,8,["text"])):S("",!0),e(De)?(f(),C(le,{key:2,type:"success",variant:"outlined",class:"mb-4",text:e(De),closable:"","onClick:close":a[2]||(a[2]=l=>De.value="")},null,8,["text"])):S("",!0),t(ae,{class:"mb-6"},{default:s(()=>[t(U,{cols:"12",md:"3"},{default:s(()=>[t(F,{class:"stats-card"},{default:s(()=>[t(z,null,{default:s(()=>[o("div",jt,[o("div",null,[o("div",Rt,i(Ie.value.total_items||0),1),a[31]||(a[31]=o("div",{class:"text-caption text-medium-emphasis"}," Total Produk ",-1))]),t(j,{icon:"tabler-package",size:"48",class:"text-primary opacity-50"})])]),_:1})]),_:1})]),_:1}),t(U,{cols:"12",md:"3"},{default:s(()=>[t(F,{class:"stats-card"},{default:s(()=>[t(z,null,{default:s(()=>[o("div",$t,[o("div",null,[o("div",Et,i(e(G)||0),1),a[32]||(a[32]=o("div",{class:"text-caption text-medium-emphasis"}," Stok Menipis ",-1))]),t(j,{icon:"tabler-alert-triangle",size:"48",class:"text-warning opacity-50"})])]),_:1})]),_:1})]),_:1}),t(U,{cols:"12",md:"3"},{default:s(()=>[t(F,{class:"stats-card"},{default:s(()=>[t(z,null,{default:s(()=>[o("div",Lt,[o("div",null,[o("div",At,i(e(ke)||0),1),a[33]||(a[33]=o("div",{class:"text-caption text-medium-emphasis"}," Stok Habis ",-1))]),t(j,{icon:"tabler-x-circle",size:"48",class:"text-error opacity-50"})])]),_:1})]),_:1})]),_:1}),t(U,{cols:"12",md:"3"},{default:s(()=>[t(F,{class:"stats-card"},{default:s(()=>[t(z,null,{default:s(()=>[o("div",Ft,[o("div",null,[o("div",zt,i(e(_e)(e(ue)||0)),1),a[34]||(a[34]=o("div",{class:"text-caption text-medium-emphasis"}," Nilai Stok ",-1))]),t(j,{icon:"tabler-currency-dollar",size:"48",class:"text-success opacity-50"})])]),_:1})]),_:1})]),_:1})]),_:1}),t(F,{class:"mb-6 info-card",color:"info",variant:"tonal"},{default:s(()=>[t(z,null,{default:s(()=>[o("div",qt,[o("div",Bt,[t(j,{icon:"tabler-info-circle",size:"32",class:"text-info"}),a[35]||(a[35]=o("div",null,[o("div",{class:"text-subtitle-1 font-weight-medium text-info"}," Sistem Stock Movement Otomatis "),o("div",{class:"text-body-2 text-medium-emphasis"},[p(" Stok akan bertambah otomatis saat purchasing dan berkurang saat penjualan POS. Gunakan tombol "),o("strong",null,"Penyesuaian"),p(" untuk koreksi manual jika diperlukan. ")])],-1))]),o("div",Ot,[t(ee,{color:"success",variant:"tonal",size:"small"},{default:s(()=>[t(j,{icon:"tabler-shopping-cart",class:"me-1"}),a[36]||(a[36]=p(" Purchase â†’ Stok + "))]),_:1,__:[36]}),t(ee,{color:"error",variant:"tonal",size:"small"},{default:s(()=>[t(j,{icon:"tabler-cash",class:"me-1"}),a[37]||(a[37]=p(" POS Sale â†’ Stok - "))]),_:1,__:[37]})])])]),_:1})]),_:1}),e(R).length>0?(f(),C(F,{key:3,class:"mb-6 low-stock-alert"},{default:s(()=>[t(pe,{class:"d-flex align-center"},{default:s(()=>[t(j,{icon:"tabler-alert-triangle",class:"text-warning me-2"}),p(" Peringatan Stok Menipis ("+i(e(R).length)+" produk) ",1)]),_:1}),t(z,null,{default:s(()=>[o("div",Nt,[(f(!0),K(rt,null,nt(e(R).slice(0,10),l=>(f(),C(ee,{key:l.id_inventory,color:"warning",variant:"outlined",size:"small"},{default:s(()=>{var k;return[p(i((k=l.product)==null?void 0:k.name)+" ("+i(l.current_stock)+"/"+i(l.reorder_level)+") ",1)]}),_:2},1024))),128)),e(R).length>10?(f(),C(ee,{key:0,color:"warning",variant:"tonal",size:"small"},{default:s(()=>[p(" +"+i(e(R).length-10)+" lainnya ",1)]),_:1})):S("",!0)])]),_:1})]),_:1})):S("",!0),!e(h)&&e(m).length===0&&!e(P)&&!e(n).search&&e(n).stock_status==="all"?(f(),C(F,{key:4,class:"mb-6"},{default:s(()=>[t(z,{class:"text-center py-6"},{default:s(()=>[t(j,{icon:"tabler-info-circle",size:"48",class:"text-info mb-3"}),a[38]||(a[38]=o("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),a[39]||(a[39]=o("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[38,39]})]),_:1})):S("",!0),t(F,{class:"mb-6"},{default:s(()=>[t(z,null,{default:s(()=>[t(ae,null,{default:s(()=>[t(U,{cols:"12",md:"4"},{default:s(()=>[t(Y,{modelValue:e(n).search,"onUpdate:modelValue":[a[3]||(a[3]=l=>e(n).search=l),a[4]||(a[4]=l=>e(me)({search:l}))],label:"Cari inventory produk...",placeholder:"Nama produk, SKU, atau variant","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(U,{cols:"12",md:"4"},{default:s(()=>[t(Ze,{modelValue:e(n).stock_status,"onUpdate:modelValue":[a[5]||(a[5]=l=>e(n).stock_status=l),a[6]||(a[6]=l=>e(me)({stock_status:l||"all"}))],items:e(ce),label:"Status Stok",variant:"outlined",clearable:""},null,8,["modelValue","items"])]),_:1}),t(U,{cols:"12",md:"4",class:"d-flex align-center gap-2"},{default:s(()=>[t(w,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:a[7]||(a[7]=l=>{e(oe)(),e(re)(),e(Q)()})},{default:s(()=>a[40]||(a[40]=[p(" Refresh ")])),_:1,__:[40]}),e(n).search||e(n).stock_status!=="all"?(f(),C(w,{key:0,variant:"outlined",color:"warning","prepend-icon":"tabler-filter-off",onClick:a[8]||(a[8]=l=>e(me)({search:"",stock_status:"all"}))},{default:s(()=>a[41]||(a[41]=[p(" Clear ")])),_:1,__:[41]})):S("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),!e(h)&&e(m).length===0&&!e(P)&&!e(n).search&&e(n).stock_status==="all"?(f(),C(F,{key:5,class:"mb-6"},{default:s(()=>[t(z,{class:"text-center py-6"},{default:s(()=>[t(j,{icon:"tabler-package-off",size:"48",class:"text-disabled mb-3"}),a[42]||(a[42]=o("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),a[43]||(a[43]=o("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[42,43]})]),_:1})):S("",!0),t(F,{class:"products-inventory-table"},{default:s(()=>[t(pe,{class:"d-flex align-center gap-2 coffee-header"},{default:s(()=>[t(j,{icon:"tabler-package",class:"text-white"}),a[44]||(a[44]=o("span",{class:"text-white"},"Inventory Produk",-1)),t(he),t(ee,{color:"white",size:"small",variant:"tonal"},{default:s(()=>[p(i(e(y))+" Produk ",1)]),_:1})]),_:1,__:[44]}),t(Z),t(ct,{headers:[{title:"Produk/Variant",key:"item_name",sortable:!1},{title:"SKU",key:"sku",sortable:!1},{title:"Stok Saat Ini",key:"current_stock",sortable:!1},{title:"Stok Tersedia",key:"available_stock",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Reorder Level",key:"reorder_level",sortable:!1},{title:"Harga Rata-rata",key:"average_cost",sortable:!1},{title:"Nilai Stok",key:"stock_value",sortable:!1},{title:"Aksi",key:"actions",sortable:!1}],items:e(m),loading:e(h),"items-length":e(y),"items-per-page":e(_),page:e(g),"items-per-page-options":[10,15,25,50,100],"items-per-page-text":"Items per page:","page-text":"{0}-{1} of {2}","no-data-text":"Tidak ada data inventory",class:"text-no-wrap","onUpdate:page":e(ne),"onUpdate:itemsPerPage":e(Ve)},{"item.item_name":s(({item:l})=>{var k,te,Xe,We,Qe;return[o("div",Kt,[o("div",null,[o("div",Ht,i(((k=l.item)==null?void 0:k.name)||((te=l.product)==null?void 0:te.name)||"Unknown Item"),1),o("small",Gt,i(((Xe=l.item)==null?void 0:Xe.description)||((Qe=(We=l.product)==null?void 0:We.category)==null?void 0:Qe.name)||"-"),1)])])]}),"item.sku":s(({item:l})=>[t(ee,{variant:"outlined",size:"small",color:"primary"},{default:s(()=>{var k,te;return[p(i(((k=l.item)==null?void 0:k.item_code)||((te=l.product)==null?void 0:te.sku)||"N/A"),1)]}),_:2},1024)]),"item.current_stock":s(({item:l})=>[o("div",Jt,[o("div",Xt,i(l.current_stock),1),l.reserved_stock>0?(f(),K("small",Wt," ("+i(l.reserved_stock)+" reserved) ",1)):S("",!0)])]),"item.available_stock":s(({item:l})=>[o("div",Qt,[t(ee,{color:l.available_stock>0?"success":"error",variant:"tonal",size:"small"},{default:s(()=>[p(i(l.available_stock),1)]),_:2},1032,["color"])])]),"item.status":s(({item:l})=>[t(ee,{color:e(Ee)(l),variant:"tonal",size:"small"},{default:s(()=>[p(i(e(Le)(l)),1)]),_:2},1032,["color"])]),"item.reorder_level":s(({item:l})=>[o("div",Yt,i(l.reorder_level||"-"),1)]),"item.average_cost":s(({item:l})=>[o("div",Zt,i(e(_e)(l.average_cost)),1)]),"item.stock_value":s(({item:l})=>[o("div",ea,i(e(_e)(l.current_stock*l.average_cost)),1)]),"item.actions":s(({item:l})=>[o("div",ta,[t(je,{text:"Penyesuaian Stok"},{activator:s(({props:k})=>[t(w,Te(k,{icon:"tabler-adjustments",color:"warning",variant:"text",size:"small",disabled:!l.item,onClick:te=>M(l)}),null,16,["disabled","onClick"])]),_:2},1024),t(je,{text:"Update Stok"},{activator:s(({props:k})=>[t(w,Te(k,{icon:"tabler-edit",color:"primary",variant:"text",size:"small",onClick:te=>e(xe)(l)}),null,16,["onClick"])]),_:2},1024),t(je,{text:"Set Reorder Level"},{activator:s(({props:k})=>[t(w,Te(k,{icon:"tabler-settings",color:"info",variant:"text",size:"small",onClick:te=>e(Se)(l)}),null,16,["onClick"])]),_:2},1024),t(je,{text:"Lihat Riwayat"},{activator:s(({props:k})=>[t(w,Te(k,{icon:"tabler-history",color:"secondary",variant:"text",size:"small",onClick:te=>e(we)(l)}),null,16,["onClick"])]),_:2},1024)])]),"no-data":s(()=>{var l;return[o("div",aa,[t(j,{icon:e(n).search||e(n).stock_status!=="all"?"tabler-search-off":"tabler-package-off",size:"64",class:"text-medium-emphasis mb-4"},null,8,["icon"]),o("div",sa,i(e(n).search||e(n).stock_status!=="all"?"Tidak Ada Hasil Pencarian":"Belum Ada Data Inventory"),1),o("div",la,[e(n).search||e(n).stock_status!=="all"?(f(),K("span",oa,[e(n).search?(f(),K("span",ra,[a[45]||(a[45]=p(' Tidak ditemukan inventory dengan kata kunci "')),o("strong",null,i(e(n).search),1),a[46]||(a[46]=p('" '))])):S("",!0),e(n).search&&e(n).stock_status!=="all"?(f(),K("span",na," dan ")):S("",!0),e(n).stock_status!=="all"?(f(),K("span",ia,[a[47]||(a[47]=p(' status stok "')),o("strong",null,i(((l=e(ce).find(k=>k.value===e(n).stock_status))==null?void 0:l.title)||e(n).stock_status),1),a[48]||(a[48]=p('" '))])):S("",!0),a[49]||(a[49]=o("br",null,null,-1)),a[50]||(a[50]=p("Coba kata kunci yang berbeda atau hapus filter. "))])):(f(),K("span",ua,a[51]||(a[51]=[p(" Data inventory akan muncul setelah produk dan variant dibuat."),o("br",null,null,-1),p(" Silakan buat produk terlebih dahulu di menu "),o("strong",null,"Kelola Produk",-1),p(". ")])))]),o("div",ca,[e(n).search||e(n).stock_status!=="all"?(f(),C(w,{key:0,color:"warning",variant:"outlined","prepend-icon":"tabler-filter-off",onClick:a[9]||(a[9]=k=>e(me)({search:"",stock_status:"all"}))},{default:s(()=>a[52]||(a[52]=[p(" Hapus Filter ")])),_:1,__:[52]})):(f(),C(w,{key:1,color:"primary","prepend-icon":"tabler-plus",to:"/products-management"},{default:s(()=>a[53]||(a[53]=[p(" Buat Produk Baru ")])),_:1,__:[53]})),t(w,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:a[10]||(a[10]=k=>{e(oe)(),e(re)(),e(Q)()})},{default:s(()=>a[54]||(a[54]=[p(" Refresh Data ")])),_:1,__:[54]})])])]}),loading:s(()=>[o("div",da,[t(at,{indeterminate:"",color:"primary",size:"40"}),a[55]||(a[55]=o("div",{class:"mt-4 text-medium-emphasis"}," Memuat data inventory... ",-1))])]),_:1},8,["items","loading","items-length","items-per-page","page","onUpdate:page","onUpdate:itemsPerPage"]),!e(h)&&e(m).length>0?(f(),C(z,{key:0,class:"text-center py-2 text-caption text-medium-emphasis"},{default:s(()=>[p(" Menampilkan "+i(e(m).length)+" dari "+i(e(y))+" total produk inventory ",1),e(n).search||e(n).stock_status!=="all"?(f(),K("span",ma," (hasil pencarian/filter) ")):S("",!0),a[56]||(a[56]=o("br",null,null,-1)),o("small",pa," Debug: Page "+i(e(g))+"/"+i(e(Ae))+" | Items per page: "+i(e(_))+" | Has Next: "+i(e(Fe))+" | Has Prev: "+i(e(ze)),1)]),_:1,__:[56]})):S("",!0)]),_:1}),t(be,{modelValue:e(B),"onUpdate:modelValue":a[17]||(a[17]=l=>ye(B)?B.value=l:null),"max-width":"800px",fullscreen:e(u),persistent:"",class:"stock-dialog"},{default:s(()=>[t(F,null,{default:s(()=>[t(pe,null,{default:s(()=>{var l,k;return[p(" Update Stok - "+i((k=(l=e(L))==null?void 0:l.product)==null?void 0:k.name),1)]}),_:1}),t(Z),t(Re,{onSubmit:Ue(e(ve),["prevent"])},{default:s(()=>[t(z,null,{default:s(()=>[e(W)?(f(),C(le,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":e(V)},{default:s(()=>[p(i(e(W)),1)]),_:1},8,["onClick:close"])):S("",!0),t(ae,null,{default:s(()=>[t(U,{cols:"12",md:"6"},{default:s(()=>[t(Ze,{modelValue:e(D).movement_type,"onUpdate:modelValue":a[11]||(a[11]=l=>e(D).movement_type=l),label:"Jenis Pergerakan *",items:[{title:"Stock Masuk",value:"stock_in"},{title:"Stock Keluar",value:"stock_out"},{title:"Penyesuaian",value:"adjustment"},{title:"Transfer",value:"transfer"},{title:"Retur",value:"return"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),t(U,{cols:"12",md:"6"},{default:s(()=>[t(Y,{modelValue:e(D).quantity,"onUpdate:modelValue":a[12]||(a[12]=l=>e(D).quantity=l),modelModifiers:{number:!0},label:"Kuantitas *",type:"number",min:"1",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ae,null,{default:s(()=>[t(U,{cols:"12"},{default:s(()=>[t(Y,{modelValue:e(D).reason,"onUpdate:modelValue":a[13]||(a[13]=l=>e(D).reason=l),label:"Alasan *",placeholder:"Contoh: Pembelian dari supplier, Penjualan, dll",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ae,null,{default:s(()=>[t(U,{cols:"12",md:"6"},{default:s(()=>[t(Y,{modelValue:e(D).reference_number,"onUpdate:modelValue":a[14]||(a[14]=l=>e(D).reference_number=l),label:"Nomor Referensi",placeholder:"PO-001, SO-001, dll",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(U,{cols:"12",md:"6"},{default:s(()=>[t(Y,{modelValue:e(D).cost_per_unit,"onUpdate:modelValue":a[15]||(a[15]=l=>e(D).cost_per_unit=l),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",min:"0",step:"0.01",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ae,null,{default:s(()=>[t(U,{cols:"12"},{default:s(()=>[t(Oe,{modelValue:e(D).notes,"onUpdate:modelValue":a[16]||(a[16]=l=>e(D).notes=l),label:"Catatan",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Z),t($e,{class:"pa-4"},{default:s(()=>[t(he),t(w,{variant:"outlined",onClick:e(d)},{default:s(()=>a[57]||(a[57]=[p(" Batal ")])),_:1,__:[57]},8,["onClick"]),t(w,{type:"submit",color:"primary",loading:e(E)},{default:s(()=>a[58]||(a[58]=[p(" Update Stok ")])),_:1,__:[58]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(be,{modelValue:e(O),"onUpdate:modelValue":a[20]||(a[20]=l=>ye(O)?O.value=l:null),"max-width":"600px",fullscreen:e(u),persistent:"",class:"stock-dialog"},{default:s(()=>[t(F,null,{default:s(()=>[t(pe,null,{default:s(()=>{var l,k;return[p(" Set Reorder Level - "+i((k=(l=e(L))==null?void 0:l.product)==null?void 0:k.name),1)]}),_:1}),t(Z),t(Re,{onSubmit:Ue(e(de),["prevent"])},{default:s(()=>[t(z,null,{default:s(()=>[e(W)?(f(),C(le,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":e(V)},{default:s(()=>[p(i(e(W)),1)]),_:1},8,["onClick:close"])):S("",!0),t(ae,null,{default:s(()=>[t(U,{cols:"12"},{default:s(()=>[t(Y,{modelValue:e($).reorder_level,"onUpdate:modelValue":a[18]||(a[18]=l=>e($).reorder_level=l),modelModifiers:{number:!0},label:"Reorder Level *",type:"number",min:"0",hint:"Stok minimum sebelum perlu restock","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ae,null,{default:s(()=>[t(U,{cols:"12"},{default:s(()=>[t(Y,{modelValue:e($).max_stock_level,"onUpdate:modelValue":a[19]||(a[19]=l=>e($).max_stock_level=l),modelModifiers:{number:!0},label:"Max Stock Level",type:"number",min:"0",hint:"Stok maksimum yang diizinkan","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Z),t($e,{class:"pa-4"},{default:s(()=>[t(he),t(w,{variant:"outlined",onClick:e(I)},{default:s(()=>a[59]||(a[59]=[p(" Batal ")])),_:1,__:[59]},8,["onClick"]),t(w,{type:"submit",color:"primary",loading:e(E)},{default:s(()=>a[60]||(a[60]=[p(" Simpan ")])),_:1,__:[60]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Ct,{modelValue:e(N),"onUpdate:modelValue":a[21]||(a[21]=l=>ye(N)?N.value=l:null),"inventory-id":(He=(Ke=e(L))==null?void 0:Ke.id_inventory)==null?void 0:He.toString(),"inventory-name":(Je=(Ge=e(L))==null?void 0:Ge.item)==null?void 0:Je.name},null,8,["modelValue","inventory-id","inventory-name"]),t(be,{modelValue:e(Pe),"onUpdate:modelValue":a[24]||(a[24]=l=>ye(Pe)?Pe.value=l:null),"max-width":"600px",fullscreen:e(u),persistent:"",class:"stock-dialog"},{default:s(()=>[t(F,{class:"stock-movement-dialog coffee-dialog"},{default:s(()=>[t(pe,{class:"d-flex align-center justify-space-between coffee-header"},{default:s(()=>[o("div",va,[t(j,{icon:"tabler-adjustments",class:"text-white"}),a[61]||(a[61]=o("span",{class:"text-white"}," Penyesuaian Stok ",-1))]),t(w,{icon:"tabler-x",variant:"text",color:"white",onClick:e(ge)},null,8,["onClick"])]),_:1}),t(Z),t(z,{class:"pa-6"},{default:s(()=>[t(Re,{onSubmit:Ue(e(fe),["prevent"])},{default:s(()=>{var l;return[e(J)?(f(),C(le,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:s(()=>[o("div",_a,[t(j,{icon:"tabler-package"}),o("div",null,[o("div",fa,i(e(J).name),1),o("div",ka,i(e(J).item_code),1),o("div",ga,"Stok Saat Ini: "+i(e(J).current_stock)+" "+i(e(J).unit),1)])])]),_:1})):S("",!0),e(Be)?(f(),C(le,{key:1,type:"error",variant:"outlined",class:"mb-4",text:e(Be),closable:"","onClick:close":e(Ne)},null,8,["text","onClick:close"])):S("",!0),t(Y,{modelValue:e(T).quantity,"onUpdate:modelValue":a[22]||(a[22]=k=>e(T).quantity=k),modelModifiers:{number:!0},label:"Stok Baru",type:"number",min:"0",step:"0.001",variant:"outlined",suffix:(l=e(J))==null?void 0:l.unit,class:"mb-4",required:""},null,8,["modelValue","suffix"]),t(Oe,{modelValue:e(T).notes,"onUpdate:modelValue":a[23]||(a[23]=k=>e(T).notes=k),label:"Catatan (opsional)",variant:"outlined",rows:"3",class:"mb-4"},null,8,["modelValue"]),o("div",ya,[t(w,{variant:"outlined",onClick:e(ge)},{default:s(()=>a[62]||(a[62]=[p(" Batal ")])),_:1,__:[62]},8,["onClick"]),t(w,{type:"submit",color:"primary",class:"coffee-primary",loading:e(qe)},{default:s(()=>a[63]||(a[63]=[p(" Simpan Penyesuaian ")])),_:1,__:[63]},8,["loading"])])]}),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(be,{modelValue:e(Ce),"onUpdate:modelValue":a[28]||(a[28]=l=>ye(Ce)?Ce.value=l:null),"max-width":"800px",fullscreen:e(u),persistent:"",class:"stock-dialog"},{default:s(()=>[t(F,{class:"stock-movement-dialog coffee-dialog"},{default:s(()=>[t(pe,{class:"d-flex align-center justify-space-between coffee-header"},{default:s(()=>[o("div",ba,[t(j,{icon:e(T).type==="in"?"tabler-plus":"tabler-minus",class:"text-white"},null,8,["icon"]),o("span",ha,i(e(T).type==="in"?"Stok Masuk":e(T).type==="out"?"Stok Keluar":"Penyesuaian Stok"),1)]),t(w,{icon:"tabler-x",variant:"text",color:"white",onClick:e(ge)},null,8,["onClick"])]),_:1}),t(Z),t(z,{class:"pa-6"},{default:s(()=>[t(Re,{onSubmit:Ue(e(fe),["prevent"])},{default:s(()=>[e(J)?(f(),C(le,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:s(()=>[o("div",xa,[t(dt,{color:"primary",size:"40",variant:"tonal"},{default:s(()=>[t(j,{icon:"tabler-package"})]),_:1}),o("div",null,[o("div",Sa,i(e(J).name),1),o("div",wa," Stok saat ini: "+i(e(J).current_stock)+" "+i(e(J).unit),1)])])]),_:1})):S("",!0),t(ae,null,{default:s(()=>[t(U,{cols:"12",md:"6"},{default:s(()=>[t(Y,{modelValue:e(T).quantity,"onUpdate:modelValue":a[25]||(a[25]=l=>e(T).quantity=l),modelModifiers:{number:!0},label:`Jumlah ${e(T).type==="in"?"Masuk":e(T).type==="out"?"Keluar":"Akhir"}`,type:"number",variant:"outlined",required:"",min:e(T).type==="adjustment"?0:1,rules:[l=>l>0||"Jumlah harus lebih dari 0"]},null,8,["modelValue","label","min","rules"])]),_:1}),t(U,{cols:"12",md:"6"},{default:s(()=>[t(Y,{modelValue:e(T).cost_per_unit,"onUpdate:modelValue":a[26]||(a[26]=l=>e(T).cost_per_unit=l),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",variant:"outlined",prefix:"Rp",readonly:e(T).type!=="in"},null,8,["modelValue","readonly"])]),_:1}),t(U,{cols:"12"},{default:s(()=>[t(Oe,{modelValue:e(T).notes,"onUpdate:modelValue":a[27]||(a[27]=l=>e(T).notes=l),label:"Catatan",placeholder:"Masukkan catatan untuk pergerakan stok...",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),t(Z),t($e,{class:"pa-6"},{default:s(()=>[t(he),t(w,{variant:"outlined",class:"coffee-secondary",onClick:e(ge)},{default:s(()=>a[64]||(a[64]=[p(" Batal ")])),_:1,__:[64]},8,["onClick"]),t(w,{color:"primary",class:"coffee-primary",loading:e(qe),onClick:e(fe)},{default:s(()=>a[65]||(a[65]=[p(" Simpan ")])),_:1,__:[65]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}}),es=st(Va,[["__scopeId","data-v-c49eec36"]]);export{es as default};
