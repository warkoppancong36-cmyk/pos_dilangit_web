import{D as At}from"./DeleteConfirmationDialog-BuwEZI9p.js";import{f as tt}from"./formatters-BD6tdLx_.js";import{P as vt,u as ta}from"./useProductItems-BZACHggT.js";import{I as aa}from"./ItemsApi-CKdJIQXp.js";import{H as la,u as oa}from"./HPPBreakdownDialog-DPhrYFUx.js";import{V as Ne}from"./VDialog-DjCk3bIr.js";import{V as de,b as $e,c as Ke}from"./VCard-BFWoCrFa.js";import{cq as Mt,a8 as Qe,a9 as Ze,as as sa,aF as na,af as Et,bT as ia,r as H,V as ce,aG as Ge,w as Se,W as We,b as e,a0 as K,aa as et,ak as ra,ab as Ht,ac as Bt,H as Ft,ba as ua,L as da,N as Kt,bZ as ca,b_ as ma,b9 as pt,aJ as bt,I as va,ag as Rt,aM as gt,bj as fa,bt as $t,p as Ve,be as wt,cr as pa,c8 as Dt,bh as ga,F as ze,X as I,cp as _a,c9 as ka,aI as ya,s as v,cs as ba,a$ as ha,ad as xa,aH as wa,b3 as Va,b5 as Pa,d as Re,D as ut,c as ne,f as t,e as a,t as c,g as N,l as ae,m as J,i as Xe,v as Je,o as b,aw as qt,ax as ht,$ as Vt,j as Ot,ct as Ca,aA as Oe,ap as Ia,aq as Sa,a5 as yt}from"./main-XvKXkpJg.js";import{V as fe}from"./VCardText-09i_jPh7.js";import{V as Te}from"./VAvatar-D_3QeFUX.js";import{V as pe,m as $a,b as Tt}from"./VChip-C8jp0Bna.js";import{V as Ue,a as E}from"./VRow-DXJ7U-lv.js";import{V as Pt}from"./VAutocomplete-DZiM9BfI.js";import{u as Da,e as Ta,t as ot,V as kt,a as Ye,b as nt,d as it}from"./VList-DHZC2ZFC.js";import{u as Ua,V as Ie,m as za}from"./VTextField-C9SZ_ma1.js";import{V as rt}from"./VSwitch-CfaMPmeU.js";import{a as _t,V as Be}from"./VAlert-D9RZjIow.js";import{V as Le}from"./VSpacer-CAQ1Q6KU.js";import{V as at}from"./VSnackbar-CY18rjFF.js";import{_ as je}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Aa,m as Ma,a as Ea,V as Fe}from"./VSelect-Dg4zTtw3.js";import{V as Ha}from"./VCheckbox-BmkptV88.js";import{V as Me}from"./VDivider-D1gbqQUn.js";import{V as Ba}from"./VContainer-B_agW0DO.js";import{a as Nt,u as Fa,P as Ka}from"./useProducts-Cj8gfjmh.js";import{V as Ct}from"./VForm-D6QVcMIO.js";import{V as Ut}from"./VTextarea-BconjVXb.js";import{V as He}from"./VTooltip-CkjNy_S7.js";import{M as Ra,m as qa,V as Oa}from"./VImg-B_doLpoh.js";import{V as Na,u as La}from"./useCategories-Y81oWNPg.js";import{u as ja,m as Wa,h as Ga}from"./filter-DVzn0_9b.js";import{f as Lt,a as Xa,s as Ja}from"./forwardRefs-B931MWyl.js";import{V as Ya}from"./VMenu-DJBNImy5.js";import{V as Qa}from"./VCheckboxBtn-DiZfUUJV.js";import{V as Za}from"./VDataTableServer-Bo0DXCIB.js";import{V as el}from"./VSkeletonLoader-wwCcEu65.js";import{V as tl}from"./VDataTable-Bu6RIjZT.js";import{c as al,d as ll,u as ol}from"./VOverlay-BYYQKJRO.js";import"./ProductsApi-BGWAKqFw.js";import"./api-DDD9HUWj.js";import"./index-D-EbNoF1.js";/* empty css              */import"./helpers-B-vn2Qqf.js";import"./CategoriesApi-rniBvUwm.js";import"./VTable-CwUY3cL0.js";const sl=l=>{const{touchstartX:F,touchendX:h,touchstartY:d,touchendY:U}=l,p=.5,V=16;l.offsetX=h-F,l.offsetY=U-d,Math.abs(l.offsetY)<p*Math.abs(l.offsetX)&&(l.left&&h<F-V&&l.left(l),l.right&&h>F+V&&l.right(l)),Math.abs(l.offsetX)<p*Math.abs(l.offsetY)&&(l.up&&U<d-V&&l.up(l),l.down&&U>d+V&&l.down(l))};function nl(l,F){var d;const h=l.changedTouches[0];F.touchstartX=h.clientX,F.touchstartY=h.clientY,(d=F.start)==null||d.call(F,{originalEvent:l,...F})}function il(l,F){var d;const h=l.changedTouches[0];F.touchendX=h.clientX,F.touchendY=h.clientY,(d=F.end)==null||d.call(F,{originalEvent:l,...F}),sl(F)}function rl(l,F){var d;const h=l.changedTouches[0];F.touchmoveX=h.clientX,F.touchmoveY=h.clientY,(d=F.move)==null||d.call(F,{originalEvent:l,...F})}function ul(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const F={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:l.left,right:l.right,up:l.up,down:l.down,start:l.start,move:l.move,end:l.end};return{touchstart:h=>nl(h,F),touchend:h=>il(h,F),touchmove:h=>rl(h,F)}}function dl(l,F){var m;const h=F.value,d=h!=null&&h.parent?l.parentElement:l,U=(h==null?void 0:h.options)??{passive:!0},p=(m=F.instance)==null?void 0:m.$.uid;if(!d||!p)return;const V=ul(F.value);d._touchHandlers=d._touchHandlers??Object.create(null),d._touchHandlers[p]=V,Mt(V).forEach(r=>{d.addEventListener(r,V[r],U)})}function cl(l,F){var p,V;const h=(p=F.value)!=null&&p.parent?l.parentElement:l,d=(V=F.instance)==null?void 0:V.$.uid;if(!(h!=null&&h._touchHandlers)||!d)return;const U=h._touchHandlers[d];Mt(U).forEach(m=>{h.removeEventListener(m,U[m])}),delete h._touchHandlers[d]}const jt={mounted:dl,unmounted:cl},Wt=Symbol.for("vuetify:v-window"),Gt=Symbol.for("vuetify:v-window-group"),Xt=Ze({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:l=>typeof l=="boolean"||l==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Bt(),...Ht(),...ra()},"VWindow"),xt=Qe()({name:"VWindow",directives:{Touch:jt},props:Xt(),emits:{"update:modelValue":l=>!0},setup(l,F){let{slots:h}=F;const{themeClasses:d}=sa(l),{isRtl:U}=na(),{t:p}=Et(),V=ia(l,Gt),m=H(),r=ce(()=>U.value?!l.reverse:l.reverse),s=Ge(!1),W=ce(()=>{const g=l.direction==="vertical"?"y":"x",S=(r.value?!s.value:s.value)?"-reverse":"";return`v-window-${g}${S}-transition`}),_=Ge(0),L=H(void 0),oe=ce(()=>V.items.value.findIndex(g=>V.selected.value.includes(g.id)));Se(oe,(g,k)=>{const S=V.items.value.length,G=S-1;S<=2?s.value=g<k:g===G&&k===0?s.value=!0:g===0&&k===G?s.value=!1:s.value=g<k}),da(Wt,{transition:W,isReversed:s,transitionCount:_,transitionHeight:L,rootRef:m});const D=We(()=>l.continuous||oe.value!==0),C=We(()=>l.continuous||oe.value!==V.items.value.length-1);function ie(){D.value&&V.prev()}function ge(){C.value&&V.next()}const q=ce(()=>{const g=[],k={icon:U.value?l.nextIcon:l.prevIcon,class:`v-window__${r.value?"right":"left"}`,onClick:V.prev,"aria-label":p("$vuetify.carousel.prev")};g.push(D.value?h.prev?h.prev({props:k}):e(K,k,null):e("div",null,null));const S={icon:U.value?l.prevIcon:l.nextIcon,class:`v-window__${r.value?"left":"right"}`,onClick:V.next,"aria-label":p("$vuetify.carousel.next")};return g.push(C.value?h.next?h.next({props:S}):e(K,S,null):e("div",null,null)),g}),Z=ce(()=>l.touch===!1?l.touch:{...{left:()=>{r.value?ie():ge()},right:()=>{r.value?ge():ie()},start:k=>{let{originalEvent:S}=k;S.stopPropagation()}},...l.touch===!0?{}:l.touch});return et(()=>Ft(e(l.tag,{ref:m,class:["v-window",{"v-window--show-arrows-on-hover":l.showArrows==="hover"},d.value,l.class],style:l.style},{default:()=>{var g,k;return[e("div",{class:"v-window__container",style:{height:L.value}},[(g=h.default)==null?void 0:g.call(h,{group:V}),l.showArrows!==!1&&e("div",{class:"v-window__controls"},[q.value])]),(k=h.additional)==null?void 0:k.call(h,{group:V})]}}),[[ua("touch"),Z.value]])),{group:V}}}),Jt=Ze({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Bt(),...ma(),...ll()},"VWindowItem"),st=Qe()({name:"VWindowItem",directives:{Touch:jt},props:Jt(),emits:{"group:selected":l=>!0},setup(l,F){let{slots:h}=F;const d=Kt(Wt),U=ca(l,Gt),{isBooted:p}=Da();if(!d||!U)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const V=Ge(!1),m=ce(()=>p.value&&(d.isReversed.value?l.reverseTransition!==!1:l.transition!==!1));function r(){!V.value||!d||(V.value=!1,d.transitionCount.value>0&&(d.transitionCount.value-=1,d.transitionCount.value===0&&(d.transitionHeight.value=void 0)))}function s(){var D;V.value||!d||(V.value=!0,d.transitionCount.value===0&&(d.transitionHeight.value=bt((D=d.rootRef.value)==null?void 0:D.clientHeight)),d.transitionCount.value+=1)}function W(){r()}function _(D){V.value&&pt(()=>{!m.value||!V.value||!d||(d.transitionHeight.value=bt(D.clientHeight))})}const L=ce(()=>{const D=d.isReversed.value?l.reverseTransition:l.transition;return m.value?{name:typeof D!="string"?d.transition.value:D,onBeforeEnter:s,onAfterEnter:r,onEnterCancelled:W,onBeforeLeave:s,onAfterLeave:r,onLeaveCancelled:W,onEnter:_}:!1}),{hasContent:oe}=al(l,U.isSelected);return et(()=>e(Ra,{transition:L.value,disabled:!p.value},{default:()=>{var D;return[Ft(e("div",{class:["v-window-item",U.selectedClass.value,l.class],style:l.style},[oe.value&&((D=h.default)==null?void 0:D.call(h))]),[[va,U.isSelected.value]])]}})),{groupItem:U}}}),ml=Ze({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Wa({filterKeys:["title"]}),...Ma({hideNoData:!0,returnObject:!0}),...wt(za({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...qa({transition:!1})},"VCombobox"),vl=Qe()({name:"VCombobox",props:ml(),emits:{"update:focused":l=>!0,"update:modelValue":l=>!0,"update:search":l=>!0,"update:menu":l=>!0},setup(l,F){var M;let{emit:h,slots:d}=F;const{t:U}=Et(),p=H(),V=Ge(!1),m=Ge(!0),r=Ge(!1),s=H(),W=H(),_=Ge(-1);let L=!1;const{items:oe,transformIn:D,transformOut:C}=Ta(l),{textColorClasses:ie,textColorStyles:ge}=Rt(()=>{var o;return(o=p.value)==null?void 0:o.color}),q=gt(l,"modelValue",[],o=>D(fa(o)),o=>{const T=C(o);return l.multiple?T:T[0]??null}),Z=Ua(l),g=ce(()=>!!(l.chips||d.chip)),k=ce(()=>g.value||!!d.selection),S=Ge(!l.multiple&&!k.value?((M=q.value[0])==null?void 0:M.title)??"":""),G=ce({get:()=>S.value,set:o=>{var T;if(S.value=o??"",!l.multiple&&!k.value&&(q.value=[ot(l,o)]),o&&l.multiple&&((T=l.delimiters)!=null&&T.length)){const R=o.split(new RegExp(`(?:${l.delimiters.join("|")})+`));R.length>1&&(R.forEach(Y=>{Y=Y.trim(),Y&&xe(ot(l,Y))}),S.value="")}o||(_.value=-1),m.value=!o}}),j=ce(()=>typeof l.counterValue=="function"?l.counterValue(q.value):typeof l.counterValue=="number"?l.counterValue:l.multiple?q.value.length:G.value.length),{filteredItems:y,getMatches:w}=ja(l,oe,()=>m.value?"":G.value),O=ce(()=>l.hideSelected?y.value.filter(o=>!q.value.some(T=>T.value===o.value)):y.value),re=ce(()=>l.hideNoData&&!O.value.length||Z.isReadonly.value||Z.isDisabled.value),he=gt(l,"menu"),ve=ce({get:()=>he.value,set:o=>{var T;he.value&&!o&&((T=s.value)!=null&&T.ΨopenChildren.size)||o&&re.value||(he.value=o)}}),Q=We(()=>ve.value?l.closeText:l.openText);Se(S,o=>{L?pt(()=>L=!1):V.value&&!ve.value&&(ve.value=!0),h("update:search",o)}),Se(q,o=>{var T;!l.multiple&&!k.value&&(S.value=((T=o[0])==null?void 0:T.title)??"")});const f=ce(()=>q.value.map(o=>o.value)),u=ce(()=>{var T;return(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&G.value===((T=O.value[0])==null?void 0:T.title))&&O.value.length>0&&!m.value&&!r.value}),n=H(),i=Aa(n,p);function z(o){L=!0,l.openOnClear&&(ve.value=!0)}function A(){re.value||(ve.value=!0)}function ke(o){re.value||(V.value&&(o.preventDefault(),o.stopPropagation()),ve.value=!ve.value)}function B(o){var T;o.key!==" "&&Dt(o)&&((T=p.value)==null||T.focus())}function x(o){var Y,$,ee,se;if(pa(o)||Z.isReadonly.value)return;const T=(Y=p.value)==null?void 0:Y.selectionStart,R=q.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(o.key)&&o.preventDefault(),["Enter","ArrowDown"].includes(o.key)&&(ve.value=!0),["Escape"].includes(o.key)&&(ve.value=!1),["Enter","Escape","Tab"].includes(o.key)&&(u.value&&["Enter","Tab"].includes(o.key)&&!q.value.some(P=>{let{value:me}=P;return me===O.value[0].value})&&xe(y.value[0]),m.value=!0),o.key==="ArrowDown"&&u.value&&(($=n.value)==null||$.focus("next")),o.key==="Enter"&&G.value&&(xe(ot(l,G.value)),k.value&&(S.value="")),["Backspace","Delete"].includes(o.key)){if(!l.multiple&&k.value&&q.value.length>0&&!G.value)return xe(q.value[0],!1);if(~_.value){o.preventDefault();const P=_.value;xe(q.value[_.value],!1),_.value=P>=R-1?R-2:P}else o.key==="Backspace"&&!G.value&&(_.value=R-1);return}if(l.multiple)if(o.key==="ArrowLeft"){if(_.value<0&&T&&T>0)return;const P=_.value>-1?_.value-1:R-1;q.value[P]?_.value=P:(_.value=-1,(ee=p.value)==null||ee.setSelectionRange(G.value.length,G.value.length))}else if(o.key==="ArrowRight"){if(_.value<0)return;const P=_.value+1;q.value[P]?_.value=P:(_.value=-1,(se=p.value)==null||se.setSelectionRange(0,0))}else~_.value&&Dt(o)&&(_.value=-1)}function ue(){var o;l.eager&&((o=W.value)==null||o.calculateVisibleItems())}function De(){var o;V.value&&(m.value=!0,(o=p.value)==null||o.focus())}function xe(o){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!o||o.props.disabled))if(l.multiple){const R=q.value.findIndex($=>(l.valueComparator||$t)($.value,o.value)),Y=T??!~R;if(~R){const $=Y?[...q.value,o]:[...q.value];$.splice(R,1),q.value=$}else Y&&(q.value=[...q.value,o]);l.clearOnSelect&&(G.value="")}else{const R=T!==!1;q.value=R?[o]:[],S.value=R&&!k.value?o.title:"",pt(()=>{ve.value=!1,m.value=!0})}}function Pe(o){V.value=!0,setTimeout(()=>{r.value=!0})}function te(o){r.value=!1}function ye(o){(o==null||o===""&&!l.multiple&&!k.value)&&(q.value=[])}return Se(V,(o,T)=>{if(!(o||o===T)&&(_.value=-1,ve.value=!1,G.value)){if(l.multiple){xe(ot(l,G.value));return}if(!k.value)return;q.value.some(R=>{let{title:Y}=R;return Y===G.value})?S.value="":xe(ot(l,G.value))}}),Se(ve,()=>{if(!l.hideSelected&&ve.value&&q.value.length){const o=O.value.findIndex(T=>q.value.some(R=>(l.valueComparator||$t)(R.value,T.value)));ga&&window.requestAnimationFrame(()=>{var T;o>=0&&((T=W.value)==null||T.scrollToIndex(o))})}}),Se(()=>l.items,(o,T)=>{ve.value||V.value&&!T.length&&o.length&&(ve.value=!0)}),et(()=>{const o=!!(!l.hideNoData||O.value.length||d["prepend-item"]||d["append-item"]||d["no-data"]),T=q.value.length>0,R=Ie.filterProps(l);return e(Ie,Ve({ref:p},R,{modelValue:G.value,"onUpdate:modelValue":[Y=>G.value=Y,ye],focused:V.value,"onUpdate:focused":Y=>V.value=Y,validationValue:q.externalValue,counterValue:j.value,dirty:T,class:["v-combobox",{"v-combobox--active-menu":ve.value,"v-combobox--chips":!!l.chips,"v-combobox--selection-slot":!!k.value,"v-combobox--selecting-index":_.value>-1,[`v-combobox--${l.multiple?"multiple":"single"}`]:!0},l.class],style:l.style,readonly:Z.isReadonly.value,placeholder:T?void 0:l.placeholder,"onClick:clear":z,"onMousedown:control":A,onKeydown:x}),{...d,default:()=>e(ze,null,[e(Ya,Ve({ref:s,modelValue:ve.value,"onUpdate:modelValue":Y=>ve.value=Y,activator:"parent",contentClass:"v-combobox__content",disabled:re.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterEnter:ue,onAfterLeave:De},l.menuProps),{default:()=>[o&&e(kt,Ve({ref:n,selected:f.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:Y=>Y.preventDefault(),onKeydown:B,onFocusin:Pe,onFocusout:te,tabindex:"-1","aria-live":"polite",color:l.itemColor??l.color},i,l.listProps),{default:()=>{var Y,$,ee;return[(Y=d["prepend-item"])==null?void 0:Y.call(d),!O.value.length&&!l.hideNoData&&((($=d["no-data"])==null?void 0:$.call(d))??e(Ye,{key:"no-data",title:U(l.noDataText)},null)),e(Ea,{ref:W,renderless:!0,items:O.value,itemKey:"value"},{default:se=>{var we;let{item:P,index:me,itemRef:X}=se;const _e=Ve(P.props,{ref:X,key:P.value,active:u.value&&me===0?!0:void 0,onClick:()=>xe(P,null)});return((we=d.item)==null?void 0:we.call(d,{item:P,index:me,props:_e}))??e(Ye,Ve(_e,{role:"option"}),{prepend:Ce=>{let{isSelected:Ee}=Ce;return e(ze,null,[l.multiple&&!l.hideSelected?e(Qa,{key:P.value,modelValue:Ee,ripple:!1,tabindex:"-1"},null):void 0,P.props.prependAvatar&&e(Te,{image:P.props.prependAvatar},null),P.props.prependIcon&&e(I,{icon:P.props.prependIcon},null)])},title:()=>{var Ce;return m.value?P.title:Ga("v-combobox",P.title,(Ce=w(P))==null?void 0:Ce.title)}})}}),(ee=d["append-item"])==null?void 0:ee.call(d)]}})]}),q.value.map((Y,$)=>{function ee(X){X.stopPropagation(),X.preventDefault(),xe(Y,!1)}const se={"onClick:close":ee,onKeydown(X){X.key!=="Enter"&&X.key!==" "||(X.preventDefault(),X.stopPropagation(),ee(X))},onMousedown(X){X.preventDefault(),X.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},P=g.value?!!d.chip:!!d.selection,me=P?ka(g.value?d.chip({item:Y,index:$,props:se}):d.selection({item:Y,index:$})):void 0;if(!(P&&!me))return e("div",{key:Y.value,class:["v-combobox__selection",$===_.value&&["v-combobox__selection--selected",ie.value]],style:$===_.value?ge.value:{}},[g.value?d.chip?e(ya,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:Y.title}}},{default:()=>[me]}):e(pe,Ve({key:"chip",closable:l.closableChips,size:"small",text:Y.title,disabled:Y.props.disabled},se),null):me??e("span",{class:"v-combobox__selection-text"},[Y.title,l.multiple&&$<q.value.length-1&&e("span",{class:"v-combobox__selection-comma"},[v(",")])])])})]),"append-inner":function(){var se,P;for(var Y=arguments.length,$=new Array(Y),ee=0;ee<Y;ee++)$[ee]=arguments[ee];return e(ze,null,[(se=d["append-inner"])==null?void 0:se.call(d,...$),(!l.hideNoData||l.items.length)&&l.menuIcon?e(I,{class:"v-combobox__menu-icon",color:(P=p.value)==null?void 0:P.fieldIconColor,icon:l.menuIcon,onMousedown:ke,onClick:_a,"aria-label":U(Q.value),title:U(Q.value),tabindex:"-1"},null):void 0])}})}),Lt({isFocused:V,isPristine:m,menu:ve,search:G,selectionIndex:_,filteredItems:y,select:xe},p)}}),It=Symbol.for("vuetify:v-tabs"),fl=Ze({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...wt(ba({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),ft=Qe()({name:"VTab",props:fl(),setup(l,F){let{slots:h,attrs:d}=F;const{textColorClasses:U,textColorStyles:p}=Rt(()=>l.sliderColor),V=H(),m=H(),r=ce(()=>l.direction==="horizontal"),s=ce(()=>{var _,L;return((L=(_=V.value)==null?void 0:_.group)==null?void 0:L.isSelected.value)??!1});function W(_){var oe,D;let{value:L}=_;if(L){const C=(D=(oe=V.value)==null?void 0:oe.$el.parentElement)==null?void 0:D.querySelector(".v-tab--selected .v-tab__slider"),ie=m.value;if(!C||!ie)return;const ge=getComputedStyle(C).color,q=C.getBoundingClientRect(),Z=ie.getBoundingClientRect(),g=r.value?"x":"y",k=r.value?"X":"Y",S=r.value?"right":"bottom",G=r.value?"width":"height",j=q[g],y=Z[g],w=j>y?q[S]-Z[S]:q[g]-Z[g],O=Math.sign(w)>0?r.value?"right":"bottom":Math.sign(w)<0?r.value?"left":"top":"center",he=(Math.abs(w)+(Math.sign(w)<0?q[G]:Z[G]))/Math.max(q[G],Z[G])||0,ve=q[G]/Z[G]||0,Q=1.5;Xa(ie,{backgroundColor:[ge,"currentcolor"],transform:[`translate${k}(${w}px) scale${k}(${ve})`,`translate${k}(${w/Q}px) scale${k}(${(he-1)/Q+1})`,"none"],transformOrigin:Array(3).fill(O)},{duration:225,easing:Ja})}}return et(()=>{const _=K.filterProps(l);return e(K,Ve({symbol:It,ref:V,class:["v-tab",l.class],style:l.style,tabindex:s.value?0:-1,role:"tab","aria-selected":String(s.value),active:!1},_,d,{block:l.fixed,maxWidth:l.fixed?300:void 0,"onGroup:selected":W}),{...h,default:()=>{var L;return e(ze,null,[((L=h.default)==null?void 0:L.call(h))??l.text,!l.hideSlider&&e("div",{ref:m,class:["v-tab__slider",U.value],style:p.value},null)])}})}),Lt({},V)}}),pl=Ze({...wt(Xt(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),gl=Qe()({name:"VTabsWindow",props:pl(),emits:{"update:modelValue":l=>!0},setup(l,F){let{slots:h}=F;const d=Kt(It,null),U=gt(l,"modelValue"),p=ce({get(){var V;return U.value!=null||!d?U.value:(V=d.items.value.find(m=>d.selected.value.includes(m.id)))==null?void 0:V.value},set(V){U.value=V}});return et(()=>{const V=xt.filterProps(l);return e(xt,Ve({_as:"VTabsWindow"},V,{modelValue:p.value,"onUpdate:modelValue":m=>p.value=m,class:["v-tabs-window",l.class],style:l.style,mandatory:!1,touch:!1}),h)}),{}}}),_l=Ze({...Jt()},"VTabsWindowItem"),kl=Qe()({name:"VTabsWindowItem",props:_l(),setup(l,F){let{slots:h}=F;return et(()=>{const d=st.filterProps(l);return e(st,Ve({_as:"VTabsWindowItem"},d,{class:["v-tabs-window-item",l.class],style:l.style}),h)}),{}}});function yl(l){return l?l.map(F=>Pa(F)?F:{text:F,value:F}):[]}const bl=Ze({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...$a({mandatory:"force",selectedClass:"v-tab-item--selected"}),...Va(),...Ht()},"VTabs"),hl=Qe()({name:"VTabs",props:bl(),emits:{"update:modelValue":l=>!0},setup(l,F){let{attrs:h,slots:d}=F;const U=gt(l,"modelValue"),p=ce(()=>yl(l.items)),{densityClasses:V}=ha(l),{backgroundColorClasses:m,backgroundColorStyles:r}=xa(()=>l.bgColor),{scopeId:s}=ol();return wa({VTab:{color:We(()=>l.color),direction:We(()=>l.direction),stacked:We(()=>l.stacked),fixed:We(()=>l.fixedTabs),sliderColor:We(()=>l.sliderColor),hideSlider:We(()=>l.hideSlider)}}),et(()=>{const W=Tt.filterProps(l),_=!!(d.window||l.items.length>0);return e(ze,null,[e(Tt,Ve(W,{modelValue:U.value,"onUpdate:modelValue":L=>U.value=L,class:["v-tabs",`v-tabs--${l.direction}`,`v-tabs--align-tabs-${l.alignTabs}`,{"v-tabs--fixed-tabs":l.fixedTabs,"v-tabs--grow":l.grow,"v-tabs--stacked":l.stacked},V.value,m.value,l.class],style:[{"--v-tabs-height":bt(l.height)},r.value,l.style],role:"tablist",symbol:It},s,h),{default:()=>{var L;return[((L=d.default)==null?void 0:L.call(d))??p.value.map(oe=>{var D;return((D=d.tab)==null?void 0:D.call(d,{item:oe}))??e(ft,Ve(oe,{key:oe.text,value:oe.value}),{default:d[`tab.${oe.value}`]?()=>{var C;return(C=d[`tab.${oe.value}`])==null?void 0:C.call(d,{item:oe})}:void 0})})]}}),_&&e(gl,Ve({modelValue:U.value,"onUpdate:modelValue":L=>U.value=L,key:"tabs-window"},s),{default:()=>{var L;return[p.value.map(oe=>{var D;return((D=d.item)==null?void 0:D.call(d,{item:oe}))??e(kl,{value:oe.value},{default:()=>{var C;return(C=d[`item.${oe.value}`])==null?void 0:C.call(d,{item:oe})}})}),(L=d.window)==null?void 0:L.call(d)]}})])}),{}}}),xl={class:"d-flex align-center gap-3"},wl={class:"text-body-2 ma-0 opacity-90"},Vl={class:"d-flex align-center gap-4"},Pl={class:"flex-grow-1"},Cl={class:"text-h6 font-weight-bold mb-1"},Il={class:"text-body-2 text-medium-emphasis mb-1"},Sl={class:"text-body-2 text-medium-emphasis mb-0"},$l={class:"d-flex align-center justify-space-between w-100"},Dl={class:"d-flex align-center"},Tl={key:0,class:"text-warning"},Ul={key:1},zl={key:0,class:"text-center pa-8"},Al={class:"d-flex align-center gap-4 mt-1"},Ml={key:1,class:"text-primary"},El={class:"d-flex gap-2"},Hl=Re({__name:"ProductCompositionDialog",props:{modelValue:{type:Boolean},product:{},items:{}},emits:["update:modelValue","save","refresh"],setup(l,{emit:F}){const h=l,d=F,U=ce({get:()=>h.modelValue,set:B=>d("update:modelValue",B)}),p=H(!1),V=H([]),m=H(!1),r=H(!1),s=H(""),W=H(""),_=H(!1),L=H(-1),oe=H(!1),D=H({itemId:null,quantity:1,unit:"pcs",isCritical:!1}),C=H([]),ie=H(!1),ge=H([]),q=async()=>{var B;if(h.product)try{const x=h.product.id_product||h.product.id;console.log("🔄 Fetching composition for product ID:",x);const ue=await vt.getAll({product_id:x,page:1,per_page:1e5});ue.success&&((B=ue.data)!=null&&B.data)&&(V.value=ue.data.data,ge.value=JSON.parse(JSON.stringify(ue.data.data)),console.log("✅ Initial composition loaded:",ge.value.length,"items"))}catch(x){console.error("Error fetching product composition:",x)}},Z=async()=>{var B;ie.value=!0;try{const x=await aa.getAll({page:1,per_page:1e5,active:!0});x.success&&((B=x.data)!=null&&B.data)&&(C.value=x.data.data.map(ue=>{var De,xe,Pe;return{id:((De=ue.id_item)==null?void 0:De.toString())||((xe=ue.id)==null?void 0:xe.toString()),name:ue.name,current_stock:((Pe=ue.inventory)==null?void 0:Pe.current_stock)||0,unit:ue.unit||"pcs"}}))}catch(x){console.error("Error fetching available items:",x),C.value=[]}finally{ie.value=!1}},g=ce(()=>D.value.itemId&&D.value.quantity>0&&D.value.unit.trim().length>0),k=ce(()=>{if(!D.value.itemId)return null;const B=C.value.find(x=>x.id===D.value.itemId);return(B==null?void 0:B.unit)||null}),S=ce(()=>{if(!D.value.itemId)return null;const B=C.value.find(x=>x.id===D.value.itemId);return B?y(B):null}),G=ce(()=>S.value!==null&&S.value<=0),j=ce(()=>Array.isArray(C.value)?C.value:[]),y=B=>B.current_stock||B.stock||0,w=()=>ie.value?"Memuat items...":!C.value||C.value.length===0?"Tidak ada item tersedia":"Tidak ada item yang ditemukan",O=B=>{const x=y(B);return x>50?"success":x>20?"warning":x>0?"error":"grey"},re=B=>{const x=y(B);return x>50?"Aman":x>20?"Rendah":x>0?"Kritis":"Habis"};Se(()=>D.value.itemId,B=>{if(B){const x=C.value.find(ue=>ue.id===B);x!=null&&x.unit&&(D.value.unit=x.unit)}}),Se(()=>h.items,B=>{B&&B.length>0,V.value=[...B]},{immediate:!0}),Se(()=>h.modelValue,B=>{B&&h.product&&q()}),ut(()=>{Z()});const he=()=>{oe.value=!0},ve=()=>V.value.some(x=>{var ue;return((ue=x.item)==null?void 0:ue.inventory)&&x.item.inventory.current_stock<x.quantity_needed})?"error":"success",Q=()=>V.value.some(x=>{var ue;return((ue=x.item)==null?void 0:ue.inventory)&&x.item.inventory.current_stock<x.quantity_needed})?"Stok Kritis":"Stok Aman",f=()=>{if(!g.value)return;const B=C.value.find(De=>De.id===D.value.itemId);if(!B)return;if(V.value.find(De=>{var xe;return((xe=De.item)==null?void 0:xe.id)===B.id})){s.value=`Item "${B.name}" sudah ada dalam komposisi produk ini`,m.value=!0;return}const ue={id_product_item:`temp_${Date.now()}`,item:{id:String(B.id),name:B.name,inventory:{current_stock:B.current_stock||0}},quantity_needed:D.value.quantity,unit:D.value.unit,is_critical:D.value.isCritical};V.value.push(ue),i()},u=(B,x)=>{var xe;if(console.log("🔍 EditItem called with:",B),console.log("🔍 Item structure:",JSON.stringify(B,null,2)),C.value.length===0){console.warn("⚠️ Available items not loaded yet, fetching..."),Z().then(()=>{console.log("✅ Available items loaded, retrying edit"),u(B,x)});return}_.value=!0,L.value=x;let ue=((xe=B.item)==null?void 0:xe.id)||null;ue!==null&&(ue=ue.toString()),console.log("🎯 Found itemId (converted to string):",ue),console.log("🔍 Available items for reference:",C.value.map(Pe=>({id:Pe.id,name:Pe.name}))),D.value={itemId:ue,quantity:B.quantity_needed,unit:B.unit,isCritical:B.is_critical},console.log("📝 Form data set for edit:",D.value);const De=C.value.find(Pe=>Pe.id===ue);if(De)console.log("✅ Item found in available items:",De.name);else{console.warn("⚠️ Item ID not found in available items, trying alternative matching...");const Pe=C.value.find(te=>{var ye;return te.name===((ye=B.item)==null?void 0:ye.name)});Pe?(console.log("✅ Found item by name matching, using ID:",Pe.id),D.value.itemId=Pe.id):console.error("❌ Could not find item in available items by ID or name")}},n=()=>{if(!g.value||L.value===-1)return;const B=C.value.find(x=>x.id===D.value.itemId);B&&(V.value[L.value]={...V.value[L.value],item:{id:String(B.id),name:B.name,inventory:{current_stock:B.current_stock||0}},quantity_needed:D.value.quantity,unit:D.value.unit,is_critical:D.value.isCritical},i())},i=()=>{_.value=!1,L.value=-1,D.value={itemId:null,quantity:1,unit:"pcs",isCritical:!1}},z=B=>{V.value.splice(B,1)},A=async()=>{var B,x,ue,De,xe,Pe,te,ye,M,o,T,R,Y,$,ee;if(h.product){p.value=!0;try{console.log("💾 Saving composition for product:",h.product.name),console.log("📦 Items to save:",V.value);const se=parseInt(String(((B=h.product)==null?void 0:B.id_product)||((x=h.product)==null?void 0:x.id)||"0")),P=ge.value||[],me=V.value;console.log("🔄 Comparing items for save:",{existing_count:P.length,current_count:me.length,existing_items:P.map(X=>{var _e,we;return{id:X.id_product_item,item_id:(_e=X.item)==null?void 0:_e.id,item_name:(we=X.item)==null?void 0:we.name}}),current_items:me.map(X=>{var _e,we;return{id:X.id_product_item,item_id:(_e=X.item)==null?void 0:_e.id,item_name:(we=X.item)==null?void 0:we.name}})});for(const X of me){const _e=P.find(Ce=>{var Ee,qe;return!!(Ce.id_product_item===X.id_product_item||X.id_product_item&&!X.id_product_item.toString().startsWith("temp_")&&((Ee=Ce.item)==null?void 0:Ee.id)===((qe=X.item)==null?void 0:qe.id))});console.log("🔍 Processing item:",{item_name:(ue=X.item)==null?void 0:ue.name,item_id_product_item:X.id_product_item,existing_found:!!_e,existing_id:_e==null?void 0:_e.id_product_item,is_temp:(De=X.id_product_item)==null?void 0:De.toString().startsWith("temp_"),matching_strategy:_e?_e.id_product_item===X.id_product_item?"exact_id":"item_product_match":"no_match"});const we={product_id:se,item_id:parseInt(((xe=X.item)==null?void 0:xe.id)||"0"),quantity_needed:X.quantity_needed,unit:X.unit,is_critical:X.is_critical,notes:X.notes||""};console.log("📤 API Data:",we);try{_e&&!((Pe=X.id_product_item)!=null&&Pe.toString().startsWith("temp_"))?(console.log("✏️ Updating existing item:",{id:_e.id_product_item,item_name:(te=X.item)==null?void 0:te.name,current_stock:(M=(ye=X.item)==null?void 0:ye.inventory)==null?void 0:M.current_stock}),await vt.update(parseInt(_e.id_product_item||"0"),we)):(console.log("➕ Creating new item:",{item_name:(o=X.item)==null?void 0:o.name,current_stock:(R=(T=X.item)==null?void 0:T.inventory)==null?void 0:R.current_stock,id_product_item:X.id_product_item,is_temp:(Y=X.id_product_item)==null?void 0:Y.toString().startsWith("temp_"),existing_item_found:!!_e}),await vt.create(we))}catch(Ce){throw console.error("❌ Error processing item:",Ce),($=Ce.message)!=null&&$.includes("already assigned")?s.value=`Item "${(ee=X.item)==null?void 0:ee.name}" sudah ditambahkan ke produk ini`:s.value=Ce.message||"Terjadi kesalahan saat menyimpan item",m.value=!0,Ce}}for(const X of P)if(!me.find(we=>we.id_product_item===X.id_product_item)&&X.id_product_item)try{console.log("🗑️ Deleting item:",X.id_product_item),await vt.delete(parseInt(X.id_product_item))}catch(we){console.error("❌ Error deleting item:",we),s.value=`Gagal menghapus item: ${we.message}`,m.value=!0}console.log("✅ Composition saved successfully!"),W.value="Komposisi produk berhasil disimpan!",r.value=!0,d("save",{product:h.product,items:V.value}),d("refresh"),ke()}catch(se){console.error("❌ Error saving composition:",se),m.value||(s.value=se.message||"Terjadi kesalahan saat menyimpan komposisi",m.value=!0)}finally{p.value=!1}}},ke=()=>{U.value=!1,setTimeout(()=>{V.value=[...h.items],i()},300)};return(B,x)=>{var ue,De,xe,Pe;return b(),ne(ze,null,[e(Ne,{modelValue:U.value,"onUpdate:modelValue":x[9]||(x[9]=te=>U.value=te),"max-width":"900",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-between bg-primary text-white"},{default:t(()=>{var te;return[a("div",xl,[e(I,{icon:"mdi-chef-hat",size:"24"}),a("div",null,[x[13]||(x[13]=a("h3",{class:"text-h6 font-weight-bold"},"Kelola Komposisi Item",-1)),a("p",wl,c(((te=B.product)==null?void 0:te.name)||"Produk"),1)])]),e(K,{icon:"mdi-close",variant:"text",size:"small",onClick:ke})]}),_:1}),e(fe,{class:"pa-6"},{default:t(()=>[e(de,{variant:"tonal",class:"mb-6"},{default:t(()=>[e(fe,{class:"pa-4"},{default:t(()=>{var te,ye,M,o,T;return[a("div",Vl,[e(Te,{image:(te=B.product)==null?void 0:te.image_url,size:"64"},{default:t(()=>{var R;return[(R=B.product)!=null&&R.image_url?ae("",!0):(b(),N(I,{key:0,icon:"mdi-coffee"}))]}),_:1},8,["image"]),a("div",Pl,[a("h4",Cl,c((ye=B.product)==null?void 0:ye.name),1),a("p",Il," SKU: "+c(((M=B.product)==null?void 0:M.sku)||"SKU-"+((o=B.product)==null?void 0:o.id_product)),1),a("p",Sl," Harga: "+c(J(tt)(((T=B.product)==null?void 0:T.price)||0)),1)]),e(pe,{color:ve(),variant:"tonal"},{default:t(()=>[v(c(Q()),1)]),_:1},8,["color"])])]}),_:1})]),_:1}),e(de,{class:"mb-6",elevation:"2"},{default:t(()=>[e($e,{class:"bg-grey-lighten-4 py-3"},{default:t(()=>[a("div",$l,[a("div",Dl,[e(I,{icon:_.value?"mdi-pencil-circle":"mdi-plus-circle",class:"me-2"},null,8,["icon"]),v(" "+c(_.value?"Edit Item Komposisi":"Tambah Item Komposisi"),1)])])]),_:1}),e(fe,{class:"pa-4"},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(Pt,{modelValue:D.value.itemId,"onUpdate:modelValue":x[0]||(x[0]=te=>D.value.itemId=te),items:j.value,loading:ie.value,"item-title":"name","item-value":"id",label:"Pilih Item",placeholder:"Cari item (termasuk yang stok kosong)...","prepend-inner-icon":"mdi-magnify",variant:"outlined",clearable:"","no-data-text":w()},{item:t(({props:te,item:ye})=>[e(Ye,Ve(te,{class:{"text-medium-emphasis":y(ye.raw)<=0}}),{prepend:t(()=>[e(Te,{size:"32",class:"me-3",color:y(ye.raw)<=0?"warning":"primary",variant:"tonal"},{default:t(()=>[e(I,{icon:"mdi-package-variant",color:y(ye.raw)<=0?"warning":"primary"},null,8,["color"])]),_:2},1032,["color"])]),append:t(()=>[y(ye.raw)>0?(b(),N(pe,{key:0,size:"x-small",color:O(ye.raw),variant:"tonal"},{default:t(()=>[v(c(re(ye.raw)),1)]),_:2},1032,["color"])):(b(),N(pe,{key:1,size:"x-small",color:"warning",variant:"tonal","prepend-icon":"mdi-alert"},{default:t(()=>x[15]||(x[15]=[v(" Kosong ")])),_:1,__:[15]}))]),default:t(()=>[e(nt,null,{default:t(()=>[v(c(ye.raw.name),1)]),_:2},1024),e(it,{class:"text-medium-emphasis"},{default:t(()=>[y(ye.raw)<=0?(b(),ne("span",Tl,[e(I,{icon:"mdi-alert-circle",size:"12",class:"me-1"}),x[14]||(x[14]=v(" Stok Kosong - Masih bisa digunakan "))])):(b(),ne("span",Ul," Stok: "+c(y(ye.raw))+" "+c(ye.raw.unit),1))]),_:2},1024)]),_:2},1040,["class"])]),_:1},8,["modelValue","items","loading","no-data-text"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Ie,{modelValue:D.value.quantity,"onUpdate:modelValue":x[1]||(x[1]=te=>D.value.quantity=te),modelModifiers:{number:!0},type:"number",label:"Jumlah",variant:"outlined",min:"0",step:"0.01"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Ie,{modelValue:D.value.unit,"onUpdate:modelValue":x[2]||(x[2]=te=>D.value.unit=te),label:"Satuan",variant:"outlined",placeholder:"kg, pcs, ml",readonly:!!k.value,hint:k.value?`Satuan dari item: ${k.value}`:"","persistent-hint":""},null,8,["modelValue","readonly","hint"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(rt,{modelValue:D.value.isCritical,"onUpdate:modelValue":x[3]||(x[3]=te=>D.value.isCritical=te),label:"Item Kritis",color:"error","hide-details":""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(K,{color:_.value?"success":"primary",block:"","prepend-icon":_.value?"mdi-check":"mdi-plus",onClick:x[4]||(x[4]=te=>_.value?n():f()),disabled:!g.value},{default:t(()=>[v(c(_.value?"Update":"Tambah"),1)]),_:1},8,["color","prepend-icon","disabled"]),_.value?(b(),N(K,{key:0,color:"error",variant:"outlined",block:"","prepend-icon":"mdi-close",class:"mt-2",onClick:i},{default:t(()=>x[16]||(x[16]=[v(" Batal ")])),_:1,__:[16]})):ae("",!0)]),_:1})]),_:1}),G.value?(b(),N(Be,{key:0,color:"warning",variant:"tonal",class:"mt-4","prepend-icon":"mdi-alert"},{default:t(()=>[e(_t,null,{default:t(()=>x[17]||(x[17]=[v("Item Stok Kosong")])),_:1,__:[17]}),x[18]||(x[18]=a("div",null,"Item yang dipilih sedang kosong stok, namun masih bisa ditambahkan ke komposisi. Pastikan untuk memperbarui stok sebelum produksi.",-1))]),_:1,__:[18]})):ae("",!0)]),_:1})]),_:1}),e(de,{elevation:"2"},{default:t(()=>[e($e,{class:"bg-grey-lighten-4 py-3"},{default:t(()=>[e(I,{icon:"mdi-format-list-bulleted",class:"me-2"}),v(" Daftar Item Komposisi ("+c(V.value.length)+") ",1)]),_:1}),e(fe,{class:"pa-0"},{default:t(()=>[V.value.length===0?(b(),ne("div",zl,[e(I,{icon:"mdi-package-variant-closed",size:"64",class:"text-disabled mb-4"}),x[19]||(x[19]=a("h4",{class:"text-h6 mb-2"},"Belum ada item komposisi",-1)),x[20]||(x[20]=a("p",{class:"text-body-2 text-medium-emphasis"}," Tambahkan item yang dibutuhkan untuk membuat produk ini ",-1))])):(b(),N(kt,{key:1},{default:t(()=>[(b(!0),ne(ze,null,Xe(V.value,(te,ye)=>(b(),N(Ye,{key:te.id||ye,class:"border-b"},{prepend:t(()=>[e(Te,{size:"40",class:"me-3"},{default:t(()=>{var M,o;return[e(I,{icon:(M=te.item)!=null&&M.inventory&&te.item.inventory.current_stock>=te.quantity_needed?"mdi-check-circle":"mdi-alert-circle",color:(o=te.item)!=null&&o.inventory&&te.item.inventory.current_stock>=te.quantity_needed?"success":"error"},null,8,["icon","color"])]}),_:2},1024)]),append:t(()=>[a("div",El,[e(K,{icon:"mdi-pencil",variant:"text",size:"small",color:"primary",onClick:M=>u(te,ye)},null,8,["onClick"]),e(K,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:M=>z(ye)},null,8,["onClick"])])]),default:t(()=>[e(nt,{class:"font-weight-medium"},{default:t(()=>{var M;return[v(c(((M=te.item)==null?void 0:M.name)||"Item tidak ditemukan")+" ",1),te.is_critical?(b(),N(pe,{key:0,color:"error",size:"x-small",variant:"tonal",class:"ms-2"},{default:t(()=>x[21]||(x[21]=[v(" Kritis ")])),_:1,__:[21]})):ae("",!0)]}),_:2},1024),e(it,null,{default:t(()=>{var M;return[a("div",Al,[a("span",null,"Dibutuhkan: "+c(te.quantity_needed)+" "+c(te.unit),1),(M=te.item)!=null&&M.inventory?(b(),ne("span",{key:0,class:Je(te.item.inventory.current_stock>=te.quantity_needed?"text-success":"text-error")}," Stok: "+c(te.item.inventory.current_stock)+" "+c(te.unit),3)):ae("",!0),te.formatted_total_cost?(b(),ne("span",Ml,c(te.formatted_total_cost),1)):ae("",!0)])]}),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(Ke,{class:"pa-6 pt-0"},{default:t(()=>[e(K,{color:"warning",variant:"outlined","prepend-icon":"mdi-calculator",onClick:he},{default:t(()=>x[22]||(x[22]=[v(" Setting HPP ")])),_:1,__:[22]}),e(Le),e(K,{variant:"outlined",onClick:ke},{default:t(()=>x[23]||(x[23]=[v(" Batal ")])),_:1,__:[23]}),e(K,{color:"primary",onClick:A,loading:p.value},{default:t(()=>x[24]||(x[24]=[v(" Simpan Komposisi ")])),_:1,__:[24]},8,["loading"])]),_:1})]),_:1}),e(at,{modelValue:m.value,"onUpdate:modelValue":x[6]||(x[6]=te=>m.value=te),color:"error",location:"top",timeout:5e3},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:x[5]||(x[5]=te=>m.value=!1)},{default:t(()=>x[25]||(x[25]=[v(" Tutup ")])),_:1,__:[25]})]),default:t(()=>[v(c(s.value)+" ",1)]),_:1},8,["modelValue"]),e(at,{modelValue:r.value,"onUpdate:modelValue":x[8]||(x[8]=te=>r.value=te),color:"success",location:"top",timeout:3e3},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:x[7]||(x[7]=te=>r.value=!1)},{default:t(()=>x[26]||(x[26]=[v(" Tutup ")])),_:1,__:[26]})]),default:t(()=>[v(c(W.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),e(la,{modelValue:oe.value,"onUpdate:modelValue":x[10]||(x[10]=te=>oe.value=te),"product-id":parseInt(String(((ue=B.product)==null?void 0:ue.id_product)||((De=B.product)==null?void 0:De.id)||"0")),"product-name":((xe=B.product)==null?void 0:xe.product_name)||((Pe=B.product)==null?void 0:Pe.name),onHppUpdated:x[11]||(x[11]=te=>d("refresh")),onPriceUpdated:x[12]||(x[12]=te=>d("refresh"))},null,8,["modelValue","product-id","product-name"])],64)}}}),Yt=je(Hl,[["__scopeId","data-v-003623cf"]]),Bl={class:"composition-cards"},Fl={key:1,class:"text-center pa-12"},Kl={key:2,class:"text-center pa-12"},Rl={class:"d-flex align-center gap-3"},ql={class:"flex-grow-1 min-width-0"},Ol={class:"text-h6 font-weight-bold text-truncate"},Nl={class:"text-caption text-medium-emphasis mb-0"},Ll={class:"d-flex align-center gap-2 mb-3"},jl={class:"text-body-2 font-weight-medium"},Wl={class:"composition-items"},Gl={class:"d-flex align-center gap-2 flex-grow-1 min-width-0"},Xl={class:"text-body-2 text-truncate"},Jl={class:"text-end flex-shrink-0"},Yl={class:"text-body-2 font-weight-medium"},Ql={key:0,class:"text-caption text-success"},Zl={key:1,class:"text-caption text-primary"},eo={class:"d-flex justify-between align-center mb-3"},to={class:"text-h6 font-weight-bold text-primary"},ao={class:"d-flex gap-2"},lo={class:"d-flex align-center"},oo={class:"d-flex align-center gap-4"},so={class:"flex-grow-1"},no={class:"text-h5 font-weight-bold mb-2"},io={class:"d-flex align-center gap-4 mb-2"},ro={class:"text-body-2"},uo={class:"text-h6 text-primary font-weight-bold"},co={class:"d-flex align-center mt-1 gap-4"},mo={class:"d-flex align-center"},vo={class:"d-flex align-center"},fo={key:0,class:"d-flex align-center"},po={class:"text-primary font-weight-medium"},go={key:1,class:"text-center py-8"},_o={class:"text-h6 font-weight-bold"},ko={class:"text-h6 font-weight-bold"},yo={class:"text-h6 font-weight-bold"},bo=Re({__name:"ProductCompositionCards",props:{productItems:{},loading:{type:Boolean}},emits:["refresh","edit-composition","view-details"],setup(l,{emit:F}){const h=l,d=F,U=H(!1),p=H(!1),V=H(null),m=H([]),r=H(null),s=H({search:"",stockStatus:"",itemType:"",criticalOnly:!1,sortBy:"name_asc"}),W=[{title:"Semua Status",value:""},{title:"Stok Aman",value:"safe"},{title:"Stok Kritis",value:"critical"},{title:"Stok Habis",value:"out"}],_=[{title:"Nama A-Z",value:"name_asc"},{title:"Nama Z-A",value:"name_desc"},{title:"Harga Tertinggi",value:"price_desc"},{title:"Harga Terendah",value:"price_asc"},{title:"Item Terbanyak",value:"items_desc"},{title:"Item Tersedikit",value:"items_asc"}],L=j=>{V.value=j,m.value=j.items||[],U.value=!0},oe=j=>{r.value=j,p.value=!0},D=j=>{console.log("Composition saved:",j),d("refresh")},C=()=>{s.value={search:"",stockStatus:"",itemType:"",criticalOnly:!1,sortBy:"name_asc"}},ie=ce(()=>!!(s.value.search||s.value.stockStatus||s.value.itemType||s.value.criticalOnly||s.value.sortBy!=="name_asc")),ge=ce(()=>{let j=0;return s.value.search&&j++,s.value.stockStatus&&j++,s.value.itemType&&j++,s.value.criticalOnly&&j++,s.value.sortBy!=="name_asc"&&j++,j}),q=ce(()=>{const j=new Map;h.productItems.forEach(w=>{if(!w.product)return;const O=w.product.id_product||w.product.id;j.has(O)||j.set(O,{...w.product,items:[],totalItems:0}),j.get(O).items.push(w),j.get(O).totalItems++});let y=Array.from(j.values());if(s.value.search){const w=s.value.search.toLowerCase();y=y.filter(O=>O.name.toLowerCase().includes(w)||O.sku&&O.sku.toLowerCase().includes(w)||O.items.some(re=>{var he;return(he=re.item)==null?void 0:he.name.toLowerCase().includes(w)}))}return s.value.stockStatus&&(y=y.filter(w=>{const O=Z(w);switch(s.value.stockStatus){case"safe":return O.color==="success";case"critical":return O.color==="warning";case"out":return O.color==="error";default:return!0}})),s.value.criticalOnly&&(y=y.filter(w=>w.items.some(O=>O.is_critical))),y.sort((w,O)=>{switch(s.value.sortBy){case"name_asc":return w.name.localeCompare(O.name);case"name_desc":return O.name.localeCompare(w.name);case"price_asc":return(w.price||0)-(O.price||0);case"price_desc":return(O.price||0)-(w.price||0);case"items_asc":return w.totalItems-O.totalItems;case"items_desc":return O.totalItems-w.totalItems;default:return w.name.localeCompare(O.name)}}),y}),Z=j=>{let y=!1,w=!1;return j.items.forEach(O=>{var re;if((re=O.item)!=null&&re.inventory){const he=O.item.inventory.current_stock||0,ve=O.quantity_needed||0;he<=0?y=!0:(he<ve||O.is_critical)&&(w=!0)}}),y?{text:"Stok Habis",color:"error"}:w?{text:"Stok Kritis",color:"warning"}:{text:"Stok Aman",color:"success"}},g=j=>{if(!(j!=null&&j.inventory))return"grey";const y=j.inventory.current_stock||0;return y<=0?"error":y<=10?"warning":"success"},k=j=>{if(!(j!=null&&j.inventory))return"Tidak ada data";const y=j.inventory.current_stock||0;return y<=0?"Habis":y<=10?"Rendah":"Aman"},S=j=>{const y=g(j);return{"text-error":y==="error","text-warning":y==="warning","text-success":y==="success","text-grey":y==="grey"}},G=j=>`Item Komposisi (${j})`;return(j,y)=>(b(),ne("div",Bl,[e(de,{class:"mb-6"},{default:t(()=>[e($e,{class:"d-flex align-center justify-between"},{default:t(()=>[y[12]||(y[12]=a("div",null,[a("h2",{class:"text-h5 font-weight-bold"},"Komposisi Produk"),a("p",{class:"text-body-2 text-medium-emphasis"}," Kelola komposisi bahan untuk setiap produk ")],-1)),e(K,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:y[0]||(y[0]=w=>d("refresh")),loading:j.loading},{default:t(()=>y[11]||(y[11]=[v(" Refresh ")])),_:1,__:[11]},8,["loading"])]),_:1,__:[12]})]),_:1}),e(de,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ie,{modelValue:s.value.search,"onUpdate:modelValue":y[1]||(y[1]=w=>s.value.search=w),label:"Cari Produk",placeholder:"Nama produk, SKU, atau item...",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Fe,{modelValue:s.value.stockStatus,"onUpdate:modelValue":y[2]||(y[2]=w=>s.value.stockStatus=w),items:W,label:"Status Stok",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-chart-line","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Fe,{modelValue:s.value.sortBy,"onUpdate:modelValue":y[3]||(y[3]=w=>s.value.sortBy=w),items:_,label:"Urutkan",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-sort","hide-details":""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3",class:"d-flex align-center"},{default:t(()=>[e(Ha,{modelValue:s.value.criticalOnly,"onUpdate:modelValue":y[4]||(y[4]=w=>s.value.criticalOnly=w),label:"Hanya Item Kritis",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(Ue,{class:"mt-3"},{default:t(()=>[e(E,{cols:"12",md:"6",class:"d-flex align-center gap-2"},{default:t(()=>[e(K,{variant:"outlined",color:"grey",size:"small","prepend-icon":"mdi-filter-off",onClick:C,disabled:!ie.value},{default:t(()=>y[13]||(y[13]=[v(" Reset Filter ")])),_:1,__:[13]},8,["disabled"]),ie.value?(b(),N(pe,{key:0,color:"primary",variant:"tonal",size:"small"},{default:t(()=>[v(c(ge.value)+" filter aktif ",1)]),_:1})):ae("",!0)]),_:1}),e(E,{cols:"12",md:"6",class:"d-flex align-center justify-end"},{default:t(()=>[e(pe,{color:q.value.length>0?"success":"default",variant:"tonal","prepend-icon":"mdi-package-variant"},{default:t(()=>[v(c(q.value.length)+" Produk dengan Komposisi ",1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),!j.loading&&q.value.length===0&&ie.value?(b(),N(Be,{key:0,type:"info",variant:"outlined",class:"mb-6",title:"Tidak ada hasil",text:"Tidak ada produk yang sesuai dengan filter yang dipilih. Coba ubah filter pencarian."})):ae("",!0),j.loading?(b(),ne("div",Fl,[e(qt,{color:"primary",indeterminate:"",size:"64"}),y[14]||(y[14]=a("div",{class:"mt-4 text-h6"},"Memuat komposisi...",-1))])):q.value.length===0?(b(),ne("div",Kl,[e(I,{icon:"mdi-chef-hat-off",size:"96",class:"text-disabled mb-6"}),y[16]||(y[16]=a("h3",{class:"text-h5 font-weight-bold mb-4"},"Belum Ada Komposisi Produk",-1)),y[17]||(y[17]=a("p",{class:"text-body-1 text-medium-emphasis mb-6"}," Buat komposisi untuk produk Anda agar dapat melihat detail bahan yang dibutuhkan ",-1)),e(K,{color:"primary",size:"large","prepend-icon":"mdi-plus"},{default:t(()=>y[15]||(y[15]=[v(" Buat Komposisi Pertama ")])),_:1,__:[15]})])):(b(),N(Ue,{key:3},{default:t(()=>[(b(!0),ne(ze,null,Xe(q.value,w=>(b(),N(E,{key:w.id_product,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(de,{class:Je(["composition-card h-100",{"border-error":Z(w).color==="error"}]),elevation:"2"},{default:t(()=>[e($e,{class:"pa-4 pb-2"},{default:t(()=>[a("div",Rl,[e(Te,{image:w.image_url,size:"48",class:"flex-shrink-0"},{default:t(()=>[w.image_url?ae("",!0):(b(),N(I,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"]),a("div",ql,[a("h3",Ol,c(w.name),1),a("p",Nl,c(w.sku||"SKU-"+w.id_product),1)])])]),_:2},1024),e(fe,{class:"py-2"},{default:t(()=>[e(pe,{color:Z(w).color,size:"small",variant:"tonal",class:"mb-3"},{default:t(()=>[v(c(Z(w).text),1)]),_:2},1032,["color"]),a("div",Ll,[e(I,{icon:"mdi-format-list-bulleted",size:"16"}),a("span",jl,c(G(w.totalItems)),1)]),a("div",Wl,[(b(!0),ne(ze,null,Xe(w.items,O=>{var re,he,ve,Q;return b(),ne("div",{key:O.id_product_item,class:"composition-item d-flex align-center justify-between mb-2"},[a("div",Gl,[e(I,{icon:(re=O.item)!=null&&re.inventory&&O.item.inventory.current_stock>=O.quantity_needed?"mdi-check-circle":"mdi-alert-circle",color:(he=O.item)!=null&&he.inventory&&O.item.inventory.current_stock>=O.quantity_needed?"success":"error",size:"16"},null,8,["icon","color"]),a("span",Xl,c(((ve=O.item)==null?void 0:ve.name)||"Item tidak ditemukan"),1),O.is_critical?(b(),N(pe,{key:0,color:"error",size:"x-small",variant:"tonal"},{default:t(()=>y[18]||(y[18]=[v(" Kritis ")])),_:1,__:[18]})):ae("",!0)]),a("div",Jl,[a("div",Yl,c(O.quantity_needed)+" "+c(O.unit),1),(Q=O.item)!=null&&Q.inventory?(b(),ne("div",Ql," Stok: "+c(O.item.inventory.current_stock)+" "+c(O.unit),1)):ae("",!0),O.formatted_total_cost?(b(),ne("div",Zl,c(O.formatted_total_cost),1)):ae("",!0)])])}),128))])]),_:2},1024),e(fe,{class:"pt-0"},{default:t(()=>[e(Me,{class:"mb-3"}),a("div",eo,[y[19]||(y[19]=a("span",{class:"text-body-2"},"Harga:",-1)),a("span",to,c(J(tt)(w.price||0)),1)]),a("div",ao,[e(K,{color:"primary",size:"small","prepend-icon":"mdi-eye",onClick:O=>oe(w)},{default:t(()=>y[20]||(y[20]=[v(" Detail ")])),_:2,__:[20]},1032,["onClick"]),e(K,{color:"secondary",variant:"outlined",size:"small","prepend-icon":"mdi-cog",onClick:O=>L(w)},{default:t(()=>y[21]||(y[21]=[v(" Kelola ")])),_:2,__:[21]},1032,["onClick"])])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})),e(Yt,{modelValue:U.value,"onUpdate:modelValue":y[5]||(y[5]=w=>U.value=w),product:V.value,items:m.value,onSave:D,onRefresh:y[6]||(y[6]=w=>d("refresh"))},null,8,["modelValue","product","items"]),e(Ne,{modelValue:p.value,"onUpdate:modelValue":y[10]||(y[10]=w=>p.value=w),"max-width":"900",scrollable:""},{default:t(()=>[e(de,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",lo,[e(I,{icon:"mdi-eye",class:"mr-2",color:"primary"}),y[22]||(y[22]=a("span",null,"Detail Komposisi Produk",-1))]),e(K,{icon:"",variant:"text",onClick:y[7]||(y[7]=w=>p.value=!1)},{default:t(()=>[e(I,{icon:"mdi-close"})]),_:1})]),_:1}),e(Me),r.value?(b(),N(fe,{key:0},{default:t(()=>[e(Ba,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(de,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(fe,null,{default:t(()=>[a("div",oo,[e(Te,{image:r.value.image_url,size:"80"},{default:t(()=>[r.value.image_url?ae("",!0):(b(),N(I,{key:0,icon:"mdi-coffee",size:"40"}))]),_:1},8,["image"]),a("div",so,[a("h2",no,c(r.value.name),1),a("div",io,[e(pe,{color:Z(r.value).color,variant:"tonal",size:"small"},{default:t(()=>[v(c(Z(r.value).text),1)]),_:1},8,["color"]),a("span",ro,"SKU: "+c(r.value.sku||"-"),1)]),a("div",uo,c(J(tt)(r.value.price||0)),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(de,{variant:"outlined"},{default:t(()=>[e($e,{class:"text-h6"},{default:t(()=>[e(I,{icon:"mdi-format-list-bulleted",class:"mr-2"}),v(" Komposisi Item ("+c(r.value.totalItems||0)+") ",1)]),_:1}),e(fe,null,{default:t(()=>[r.value.items&&r.value.items.length>0?(b(),N(kt,{key:0},{default:t(()=>[(b(!0),ne(ze,null,Xe(r.value.items,(w,O)=>(b(),N(Ye,{key:w.id_product_item,class:"px-0"},{prepend:t(()=>[e(Te,{size:"40",color:g(w.item),variant:"tonal"},{default:t(()=>{var re;return[e(I,{icon:(re=w.item)!=null&&re.inventory&&w.item.inventory.current_stock>=w.quantity_needed?"mdi-check":"mdi-alert"},null,8,["icon"])]}),_:2},1032,["color"])]),append:t(()=>[e(pe,{color:g(w.item),variant:"tonal",size:"small"},{default:t(()=>[v(c(k(w.item)),1)]),_:2},1032,["color"])]),default:t(()=>[e(nt,{class:"font-weight-medium"},{default:t(()=>{var re;return[v(c(((re=w.item)==null?void 0:re.name)||"Unknown Item")+" ",1),w.is_critical?(b(),N(pe,{key:0,color:"error",variant:"tonal",size:"x-small",class:"ml-2"},{default:t(()=>y[23]||(y[23]=[v(" Kritis ")])),_:1,__:[23]})):ae("",!0)]}),_:2},1024),e(it,null,{default:t(()=>{var re,he;return[a("div",co,[a("div",mo,[e(I,{icon:"mdi-scale",size:"14",class:"mr-1"}),a("span",null," Kebutuhan: "+c(Number(w.quantity_needed||0).toLocaleString("id-ID"))+" "+c(w.unit),1)]),a("div",vo,[e(I,{icon:"mdi-warehouse",size:"14",class:"mr-1"}),a("span",{class:Je(S(w.item))}," Stok: "+c(Number(((he=(re=w.item)==null?void 0:re.inventory)==null?void 0:he.current_stock)||0).toLocaleString("id-ID"))+" "+c(w.unit),3)]),w.formatted_total_cost?(b(),ne("div",fo,[e(I,{icon:"mdi-currency-usd",size:"14",class:"mr-1"}),a("span",po,c(w.formatted_total_cost),1)])):ae("",!0)])]}),_:2},1024),O<r.value.items.length-1?(b(),N(Me,{key:0,class:"mt-3"})):ae("",!0)]),_:2},1024))),128))]),_:1})):(b(),ne("div",go,[e(I,{icon:"mdi-package-variant-closed",size:"48",color:"grey-lighten-1",class:"mb-2"}),y[24]||(y[24]=a("p",{class:"text-body-1 text-grey"}," Belum ada komposisi item untuk produk ini ",-1))]))]),_:1})]),_:1})]),_:1})]),_:1}),e(Ue,{class:"mt-4"},{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"outlined",color:"primary"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[e(I,{icon:"mdi-format-list-bulleted",size:"32",class:"mb-2"}),a("div",_o,c(r.value.totalItems||0),1),y[25]||(y[25]=a("div",{class:"text-body-2"},"Total Item",-1))]),_:1,__:[25]})]),_:1})]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"outlined",color:"warning"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>{var w;return[e(I,{icon:"mdi-alert",size:"32",class:"mb-2"}),a("div",ko,c(((w=r.value.items)==null?void 0:w.filter(O=>O.is_critical).length)||0),1),y[26]||(y[26]=a("div",{class:"text-body-2"},"Item Kritis",-1))]}),_:1,__:[26]})]),_:1})]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"outlined",color:"success"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[e(I,{icon:"mdi-currency-usd",size:"32",class:"mb-2"}),a("div",yo,c(J(tt)(r.value.price||0)),1),y[27]||(y[27]=a("div",{class:"text-body-2"},"Harga Jual",-1))]),_:1,__:[27]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):ae("",!0),e(Me),e(Ke,{class:"pa-4"},{default:t(()=>[e(Le),e(K,{variant:"outlined",onClick:y[8]||(y[8]=w=>p.value=!1)},{default:t(()=>y[28]||(y[28]=[v(" Tutup ")])),_:1,__:[28]}),e(K,{color:"secondary",variant:"outlined","prepend-icon":"mdi-cog",onClick:y[9]||(y[9]=()=>{p.value=!1,L(r.value)})},{default:t(()=>y[29]||(y[29]=[v(" Kelola Komposisi ")])),_:1,__:[29]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),ho=je(bo,[["__scopeId","data-v-8f4d44b6"]]),xo={class:"d-flex align-center gap-2"},wo={class:"text-white"},Vo={class:"text-h6 mb-4 d-flex align-center gap-2"},Po={class:"text-h6 mb-4 d-flex align-center gap-2"},Co={class:"d-flex flex-column gap-2"},Io={key:0,class:"d-flex align-center gap-2"},So={class:"d-flex align-center gap-2 mb-2"},$o={class:"d-flex gap-2"},Do={class:"d-flex gap-2"},To={class:"d-flex align-center justify-space-between"},Uo={class:"d-flex align-center gap-2"},zo={class:"text-end"},Ao={class:"text-h6 font-weight-bold"},Mo={class:"text-caption"},Eo={class:"text-h6 mb-4 d-flex align-center gap-2"},Ho={class:"text-h6 mb-4 d-flex align-center gap-2"},Bo={class:"image-upload-container"},Fo={key:0,class:"mb-4"},Ko={class:"text-center mt-2"},Ro={class:"text-h6 mb-4 d-flex align-center gap-2"},qo={class:"text-h6 mb-4 d-flex align-center gap-2"},Oo={class:"d-flex align-center"},No={class:"text-subtitle-1"},Lo={class:"text-body-1"},jo={class:"d-flex align-center"},Wo={class:"text-subtitle-1"},Go=Re({__name:"ProductDialog",props:{modelValue:{type:Boolean},editMode:{type:Boolean},formData:{},categories:{},loading:{type:Boolean},errorMessage:{},successMessage:{},selectedImage:{},imagePreview:{},useDialogError:{type:Boolean}},emits:["update:modelValue","close","submit","image-change","remove-image","clear-error","clear-success","update-form"],setup(l,{emit:F}){var Q,f,u;const h=Ot(),{nameRules:d,categoryRules:U}=Nt(),{getProductHPPBreakdown:p}=oa(),V=H(!1),m=H(!1),r=async()=>{if(!(!_.editMode||!C.id))try{const n=await fetch(`/api/products/${C.id}/items`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(n.ok){const i=await n.json();m.value=i.success&&i.data&&i.data.length>0}}catch(n){console.error("Error checking HPP status:",n)}},s=async()=>{if(C.id)try{V.value=!0;const n=await p(C.id,"latest");n&&(C.cost=n.total_hpp,oe("update-form","cost",n.total_hpp))}catch(n){console.error("Error refreshing HPP:",n)}finally{V.value=!1}},W=()=>{console.log("Open items setup for product:",C.id)},_=l,L=ce(()=>_.errorMessage),oe=F,D=H(),C=ht({..._.formData});Se(()=>_.formData,n=>{Object.assign(C,n)},{deep:!0}),Se(C,n=>{Object.keys(n).forEach(i=>{oe("update-form",i,n[i])})},{deep:!0}),Se(()=>_.modelValue,n=>{n&&_.editMode&&r()});const ie=ht({length:((Q=_.formData.dimensions)==null?void 0:Q.length)||null,width:((f=_.formData.dimensions)==null?void 0:f.width)||null,height:((u=_.formData.dimensions)==null?void 0:u.height)||null});Se(ie,n=>{const i=n.length!==null||n.width!==null||n.height!==null;C.dimensions=i?{length:n.length!==null?n.length:void 0,width:n.width!==null?n.width:void 0,height:n.height!==null?n.height:void 0}:{}},{deep:!0});const ge=[{title:"Draft",value:"draft"},{title:"Published",value:"published"},{title:"Archived",value:"archived"}],q=ce(()=>{if(!C.price||!C.cost||C.cost<=0)return 0;const n=(C.price-C.cost)/C.cost*100;return Math.ceil(n)}),Z=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),g=n=>n<10?"error":n<25?"warning":n<50?"success":"info",k=n=>n<10?"tabler-trending-down":n<25?"tabler-trending-up":n<50?"tabler-trending-up-2":"tabler-trending-up-3",S=n=>!n||n===0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),G=n=>{if(!n||n.trim()===""||n==="Rp 0")return 0;const z=n.replace(/[^\d,.-]/g,"").replace(/\./g,"").replace(",",".");return parseFloat(z)||0},j=H(!1),y=n=>{const i=G(n);C.price=i},w=()=>{j.value=!0},O=()=>{j.value=!1},re=async()=>{var i;const{valid:n}=await((i=D.value)==null?void 0:i.validate());n&&oe("submit",C)},he=n=>{oe("image-change",n)},ve=()=>{oe("remove-image")};return(n,i)=>(b(),N(Ne,{"model-value":n.modelValue,"max-width":"900px",persistent:"",scrollable:"","onUpdate:modelValue":i[25]||(i[25]=z=>n.$emit("update:modelValue",z))},{default:t(()=>[e(de,{class:"product-dialog coffee-dialog"},{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between coffee-header"},{default:t(()=>[a("div",xo,[e(I,{icon:n.editMode?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),a("span",wo,c(n.editMode?"Edit Produk":"Tambah Produk Baru"),1)]),e(K,{icon:"tabler-x",variant:"text",color:"white",onClick:i[0]||(i[0]=z=>n.$emit("close"))})]),_:1}),e(Me),e(fe,{class:"pa-6"},{default:t(()=>[e(Ct,{ref_key:"formRef",ref:D,onSubmit:Vt(re,["prevent"])},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[a("h6",Vo,[e(I,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),i[26]||(i[26]=v(" Informasi Dasar "))])]),_:1}),e(E,{cols:"12",md:"8"},{default:t(()=>[e(Ie,{modelValue:C.name,"onUpdate:modelValue":i[1]||(i[1]=z=>C.name=z),label:"Nama Produk",placeholder:"Masukkan nama produk",rules:J(d),required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ie,{modelValue:C.sku,"onUpdate:modelValue":i[2]||(i[2]=z=>C.sku=z),label:"SKU",placeholder:"Auto generate jika kosong",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Ut,{modelValue:C.description,"onUpdate:modelValue":i[3]||(i[3]=z=>C.description=z),label:"Deskripsi Produk",placeholder:"Masukkan deskripsi produk",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Fe,{"model-value":C.category_id,"onUpdate:modelValue":i[4]||(i[4]=z=>C.category_id=z),items:n.categories,"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Pilih kategori",rules:J(U),required:"",variant:"outlined"},null,8,["model-value","items","rules"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Ie,{modelValue:C.brand,"onUpdate:modelValue":i[5]||(i[5]=z=>C.brand=z),label:"Brand/Merek",placeholder:"Masukkan brand produk",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Po,[e(I,{icon:"tabler-currency-dollar",size:"20",class:"coffee-icon"}),i[27]||(i[27]=v(" Harga & Biaya "))])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Ie,{"model-value":S(C.price),"onUpdate:modelValue":i[6]||(i[6]=z=>y(z)),label:"Harga Jual",placeholder:"Rp 0",required:"",variant:"outlined",onFocus:w,onBlur:O},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[a("div",Co,[e(Ie,{"model-value":S(C.cost),label:"Harga Pokok Penjualan (HPP)",placeholder:"Auto-calculated dari bahan baku",variant:"outlined",readonly:"","append-inner-icon":"mdi-calculator",hint:"HPP dihitung otomatis berdasarkan harga bahan baku","persistent-hint":""},null,8,["model-value"]),n.editMode?(b(),ne("div",Io,[e(pe,{color:m.value?"success":"warning",size:"small",variant:"tonal"},{default:t(()=>[e(I,{icon:m.value?"tabler-calculator":"tabler-alert-circle",size:"14",class:"me-1"},null,8,["icon"]),v(" "+c(m.value?"Auto HPP Active":"Setup Required"),1)]),_:1},8,["color"]),m.value?(b(),N(K,{key:0,size:"small",variant:"outlined",color:"primary",onClick:s,loading:V.value},{default:t(()=>[e(I,{icon:"tabler-refresh",size:"14",class:"me-1"}),i[28]||(i[28]=v(" Update HPP "))]),_:1,__:[28]},8,["loading"])):(b(),N(He,{key:1},{activator:t(({props:z})=>[e(pe,Ve(z,{color:"warning",size:"small",variant:"tonal"}),{default:t(()=>[e(I,{icon:"tabler-alert-circle",size:"14",class:"me-1"}),i[29]||(i[29]=v(" Belum Ada Resep "))]),_:2,__:[29]},1040)]),default:t(()=>[i[30]||(i[30]=a("span",null,"Setup resep produk untuk menghitung HPP otomatis",-1))]),_:1,__:[30]}))])):ae("",!0)])]),_:1}),n.editMode?(b(),N(E,{key:0,cols:"12"},{default:t(()=>[m.value?(b(),N(Be,{key:0,color:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[e(_t,null,{default:t(()=>[e(I,{icon:"tabler-info-circle",class:"me-2"}),i[31]||(i[31]=v(" HPP Otomatis Aktif "))]),_:1,__:[31]}),i[32]||(i[32]=a("div",{class:"mt-2"}," HPP produk ini dihitung otomatis berdasarkan item/bahan yang digunakan. Untuk mengubah HPP, silakan update harga item di menu Item Management. ",-1))]),_:1,__:[32]})):(b(),N(Be,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[e(_t,null,{default:t(()=>[e(I,{icon:"tabler-alert-triangle",class:"me-2"}),i[33]||(i[33]=v(" HPP Manual "))]),_:1,__:[33]}),i[34]||(i[34]=a("div",{class:"mt-2"}," Produk ini menggunakan HPP manual. Untuk perhitungan otomatis, tambahkan item/bahan yang digunakan untuk produk ini. ",-1))]),_:1,__:[34]}))]),_:1})):ae("",!0),e(E,{cols:"12"},{default:t(()=>[m.value&&n.editMode?(b(),N(Be,{key:0,color:"success",variant:"tonal",class:"mb-4"},{default:t(()=>[a("div",So,[e(I,{icon:"tabler-check-circle"}),i[35]||(i[35]=a("span",{class:"font-weight-medium"},"HPP Otomatis Aktif",-1))]),i[38]||(i[38]=a("div",{class:"text-body-2 mb-3"}," Produk ini sudah memiliki resep dan HPP dihitung otomatis berdasarkan harga bahan baku terkini. HPP akan update secara otomatis saat harga bahan baku berubah. ",-1)),a("div",$o,[e(K,{size:"small",color:"primary",variant:"outlined",onClick:W},{default:t(()=>[e(I,{icon:"tabler-edit",size:"14",class:"me-1"}),i[36]||(i[36]=v(" Edit Resep "))]),_:1,__:[36]}),e(K,{size:"small",variant:"outlined",color:"info",onClick:s,loading:V.value},{default:t(()=>[e(I,{icon:"tabler-refresh",size:"14",class:"me-1"}),i[37]||(i[37]=v(" Refresh HPP "))]),_:1,__:[37]},8,["loading"])])]),_:1,__:[38]})):!m.value&&n.editMode?(b(),N(Be,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[a("div",Do,[e(K,{size:"small",variant:"outlined",color:"info",onClick:i[7]||(i[7]=z=>J(h).push("/hpp-management"))},{default:t(()=>[e(I,{icon:"tabler-calculator",size:"14",class:"me-1"}),i[39]||(i[39]=v(" Lihat HPP Management "))]),_:1,__:[39]})])]),_:1})):ae("",!0)]),_:1}),e(E,{cols:"12"},{default:t(()=>[C.price&&C.cost&&C.cost>0?(b(),N(Be,{key:0,color:g(q.value),variant:"tonal",class:"mb-0"},{default:t(()=>[a("div",To,[a("div",Uo,[e(I,{icon:k(q.value)},null,8,["icon"]),i[40]||(i[40]=a("span",{class:"font-weight-medium"},"Profit Margin",-1))]),a("div",zo,[a("div",Ao,c(Math.round(q.value))+"%",1),a("div",Mo," Keuntungan: "+c(Z(C.price-C.cost)),1)])])]),_:1},8,["color"])):ae("",!0)]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Eo,[e(I,{icon:"tabler-ruler",size:"20",class:"coffee-icon"}),i[41]||(i[41]=v(" Dimensi (cm) "))])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ie,{modelValue:ie.length,"onUpdate:modelValue":i[8]||(i[8]=z=>ie.length=z),modelModifiers:{number:!0},label:"Panjang",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ie,{modelValue:ie.width,"onUpdate:modelValue":i[9]||(i[9]=z=>ie.width=z),modelModifiers:{number:!0},label:"Lebar",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ie,{modelValue:ie.height,"onUpdate:modelValue":i[10]||(i[10]=z=>ie.height=z),modelModifiers:{number:!0},label:"Tinggi",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Ho,[e(I,{icon:"tabler-photo",size:"20",class:"coffee-icon"}),i[42]||(i[42]=v(" Gambar Produk "))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("div",Bo,[n.imagePreview?(b(),ne("div",Fo,[e(Oa,{src:n.imagePreview,"max-width":"200","max-height":"200",class:"mx-auto rounded"},null,8,["src"]),a("div",Ko,[e(K,{size:"small",color:"error",variant:"outlined",onClick:ve},{default:t(()=>i[43]||(i[43]=[v(" Hapus Gambar ")])),_:1,__:[43]})])])):ae("",!0),e(Na,{"model-value":n.selectedImage,"onUpdate:modelValue":i[11]||(i[11]=z=>he(Array.isArray(z)?z:[z])),label:"Upload Gambar","prepend-icon":"tabler-camera",accept:"image/*",variant:"outlined"},null,8,["model-value"]),i[44]||(i[44]=a("div",{class:"text-caption text-medium-emphasis mt-1"}," Format: JPG, JPEG, PNG, GIF. Maksimal 2MB. ",-1))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Ro,[e(I,{icon:"tabler-settings",size:"20",class:"coffee-icon"}),i[45]||(i[45]=v(" Pengaturan "))])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Fe,{"model-value":C.status,"onUpdate:modelValue":i[12]||(i[12]=z=>C.status=z),items:ge,label:"Status Publikasi",variant:"outlined"},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(rt,{"model-value":C.active,"onUpdate:modelValue":i[13]||(i[13]=z=>C.active=z??!1),label:"Produk Aktif",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(rt,{"model-value":C.featured,"onUpdate:modelValue":i[14]||(i[14]=z=>C.featured=z??!1),label:"Produk Unggulan",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",qo,[e(I,{icon:"tabler-seo",size:"20",class:"coffee-icon"}),i[46]||(i[46]=v(" SEO (Opsional) "))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Ie,{modelValue:C.meta_title,"onUpdate:modelValue":i[15]||(i[15]=z=>C.meta_title=z),label:"Meta Title",placeholder:"Judul untuk SEO",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Ut,{modelValue:C.meta_description,"onUpdate:modelValue":i[16]||(i[16]=z=>C.meta_description=z),label:"Meta Description",placeholder:"Deskripsi untuk SEO",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(vl,{"model-value":C.tags,"onUpdate:modelValue":i[17]||(i[17]=z=>C.tags=z),label:"Tags",placeholder:"Tambah tag dan tekan Enter",multiple:"",chips:"",variant:"outlined"},null,8,["model-value"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(Me),e(Ke,{class:"pa-6"},{default:t(()=>[e(Le),e(K,{variant:"outlined",class:"coffee-secondary",onClick:i[18]||(i[18]=z=>n.$emit("close"))},{default:t(()=>i[47]||(i[47]=[v(" Batal ")])),_:1,__:[47]}),e(K,{color:"primary",class:"coffee-primary",loading:n.loading,onClick:re},{default:t(()=>[v(c(n.editMode?"Perbarui":"Simpan")+" Produk ",1)]),_:1},8,["loading"])]),_:1})]),_:1}),n.useDialogError?ae("",!0):(b(),N(at,{key:0,"model-value":!!L.value,"onUpdate:modelValue":i[20]||(i[20]=z=>!z&&n.$emit("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500"},{actions:t(()=>[e(K,{icon:"tabler-x",size:"small",variant:"text",onClick:i[19]||(i[19]=z=>n.$emit("clear-error"))})]),default:t(()=>[a("div",Oo,[e(I,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),a("div",null,[i[48]||(i[48]=a("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),a("div",No,c(L.value),1)])])]),_:1},8,["model-value"])),n.useDialogError?(b(),N(Ne,{key:1,"model-value":!!L.value,"onUpdate:modelValue":i[22]||(i[22]=z=>!z&&n.$emit("clear-error")),"max-width":"400",persistent:"",class:"error-dialog"},{default:t(()=>[e(de,null,{default:t(()=>[e($e,{class:"d-flex align-center text-error"},{default:t(()=>[e(I,{icon:"tabler-alert-circle",class:"me-2"}),i[49]||(i[49]=v(" Error Occurred "))]),_:1,__:[49]}),e(Me),e(fe,{class:"py-4"},{default:t(()=>[a("div",Lo,c(L.value),1)]),_:1}),e(Me),e(Ke,{class:"justify-end pa-4"},{default:t(()=>[e(K,{color:"error",variant:"outlined",onClick:i[21]||(i[21]=z=>n.$emit("clear-error"))},{default:t(()=>i[50]||(i[50]=[v(" Close ")])),_:1,__:[50]})]),_:1})]),_:1})]),_:1},8,["model-value"])):ae("",!0),e(at,{"model-value":!!n.successMessage,"onUpdate:modelValue":i[24]||(i[24]=z=>!z&&n.$emit("clear-success")),color:"success",location:"top right",timeout:4e3,vertical:"","min-width":"320","max-width":"500"},{actions:t(()=>[e(K,{icon:"tabler-x",size:"small",variant:"text",onClick:i[23]||(i[23]=z=>n.$emit("clear-success"))})]),default:t(()=>[a("div",jo,[e(I,{icon:"tabler-check-circle",class:"me-3",size:"28"}),a("div",null,[i[51]||(i[51]=a("div",{class:"text-h6 font-weight-bold"},"Berhasil!",-1)),a("div",Wo,c(n.successMessage),1)])])]),_:1},8,["model-value"])]),_:1},8,["model-value"]))}}),Xo=je(Go,[["__scopeId","data-v-66fc4b3b"]]),Jo={key:0,class:"mt-4"},Yo={class:"d-flex align-center gap-2 mb-2"},Qo={class:"d-flex flex-wrap gap-2"},Zo=Re({__name:"ProductSearchFilters",props:{filters:{}},emits:["update:filters","search"],setup(l,{emit:F}){const h=l,d=F,{categories:U,loading:p,fetchCategories:V}=La(),m=H(!1),r=H("");ut(()=>{V(),r.value=s.search||""});const s=ht({...h.filters});Se(()=>h.filters,Z=>{Object.assign(s,Z),r.value=Z.search||""},{deep:!0}),Ca(r,Z=>{console.log("🔍 Search query changed:",Z),s.search=Z,Z.length>=3||Z.length===0?(console.log("✅ Triggering search with query:",Z),m.value=!0,d("search",Z),D(),setTimeout(()=>{m.value=!1},500)):console.log("⏳ Query too short, waiting for more characters:",Z.length)},{debounce:500,maxWait:1e3});const W=[{title:"Aktif",value:"active"},{title:"Tidak Aktif",value:"inactive"}],_=[{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],L=[{title:"Terbaru",value:"desc"},{title:"Terlama",value:"asc"}],oe=ce(()=>!!(r.value||s.category_id||s.active||s.stock_status||s.featured!==null||s.min_price||s.max_price)),D=()=>{d("update:filters",{...s})},C=()=>{r.value="",Object.assign(s,{search:"",category_id:null,active:null,stock_status:null,featured:null,min_price:null,max_price:null,sort_by:"created_at",sort_order:"desc"}),D()},ie=Z=>{const g=U.value.find(k=>k.id_category===Z);return(g==null?void 0:g.name)||"Unknown"},ge=Z=>{if(!Z)return"Semua";const g=W.find(k=>k.value===Z);return(g==null?void 0:g.title)||String(Z)},q=Z=>{const g=_.find(k=>k.value===Z);return(g==null?void 0:g.title)||Z};return(Z,g)=>(b(),N(de,{class:"mb-6"},{default:t(()=>[e($e,{class:"d-flex align-center gap-2"},{default:t(()=>[e(I,{icon:"tabler-filter",class:"coffee-icon"}),g[11]||(g[11]=v(" Filter & Pencarian Produk "))]),_:1,__:[11]}),e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ie,{modelValue:r.value,"onUpdate:modelValue":g[0]||(g[0]=k=>r.value=k),label:"Cari produk...",placeholder:"Nama, SKU, atau deskripsi (min. 3 karakter)","prepend-inner-icon":"tabler-search",loading:m.value,clearable:"",variant:"outlined",hint:r.value.length>0&&r.value.length<3?`Ketik ${3-r.value.length} karakter lagi untuk mencari`:"","persistent-hint":""},null,8,["modelValue","loading","hint"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Fe,{modelValue:s.category_id,"onUpdate:modelValue":[g[1]||(g[1]=k=>s.category_id=k),D],items:J(U),"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Semua kategori","prepend-inner-icon":"tabler-category",loading:J(p),clearable:"",variant:"outlined"},null,8,["modelValue","items","loading"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Fe,{modelValue:s.active,"onUpdate:modelValue":[g[2]||(g[2]=k=>s.active=k),D],items:W,label:"Status",placeholder:"Semua status","prepend-inner-icon":"tabler-toggle-left",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Fe,{modelValue:s.stock_status,"onUpdate:modelValue":[g[3]||(g[3]=k=>s.stock_status=k),D],items:_,label:"Stok",placeholder:"Semua stok","prepend-inner-icon":"tabler-package",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"1",class:"d-flex align-center"},{default:t(()=>[e(K,{icon:"tabler-refresh",variant:"outlined",color:"coffee",onClick:C})]),_:1})]),_:1}),e(Ue,{class:"mt-3"},{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ie,{modelValue:s.min_price,"onUpdate:modelValue":g[4]||(g[4]=k=>s.min_price=k),label:"Harga Minimum",placeholder:"0","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:D},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ie,{modelValue:s.max_price,"onUpdate:modelValue":g[5]||(g[5]=k=>s.max_price=k),label:"Harga Maksimum",placeholder:"Tidak terbatas","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:D},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Fe,{modelValue:s.sort_order,"onUpdate:modelValue":[g[6]||(g[6]=k=>s.sort_order=k),D],items:L,label:"Urutan",placeholder:"Terbaru","prepend-inner-icon":"tabler-arrow-up",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),oe.value?(b(),ne("div",Jo,[a("div",Yo,[e(I,{icon:"tabler-filter-check",size:"small",class:"coffee-icon"}),g[12]||(g[12]=a("span",{class:"text-sm font-weight-medium"},"Filter Aktif:",-1))]),a("div",Qo,[r.value?(b(),N(pe,{key:0,closable:"",size:"small",color:"coffee","onClick:close":g[7]||(g[7]=k=>{r.value="",s.search="",D()})},{default:t(()=>[v(" Pencarian: "+c(r.value),1)]),_:1})):ae("",!0),s.category_id?(b(),N(pe,{key:1,closable:"",size:"small",color:"coffee","onClick:close":g[8]||(g[8]=k=>{s.category_id=null,D()})},{default:t(()=>[v(" Kategori: "+c(ie(s.category_id)),1)]),_:1})):ae("",!0),s.active?(b(),N(pe,{key:2,closable:"",size:"small",color:"coffee","onClick:close":g[9]||(g[9]=k=>{s.active=null,D()})},{default:t(()=>[v(" Status: "+c(ge(s.active)),1)]),_:1})):ae("",!0),s.stock_status?(b(),N(pe,{key:3,closable:"",size:"small",color:"coffee","onClick:close":g[10]||(g[10]=k=>{s.stock_status=null,D()})},{default:t(()=>[v(" Stok: "+c(q(s.stock_status)),1)]),_:1})):ae("",!0)])])):ae("",!0)]),_:1})]),_:1}))}}),es=je(Zo,[["__scopeId","data-v-1afc3ae3"]]),ts={class:"d-flex align-center gap-2"},as={class:"text-h6"},ls={class:"d-flex align-center gap-2"},os={class:"text-h6"},ss={class:"d-flex align-center gap-2"},ns={class:"text-h6"},is={class:"d-flex align-center gap-2"},rs={class:"text-h6"},us={class:"d-flex align-center gap-2"},ds={class:"text-h6"},cs={class:"d-flex align-center gap-2"},ms={class:"text-h6"},vs={class:"d-flex align-center gap-2"},fs={class:"text-h6"},ps={class:"d-flex align-center gap-2"},gs={class:"text-h6"},_s=Re({__name:"ProductStatsCards",props:{stats:{}},setup(l){const F=d=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(d),h=d=>`${d.toFixed(1)}%`;return(d,U)=>(b(),N(Ue,{class:"mb-6"},{default:t(()=>[e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[e(I,{icon:"tabler-package"})]),_:1}),a("div",null,[U[0]||(U[0]=a("span",{class:"text-sm text-medium-emphasis"},"Total Produk",-1)),a("div",ts,[a("h6",as,c(((p=d.stats)==null?void 0:p.total_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"success",variant:"tonal",class:"me-3"},{default:t(()=>[e(I,{icon:"tabler-check"})]),_:1}),a("div",null,[U[1]||(U[1]=a("span",{class:"text-sm text-medium-emphasis"},"Produk Aktif",-1)),a("div",ls,[a("h6",os,c(((p=d.stats)==null?void 0:p.active_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"warning",variant:"tonal",class:"me-3"},{default:t(()=>[e(I,{icon:"tabler-star"})]),_:1}),a("div",null,[U[2]||(U[2]=a("span",{class:"text-sm text-medium-emphasis"},"Produk Unggulan",-1)),a("div",ss,[a("h6",ns,c(((p=d.stats)==null?void 0:p.featured_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"error",variant:"tonal",class:"me-3"},{default:t(()=>[e(I,{icon:"tabler-alert-triangle"})]),_:1}),a("div",null,[U[3]||(U[3]=a("span",{class:"text-sm text-medium-emphasis"},"Stok Rendah",-1)),a("div",is,[a("h6",rs,c(((p=d.stats)==null?void 0:p.low_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"info",variant:"tonal",class:"me-3"},{default:t(()=>[e(I,{icon:"tabler-currency-dollar"})]),_:1}),a("div",null,[U[4]||(U[4]=a("span",{class:"text-sm text-medium-emphasis"},"Nilai Stok",-1)),a("div",us,[a("h6",ds,c(F(((p=d.stats)==null?void 0:p.total_stock_value)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"secondary",variant:"tonal",class:"me-3"},{default:t(()=>[e(I,{icon:"tabler-chart-line"})]),_:1}),a("div",null,[U[5]||(U[5]=a("span",{class:"text-sm text-medium-emphasis"},"Harga Rata-rata",-1)),a("div",cs,[a("h6",ms,c(F(((p=d.stats)==null?void 0:p.average_price)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"coffee",variant:"tonal",class:"me-3"},{default:t(()=>[e(I,{icon:"tabler-trending-up"})]),_:1}),a("div",null,[U[6]||(U[6]=a("span",{class:"text-sm text-medium-emphasis"},"Margin Rata-rata",-1)),a("div",vs,[a("h6",fs,c(h(((p=d.stats)==null?void 0:p.average_margin)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"surface",variant:"tonal",class:"me-3"},{default:t(()=>[e(I,{icon:"tabler-x-circle"})]),_:1}),a("div",null,[U[7]||(U[7]=a("span",{class:"text-sm text-medium-emphasis"},"Stok Habis",-1)),a("div",ps,[a("h6",gs,c(((p=d.stats)==null?void 0:p.out_of_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1})]),_:1}))}}),ks=je(_s,[["__scopeId","data-v-124783ae"]]),ys={class:"d-flex align-center gap-2"},bs={class:"d-flex align-center gap-2"},hs={class:"text-center py-8"},xs={class:"d-flex align-center gap-3 py-2"},ws={class:"font-weight-medium"},Vs={class:"text-caption text-medium-emphasis"},Ps={class:"text-end"},Cs={class:"font-weight-medium"},Is={key:0,class:"text-caption text-medium-emphasis"},Ss={class:"text-center profit-margin-container"},$s={class:"text-center"},Ds={key:0,class:"text-caption text-medium-emphasis mt-1"},Ts={class:"d-flex align-center gap-2"},Us={class:"text-body-2"},zs={class:"text-caption text-medium-emphasis"},As={class:"d-flex align-center gap-1"},Ms=Re({__name:"ProductTable",props:{products:{},totalItems:{},loading:{type:Boolean},currentPage:{},itemsPerPage:{},selectedProducts:{},toggleLoading:{}},emits:["add-product","view-product","edit-product","manage-recipes","open-recipe-dialog","open-composition-dialog","open-variant-dialog","delete-product","toggle-active","toggle-featured","bulk-delete","update:page","update:items-per-page","update:sort-by","update:selected-products"],setup(l){const F=[{title:"Produk",key:"name",sortable:!0,width:"250px"},{title:"Kategori",key:"category",sortable:!1,width:"120px"},{title:"Harga",key:"price",sortable:!0,align:"end",width:"130px"},{title:"Margin",key:"profit_margin",sortable:!0,align:"center",width:"100px"},{title:"Stok",key:"stock",sortable:!0,align:"center",width:"100px"},{title:"Status",key:"active",sortable:!0,width:"140px"},{title:"Dibuat",key:"created_at",sortable:!0,width:"120px"},{title:"Aksi",key:"actions",sortable:!1,align:"center",width:"200px"}],h=m=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(m),d=m=>new Date(m).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),U=m=>new Date(m).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),p=(m,r)=>m<=0?"error":r&&m<=r?"warning":"success",V=m=>m<10?"error":m<25?"warning":m<50?"success":"info";return(m,r)=>(b(),N(de,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",ys,[e(I,{icon:"tabler-list",class:"coffee-icon"}),r[7]||(r[7]=v(" Data Produk ")),m.totalItems?(b(),N(pe,{key:0,size:"small",color:"coffee",variant:"tonal"},{default:t(()=>[v(c(m.totalItems)+" item ",1)]),_:1})):ae("",!0)]),a("div",bs,[m.selectedProducts.length>0?(b(),N(K,{key:0,"prepend-icon":"tabler-trash",color:"error",variant:"outlined",onClick:r[0]||(r[0]=s=>m.$emit("bulk-delete"))},{default:t(()=>[v(" Hapus Terpilih ("+c(m.selectedProducts.length)+") ",1)]),_:1})):ae("",!0),e(K,{"prepend-icon":"tabler-plus",color:"coffee",onClick:r[1]||(r[1]=s=>m.$emit("add-product"))},{default:t(()=>r[8]||(r[8]=[v(" Tambah Produk ")])),_:1,__:[8]})])]),_:1}),e(Me),e(Za,{"model-value":m.selectedProducts,"onUpdate:modelValue":r[3]||(r[3]=s=>m.$emit("update:selected-products",s)),headers:F,items:m.products,"items-length":m.totalItems,loading:m.loading,"items-per-page":m.itemsPerPage,page:m.currentPage,"show-select":"","item-value":"id",class:"products-table","onUpdate:page":r[4]||(r[4]=s=>m.$emit("update:page",s)),"onUpdate:itemsPerPage":r[5]||(r[5]=s=>m.$emit("update:items-per-page",s)),"onUpdate:sortBy":r[6]||(r[6]=s=>m.$emit("update:sort-by",s))},{loading:t(()=>[e(el,{type:"table-row@10"})]),"no-data":t(()=>[a("div",hs,[e(I,{icon:"tabler-package-off",size:"64",class:"mb-4 text-disabled"}),r[10]||(r[10]=a("h6",{class:"text-h6 mb-2"}," Tidak ada produk ",-1)),r[11]||(r[11]=a("p",{class:"text-body-2 text-medium-emphasis mb-4"}," Belum ada produk yang ditambahkan atau sesuai dengan filter yang dipilih. ",-1)),e(K,{"prepend-icon":"tabler-plus",color:"coffee",onClick:r[2]||(r[2]=s=>m.$emit("add-product"))},{default:t(()=>r[9]||(r[9]=[v(" Tambah Produk Pertama ")])),_:1,__:[9]})])]),"item.name":t(({item:s})=>[a("div",xs,[e(Te,{image:s.image_url,size:"40",rounded:"",class:"product-avatar"},{default:t(()=>[s.image_url?ae("",!0):(b(),N(I,{key:0,icon:"tabler-package"}))]),_:2},1032,["image"]),a("div",null,[a("div",ws,c(s.name),1),a("div",Vs," SKU: "+c(s.sku||"-"),1)])])]),"item.category":t(({item:s})=>[e(pe,{color:"coffee",size:"small",variant:"tonal"},{default:t(()=>{var W;return[v(c(((W=s.category)==null?void 0:W.name)||"-"),1)]}),_:2},1024)]),"item.price":t(({item:s})=>[a("div",Ps,[a("div",Cs,c(h(s.price)),1),s.cost?(b(),ne("div",Is," HPP: "+c(h(s.cost)),1)):ae("",!0)])]),"item.profit_margin":t(({item:s})=>[a("div",Ss,[s.cost&&s.cost>0&&s.profit_margin!==void 0?(b(),N(pe,{key:0,color:V(s.profit_margin),size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>[v(c(Math.round(s.profit_margin))+"% ",1)]),_:2},1032,["color"])):(b(),N(pe,{key:1,color:"grey",size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>r[12]||(r[12]=[v(" - ")])),_:1,__:[12]}))])]),"item.stock":t(({item:s})=>[a("div",$s,[e(pe,{color:p(s.stock,s.min_stock),size:"small",variant:"tonal"},{default:t(()=>[v(c(s.stock)+" "+c(s.unit||"pcs"),1)]),_:2},1032,["color"]),s.min_stock?(b(),ne("div",Ds," Min: "+c(s.min_stock),1)):ae("",!0)])]),"item.active":t(({item:s})=>[a("div",Ts,[e(pe,{color:s.active?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[v(c(s.active?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["color"]),s.featured?(b(),N(He,{key:0,text:"Produk Unggulan"},{activator:t(({props:W})=>[e(I,Ve(W,{icon:"tabler-star-filled",color:"warning",size:"small"}),null,16)]),_:1})):ae("",!0)])]),"item.created_at":t(({item:s})=>[a("div",Us,c(d(s.created_at??"")),1),a("div",zs,c(U((s==null?void 0:s.created_at)??"")),1)]),"item.actions":t(({item:s})=>[a("div",As,[e(He,{text:"Kelola Komposisi"},{activator:t(({props:W})=>[e(K,Ve(W,{icon:"tabler-chef-hat",size:"small",variant:"text",color:"primary",onClick:_=>m.$emit("open-composition-dialog",s)}),null,16,["onClick"])]),_:2},1024),e(He,{text:"Kelola Variant"},{activator:t(({props:W})=>[e(K,Ve(W,{icon:"tabler-versions",size:"small",variant:"text",color:"secondary",onClick:_=>m.$emit("open-variant-dialog",s)}),null,16,["onClick"])]),_:2},1024),e(He,{text:"Edit Produk"},{activator:t(({props:W})=>[e(K,Ve(W,{icon:"tabler-edit",size:"small",variant:"text",color:"coffee",onClick:_=>m.$emit("edit-product",s)}),null,16,["onClick"])]),_:2},1024),e(He,{text:s.active?"Nonaktifkan":"Aktifkan"},{activator:t(({props:W})=>{var _;return[e(K,Ve(W,{icon:s.active?"tabler-toggle-right":"tabler-toggle-left",size:"small",variant:"text",color:s.active?"success":"error",loading:((_=m.toggleLoading)==null?void 0:_[s.id_product])||!1,onClick:L=>m.$emit("toggle-active",s)}),null,16,["icon","color","loading","onClick"])]}),_:2},1032,["text"]),e(He,{text:s.featured?"Hapus dari Unggulan":"Jadikan Unggulan"},{activator:t(({props:W})=>[e(K,Ve(W,{icon:s.featured?"tabler-star-filled":"tabler-star",size:"small",variant:"text",color:s.featured?"warning":"default",onClick:_=>m.$emit("toggle-featured",s)}),null,16,["icon","color","onClick"])]),_:2},1032,["text"]),e(He,{text:"Hapus Produk"},{activator:t(({props:W})=>[e(K,Ve(W,{icon:"tabler-trash",size:"small",variant:"text",color:"error",onClick:_=>m.$emit("delete-product",s)}),null,16,["onClick"])]),_:2},1024)])]),_:1},8,["model-value","items","items-length","loading","items-per-page","page"])]),_:1}))}}),Es=je(Ms,[["__scopeId","data-v-bbf8f372"]]),Hs={class:"d-flex align-center gap-3"},Bs={class:"text-h5 font-weight-bold"},Fs={class:"text-h6"},Ks={class:"text-body-1"},Rs={class:"d-flex flex-column"},qs={class:"font-weight-medium"},Os={class:"text-caption text-grey-darken-1"},Ns={class:"font-weight-medium"},Ls={key:0,class:"text-caption"},js={key:1,class:"text-grey-lighten-1 text-caption"},Ws={class:"v-data-table__footer"},Gs={class:"pa-4 d-flex justify-space-between align-center"},Xs={class:"text-subtitle-1 font-weight-bold"},Js={class:"text-subtitle-2 text-uppercase"},Ys={class:"text-h6 font-weight-bold my-2"},Qs={class:"text-caption"},Qt=Re({__name:"HPPVariantBreakdownDialog",props:{modelValue:{type:Boolean},variantId:{},variantName:{default:""}},emits:["update:modelValue","hpp-updated","price-updated"],setup(l,{emit:F}){const h=l,d=F,U=H(!1),p=H(null),V=H(null),m=H(!1),r=H(!1),s=H("latest"),W=H(0),_=H(0),L=H(""),oe=H(0),D=H(!1),C=H(!1),ie=H(""),ge=H(""),q=[{title:"Current Cost",value:"current"},{title:"Latest Purchase",value:"latest"},{title:"Average Purchase",value:"average"}],Z=[{title:"Item",value:"item_name",sortable:!0},{title:"Quantity",value:"quantity_needed",align:"end"},{title:"Cost/Unit",value:"cost_per_unit",align:"end"},{title:"Total Cost",value:"total_cost",align:"end"},{title:"Priority",value:"is_critical",align:"center"},{title:"Notes",value:"notes"}],g=Q=>!Q||Q===0?"":new Intl.NumberFormat("id-ID").format(Q),k=Q=>{if(!Q)return 0;const f=Q.replace(/[^\d]/g,"");return parseInt(f)||0},S=Q=>{var u;const f=k(Q);if(_.value=f,L.value=g(f),(u=p.value)!=null&&u.total_hpp&&f>0){const n=p.value.total_hpp;W.value=n>0?Math.round((f-n)/n*100):0}else W.value=0},G=Q=>tt(Q),j=async(Q,f)=>{U.value=!0;try{await new Promise(u=>setTimeout(u,500)),p.value={total_hpp:15e4,method:f,calculated_at:new Date().toISOString(),items:[{item_name:"Tepung Terigu",item_code:"TPNG001",quantity_needed:.5,unit:"kg",cost_per_unit:15e3,total_cost:7500,is_critical:!1,notes:null},{item_name:"Gula Pasir",item_code:"GUL001",quantity_needed:.25,unit:"kg",cost_per_unit:12e3,total_cost:3e3,is_critical:!1,notes:null},{item_name:"Telur Ayam",item_code:"TLR001",quantity_needed:3,unit:"pcs",cost_per_unit:3e3,total_cost:9e3,is_critical:!0,notes:"Price volatile"}]},m.value=!0}catch(u){console.error("Error loading HPP breakdown:",u),m.value=!1}finally{U.value=!1}},y=async(Q,f)=>{U.value=!0;try{if(await new Promise(u=>setTimeout(u,1e3)),p.value){switch(f){case"latest":p.value.total_hpp=Math.round(p.value.total_hpp*1.1);break;case"average":p.value.total_hpp=Math.round(p.value.total_hpp*1.05);break;default:p.value.total_hpp=Math.round(p.value.total_hpp*1.03)}p.value.calculated_at=new Date().toISOString()}}catch(u){throw u}finally{U.value=!1}},w=async(Q,f,u,n,i)=>{U.value=!0;try{return await new Promise(z=>setTimeout(z,1e3)),{data:{new_price:u,markup_percentage:p.value?Math.round((u-p.value.total_hpp)/p.value.total_hpp*100):0}}}catch(z){throw z}finally{U.value=!1}},O=async()=>{var Q,f,u;if(h.variantId)try{const n=localStorage.getItem("token"),i=await Oe.get(`/api/variants/${h.variantId}`,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json"}});if(i.data.success&&i.data.data){const z=i.data.data;if(z.price&&z.price>0)_.value=Number(z.price),L.value=g(Number(z.price));else if((Q=p.value)!=null&&Q.total_hpp){const A=Math.round(p.value.total_hpp*1.2);_.value=A,L.value=g(A)}if((f=p.value)!=null&&f.total_hpp&&_.value>0){const A=p.value.total_hpp;W.value=A>0?Math.round((_.value-A)/A*100):0}oe.value+=1}}catch(n){console.warn("Could not load target price, using default:",n),(u=p.value)!=null&&u.total_hpp&&(_.value=Math.round(p.value.total_hpp*1.2))}},re=async()=>{h.variantId&&(await j(h.variantId,s.value),await O())},he=async()=>{var Q,f;if(h.variantId)try{await y(h.variantId,s.value),ie.value=`HPP successfully updated using ${s.value} method!`,D.value=!0,d("hpp-updated"),await re()}catch(u){console.error("Error updating HPP:",u),ge.value=((f=(Q=u==null?void 0:u.response)==null?void 0:Q.data)==null?void 0:f.message)||"Failed to update HPP",C.value=!0}},ve=async()=>{var Q,f,u,n,i,z;if(h.variantId&&((Q=p.value)!=null&&Q.total_hpp)&&_.value)try{const A=await w(h.variantId,s.value,_.value,!0,!0);if((f=A==null?void 0:A.data)!=null&&f.new_price){if(_.value=A.data.new_price,L.value=g(A.data.new_price),((u=A==null?void 0:A.data)==null?void 0:u.markup_percentage)!==void 0)W.value=A.data.markup_percentage;else{const ke=p.value.total_hpp;W.value=ke>0?Math.round((A.data.new_price-ke)/ke*100):0}oe.value+=1,await pt()}await re(),ie.value=`Price successfully updated to ${G(((n=A==null?void 0:A.data)==null?void 0:n.new_price)||_.value)}!`,D.value=!0,d("price-updated")}catch(A){console.error("Error applying price suggestion:",A),ge.value=((z=(i=A==null?void 0:A.response)==null?void 0:i.data)==null?void 0:z.message)||"Failed to update variant price",C.value=!0}};return Se(()=>h.modelValue,Q=>{Q&&h.variantId&&re()}),Se(()=>h.variantId,Q=>{Q&&h.modelValue&&re()}),Se(s,async()=>{h.variantId&&await re()}),Se([()=>{var Q;return(Q=p.value)==null?void 0:Q.total_hpp},_],()=>{var Q;if((Q=p.value)!=null&&Q.total_hpp&&_.value>0){const f=p.value.total_hpp;W.value=f>0?Math.round((_.value-f)/f*100):0}else W.value=0}),Se(_,Q=>{Q!==k(L.value)&&(L.value=g(Q))}),(Q,f)=>(b(),ne(ze,null,[e(Ne,{"model-value":Q.modelValue,"max-width":"1200",scrollable:"","onUpdate:modelValue":f[6]||(f[6]=u=>Q.$emit("update:modelValue",u))},{default:t(()=>[e(de,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",Hs,[e(I,{icon:"mdi-calculator-variant",size:"24"}),a("span",null,"HPP Breakdown - "+c(Q.variantName||"Variant"),1)]),e(K,{icon:"mdi-close",size:"small",variant:"text",onClick:f[0]||(f[0]=u=>Q.$emit("update:modelValue",!1))})]),_:1}),e(fe,null,{default:t(()=>[e(Ue,{class:"mb-4"},{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>[e(Fe,{modelValue:s.value,"onUpdate:modelValue":[f[1]||(f[1]=u=>s.value=u),re],items:q,label:"HPP Calculation Method",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(K,{color:"primary",variant:"elevated",loading:U.value,"prepend-icon":"mdi-update",block:"",onClick:he},{default:t(()=>[v(" Update HPP with "+c(s.value),1)]),_:1},8,["loading"])]),_:1})]),_:1}),m.value?(b(),N(de,{key:0,variant:"tonal",color:"primary",class:"mb-4"},{default:t(()=>[e(fe,null,{default:t(()=>[e(Ue,{align:"center"},{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>{var u;return[f[11]||(f[11]=a("div",{class:"text-subtitle-2"}," Total HPP ",-1)),a("div",Bs,c(G(((u=p.value)==null?void 0:u.total_hpp)||0)),1)]}),_:1,__:[11]}),e(E,{cols:"12",md:"4"},{default:t(()=>{var u;return[f[12]||(f[12]=a("div",{class:"text-subtitle-2"}," Calculation Method ",-1)),a("div",Fs,c((u=q.find(n=>{var i;return n.value===((i=p.value)==null?void 0:i.method)}))==null?void 0:u.title),1)]}),_:1,__:[12]}),e(E,{cols:"12",md:"4"},{default:t(()=>{var u;return[f[13]||(f[13]=a("div",{class:"text-subtitle-2"}," Last Calculated ",-1)),a("div",Ks,c((u=p.value)!=null&&u.calculated_at?new Date(p.value.calculated_at).toLocaleString():"-"),1)]}),_:1,__:[13]})]),_:1})]),_:1})]),_:1})):ae("",!0),m.value?(b(),N(de,{key:1},{default:t(()=>{var u;return[e($e,null,{default:t(()=>{var n,i;return[e(I,{icon:"mdi-format-list-bulleted",class:"me-2"}),v(" Item Breakdown ("+c(((i=(n=p.value)==null?void 0:n.items)==null?void 0:i.length)||0)+" items) ",1)]}),_:1}),e(tl,{headers:Z,items:((u=p.value)==null?void 0:u.items)||[],"items-per-page":10,class:"elevation-0"},{"item.item_name":t(({item:n})=>[a("div",Rs,[a("span",qs,c(n.item_name),1),a("span",Os,c(n.item_code),1)])]),"item.quantity_needed":t(({item:n})=>[a("span",Ns,c(n.quantity_needed)+" "+c(n.unit),1)]),"item.cost_per_unit":t(({item:n})=>[a("span",null,c(G(n.cost_per_unit)),1)]),"item.total_cost":t(({item:n})=>[e(pe,{color:n.is_critical?"error":"primary",variant:"elevated",size:"small"},{default:t(()=>[v(c(G(n.total_cost)),1)]),_:2},1032,["color"])]),"item.is_critical":t(({item:n})=>[e(pe,{color:n.is_critical?"error":"success","prepend-icon":n.is_critical?"mdi-alert":"mdi-check",variant:"tonal",size:"small"},{default:t(()=>[v(c(n.is_critical?"Critical":"Normal"),1)]),_:2},1032,["color","prepend-icon"])]),"item.notes":t(({item:n})=>[n.notes?(b(),ne("span",Ls,c(n.notes),1)):(b(),ne("span",js,"—"))]),bottom:t(()=>{var n;return[a("div",Ws,[e(Me),a("div",Gs,[a("div",Xs," Total HPP: "+c(G(((n=p.value)==null?void 0:n.total_hpp)||0)),1),e(pe,{color:"info",variant:"elevated"},{default:t(()=>{var i,z;return[v(c(((z=(i=p.value)==null?void 0:i.items)==null?void 0:z.length)||0)+" items ",1)]}),_:1})])])]}),_:1},8,["items"])]}),_:1})):ae("",!0),m.value?(b(),N(de,{key:2,class:"mt-4"},{default:t(()=>[e($e,null,{default:t(()=>[e(I,{icon:"mdi-cash-multiple",class:"me-2"}),f[14]||(f[14]=v(" Price Suggestion "))]),_:1,__:[14]}),e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>{var u;return[(b(),N(Ie,{key:oe.value,modelValue:L.value,"onUpdate:modelValue":[f[2]||(f[2]=n=>L.value=n),S],label:"Target Selling Price",variant:"outlined",prefix:"Rp",hint:`Current HPP: ${G(((u=p.value)==null?void 0:u.total_hpp)||0)}`,"persistent-hint":""},null,8,["modelValue","hint"]))]}),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>{var u;return[(b(),N(Ie,{key:oe.value,modelValue:W.value,"onUpdate:modelValue":f[3]||(f[3]=n=>W.value=n),label:"Markup Percentage",variant:"outlined",type:"number",min:"0",step:"5",suffix:"%",readonly:"",hint:`Profit: ${G(_.value-(((u=p.value)==null?void 0:u.total_hpp)||0))}`,"persistent-hint":""},null,8,["modelValue","hint"]))]}),_:1})]),_:1}),e(Ue,{class:"mt-2"},{default:t(()=>[e(E,{cols:"12",md:"12"},{default:t(()=>[e(K,{color:"success",variant:"elevated","prepend-icon":"mdi-check-circle",loading:U.value,disabled:!_.value||_.value<=0,block:"",onClick:ve},{default:t(()=>f[15]||(f[15]=[v(" Apply Price ")])),_:1,__:[15]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})):ae("",!0),r.value?(b(),N(de,{key:3,variant:"tonal",color:"success",class:"mt-4"},{default:t(()=>[e($e,null,{default:t(()=>[e(I,{icon:"mdi-lightbulb",class:"me-2"}),f[16]||(f[16]=v(" Price Suggestions "))]),_:1,__:[16]}),e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[(b(!0),ne(ze,null,Xe(V.value.suggestions,(u,n)=>(b(),N(E,{key:n,cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"elevated"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[a("div",Js,c(n)+" Method ",1),a("div",Ys,c(G(u.suggested_price)),1),a("div",Qs,[v(" HPP: "+c(G(u.hpp)),1),f[17]||(f[17]=a("br",null,null,-1)),v(" Markup: "+c(u.markup_percentage.toFixed(1))+"%",1),f[18]||(f[18]=a("br",null,null,-1)),v(" Margin: "+c(u.profit_margin.toFixed(1))+"% ",1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):ae("",!0),!m.value&&!U.value?(b(),N(de,{key:4,variant:"outlined"},{default:t(()=>[e(fe,{class:"text-center py-8"},{default:t(()=>[e(I,{icon:"mdi-calculator-variant-outline",size:"64",color:"grey",class:"mb-4"}),f[20]||(f[20]=a("div",{class:"text-h6 mb-2"}," No HPP Data Available ",-1)),f[21]||(f[21]=a("div",{class:"text-body-2 text-medium-emphasis mb-4"}," Add composition items first, then calculate HPP using the method above. ",-1)),e(K,{color:"primary","prepend-icon":"mdi-plus",onClick:f[4]||(f[4]=u=>Q.$emit("update:modelValue",!1))},{default:t(()=>f[19]||(f[19]=[v(" Add Composition Items ")])),_:1,__:[19]})]),_:1,__:[20,21]})]),_:1})):ae("",!0)]),_:1}),e(Ke,{class:"pa-4"},{default:t(()=>[e(Le),e(K,{variant:"outlined",color:"grey","prepend-icon":"mdi-close",onClick:f[5]||(f[5]=u=>Q.$emit("update:modelValue",!1))},{default:t(()=>f[22]||(f[22]=[v(" Batal ")])),_:1,__:[22]})]),_:1})]),_:1})]),_:1},8,["model-value"]),e(at,{modelValue:D.value,"onUpdate:modelValue":f[8]||(f[8]=u=>D.value=u),color:"success",location:"top"},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:f[7]||(f[7]=u=>D.value=!1)},{default:t(()=>f[23]||(f[23]=[v(" Close ")])),_:1,__:[23]})]),default:t(()=>[v(c(ie.value)+" ",1)]),_:1},8,["modelValue"]),e(at,{modelValue:C.value,"onUpdate:modelValue":f[10]||(f[10]=u=>C.value=u),color:"error",location:"top"},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:f[9]||(f[9]=u=>C.value=!1)},{default:t(()=>f[24]||(f[24]=[v(" Close ")])),_:1,__:[24]})]),default:t(()=>[v(c(ge.value)+" ",1)]),_:1},8,["modelValue"])],64))}}),Zs={class:"d-flex align-center gap-2"},en={class:"pa-4",style:{"background-color":"#2A2A2A"}},tn={key:0,class:"d-flex align-center gap-3"},an={class:"text-h6 text-white font-weight-bold"},ln={class:"d-flex align-center gap-4 mt-1"},on={class:"text-caption text-grey-lighten-1"},sn={class:"text-caption text-grey-lighten-1"},nn={class:"pa-4 add-item-form"},rn={class:"d-flex align-center justify-space-between mb-4"},un={class:"d-flex align-center gap-2"},dn={class:"text-h6"},cn={key:0,class:"text-error"},mn={key:1},vn={class:"d-flex align-center"},fn={class:"pa-4 text-center"},pn={class:"pa-4 pt-0"},gn={class:"d-flex align-center justify-between mb-4"},_n={class:"text-h6"},kn={key:0,class:"composition-list"},yn={class:"d-flex align-center justify-between"},bn={class:"d-flex align-center gap-3"},hn={class:"font-weight-medium"},xn={class:"text-caption text-medium-emphasis"},wn={class:"font-weight-medium text-primary"},Vn={class:"d-flex align-center gap-2"},Pn={class:"text-center"},Cn={key:0,class:"text-body-2 text-medium-emphasis"},In={class:"text-center"},Sn={class:"text-body-1 mb-2",style:{"white-space":"pre-line"}},$n=Re({__name:"AddItemCompositionDialog",props:{modelValue:{type:Boolean},variant:{}},emits:["update:modelValue","save"],setup(l,{emit:F}){const h=l,d=F,U=H(),p=H(!1),V=H(!1),m=H([]),r=H([]),s=H(!1),W=H(null),_=H(!1),L=H(null),oe=H(!1),D=H(!1),C=H(""),ie=H(""),ge=H("success"),q=H(!1),Z=ce({get:()=>(console.log("🔵 [DEBUG] Dialog getter called, props.modelValue:",h.modelValue),h.modelValue),set:M=>{console.log("🔵 [DEBUG] Dialog setter called with value:",M),d("update:modelValue",M)}}),g=()=>({item_id:null,quantity:1,is_critical:!1}),k=H(g()),S=ce(()=>!k.value.item_id||!Array.isArray(m.value)?null:m.value.find(M=>M.id_item===k.value.item_id)),G=ce(()=>!S.value||s.value&&W.value!==null?null:r.value.find(M=>{var o,T;return M.name===((o=S.value)==null?void 0:o.name)||M.id&&((T=S.value)==null?void 0:T.id_item)&&M.id===S.value.id_item})),j=ce(()=>{if(!S.value)return"";if(s.value&&W.value!==null)return"Mode Edit: Mengubah quantity item yang dipilih";if(G.value){const M=G.value;return`Item sudah ada dengan quantity ${M.quantity} ${M.unit}. Quantity akan ditambahkan.`}return`Stok tersedia: ${w(S.value)} ${S.value.unit}`}),y=ce(()=>Array.isArray(m.value)?m.value.filter(M=>w(M)>0):[]),w=M=>{var o,T;return((o=M.inventory)==null?void 0:o.current_stock)||((T=M.inventory)==null?void 0:T.available_stock)||M.current_stock||0},O=()=>V.value?"Memuat items...":!m.value||m.value.length===0?"Tidak ada item tersedia":y.value.length===0?"Semua item sedang stok habis":"Tidak ada item yang ditemukan",re=M=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(M),he=M=>{switch(M){case"overstock":return"success";case"in_stock":return"primary";case"low_stock":return"warning";case"out_of_stock":return"error";default:return"grey"}},ve=M=>{switch(M){case"overstock":return"Berlebih";case"in_stock":return"Tersedia";case"low_stock":return"Menipis";case"out_of_stock":return"Habis";default:return"Unknown"}},Q=(M,o,T)=>{var P,me,X,_e,we,Ce,Ee,qe;if(!o)return!0;const R=o.toLowerCase().trim(),Y=((me=(P=T==null?void 0:T.raw)==null?void 0:P.name)==null?void 0:me.toLowerCase())||"",$=((_e=(X=T==null?void 0:T.raw)==null?void 0:X.item_code)==null?void 0:_e.toLowerCase())||"",ee=((Ce=(we=T==null?void 0:T.raw)==null?void 0:we.unit)==null?void 0:Ce.toLowerCase())||"",se=((qe=(Ee=T==null?void 0:T.raw)==null?void 0:Ee.description)==null?void 0:qe.toLowerCase())||"";return Y.includes(R)||$.includes(R)||ee.includes(R)||se.includes(R)},f=async()=>{var M,o,T;V.value=!0,console.log("Loading available items...");try{const R=await Oe.get("/api/items?per_page=all&include=inventory");console.log("Items API response:",R.data);const Y=((o=(M=R.data)==null?void 0:M.data)==null?void 0:o.data)||((T=R.data)==null?void 0:T.data)||R.data||[];m.value=Array.isArray(Y)?Y:[],console.log("Available items loaded:",m.value.length,"items"),console.log("Sample items with inventory:",m.value.slice(0,3))}catch(R){console.error("Error loading items:",R),R!=null&&R.response&&(console.error("API Error Status:",R.response.status),console.error("API Error Data:",R.response.data)),m.value=[]}finally{V.value=!1}},u=async()=>{var M,o,T,R,Y;if(!(!((M=h.variant)!=null&&M.id)&&!((o=h.variant)!=null&&o.id_variant)))try{const $=h.variant.id||h.variant.id_variant;console.log("Loading composition items for variant:",$);const ee=await Oe.get(`/api/variant-items/variant/${$}`);console.log("Composition API response:",ee.data);const se=((R=(T=ee.data)==null?void 0:T.data)==null?void 0:R.composition)||((Y=ee.data)==null?void 0:Y.composition)||[];if(!Array.isArray(se)){console.warn("API response composition is not an array:",se),r.value=[];return}r.value=se.map(P=>{var me,X,_e,we,Ce,Ee,qe,dt,ct,mt;return{id:P.id_variant_item||P.id,name:((me=P.item)==null?void 0:me.name)||P.name,quantity:parseFloat(P.quantity_needed||P.quantity||P.qty||"1"),unit:P.unit||((X=P.item)==null?void 0:X.unit)||"pcs",stock:((we=(_e=P.item)==null?void 0:_e.inventory)==null?void 0:we.current_stock)||((Ee=(Ce=P.item)==null?void 0:Ce.inventory)==null?void 0:Ee.available_stock)||((qe=P.item)==null?void 0:qe.current_stock)||P.stock||0,price:parseFloat(((dt=P.item)==null?void 0:dt.cost_per_unit)||((ct=P.item)==null?void 0:ct.price)||P.price||"0"),is_critical:P.is_critical||!1,inventory:(mt=P.item)!=null&&mt.inventory?{current_stock:P.item.inventory.current_stock||0,available_stock:P.item.inventory.available_stock||0,stock_status:P.item.inventory.stock_status||"unknown",reorder_level:P.item.inventory.reorder_level||0}:null}}),console.log("Composition items loaded:",r.value)}catch($){console.error("Error loading composition items:",$),$!=null&&$.response&&(console.error("API Error Status:",$.response.status),console.error("API Error Data:",$.response.data)),r.value=[]}},n=async()=>{var Y,$;const{valid:M}=await U.value.validate();if(!M||!S.value)return;const o=S.value.name,T=S.value.id_item,R=k.value.quantity;if(console.log("🔍 Handle save - Mode:",s.value?"EDIT":"ADD"),console.log("🔍 Item:",o,"ID:",T),console.log("🔍 Quantity:",R),s.value&&W.value!==null){console.log("✏️ Edit mode: Updating existing item at index",W.value);const se=r.value[W.value].quantity;console.log(`📝 Updating item "${o}":`),console.log(`   - Old quantity: ${se}`),console.log(`   - New quantity: ${R}`),r.value[W.value].quantity=R,r.value[W.value].is_critical=k.value.is_critical,console.log("✅ Item updated successfully in edit mode"),s.value=!1,W.value=null}else{console.log("➕ Add mode: Checking for existing item");const ee=r.value.findIndex(se=>se.name===o||se.id&&T&&se.id===T);if(ee!==-1){const P=r.value[ee].quantity,me=P+R;console.log("📦 Item already exists! Accumulating quantity:"),console.log(`   - Item: ${o}`),console.log(`   - Old quantity: ${P}`),console.log(`   - Adding: ${R}`),console.log(`   - New quantity: ${me}`),r.value[ee].quantity=me}else{console.log("➕ Adding new item to composition:",o);const se={name:o,quantity:R,unit:S.value.unit,stock:((Y=S.value.inventory)==null?void 0:Y.current_stock)||(($=S.value.inventory)==null?void 0:$.available_stock)||S.value.current_stock||0,price:S.value.cost_per_unit||0,is_critical:k.value.is_critical,inventory:S.value.inventory?{current_stock:S.value.inventory.current_stock||0,available_stock:S.value.inventory.available_stock||0,stock_status:S.value.inventory.stock_status||"unknown",reorder_level:S.value.inventory.reorder_level||0}:null};r.value.push(se),console.log("✅ New item added successfully")}}k.value=g(),console.log("🔄 Form reset")},i=(M,o)=>{console.log("🔍 Edit item called:",M,o);const T=m.value.find(R=>R.name===M.name||R.id_item===M.id);T?(console.log("✅ Found item in available items:",T),s.value=!0,W.value=o,k.value={item_id:T.id_item,quantity:M.quantity,is_critical:M.is_critical||!1},console.log("📝 Edit mode activated!"),console.log("📝 Form data set:",k.value),console.log("📝 Editing item at index:",o),setTimeout(()=>{const R=document.querySelector(".add-item-form");R&&R.scrollIntoView({behavior:"smooth",block:"start"})},100)):(console.error("❌ Could not find item in available items"),console.log("Available items:",m.value.map(R=>({id:R.id_item,name:R.name}))),console.log("Looking for item:",{id:M.id,name:M.name}))},z=()=>{console.log("❌ Edit mode cancelled"),s.value=!1,W.value=null,k.value=g()},A=(M,o)=>{L.value={item:M,index:o},_.value=!0},ke=async()=>{var Y,$,ee;if(!L.value)return;const{item:M,index:o}=L.value,T=M.name,R=M.id;oe.value=!0,console.log("🚀 Starting delete process for:",T,"ID:",R,"Index:",o);try{R?(console.log("🗑️ Deleting item from database:",T,"with ID:",R),await Oe.delete(`/api/variant-items/${R}`),console.log("✅ Item deleted from database successfully")):console.log("📝 Item has no ID, removing from local list only"),_.value=!1,L.value=null,console.log("✅ Delete dialog closed"),console.log("🔄 Force refreshing composition list..."),await u(),console.log("✅ Composition list refreshed from server. New count:",r.value.length),console.log("📡 Emitting save event to parent component..."),d("save"),console.log("✅ Save event emitted to parent component"),console.log("🎉 Item successfully deleted:",T)}catch(se){console.error("❌ Error deleting item:",se),console.error("❌ Error details:",(Y=se.response)==null?void 0:Y.data),alert("Gagal menghapus item: "+(((ee=($=se.response)==null?void 0:$.data)==null?void 0:ee.message)||se.message))}finally{oe.value=!1,console.log("🏁 Delete process completed")}},B=()=>{_.value=!1,L.value=null},x=()=>{switch(ge.value){case"success":return"mdi-check-circle";case"info":return"mdi-information";case"warning":return"mdi-alert";default:return"mdi-check-circle"}},ue=()=>{switch(ge.value){case"success":return"success";case"info":return"info";case"warning":return"warning";default:return"success"}},De=()=>{switch(ge.value){case"success":return"text-success";case"info":return"text-info";case"warning":return"text-warning";default:return"text-success"}},xe=()=>{switch(ge.value){case"success":return"success";case"info":return"info";case"warning":return"warning";default:return"success"}},Pe=async()=>{var M,o,T,R;if(!((M=h.variant)!=null&&M.id)&&!((o=h.variant)!=null&&o.id_variant)){console.error("No variant ID found");return}p.value=!0;try{const Y=h.variant.id||h.variant.id_variant;console.log("🔍 [DEBUG] Composition items count:",r.value.length),console.log("🔍 [DEBUG] Raw composition items:",JSON.stringify(r.value,null,2));const $=r.value.some(ee=>ee.id);if(console.log("🔍 [DEBUG] Has existing items:",$),$){console.log("� [EDIT MODE] Updating existing composition");const ee={items:r.value.map(P=>{const me=m.value.find(X=>X.name===P.name);return console.log(`Mapping item "${P.name}":`),console.log("  - Found item:",me==null?void 0:me.id_item),console.log("  - Original ID (id_variant_item):",P.id),console.log("  - Quantity:",P.quantity),console.log("  - Unit:",P.unit),console.log("  - Is critical:",P.is_critical),{id_variant_item:P.id,quantity_needed:Number(P.quantity),unit:P.unit,is_critical:P.is_critical||!1}}).filter(P=>P.id_variant_item&&P.quantity_needed>0)};console.log("Edit payload:",JSON.stringify(ee,null,2));const se=await Oe.post("/api/variant-items/bulk-update",ee);console.log("Composition updated successfully:",se.data)}else{console.log("✨ [CREATE MODE] Creating new composition");const ee={id_variant:Y,items:r.value.map(P=>{const me=m.value.find(X=>X.name===P.name);return console.log(`Mapping item "${P.name}":`),console.log("  - Found item:",me==null?void 0:me.id_item),console.log("  - Quantity:",P.quantity),console.log("  - Unit:",P.unit),console.log("  - Is critical:",P.is_critical),{id_item:me==null?void 0:me.id_item,quantity_needed:Number(P.quantity),unit:P.unit,is_critical:P.is_critical||!1}}).filter(P=>P.id_item&&P.quantity_needed>0)};console.log("Create payload:",JSON.stringify(ee,null,2));const se=await Oe.post("/api/variant-items/bulk-store",ee);console.log("Composition created successfully:",se.data)}d("save"),ye()}catch(Y){console.error("Error saving composition:",Y),alert("Gagal menyimpan komposisi: "+(((R=(T=Y.response)==null?void 0:T.data)==null?void 0:R.message)||Y.message))}finally{p.value=!1}},te=()=>{q.value=!0},ye=()=>{Z.value=!1,k.value=g(),r.value=[],s.value=!1,W.value=null};return Se(()=>h.modelValue,M=>{M?(k.value=g(),f(),u()):(s.value=!1,W.value=null)}),Se(()=>k.value.item_id,M=>{M&&S.value&&console.log("Item selected:",S.value.name,"Unit:",S.value.unit)}),ut(()=>{f()}),(M,o)=>{var T,R,Y;return b(),ne(ze,null,[e(Ne,{modelValue:Z.value,"onUpdate:modelValue":o[3]||(o[3]=$=>Z.value=$),"max-width":"1000px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between",style:{"background-color":"#D4A574",color:"white"}},{default:t(()=>[a("div",Zs,[e(I,{icon:"mdi-delete",color:"white"}),o[9]||(o[9]=a("span",null,"Kelola Komposisi Item",-1))]),e(K,{icon:"mdi-close",variant:"text",color:"white",onClick:ye,disabled:p.value},null,8,["disabled"])]),_:1}),e(fe,{class:"pa-0"},{default:t(()=>[a("div",en,[M.variant?(b(),ne("div",tn,[e(I,{icon:"mdi-coffee",size:"32",color:"white"}),a("div",null,[a("h3",an,c(M.variant.name),1),a("div",ln,[a("span",on,"SKU: "+c(M.variant.sku),1),a("span",sn,"Harga: "+c(re(M.variant.price||0)),1),e(pe,{color:"success",size:"small",variant:"tonal"},{default:t(()=>o[10]||(o[10]=[v(" Stok Aman ")])),_:1,__:[10]})])])])):ae("",!0)]),a("div",nn,[a("div",rn,[a("div",un,[e(I,{icon:"mdi-plus-circle",color:"success"}),a("h4",dn,c(s.value?"Edit Item Komposisi":"Tambah Item Komposisi"),1)])]),e(Ct,{ref_key:"form",ref:U,onSubmit:Vt(n,["prevent"])},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(Pt,{modelValue:k.value.item_id,"onUpdate:modelValue":o[0]||(o[0]=$=>k.value.item_id=$),items:y.value,"item-title":"name","item-value":"id_item",label:"Pilih Item",variant:"outlined",density:"compact",rules:[$=>!!$||"Item wajib dipilih"],loading:V.value,disabled:V.value||m.value&&m.value.length===0,"no-data-text":O(),placeholder:"Ketik untuk mencari item dengan stok...",clearable:"","menu-props":{maxHeight:"300px"},"hide-details":"auto","custom-filter":Q},{"prepend-inner":t(()=>[e(I,{icon:"mdi-package",size:"16"})]),item:t(({props:$,item:ee})=>[e(Ye,Ve($,{title:ee.raw.name,disabled:w(ee.raw)<=0,class:["pa-3",{"text-disabled":w(ee.raw)<=0}]}),{prepend:t(()=>[e(I,{icon:"mdi-package-variant",color:w(ee.raw)<=0?"grey-darken-2":"grey-lighten-1",class:"me-3"},null,8,["color"])]),subtitle:t(()=>[a("div",{class:Je(["text-caption",w(ee.raw)<=0?"text-disabled":"text-medium-emphasis"])},[w(ee.raw)<=0?(b(),ne("span",cn,[e(I,{icon:"mdi-alert-circle",size:"12",class:"me-1"}),o[11]||(o[11]=v(" Stok Habis "))])):(b(),ne("span",mn," Stok: "+c(w(ee.raw))+" "+c(ee.raw.unit),1))],2)]),append:t(()=>{var se;return[w(ee.raw)>0?(b(),N(pe,{key:0,size:"x-small",color:he(((se=ee.raw.inventory)==null?void 0:se.stock_status)||ee.raw.stock_status||"unknown"),variant:"tonal"},{default:t(()=>{var P;return[v(c(ve(((P=ee.raw.inventory)==null?void 0:P.stock_status)||ee.raw.stock_status||"unknown")),1)]}),_:2},1032,["color"])):(b(),N(pe,{key:1,size:"x-small",color:"error",variant:"outlined","prepend-icon":"mdi-close-circle"},{default:t(()=>o[12]||(o[12]=[v(" Habis ")])),_:1,__:[12]}))]}),_:2},1040,["title","disabled","class"])]),selection:t(({item:$})=>[a("div",vn,[e(I,{icon:"mdi-package-variant",size:"16",class:"me-2"}),a("span",null,c($.raw.name),1)])]),"no-data":t(()=>[a("div",fn,[e(I,{icon:"mdi-magnify",size:"48",color:"grey",class:"mb-2"}),o[13]||(o[13]=a("div",{class:"text-body-2 text-medium-emphasis"}," Tidak ada item yang ditemukan ",-1)),o[14]||(o[14]=a("div",{class:"text-caption text-disabled"}," Coba kata kunci yang berbeda ",-1))])]),_:1},8,["modelValue","items","rules","loading","disabled","no-data-text"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Ie,{modelValue:k.value.quantity,"onUpdate:modelValue":o[1]||(o[1]=$=>k.value.quantity=$),modelModifiers:{number:!0},label:"Jumlah",variant:"outlined",density:"compact",type:"number",min:"0.01",step:"0.01",rules:[$=>!!$||"Jumlah wajib diisi",$=>$>0||"Jumlah harus lebih dari 0"],hint:j.value,"persistent-hint":"",color:G.value?"warning":"primary"},null,8,["modelValue","rules","hint","color"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>{var $;return[e(Ie,{"model-value":(($=S.value)==null?void 0:$.unit)||"pcs",label:"Satuan",variant:"outlined",density:"compact",readonly:"",disabled:!S.value,placeholder:"Pilih item terlebih dahulu"},{"prepend-inner":t(()=>[e(I,{icon:"mdi-weight",size:"16"})]),_:1},8,["model-value","disabled"])]}),_:1}),e(E,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[e(rt,{modelValue:k.value.is_critical,"onUpdate:modelValue":o[2]||(o[2]=$=>k.value.is_critical=$),label:"Item Kritis",color:"warning",density:"compact","true-value":!0,"false-value":!1},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2",class:"d-flex flex-column gap-2"},{default:t(()=>[e(K,{color:s.value?"primary":G.value?"warning":"#D4A574",onClick:n,loading:p.value,disabled:!k.value.item_id||!k.value.quantity,block:""},{default:t(()=>[e(I,{icon:s.value?"mdi-content-save":G.value?"mdi-plus-box-multiple":"mdi-plus",class:"me-1"},null,8,["icon"]),v(" "+c(s.value?"Update":G.value?"Akumulasi":"Tambah"),1)]),_:1},8,["color","loading","disabled"]),s.value?(b(),N(K,{key:0,color:"grey",variant:"outlined",onClick:z,size:"small",block:""},{default:t(()=>[e(I,{icon:"mdi-close",class:"me-1"}),o[15]||(o[15]=v(" Batal "))]),_:1,__:[15]})):ae("",!0)]),_:1})]),_:1})]),_:1},512)]),a("div",pn,[a("div",gn,[a("h4",_n,"Daftar Item Komposisi ("+c(r.value.length)+")",1)]),r.value.length>0?(b(),ne("div",kn,[(b(!0),ne(ze,null,Xe(r.value,($,ee)=>(b(),N(de,{key:ee,variant:"outlined",class:"mb-3"},{default:t(()=>[e(fe,{class:"pa-3"},{default:t(()=>{var se,P,me,X,_e,we,Ce;return[a("div",yn,[a("div",bn,[e(I,{icon:"mdi-check-circle",color:"success"}),a("div",null,[a("div",hn,c($.name),1),a("div",xn,[a("span",wn,"Dibutuhkan: "+c($.quantity)+" "+c($.unit),1),o[16]||(o[16]=v(" • ")),a("span",{class:Je({"text-success":(((se=$.inventory)==null?void 0:se.current_stock)??0)>(((P=$.inventory)==null?void 0:P.reorder_level)??0),"text-warning":(((me=$.inventory)==null?void 0:me.current_stock)??0)<=(((X=$.inventory)==null?void 0:X.reorder_level)??0)&&(((_e=$.inventory)==null?void 0:_e.current_stock)??0)>0,"text-error":(((we=$.inventory)==null?void 0:we.current_stock)??0)<=0})}," Stok: "+c(((Ce=$.inventory)==null?void 0:Ce.current_stock)||$.stock||0)+" "+c($.unit),3),v(" • "+c(re($.price)),1)])])]),a("div",Vn,[e(K,{icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:Ee=>i($,ee)},null,8,["onClick"]),e(K,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:Ee=>A($,ee)},null,8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128))])):(b(),N(de,{key:1,variant:"outlined",class:"text-center pa-6"},{default:t(()=>[e(I,{icon:"mdi-package-variant-closed",size:"48",color:"grey",class:"mb-3"}),o[17]||(o[17]=a("div",{class:"text-body-2 text-medium-emphasis"}," Belum ada item komposisi ditambahkan ",-1))]),_:1,__:[17]}))])]),_:1}),e(Ke,{class:"px-6 pb-6"},{default:t(()=>[e(K,{variant:"outlined",color:"secondary","prepend-icon":"mdi-wrench",onClick:te},{default:t(()=>o[18]||(o[18]=[v(" Setting HPP ")])),_:1,__:[18]}),e(Le),e(K,{variant:"outlined",onClick:ye,disabled:p.value},{default:t(()=>o[19]||(o[19]=[v(" Batal ")])),_:1,__:[19]},8,["disabled"]),e(K,{color:"#D4A574",onClick:Pe,loading:p.value,disabled:r.value.length===0},{default:t(()=>o[20]||(o[20]=[v(" Simpan Komposisi ")])),_:1,__:[20]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Qt,{modelValue:q.value,"onUpdate:modelValue":o[4]||(o[4]=$=>q.value=$),"variant-id":((T=M.variant)==null?void 0:T.id)||((R=M.variant)==null?void 0:R.id_variant),"variant-name":(Y=M.variant)==null?void 0:Y.name,onHppUpdated:o[5]||(o[5]=$=>d("save"))},null,8,["modelValue","variant-id","variant-name"]),e(Ne,{modelValue:_.value,"onUpdate:modelValue":o[6]||(o[6]=$=>_.value=$),"max-width":"400px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-center text-h6 text-error"},{default:t(()=>[e(I,{icon:"mdi-alert-circle",color:"error",class:"me-2"}),o[21]||(o[21]=v(" Konfirmasi Hapus "))]),_:1,__:[21]}),e(Me),e(fe,{class:"pa-6"},{default:t(()=>[a("div",Pn,[e(I,{icon:"mdi-delete-alert",size:"64",color:"error",class:"mb-4"}),o[24]||(o[24]=a("p",{class:"text-body-1 mb-2"}," Apakah Anda yakin ingin menghapus item ini? ",-1)),L.value?(b(),ne("div",Cn,[a("strong",null,c(L.value.item.name),1),o[22]||(o[22]=a("br",null,null,-1)),v(" Dibutuhkan: "+c(L.value.item.quantity)+" "+c(L.value.item.unit),1)])):ae("",!0),e(Be,{type:"warning",variant:"tonal",class:"mt-4 text-start"},{default:t(()=>o[23]||(o[23]=[a("strong",null,"Perhatian:",-1),v(" Item yang sudah dihapus tidak dapat dikembalikan! ")])),_:1,__:[23]})])]),_:1}),e(Ke,{class:"px-6 pb-6"},{default:t(()=>[e(K,{variant:"outlined",onClick:B,disabled:oe.value,class:"flex-grow-1"},{default:t(()=>o[25]||(o[25]=[v(" Batal ")])),_:1,__:[25]},8,["disabled"]),e(K,{color:"error",onClick:ke,loading:oe.value,class:"flex-grow-1"},{default:t(()=>o[26]||(o[26]=[v(" Hapus ")])),_:1,__:[26]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ne,{modelValue:D.value,"onUpdate:modelValue":o[8]||(o[8]=$=>D.value=$),"max-width":"450px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e($e,{class:Je(["d-flex align-center justify-center text-h6",De()])},{default:t(()=>[e(I,{icon:x(),color:ue(),class:"me-2",size:"24"},null,8,["icon","color"]),v(" "+c(ie.value),1)]),_:1},8,["class"]),e(Me),e(fe,{class:"pa-6"},{default:t(()=>[a("div",In,[e(I,{icon:x(),color:ue(),size:"64",class:"mb-4"},null,8,["icon","color"]),a("div",Sn,c(C.value),1),e(Be,{type:ge.value,variant:"tonal",class:"mt-4 text-start"},{default:t(()=>[ge.value==="success"?(b(),ne(ze,{key:0},[o[27]||(o[27]=a("strong",null,"Berhasil!",-1)),o[28]||(o[28]=v(" Perubahan telah disimpan. "))],64)):ge.value==="info"?(b(),ne(ze,{key:1},[o[29]||(o[29]=a("strong",null,"Informasi:",-1)),o[30]||(o[30]=v(" Item telah diperbarui sesuai permintaan. "))],64)):(b(),ne(ze,{key:2},[o[31]||(o[31]=a("strong",null,"Perhatian:",-1)),o[32]||(o[32]=v(" Silakan periksa kembali informasi. "))],64))]),_:1},8,["type"])])]),_:1}),e(Ke,{class:"px-6 pb-6"},{default:t(()=>[e(Le),e(K,{color:xe(),onClick:o[7]||(o[7]=$=>D.value=!1),class:"px-6"},{default:t(()=>[e(I,{icon:"mdi-check",class:"me-1"}),o[33]||(o[33]=v(" OK "))]),_:1,__:[33]},8,["color"]),e(Le)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Dn=je($n,[["__scopeId","data-v-df449ced"]]),Tn={class:"d-flex align-center gap-2"},Un={class:"mt-2"},zn={key:0,class:"mt-1 font-weight-medium"},An={key:1,class:"mt-1 text-warning"},Mn=Re({__name:"CreateVariantDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","save"],setup(l,{emit:F}){const h=l,d=F,U=H(),p=H(!1),V=H(!1),m=H([]),r=H({name:"",selectedProduct:null,selectedProductId:null,active:!0}),s=[g=>!!g||"Nama variant wajib diisi",g=>g.length>=3||"Nama variant minimal 3 karakter"],W=[g=>!!g||"Produk wajib dipilih"],_=(g,k="success")=>{const S=document.createElement("div");S.style.cssText=`
    position: fixed;
    top: 20px;
    right: 20px;
    background: ${k==="success"?"#4CAF50":"#f44336"};
    color: white;
    padding: 16px 24px;
    border-radius: 8px;
    z-index: 9999;
    font-family: 'Roboto', sans-serif;
    font-size: 14px;
    font-weight: 500;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    display: flex;
    align-items: center;
    gap: 8px;
    animation: slideIn 0.3s ease-out;
    min-width: 300px;
  `;const G=document.createElement("span");if(G.innerHTML=k==="success"?"✓":"✕",G.style.cssText=`
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: rgba(255,255,255,0.2);
    font-weight: bold;
  `,S.appendChild(G),S.appendChild(document.createTextNode(g)),!document.querySelector("#snackbar-styles")){const j=document.createElement("style");j.id="snackbar-styles",j.textContent=`
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `,document.head.appendChild(j)}document.body.appendChild(S),setTimeout(()=>{S.style.animation="slideOut 0.3s ease-in",setTimeout(()=>{S.parentNode&&S.parentNode.removeChild(S)},300)},3e3),console.log(`${k}: ${g}`)},L=async()=>{V.value=!0;try{const g=await Oe.get("/api/products");m.value=g.data.data||g.data||[],console.log("Fetched products:",m.value),console.log("First product structure:",m.value[0])}catch(g){console.error("Gagal mengambil data produk:",g),m.value=[]}finally{V.value=!1}},oe=g=>{!g&&m.value.length===0&&L()},D=g=>{console.log("Product object changed:",g),r.value.selectedProduct=g,g?r.value.selectedProductId=g.id:r.value.selectedProductId=null},C=ce(()=>{if(console.log("Computing selected product info..."),console.log("form.selectedProduct:",r.value.selectedProduct),console.log("form.selectedProductId:",r.value.selectedProductId),r.value.selectedProduct)return console.log("Using selectedProduct object:",r.value.selectedProduct),r.value.selectedProduct;if(r.value.selectedProductId&&m.value.length>0){console.log("Searching for product with ID:",r.value.selectedProductId),console.log("Product IDs available:",m.value.map(k=>({id:k.id,name:k.name})));const g=m.value.find(k=>k.id===r.value.selectedProductId);return console.log("Found selected product by ID:",g),g}return console.log("No product selected or no products available"),null}),ie=()=>{console.log("Generating SKU...");const g=C.value;if(console.log("Product info for SKU:",g),console.log("Form name:",r.value.name),console.log("Form selectedProductId:",r.value.selectedProductId),!g||!r.value.name)return console.log("Missing productInfo or name, returning empty SKU"),"";const k=g.sku||"PROD",S=r.value.name.replace(/\s+/g,"").toUpperCase().substring(0,3),G=Date.now().toString().slice(-4),j=`${k}-${S}-${G}`;return console.log("Generated SKU:",j),j},ge=async()=>{var S,G;if(p.value)return;const{valid:g}=await U.value.validate();if(!g)return;const k=C.value;if(console.log("Product info in saveVariant:",k),!k){_("Produk tidak ditemukan","error");return}if(!k.id&&!k.id_product){_("ID Produk tidak valid","error"),console.error("Product missing ID:",k);return}p.value=!0;try{const j={id_product:k.id||k.id_product,name:r.value.name,sku:ie(),price:0,cost_price:null,barcode:null,variant_values:[],active:r.value.active};console.log("Payload being sent:",j),console.log("Payload JSON:",JSON.stringify(j));const y=await Oe.post("/api/variants",j);if(console.log("API Response:",y.data),console.log("Response Status:",y.status),y.data.success!==!1&&(y.status===200||y.status===201))_("Variant berhasil dibuat!","success"),console.log("Created variant data:",y.data.data),d("save"),Z();else throw new Error(y.data.message||"Gagal membuat variant")}catch(j){const y=((G=(S=j.response)==null?void 0:S.data)==null?void 0:G.message)||j.message||"Gagal membuat variant";_(y,"error"),console.error("Save variant error:",j)}finally{p.value=!1}},q=()=>{var g;r.value={name:"",selectedProduct:null,selectedProductId:null,active:!0},(g=U.value)==null||g.resetValidation()},Z=()=>{d("update:modelValue",!1),q()};return Se(()=>h.modelValue,g=>{g&&(q(),L())}),(g,k)=>(b(),N(Ne,{"model-value":g.modelValue,"onUpdate:modelValue":k[3]||(k[3]=S=>g.$emit("update:modelValue",S)),"max-width":"600px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e($e,{class:"bg-primary text-white"},{default:t(()=>[e(I,{icon:"mdi-plus-circle",class:"me-2"}),k[4]||(k[4]=v(" Tambah Variant Baru ")),e(Le),e(K,{icon:"mdi-close",variant:"text",color:"white",onClick:Z})]),_:1,__:[4]}),e(Ct,{ref_key:"formRef",ref:U,onSubmit:Vt(ge,["prevent"])},{default:t(()=>[e(fe,{class:"pa-6"},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(Pt,{modelValue:r.value.selectedProduct,"onUpdate:modelValue":[k[0]||(k[0]=S=>r.value.selectedProduct=S),D],items:m.value,loading:V.value,"item-title":"name","return-object":"",label:"Pilih Produk *",placeholder:"Cari produk...",variant:"outlined",rules:W,required:"","no-data-text":"Tidak ada produk ditemukan","onUpdate:search":oe},{item:t(({props:S,item:G})=>[e(Ye,Ia(Sa(S)),{prepend:t(()=>[e(Te,{image:G.raw.image_url,size:"40"},{default:t(()=>[G.raw.image_url?ae("",!0):(b(),N(I,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"])]),default:t(()=>[e(nt,null,{default:t(()=>[v(c(G.raw.name),1)]),_:2},1024),e(it,null,{default:t(()=>[v("SKU: "+c(G.raw.sku||"-"),1)]),_:2},1024)]),_:2},1040)]),selection:t(({item:S})=>[a("div",Tn,[e(Te,{image:S.raw.image_url,size:"24"},{default:t(()=>[S.raw.image_url?ae("",!0):(b(),N(I,{key:0,icon:"mdi-coffee",size:"16"}))]),_:2},1032,["image"]),a("span",null,c(S.raw.name),1)])]),_:1},8,["modelValue","items","loading"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Ie,{modelValue:r.value.name,"onUpdate:modelValue":k[1]||(k[1]=S=>r.value.name=S),label:"Nama Variant *",placeholder:"Contoh: Large Hot, Medium Cold, dll",variant:"outlined",rules:s,required:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Be,{color:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[e(_t,null,{default:t(()=>[e(I,{icon:"mdi-information",class:"me-2"}),k[5]||(k[5]=v(" SKU Otomatis "))]),_:1,__:[5]}),a("div",Un,[k[6]||(k[6]=v(" SKU variant akan dibuat otomatis berdasarkan nama produk dan variant ")),r.value.name&&(r.value.selectedProduct||r.value.selectedProductId)?(b(),ne("div",zn," Preview SKU: "+c(ie()),1)):r.value.name&&!r.value.selectedProduct&&!r.value.selectedProductId?(b(),ne("div",An," Pilih produk terlebih dahulu untuk melihat preview SKU ")):ae("",!0)])]),_:1})]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(rt,{modelValue:r.value.active,"onUpdate:modelValue":k[2]||(k[2]=S=>r.value.active=S),label:"Variant Aktif",color:"primary",inset:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Me),e(Ke,{class:"pa-6"},{default:t(()=>[e(Le),e(K,{variant:"outlined",onClick:Z,disabled:p.value},{default:t(()=>k[7]||(k[7]=[v(" Batal ")])),_:1,__:[7]},8,["disabled"]),e(K,{type:"submit",color:"primary",loading:p.value},{default:t(()=>k[8]||(k[8]=[v(" Simpan Variant ")])),_:1,__:[8]},8,["loading"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["model-value"]))}}),En=je(Mn,[["__scopeId","data-v-6f78bbf1"]]),Hn={class:"product-variant-tab"},Bn={class:"d-flex gap-2"},Fn={key:0,class:"mt-4 d-flex align-center gap-2"},Kn={key:1,class:"text-center pa-12"},Rn={key:2,class:"text-center pa-12"},qn={class:"d-flex align-center gap-3"},On={class:"flex-grow-1 min-width-0"},Nn={class:"text-h6 font-weight-bold text-truncate"},Ln={class:"text-body-2 text-medium-emphasis mb-0"},jn={class:"d-flex flex-column gap-1"},Wn={class:"text-xs"},Gn={class:"d-flex align-center gap-2"},Xn={class:"text-primary font-weight-medium"},Jn={class:"d-flex gap-1"},Yn={class:"d-flex align-center justify-space-between w-100"},Qn={class:"d-flex gap-1"},Zn=Re({__name:"ProductVariantTab",props:{loading:{type:Boolean}},emits:["refresh"],setup(l,{emit:F}){const h=F,d=H(!1),U=H([]),p=H(!1),V=H(!1),m=H(null),r=H(!1),s=H(!1),W=H(!1),_=H({search:"",stockStatus:"",activeStatus:null,sortBy:"name_asc"}),L=[{title:"Semua Status",value:""},{title:"Stok Aman",value:"safe"},{title:"Stok Kritis",value:"critical"},{title:"Stok Habis",value:"out"}],oe=[{title:"Nama Produk A-Z",value:"name_asc"},{title:"Nama Produk Z-A",value:"name_desc"},{title:"Variant Terbanyak",value:"variants_desc"},{title:"Variant Tersedikit",value:"variants_asc"}],D=ce(()=>!!(_.value.search||_.value.stockStatus||_.value.activeStatus!==null||_.value.sortBy!=="name_asc")),C=ce(()=>{const f={};return U.value.forEach(u=>{const n=u.id_product;f[n]||(f[n]={product:u.product||{id:u.id_product,id_product:u.id_product,name:`Product ${u.id_product}`,sku:""},variants:[]}),f[n].variants.push(u)}),Object.values(f)}),ie=ce(()=>{let f=[...C.value];if(_.value.search){const u=_.value.search.toLowerCase();f=f.filter(n=>{var i;return n.product.name.toLowerCase().includes(u)||((i=n.product.sku)==null?void 0:i.toLowerCase().includes(u))||n.variants.some(z=>z.name.toLowerCase().includes(u)||z.sku.toLowerCase().includes(u))})}switch(_.value.stockStatus&&(f=f.filter(u=>u.variants.some(n=>{var z;return(((z=n.composition_summary)==null?void 0:z.stock_status)||"safe")===_.value.stockStatus}))),_.value.activeStatus!==null&&(f=f.filter(u=>u.variants.some(n=>n.is_active===_.value.activeStatus))),_.value.sortBy){case"name_asc":f.sort((u,n)=>u.product.name.localeCompare(n.product.name));break;case"name_desc":f.sort((u,n)=>n.product.name.localeCompare(u.product.name));break;case"variants_desc":f.sort((u,n)=>n.variants.length-u.variants.length);break;case"variants_asc":f.sort((u,n)=>u.variants.length-n.variants.length);break}return f}),ge=(f,u="success")=>{},q=async()=>{var f,u,n;d.value=!0;try{const i=await Oe.get("/api/variants",{params:{per_page:1e3,with_product:!0,with_composition:!0}});if(i.data.success===!1)throw new Error(i.data.message||"Failed to load variants");const z=((f=i.data.data)==null?void 0:f.data)||i.data.data||[];U.value=z.map(A=>({...A,is_active:A.active!==void 0?A.active:A.is_active,id:A.id_variant||A.id,id_product:A.id_product||A.product_id}))}catch(i){(n=(u=i.response)==null?void 0:u.data)!=null&&n.message||i.message,U.value=[]}finally{d.value=!1}},Z=f=>{m.value=f,r.value=!0},g=f=>{f&&(m.value=f,s.value=!0)},k=f=>{m.value=f,p.value=!0},S=()=>{W.value=!0},G=async()=>{var f,u;if(m.value)try{V.value=!0,await Oe.delete(`/api/variants/${m.value.id_variant}`),ge("Variant berhasil dihapus","success"),await q(),p.value=!1}catch(n){(u=(f=n.response)==null?void 0:f.data)!=null&&u.message}finally{V.value=!1}},j=f=>{switch(f){case"critical":return"error";case"out":return"error";case"safe":return"success";default:return"primary"}},y=f=>{switch(f){case"critical":return"Kritis";case"out":return"Habis";case"safe":return"Aman";default:return"Normal"}},w=f=>{const u=f.filter(n=>n.is_active).length;return u===0?"error":u===f.length?"success":"warning"},O=f=>f.some(u=>{var i;const n=(i=u.composition_summary)==null?void 0:i.stock_status;return n==="critical"||n==="out"}),re=f=>{const u=f.filter(i=>i.is_active).length,n=f.filter(i=>{var A;const z=(A=i.composition_summary)==null?void 0:A.stock_status;return z==="critical"||z==="out"}).length;return n>0?{text:`${n} Stok Kritis`,color:"error",icon:"mdi-alert-circle"}:u===f.length?{text:"Semua Aktif",color:"success",icon:"mdi-check-circle"}:u===0?{text:"Semua Nonaktif",color:"error",icon:"mdi-close-circle"}:{text:`${u}/${f.length} Aktif`,color:"warning",icon:"mdi-minus-circle"}},he=()=>{_.value={search:"",stockStatus:"",activeStatus:null,sortBy:"name_asc"}},ve=()=>{q(),h("refresh")},Q=()=>{console.log("Variant created, refreshing data..."),q(),h("refresh")};return ut(()=>{q()}),(f,u)=>{var n,i,z;return b(),ne("div",Hn,[e(de,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between"},{default:t(()=>[u[14]||(u[14]=a("div",null,[a("h2",{class:"text-h5 font-weight-bold"},"Variant Produk"),a("p",{class:"text-body-2 text-medium-emphasis"}," Kelola variant dan komposisi untuk produk Anda ")],-1)),a("div",Bn,[e(K,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:q,loading:d.value},{default:t(()=>u[12]||(u[12]=[v(" Refresh ")])),_:1,__:[12]},8,["loading"]),e(K,{color:"primary","prepend-icon":"mdi-plus",onClick:S},{default:t(()=>u[13]||(u[13]=[v(" Tambah Variant ")])),_:1,__:[13]})])]),_:1,__:[14]})]),_:1}),e(de,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ie,{modelValue:_.value.search,"onUpdate:modelValue":u[0]||(u[0]=A=>_.value.search=A),label:"Cari Variant",placeholder:"Nama variant, SKU, atau produk...",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Fe,{modelValue:_.value.stockStatus,"onUpdate:modelValue":u[1]||(u[1]=A=>_.value.stockStatus=A),items:L,label:"Status Stok",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Fe,{modelValue:_.value.activeStatus,"onUpdate:modelValue":u[2]||(u[2]=A=>_.value.activeStatus=A),items:[{title:"Semua Status",value:null},{title:"Aktif",value:!0},{title:"Nonaktif",value:!1}],label:"Status Aktif",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Fe,{modelValue:_.value.sortBy,"onUpdate:modelValue":u[3]||(u[3]=A=>_.value.sortBy=A),items:oe,label:"Urutkan",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),D.value?(b(),ne("div",Fn,[u[16]||(u[16]=a("span",{class:"text-body-2"},"Filter aktif:",-1)),_.value.search?(b(),N(pe,{key:0,size:"small",closable:"","onClick:close":u[4]||(u[4]=A=>_.value.search="")},{default:t(()=>[v(" Pencarian: "+c(_.value.search),1)]),_:1})):ae("",!0),_.value.stockStatus?(b(),N(pe,{key:1,size:"small",closable:"","onClick:close":u[5]||(u[5]=A=>_.value.stockStatus="")},{default:t(()=>{var A;return[v(" Stok: "+c((A=L.find(ke=>ke.value===_.value.stockStatus))==null?void 0:A.title),1)]}),_:1})):ae("",!0),_.value.activeStatus!==null?(b(),N(pe,{key:2,size:"small",closable:"","onClick:close":u[6]||(u[6]=A=>_.value.activeStatus=null)},{default:t(()=>[v(" Status: "+c(_.value.activeStatus?"Aktif":"Nonaktif"),1)]),_:1})):ae("",!0),e(K,{variant:"text",size:"small",color:"error",onClick:he},{default:t(()=>u[15]||(u[15]=[v(" Hapus Semua Filter ")])),_:1,__:[15]})])):ae("",!0)]),_:1})]),_:1}),!d.value&&ie.value.length===0&&D.value?(b(),N(Be,{key:0,type:"info",variant:"outlined",class:"mb-6",title:"Tidak ada hasil",text:"Tidak ada variant yang sesuai dengan filter yang dipilih. Coba ubah filter pencarian."})):ae("",!0),d.value?(b(),ne("div",Kn,[e(qt,{color:"primary",indeterminate:"",size:"64"}),u[17]||(u[17]=a("div",{class:"mt-4 text-h6"},"Memuat variant...",-1))])):C.value.length===0?(b(),ne("div",Rn,[e(I,{icon:"mdi-tune-variant",size:"96",class:"text-disabled mb-6"}),u[19]||(u[19]=a("h3",{class:"text-h5 font-weight-bold mb-4"},"Belum Ada Variant Produk",-1)),u[20]||(u[20]=a("p",{class:"text-body-1 text-medium-emphasis mb-6"}," Buat variant untuk produk Anda agar dapat menawarkan pilihan yang beragam ",-1)),e(K,{color:"primary",size:"large","prepend-icon":"mdi-plus",onClick:S},{default:t(()=>u[18]||(u[18]=[v(" Buat Variant Pertama ")])),_:1,__:[18]})])):(b(),N(Ue,{key:3},{default:t(()=>[(b(!0),ne(ze,null,Xe(ie.value,A=>(b(),N(E,{key:A.product.id_product,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(de,{class:Je(["variant-group-card h-100",{"border-error":O(A.variants)}]),elevation:"2"},{default:t(()=>[e($e,{class:"pa-4 pb-2"},{default:t(()=>[a("div",qn,[e(Te,{image:A.product.image_url,size:"48",class:"flex-shrink-0"},{default:t(()=>[A.product.image_url?ae("",!0):(b(),N(I,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"]),a("div",On,[a("h3",Nn,c(A.product.name),1),a("p",Ln," SKU: "+c(A.product.sku||"-"),1)]),e(pe,{color:w(A.variants),size:"small",variant:"tonal"},{default:t(()=>[v(c(A.variants.length)+" Variant ",1)]),_:2},1032,["color"])])]),_:2},1024),e(Me),e(fe,{class:"pa-4"},{default:t(()=>[e(kt,{class:"pa-0"},{default:t(()=>[(b(!0),ne(ze,null,Xe(A.variants,(ke,B)=>(b(),N(Ye,{key:ke.id_variant,class:Je(["pa-2 rounded-lg variant-item",{"mb-2":B<A.variants.length-1}])},{prepend:t(()=>[e(Te,{size:"32",color:ke.is_active?"success":"error",variant:"tonal"},{default:t(()=>[e(I,{icon:ke.is_active?"mdi-check":"mdi-close",size:"16"},null,8,["icon"])]),_:2},1032,["color"])]),append:t(()=>[a("div",Jn,[e(He,{text:"Kelola Komposisi"},{activator:t(({props:x})=>[e(K,Ve({ref_for:!0},x,{icon:"mdi-chef-hat",size:"small",variant:"text",color:"primary",onClick:ue=>Z(ke)}),null,16,["onClick"])]),_:2},1024),e(He,{text:"Hapus Variant"},{activator:t(({props:x})=>[e(K,Ve({ref_for:!0},x,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:ue=>k(ke)}),null,16,["onClick"])]),_:2},1024)])]),default:t(()=>[e(nt,{class:"text-sm font-weight-medium"},{default:t(()=>[v(c(ke.name),1)]),_:2},1024),e(it,null,{default:t(()=>[a("div",jn,[a("span",Wn,"SKU: "+c(ke.sku),1),a("div",Gn,[a("span",Xn,c(J(tt)(ke.price||0)),1),ke.composition_summary?(b(),N(pe,{key:0,color:j(ke.composition_summary.stock_status),size:"x-small",variant:"tonal"},{default:t(()=>[v(c(y(ke.composition_summary.stock_status)),1)]),_:2},1032,["color"])):ae("",!0)])])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:2},1024)]),_:2},1024),e(Me),e(Ke,{class:"pa-4"},{default:t(()=>[a("div",Yn,[a("div",null,[e(pe,{color:re(A.variants).color,size:"small",variant:"tonal"},{default:t(()=>[e(I,{icon:re(A.variants).icon,size:"14",class:"me-1"},null,8,["icon"]),v(" "+c(re(A.variants).text),1)]),_:2},1032,["color"])]),a("div",Qn,[e(He,{text:"Setting HPP Produk"},{activator:t(({props:ke})=>[e(K,Ve({ref_for:!0},ke,{icon:"mdi-calculator-variant",size:"small",variant:"text",color:"warning",onClick:B=>g(A.variants[0])}),null,16,["onClick"])]),_:2},1024),e(He,{text:"Tambah Variant"},{activator:t(({props:ke})=>[e(K,Ve({ref_for:!0},ke,{icon:"mdi-plus",size:"small",variant:"text",color:"primary",onClick:S}),null,16)]),_:1}),e(He,{text:"Pengaturan Produk (Coming Soon)"},{activator:t(({props:ke})=>[e(K,Ve({ref_for:!0},ke,{icon:"mdi-cog",size:"small",variant:"text",color:"secondary",disabled:""}),null,16)]),_:1})])])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})),e(Dn,{modelValue:r.value,"onUpdate:modelValue":u[7]||(u[7]=A=>r.value=A),variant:m.value,onSave:ve},null,8,["modelValue","variant"]),e(Qt,{modelValue:s.value,"onUpdate:modelValue":u[8]||(u[8]=A=>s.value=A),"variant-id":(n=m.value)==null?void 0:n.id_variant,"variant-name":(i=m.value)==null?void 0:i.name,onHppUpdated:q,onPriceUpdated:q},null,8,["modelValue","variant-id","variant-name"]),e(En,{modelValue:W.value,"onUpdate:modelValue":u[9]||(u[9]=A=>W.value=A),onSave:Q},null,8,["modelValue"]),e(At,{modelValue:p.value,"onUpdate:modelValue":u[10]||(u[10]=A=>p.value=A),title:"Konfirmasi Hapus Variant","item-name":(z=m.value)==null?void 0:z.name,loading:V.value,"confirm-text":"Hapus Variant",onConfirm:G,onCancel:u[11]||(u[11]=A=>p.value=!1)},null,8,["modelValue","item-name","loading"])])}}}),zt=je(Zn,[["__scopeId","data-v-38a8b956"]]),ei={class:"product-management"},ti={class:"d-flex justify-space-between align-center mb-6"},ai={class:"d-flex gap-3 align-center"},li={key:0,class:"d-flex gap-2"},oi={class:"d-flex align-center"},si=Re({__name:"products-management",setup(l){Ot();const{productsList:F,categories:h,loading:d,saveLoading:U,deleteLoading:p,toggleLoading:V,stats:m,dialog:r,deleteDialog:s,editMode:W,selectedProduct:_,selectedProducts:L,currentPage:oe,totalItems:D,itemsPerPage:C,filters:ie,errorMessage:ge,successMessage:q,modalErrorMessage:Z,formData:g,selectedImage:k,imagePreview:S,canCreateEdit:G,hasSelectedProducts:j,fetchProductsList:y,fetchCategories:w,fetchStats:O,saveProduct:re,deleteProduct:he,bulkDeleteProducts:ve,toggleActiveStatus:Q,toggleFeaturedStatus:f,openCreateDialog:u,openEditDialog:n,openDeleteDialog:i,closeDialog:z,handleImageUpload:A,clearModalError:ke,onPageChange:B}=Nt(),{dialog:x,editMode:ue,formData:De,availableItems:xe,saveLoading:Pe,modalErrorMessage:te,openCreateDialog:ye,closeDialog:M,saveRecipe:o,clearModalError:T,fetchAvailableItems:R}=Fa(),{productItemsList:Y,loading:$,fetchProductItemsForComposition:ee}=ta(),se=H("products"),P=H(!1),me=H(null),X=H(!1),_e=H(null),we=async()=>{await he()},Ce=async()=>{await ve()},Ee=Ae=>{const le=Ae.id_product||Ae.id;ye(le)},qe=async Ae=>{me.value=Ae;try{await ee({page:1,per_page:50,critical_only:!1})}catch{}P.value=!0},dt=Ae=>{_e.value=Ae,X.value=!0},ct=Ae=>{if(!Ae)return[];const le=Ae.id_product||Ae.id;return Y.value.filter(lt=>{var be;return((be=lt.product)==null?void 0:be.id_product)===le||lt.product_id===le})||[]},mt=Ae=>{Object.assign(ie,Ae),y()},Zt=Ae=>{ie.search=Ae,y()},ea=()=>{k.value=null,S.value&&(S.value="")};return Se(se,async Ae=>{Ae==="compositions"&&await ee({page:1,per_page:15,critical_only:!1})},{immediate:!1}),ut(()=>{y(),w(),O(),R()}),(Ae,le)=>{var lt;return b(),ne("div",ei,[a("div",ti,[le[19]||(le[19]=a("div",null,[a("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Produk & Komposisi"),a("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola produk dan komposisi untuk coffee shop Anda")],-1)),a("div",ai,[J(j)&&se.value==="products"?(b(),ne("div",li,[e(pe,{color:"primary",size:"small"},{default:t(()=>[v(c(J(L).length)+" dipilih ",1)]),_:1}),e(K,{color:"error",variant:"outlined",size:"small","prepend-icon":"mdi-delete",onClick:Ce},{default:t(()=>le[17]||(le[17]=[v(" Hapus Terpilih ")])),_:1,__:[17]})])):ae("",!0),J(G)&&se.value==="products"?(b(),N(K,{key:1,color:"primary","prepend-icon":"mdi-plus",class:"coffee-btn",onClick:J(u)},{default:t(()=>le[18]||(le[18]=[v(" Tambah Produk ")])),_:1,__:[18]},8,["onClick"])):ae("",!0)])]),e(hl,{modelValue:se.value,"onUpdate:modelValue":le[0]||(le[0]=be=>se.value=be),class:"mb-6"},{default:t(()=>[e(ft,{value:"products"},{default:t(()=>[e(I,{icon:"mdi-coffee",class:"me-2"}),le[20]||(le[20]=v(" Produk "))]),_:1,__:[20]}),e(ft,{value:"compositions"},{default:t(()=>[e(I,{icon:"mdi-chef-hat",class:"me-2"}),le[21]||(le[21]=v(" Komposisi Produk "))]),_:1,__:[21]}),e(ft,{value:"variants"},{default:t(()=>[e(I,{icon:"mdi-tune-variant",class:"me-2"}),le[22]||(le[22]=v(" Variant Produk "))]),_:1,__:[22]})]),_:1},8,["modelValue"]),J(ge)?(b(),N(Be,{key:0,type:"error",variant:"outlined",class:"mb-4",text:J(ge),closable:"","onClick:close":le[1]||(le[1]=be=>ge.value="")},null,8,["text"])):ae("",!0),J(q)?(b(),N(Be,{key:1,type:"success",variant:"outlined",class:"mb-4",text:J(q),closable:"","onClick:close":le[2]||(le[2]=be=>q.value="")},null,8,["text"])):ae("",!0),e(xt,{modelValue:se.value,"onUpdate:modelValue":le[4]||(le[4]=be=>se.value=be)},{default:t(()=>[e(st,{value:"products"},{default:t(()=>[e(ks,{stats:J(m)},null,8,["stats"]),e(es,{filters:J(ie),"onUpdate:filters":mt,onSearch:Zt},null,8,["filters"]),e(Es,{products:J(F),loading:J(d),"current-page":J(oe),"total-items":J(D),"items-per-page":J(C),"selected-products":J(L),"toggle-loading":J(V),"onUpdate:page":J(B),onAddProduct:J(u),onEditProduct:J(n),onOpenRecipeDialog:Ee,onOpenCompositionDialog:qe,onOpenVariantDialog:dt,onDeleteProduct:J(i),onToggleActive:J(Q),onToggleFeatured:J(f),"onUpdate:selectedProducts":le[3]||(le[3]=be=>L.value=be)},null,8,["products","loading","current-page","total-items","items-per-page","selected-products","toggle-loading","onUpdate:page","onAddProduct","onEditProduct","onDeleteProduct","onToggleActive","onToggleFeatured"])]),_:1}),e(st,{value:"compositions"},{default:t(()=>[e(ho,{"product-items":J(Y),loading:J($),onRefresh:J(ee)},null,8,["product-items","loading","onRefresh"])]),_:1}),e(st,{value:"variants"},{default:t(()=>[e(zt,{loading:J(d),onRefresh:J(y)},null,8,["loading","onRefresh"])]),_:1})]),_:1},8,["modelValue"]),e(Xo,{modelValue:J(r),"onUpdate:modelValue":[le[5]||(le[5]=be=>yt(r)?r.value=be:null),le[6]||(le[6]=be=>r.value=be)],"edit-mode":J(W),"form-data":J(g),categories:J(h),loading:J(U),"error-message":J(Z),"selected-image":J(k)?[J(k)]:[],"image-preview":J(S),onClose:J(z),onSubmit:J(re),onImageChange:J(A),onRemoveImage:ea,onClearError:J(ke),onUpdateForm:le[7]||(le[7]=(be,St)=>J(g)[be]=St)},null,8,["modelValue","edit-mode","form-data","categories","loading","error-message","selected-image","image-preview","onClose","onSubmit","onImageChange","onClearError"]),e(Ka,{modelValue:J(x),"onUpdate:modelValue":[le[8]||(le[8]=be=>yt(x)?x.value=be:null),le[9]||(le[9]=be=>x.value=be)],"edit-mode":J(ue),"form-data":J(De),"available-items":J(xe),loading:J(Pe),"error-message":J(te),onClose:J(M),onSave:J(o),onClearError:J(T)},null,8,["modelValue","edit-mode","form-data","available-items","loading","error-message","onClose","onSave","onClearError"]),e(At,{modelValue:J(s),"onUpdate:modelValue":le[10]||(le[10]=be=>yt(s)?s.value=be:null),title:"Konfirmasi Hapus Produk","item-name":(lt=J(_))==null?void 0:lt.name,loading:J(p),"confirm-text":"Hapus Produk",onConfirm:we,onCancel:le[11]||(le[11]=be=>s.value=!1)},null,8,["modelValue","item-name","loading"]),e(Yt,{modelValue:P.value,"onUpdate:modelValue":le[12]||(le[12]=be=>P.value=be),product:me.value,items:ct(me.value),onSave:le[13]||(le[13]=()=>{J(y)(),P.value=!1}),onRefresh:J(y)},null,8,["modelValue","product","items","onRefresh"]),e(Ne,{modelValue:X.value,"onUpdate:modelValue":le[16]||(le[16]=be=>X.value=be),"max-width":"1400px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e($e,{class:"d-flex justify-between align-center"},{default:t(()=>{var be;return[a("div",oi,[e(I,{icon:"tabler-versions",class:"me-2"}),v(" Kelola Variant - "+c((be=_e.value)==null?void 0:be.name),1)]),e(K,{icon:"tabler-x",variant:"text",onClick:le[14]||(le[14]=St=>X.value=!1)})]}),_:1}),e(Me),e(fe,{class:"pa-0"},{default:t(()=>[_e.value?(b(),N(zt,{key:0,product:_e.value},null,8,["product"])):ae("",!0)]),_:1}),e(Me),e(Ke,null,{default:t(()=>[e(Le),e(K,{color:"grey-darken-1",variant:"outlined",onClick:le[15]||(le[15]=be=>X.value=!1)},{default:t(()=>[e(I,{icon:"mdi-close",class:"me-1"}),le[23]||(le[23]=v(" Tutup "))]),_:1,__:[23]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Yi=je(si,[["__scopeId","data-v-8c8b1097"]]);export{Yi as default};
