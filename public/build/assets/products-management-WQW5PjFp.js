import{D as Et}from"./DeleteConfirmationDialog-eLcg8Rnc.js";import{f as st}from"./formatters-BD6tdLx_.js";import{P as pt,u as ta}from"./useProductItems-CdTa_Om1.js";import{I as aa}from"./ItemsApi-Ct3rIgu5.js";import{H as la,u as oa}from"./HPPBreakdownDialog-BisadFOB.js";import{V as Ge}from"./VDialog-DflMU5SP.js";import{V as ue,b as $e,c as Ne}from"./VCard-DCmqYp_l.js";import{cq as Ht,a8 as lt,a9 as ot,as as na,aF as sa,af as Bt,bT as ia,r as H,V as de,aG as Ze,w as Ie,W as Qe,b as e,a0 as F,aa as nt,ak as ra,ab as Ft,ac as Kt,H as Rt,ba as ua,L as da,N as qt,bZ as ca,b_ as ma,b9 as _t,aJ as xt,I as va,ag as Ot,aM as kt,bj as fa,bt as Tt,p as Ve,be as Pt,cr as pa,c8 as Ut,bh as ga,F as Ae,X as S,cp as _a,c9 as ka,aI as ya,s as m,cs as ba,a$ as ha,ad as xa,aH as wa,b3 as Va,b5 as Pa,d as Le,D as ft,c as ie,f as t,e as a,t as d,g as O,l as ae,m as J,i as et,v as tt,o as b,aw as Nt,ax as wt,$ as Ct,j as Lt,ct as Ca,aA as We,ap as Ia,aq as Sa,a5 as ht}from"./main-D1fV7W5l.js";import{V as fe}from"./VCardText-Cb1B1zi0.js";import{V as Te}from"./VAvatar-ccFfBnUA.js";import{V as ge,m as $a,b as zt}from"./VChip-BjgEckyW.js";import{V as Ue,a as E}from"./VRow-McALRIDW.js";import{V as It}from"./VAutocomplete-DzXWAgLe.js";import{u as Da,e as Ta,t as ut,V as bt,a as at,b as ct,d as mt}from"./VList-CXj5YyIr.js";import{u as Ua,V as Ce,m as za}from"./VTextField-DUNAOjIO.js";import{V as vt}from"./VSwitch-CAzptjOV.js";import{a as yt,V as Re}from"./VAlert-BvZFuf3S.js";import{V as Xe}from"./VSpacer-DcQkAURe.js";import{V as it}from"./VSnackbar-aYcvbNyX.js";import{_ as Je}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Aa,m as Ma,a as Ea,V as Oe}from"./VSelect-DPg5CrjH.js";import{V as Ha}from"./VCheckbox-Cnt4KMrO.js";import{V as Ee}from"./VDivider-CfvBz93I.js";import{V as Ba}from"./VContainer-Cxf7fql-.js";import{a as jt,u as Fa,P as Ka}from"./useProducts-DR0L-vCo.js";import{V as St}from"./VForm-DxMFIgTb.js";import{V as At}from"./VTextarea-ClVmhYub.js";import{V as Ke}from"./VTooltip-BxGTVKzK.js";import{M as Ra,m as qa,V as Oa}from"./VImg-Ckc2hLz0.js";import{V as Na,u as La}from"./useCategories-BUXJIPPt.js";import{u as ja,m as Wa,h as Ga}from"./filter-BMU822Y1.js";import{f as Wt,a as Xa,s as Ja}from"./forwardRefs-B931MWyl.js";import{V as Ya}from"./VMenu-C9h1s1MV.js";import{V as Qa}from"./VCheckboxBtn-C9EwhFl7.js";import{V as Za}from"./VDataTableServer-7YaLOlmi.js";import{V as el}from"./VSkeletonLoader-CpHf-0Cr.js";import{V as tl}from"./VDataTable-Cd-Bd-D-.js";import{c as al,d as ll,u as ol}from"./VOverlay-xTPvxR5Z.js";import"./ProductsApi-VeaJnzJ4.js";import"./api-CSIwPjL3.js";import"./index-D-EbNoF1.js";/* empty css              */import"./helpers-B-vn2Qqf.js";import"./CategoriesApi-CbeJaOlo.js";import"./VTable-cPi1cQHC.js";const nl=o=>{const{touchstartX:B,touchendX:y,touchstartY:u,touchendY:$}=o,v=.5,w=16;o.offsetX=y-B,o.offsetY=$-u,Math.abs(o.offsetY)<v*Math.abs(o.offsetX)&&(o.left&&y<B-w&&o.left(o),o.right&&y>B+w&&o.right(o)),Math.abs(o.offsetX)<v*Math.abs(o.offsetY)&&(o.up&&$<u-w&&o.up(o),o.down&&$>u+w&&o.down(o))};function sl(o,B){var u;const y=o.changedTouches[0];B.touchstartX=y.clientX,B.touchstartY=y.clientY,(u=B.start)==null||u.call(B,{originalEvent:o,...B})}function il(o,B){var u;const y=o.changedTouches[0];B.touchendX=y.clientX,B.touchendY=y.clientY,(u=B.end)==null||u.call(B,{originalEvent:o,...B}),nl(B)}function rl(o,B){var u;const y=o.changedTouches[0];B.touchmoveX=y.clientX,B.touchmoveY=y.clientY,(u=B.move)==null||u.call(B,{originalEvent:o,...B})}function ul(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const B={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:o.left,right:o.right,up:o.up,down:o.down,start:o.start,move:o.move,end:o.end};return{touchstart:y=>sl(y,B),touchend:y=>il(y,B),touchmove:y=>rl(y,B)}}function dl(o,B){var c;const y=B.value,u=y!=null&&y.parent?o.parentElement:o,$=(y==null?void 0:y.options)??{passive:!0},v=(c=B.instance)==null?void 0:c.$.uid;if(!u||!v)return;const w=ul(B.value);u._touchHandlers=u._touchHandlers??Object.create(null),u._touchHandlers[v]=w,Ht(w).forEach(r=>{u.addEventListener(r,w[r],$)})}function cl(o,B){var v,w;const y=(v=B.value)!=null&&v.parent?o.parentElement:o,u=(w=B.instance)==null?void 0:w.$.uid;if(!(y!=null&&y._touchHandlers)||!u)return;const $=y._touchHandlers[u];Ht($).forEach(c=>{y.removeEventListener(c,$[c])}),delete y._touchHandlers[u]}const Gt={mounted:dl,unmounted:cl},Xt=Symbol.for("vuetify:v-window"),Jt=Symbol.for("vuetify:v-window-group"),Yt=ot({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:o=>typeof o=="boolean"||o==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Kt(),...Ft(),...ra()},"VWindow"),Vt=lt()({name:"VWindow",directives:{Touch:Gt},props:Yt(),emits:{"update:modelValue":o=>!0},setup(o,B){let{slots:y}=B;const{themeClasses:u}=na(o),{isRtl:$}=sa(),{t:v}=Bt(),w=ia(o,Jt),c=H(),r=de(()=>$.value?!o.reverse:o.reverse),i=Ze(!1),j=de(()=>{const f=o.direction==="vertical"?"y":"x",D=(r.value?!i.value:i.value)?"-reverse":"";return`v-window-${f}${D}-transition`}),p=Ze(0),N=H(void 0),oe=de(()=>w.items.value.findIndex(f=>w.selected.value.includes(f.id)));Ie(oe,(f,g)=>{const D=w.items.value.length,W=D-1;D<=2?i.value=f<g:f===W&&g===0?i.value=!0:f===0&&g===W?i.value=!1:i.value=f<g}),da(Xt,{transition:j,isReversed:i,transitionCount:p,transitionHeight:N,rootRef:c});const U=Qe(()=>o.continuous||oe.value!==0),C=Qe(()=>o.continuous||oe.value!==w.items.value.length-1);function re(){U.value&&w.prev()}function pe(){C.value&&w.next()}const G=de(()=>{const f=[],g={icon:$.value?o.nextIcon:o.prevIcon,class:`v-window__${r.value?"right":"left"}`,onClick:w.prev,"aria-label":v("$vuetify.carousel.prev")};f.push(U.value?y.prev?y.prev({props:g}):e(F,g,null):e("div",null,null));const D={icon:$.value?o.prevIcon:o.nextIcon,class:`v-window__${r.value?"left":"right"}`,onClick:w.next,"aria-label":v("$vuetify.carousel.next")};return f.push(C.value?y.next?y.next({props:D}):e(F,D,null):e("div",null,null)),f}),X=de(()=>o.touch===!1?o.touch:{...{left:()=>{r.value?re():pe()},right:()=>{r.value?pe():re()},start:g=>{let{originalEvent:D}=g;D.stopPropagation()}},...o.touch===!0?{}:o.touch});return nt(()=>Rt(e(o.tag,{ref:c,class:["v-window",{"v-window--show-arrows-on-hover":o.showArrows==="hover"},u.value,o.class],style:o.style},{default:()=>{var f,g;return[e("div",{class:"v-window__container",style:{height:N.value}},[(f=y.default)==null?void 0:f.call(y,{group:w}),o.showArrows!==!1&&e("div",{class:"v-window__controls"},[G.value])]),(g=y.additional)==null?void 0:g.call(y,{group:w})]}}),[[ua("touch"),X.value]])),{group:w}}}),Qt=ot({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Kt(),...ma(),...ll()},"VWindowItem"),dt=lt()({name:"VWindowItem",directives:{Touch:Gt},props:Qt(),emits:{"group:selected":o=>!0},setup(o,B){let{slots:y}=B;const u=qt(Xt),$=ca(o,Jt),{isBooted:v}=Da();if(!u||!$)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const w=Ze(!1),c=de(()=>v.value&&(u.isReversed.value?o.reverseTransition!==!1:o.transition!==!1));function r(){!w.value||!u||(w.value=!1,u.transitionCount.value>0&&(u.transitionCount.value-=1,u.transitionCount.value===0&&(u.transitionHeight.value=void 0)))}function i(){var U;w.value||!u||(w.value=!0,u.transitionCount.value===0&&(u.transitionHeight.value=xt((U=u.rootRef.value)==null?void 0:U.clientHeight)),u.transitionCount.value+=1)}function j(){r()}function p(U){w.value&&_t(()=>{!c.value||!w.value||!u||(u.transitionHeight.value=xt(U.clientHeight))})}const N=de(()=>{const U=u.isReversed.value?o.reverseTransition:o.transition;return c.value?{name:typeof U!="string"?u.transition.value:U,onBeforeEnter:i,onAfterEnter:r,onEnterCancelled:j,onBeforeLeave:i,onAfterLeave:r,onLeaveCancelled:j,onEnter:p}:!1}),{hasContent:oe}=al(o,$.isSelected);return nt(()=>e(Ra,{transition:N.value,disabled:!v.value},{default:()=>{var U;return[Rt(e("div",{class:["v-window-item",$.selectedClass.value,o.class],style:o.style},[oe.value&&((U=y.default)==null?void 0:U.call(y))]),[[va,$.isSelected.value]])]}})),{groupItem:$}}}),ml=ot({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Wa({filterKeys:["title"]}),...Ma({hideNoData:!0,returnObject:!0}),...Pt(za({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...qa({transition:!1})},"VCombobox"),vl=lt()({name:"VCombobox",props:ml(),emits:{"update:focused":o=>!0,"update:modelValue":o=>!0,"update:search":o=>!0,"update:menu":o=>!0},setup(o,B){var M;let{emit:y,slots:u}=B;const{t:$}=Bt(),v=H(),w=Ze(!1),c=Ze(!0),r=Ze(!1),i=H(),j=H(),p=Ze(-1);let N=!1;const{items:oe,transformIn:U,transformOut:C}=Ta(o),{textColorClasses:re,textColorStyles:pe}=Ot(()=>{var n;return(n=v.value)==null?void 0:n.color}),G=kt(o,"modelValue",[],n=>U(fa(n)),n=>{const A=C(n);return o.multiple?A:A[0]??null}),X=Ua(o),f=de(()=>!!(o.chips||u.chip)),g=de(()=>f.value||!!u.selection),D=Ze(!o.multiple&&!g.value?((M=G.value[0])==null?void 0:M.title)??"":""),W=de({get:()=>D.value,set:n=>{var A;if(D.value=n??"",!o.multiple&&!g.value&&(G.value=[ut(o,n)]),n&&o.multiple&&((A=o.delimiters)!=null&&A.length)){const R=n.split(new RegExp(`(?:${o.delimiters.join("|")})+`));R.length>1&&(R.forEach(Y=>{Y=Y.trim(),Y&&xe(ut(o,Y))}),D.value="")}n||(p.value=-1),c.value=!n}}),L=de(()=>typeof o.counterValue=="function"?o.counterValue(G.value):typeof o.counterValue=="number"?o.counterValue:o.multiple?G.value.length:W.value.length),{filteredItems:k,getMatches:x}=ja(o,oe,()=>c.value?"":W.value),q=de(()=>o.hideSelected?k.value.filter(n=>!G.value.some(A=>A.value===n.value)):k.value),ce=de(()=>o.hideNoData&&!q.value.length||X.isReadonly.value||X.isDisabled.value),ke=kt(o,"menu"),me=de({get:()=>ke.value,set:n=>{var A;ke.value&&!n&&((A=i.value)!=null&&A.Î¨openChildren.size)||n&&ce.value||(ke.value=n)}}),Q=Qe(()=>me.value?o.closeText:o.openText);Ie(D,n=>{N?_t(()=>N=!1):w.value&&!me.value&&(me.value=!0),y("update:search",n)}),Ie(G,n=>{var A;!o.multiple&&!g.value&&(D.value=((A=n[0])==null?void 0:A.title)??"")});const z=de(()=>G.value.map(n=>n.value)),_=de(()=>{var A;return(o.autoSelectFirst===!0||o.autoSelectFirst==="exact"&&W.value===((A=q.value[0])==null?void 0:A.title))&&q.value.length>0&&!c.value&&!r.value}),l=H(),s=Aa(l,v);function I(n){N=!0,o.openOnClear&&(me.value=!0)}function ye(){ce.value||(me.value=!0)}function Z(n){ce.value||(w.value&&(n.preventDefault(),n.stopPropagation()),me.value=!me.value)}function V(n){var A;n.key!==" "&&Ut(n)&&((A=v.value)==null||A.focus())}function h(n){var Y,T,ee,se;if(pa(n)||X.isReadonly.value)return;const A=(Y=v.value)==null?void 0:Y.selectionStart,R=G.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(n.key)&&n.preventDefault(),["Enter","ArrowDown"].includes(n.key)&&(me.value=!0),["Escape"].includes(n.key)&&(me.value=!1),["Enter","Escape","Tab"].includes(n.key)&&(_.value&&["Enter","Tab"].includes(n.key)&&!G.value.some(P=>{let{value:ve}=P;return ve===q.value[0].value})&&xe(k.value[0]),c.value=!0),n.key==="ArrowDown"&&_.value&&((T=l.value)==null||T.focus("next")),n.key==="Enter"&&W.value&&(xe(ut(o,W.value)),g.value&&(D.value="")),["Backspace","Delete"].includes(n.key)){if(!o.multiple&&g.value&&G.value.length>0&&!W.value)return xe(G.value[0],!1);if(~p.value){n.preventDefault();const P=p.value;xe(G.value[p.value],!1),p.value=P>=R-1?R-2:P}else n.key==="Backspace"&&!W.value&&(p.value=R-1);return}if(o.multiple)if(n.key==="ArrowLeft"){if(p.value<0&&A&&A>0)return;const P=p.value>-1?p.value-1:R-1;G.value[P]?p.value=P:(p.value=-1,(ee=v.value)==null||ee.setSelectionRange(W.value.length,W.value.length))}else if(n.key==="ArrowRight"){if(p.value<0)return;const P=p.value+1;G.value[P]?p.value=P:(p.value=-1,(se=v.value)==null||se.setSelectionRange(0,0))}else~p.value&&Ut(n)&&(p.value=-1)}function K(){var n;o.eager&&((n=j.value)==null||n.calculateVisibleItems())}function we(){var n;w.value&&(c.value=!0,(n=v.value)==null||n.focus())}function xe(n){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!n||n.props.disabled))if(o.multiple){const R=G.value.findIndex(T=>(o.valueComparator||Tt)(T.value,n.value)),Y=A??!~R;if(~R){const T=Y?[...G.value,n]:[...G.value];T.splice(R,1),G.value=T}else Y&&(G.value=[...G.value,n]);o.clearOnSelect&&(W.value="")}else{const R=A!==!1;G.value=R?[n]:[],D.value=R&&!g.value?n.title:"",_t(()=>{me.value=!1,c.value=!0})}}function Pe(n){w.value=!0,setTimeout(()=>{r.value=!0})}function te(n){r.value=!1}function be(n){(n==null||n===""&&!o.multiple&&!g.value)&&(G.value=[])}return Ie(w,(n,A)=>{if(!(n||n===A)&&(p.value=-1,me.value=!1,W.value)){if(o.multiple){xe(ut(o,W.value));return}if(!g.value)return;G.value.some(R=>{let{title:Y}=R;return Y===W.value})?D.value="":xe(ut(o,W.value))}}),Ie(me,()=>{if(!o.hideSelected&&me.value&&G.value.length){const n=q.value.findIndex(A=>G.value.some(R=>(o.valueComparator||Tt)(R.value,A.value)));ga&&window.requestAnimationFrame(()=>{var A;n>=0&&((A=j.value)==null||A.scrollToIndex(n))})}}),Ie(()=>o.items,(n,A)=>{me.value||w.value&&!A.length&&n.length&&(me.value=!0)}),nt(()=>{const n=!!(!o.hideNoData||q.value.length||u["prepend-item"]||u["append-item"]||u["no-data"]),A=G.value.length>0,R=Ce.filterProps(o);return e(Ce,Ve({ref:v},R,{modelValue:W.value,"onUpdate:modelValue":[Y=>W.value=Y,be],focused:w.value,"onUpdate:focused":Y=>w.value=Y,validationValue:G.externalValue,counterValue:L.value,dirty:A,class:["v-combobox",{"v-combobox--active-menu":me.value,"v-combobox--chips":!!o.chips,"v-combobox--selection-slot":!!g.value,"v-combobox--selecting-index":p.value>-1,[`v-combobox--${o.multiple?"multiple":"single"}`]:!0},o.class],style:o.style,readonly:X.isReadonly.value,placeholder:A?void 0:o.placeholder,"onClick:clear":I,"onMousedown:control":ye,onKeydown:h}),{...u,default:()=>e(Ae,null,[e(Ya,Ve({ref:i,modelValue:me.value,"onUpdate:modelValue":Y=>me.value=Y,activator:"parent",contentClass:"v-combobox__content",disabled:ce.value,eager:o.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:o.transition,onAfterEnter:K,onAfterLeave:we},o.menuProps),{default:()=>[n&&e(bt,Ve({ref:l,selected:z.value,selectStrategy:o.multiple?"independent":"single-independent",onMousedown:Y=>Y.preventDefault(),onKeydown:V,onFocusin:Pe,onFocusout:te,tabindex:"-1","aria-live":"polite",color:o.itemColor??o.color},s,o.listProps),{default:()=>{var Y,T,ee;return[(Y=u["prepend-item"])==null?void 0:Y.call(u),!q.value.length&&!o.hideNoData&&(((T=u["no-data"])==null?void 0:T.call(u))??e(at,{key:"no-data",title:$(o.noDataText)},null)),e(Ea,{ref:j,renderless:!0,items:q.value,itemKey:"value"},{default:se=>{var He;let{item:P,index:ve,itemRef:_e}=se;const ze=Ve(P.props,{ref:_e,key:P.value,active:_.value&&ve===0?!0:void 0,onClick:()=>xe(P,null)});return((He=u.item)==null?void 0:He.call(u,{item:P,index:ve,props:ze}))??e(at,Ve(ze,{role:"option"}),{prepend:Me=>{let{isSelected:Be}=Me;return e(Ae,null,[o.multiple&&!o.hideSelected?e(Qa,{key:P.value,modelValue:Be,ripple:!1,tabindex:"-1"},null):void 0,P.props.prependAvatar&&e(Te,{image:P.props.prependAvatar},null),P.props.prependIcon&&e(S,{icon:P.props.prependIcon},null)])},title:()=>{var Me;return c.value?P.title:Ga("v-combobox",P.title,(Me=x(P))==null?void 0:Me.title)}})}}),(ee=u["append-item"])==null?void 0:ee.call(u)]}})]}),G.value.map((Y,T)=>{function ee(_e){_e.stopPropagation(),_e.preventDefault(),xe(Y,!1)}const se={"onClick:close":ee,onKeydown(_e){_e.key!=="Enter"&&_e.key!==" "||(_e.preventDefault(),_e.stopPropagation(),ee(_e))},onMousedown(_e){_e.preventDefault(),_e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},P=f.value?!!u.chip:!!u.selection,ve=P?ka(f.value?u.chip({item:Y,index:T,props:se}):u.selection({item:Y,index:T})):void 0;if(!(P&&!ve))return e("div",{key:Y.value,class:["v-combobox__selection",T===p.value&&["v-combobox__selection--selected",re.value]],style:T===p.value?pe.value:{}},[f.value?u.chip?e(ya,{key:"chip-defaults",defaults:{VChip:{closable:o.closableChips,size:"small",text:Y.title}}},{default:()=>[ve]}):e(ge,Ve({key:"chip",closable:o.closableChips,size:"small",text:Y.title,disabled:Y.props.disabled},se),null):ve??e("span",{class:"v-combobox__selection-text"},[Y.title,o.multiple&&T<G.value.length-1&&e("span",{class:"v-combobox__selection-comma"},[m(",")])])])})]),"append-inner":function(){var se,P;for(var Y=arguments.length,T=new Array(Y),ee=0;ee<Y;ee++)T[ee]=arguments[ee];return e(Ae,null,[(se=u["append-inner"])==null?void 0:se.call(u,...T),(!o.hideNoData||o.items.length)&&o.menuIcon?e(S,{class:"v-combobox__menu-icon",color:(P=v.value)==null?void 0:P.fieldIconColor,icon:o.menuIcon,onMousedown:Z,onClick:_a,"aria-label":$(Q.value),title:$(Q.value),tabindex:"-1"},null):void 0])}})}),Wt({isFocused:w,isPristine:c,menu:me,search:W,selectionIndex:p,filteredItems:k,select:xe},v)}}),$t=Symbol.for("vuetify:v-tabs"),fl=ot({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Pt(ba({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),gt=lt()({name:"VTab",props:fl(),setup(o,B){let{slots:y,attrs:u}=B;const{textColorClasses:$,textColorStyles:v}=Ot(()=>o.sliderColor),w=H(),c=H(),r=de(()=>o.direction==="horizontal"),i=de(()=>{var p,N;return((N=(p=w.value)==null?void 0:p.group)==null?void 0:N.isSelected.value)??!1});function j(p){var oe,U;let{value:N}=p;if(N){const C=(U=(oe=w.value)==null?void 0:oe.$el.parentElement)==null?void 0:U.querySelector(".v-tab--selected .v-tab__slider"),re=c.value;if(!C||!re)return;const pe=getComputedStyle(C).color,G=C.getBoundingClientRect(),X=re.getBoundingClientRect(),f=r.value?"x":"y",g=r.value?"X":"Y",D=r.value?"right":"bottom",W=r.value?"width":"height",L=G[f],k=X[f],x=L>k?G[D]-X[D]:G[f]-X[f],q=Math.sign(x)>0?r.value?"right":"bottom":Math.sign(x)<0?r.value?"left":"top":"center",ke=(Math.abs(x)+(Math.sign(x)<0?G[W]:X[W]))/Math.max(G[W],X[W])||0,me=G[W]/X[W]||0,Q=1.5;Xa(re,{backgroundColor:[pe,"currentcolor"],transform:[`translate${g}(${x}px) scale${g}(${me})`,`translate${g}(${x/Q}px) scale${g}(${(ke-1)/Q+1})`,"none"],transformOrigin:Array(3).fill(q)},{duration:225,easing:Ja})}}return nt(()=>{const p=F.filterProps(o);return e(F,Ve({symbol:$t,ref:w,class:["v-tab",o.class],style:o.style,tabindex:i.value?0:-1,role:"tab","aria-selected":String(i.value),active:!1},p,u,{block:o.fixed,maxWidth:o.fixed?300:void 0,"onGroup:selected":j}),{...y,default:()=>{var N;return e(Ae,null,[((N=y.default)==null?void 0:N.call(y))??o.text,!o.hideSlider&&e("div",{ref:c,class:["v-tab__slider",$.value],style:v.value},null)])}})}),Wt({},w)}}),pl=ot({...Pt(Yt(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),gl=lt()({name:"VTabsWindow",props:pl(),emits:{"update:modelValue":o=>!0},setup(o,B){let{slots:y}=B;const u=qt($t,null),$=kt(o,"modelValue"),v=de({get(){var w;return $.value!=null||!u?$.value:(w=u.items.value.find(c=>u.selected.value.includes(c.id)))==null?void 0:w.value},set(w){$.value=w}});return nt(()=>{const w=Vt.filterProps(o);return e(Vt,Ve({_as:"VTabsWindow"},w,{modelValue:v.value,"onUpdate:modelValue":c=>v.value=c,class:["v-tabs-window",o.class],style:o.style,mandatory:!1,touch:!1}),y)}),{}}}),_l=ot({...Qt()},"VTabsWindowItem"),kl=lt()({name:"VTabsWindowItem",props:_l(),setup(o,B){let{slots:y}=B;return nt(()=>{const u=dt.filterProps(o);return e(dt,Ve({_as:"VTabsWindowItem"},u,{class:["v-tabs-window-item",o.class],style:o.style}),y)}),{}}});function yl(o){return o?o.map(B=>Pa(B)?B:{text:B,value:B}):[]}const bl=ot({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...$a({mandatory:"force",selectedClass:"v-tab-item--selected"}),...Va(),...Ft()},"VTabs"),hl=lt()({name:"VTabs",props:bl(),emits:{"update:modelValue":o=>!0},setup(o,B){let{attrs:y,slots:u}=B;const $=kt(o,"modelValue"),v=de(()=>yl(o.items)),{densityClasses:w}=ha(o),{backgroundColorClasses:c,backgroundColorStyles:r}=xa(()=>o.bgColor),{scopeId:i}=ol();return wa({VTab:{color:Qe(()=>o.color),direction:Qe(()=>o.direction),stacked:Qe(()=>o.stacked),fixed:Qe(()=>o.fixedTabs),sliderColor:Qe(()=>o.sliderColor),hideSlider:Qe(()=>o.hideSlider)}}),nt(()=>{const j=zt.filterProps(o),p=!!(u.window||o.items.length>0);return e(Ae,null,[e(zt,Ve(j,{modelValue:$.value,"onUpdate:modelValue":N=>$.value=N,class:["v-tabs",`v-tabs--${o.direction}`,`v-tabs--align-tabs-${o.alignTabs}`,{"v-tabs--fixed-tabs":o.fixedTabs,"v-tabs--grow":o.grow,"v-tabs--stacked":o.stacked},w.value,c.value,o.class],style:[{"--v-tabs-height":xt(o.height)},r.value,o.style],role:"tablist",symbol:$t},i,y),{default:()=>{var N;return[((N=u.default)==null?void 0:N.call(u))??v.value.map(oe=>{var U;return((U=u.tab)==null?void 0:U.call(u,{item:oe}))??e(gt,Ve(oe,{key:oe.text,value:oe.value}),{default:u[`tab.${oe.value}`]?()=>{var C;return(C=u[`tab.${oe.value}`])==null?void 0:C.call(u,{item:oe})}:void 0})})]}}),p&&e(gl,Ve({modelValue:$.value,"onUpdate:modelValue":N=>$.value=N,key:"tabs-window"},i),{default:()=>{var N;return[v.value.map(oe=>{var U;return((U=u.item)==null?void 0:U.call(u,{item:oe}))??e(kl,{value:oe.value},{default:()=>{var C;return(C=u[`item.${oe.value}`])==null?void 0:C.call(u,{item:oe})}})}),(N=u.window)==null?void 0:N.call(u)]}})])}),{}}}),xl={class:"d-flex align-center gap-3"},wl={class:"text-body-2 ma-0 opacity-90"},Vl={class:"d-flex align-center gap-4"},Pl={class:"flex-grow-1"},Cl={class:"text-h6 font-weight-bold mb-1"},Il={class:"text-body-2 text-medium-emphasis mb-1"},Sl={class:"text-body-2 text-medium-emphasis mb-0"},$l={class:"d-flex align-center justify-space-between w-100"},Dl={class:"d-flex align-center"},Tl={key:0,class:"text-warning"},Ul={key:1},zl={key:0,class:"text-center pa-8"},Al={class:"d-flex align-center gap-4 mt-1"},Ml={key:1,class:"text-primary"},El={class:"d-flex gap-2"},Hl=Le({__name:"ProductCompositionDialog",props:{modelValue:{type:Boolean},product:{},items:{}},emits:["update:modelValue","save","refresh"],setup(o,{emit:B}){const y=o,u=B,$=de({get:()=>y.modelValue,set:V=>u("update:modelValue",V)}),v=H(!1),w=H([]),c=H(!1),r=H(!1),i=H(""),j=H(""),p=H(!1),N=H(-1),oe=H(!1),U=H({itemId:null,quantity:1,unit:"pcs",isCritical:!1}),C=H([]),re=H(!1),pe=H([]),G=async()=>{var V;if(y.product)try{const h=y.product.id_product||y.product.id;console.log("ðŸ”„ Fetching composition for product ID:",h);const K=await pt.getAll({product_id:h,page:1,per_page:1e5});K.success&&((V=K.data)!=null&&V.data)&&(w.value=K.data.data,pe.value=JSON.parse(JSON.stringify(K.data.data)),console.log("âœ… Initial composition loaded:",pe.value.length,"items"))}catch(h){console.error("Error fetching product composition:",h)}},X=async()=>{var V;re.value=!0;try{const h=await aa.getAll({page:1,per_page:1e5,active:!0});h.success&&((V=h.data)!=null&&V.data)&&(C.value=h.data.data.map(K=>{var we,xe,Pe;return{id:((we=K.id_item)==null?void 0:we.toString())||((xe=K.id)==null?void 0:xe.toString()),name:K.name,current_stock:((Pe=K.inventory)==null?void 0:Pe.current_stock)||0,unit:K.unit||"pcs"}}))}catch(h){console.error("Error fetching available items:",h),C.value=[]}finally{re.value=!1}},f=de(()=>U.value.itemId&&U.value.quantity>0&&U.value.unit.trim().length>0),g=de(()=>{if(!U.value.itemId)return null;const V=C.value.find(h=>h.id===U.value.itemId);return(V==null?void 0:V.unit)||null}),D=de(()=>{if(!U.value.itemId)return null;const V=C.value.find(h=>h.id===U.value.itemId);return V?k(V):null}),W=de(()=>D.value!==null&&D.value<=0),L=de(()=>Array.isArray(C.value)?C.value:[]),k=V=>V.current_stock||V.stock||0,x=()=>re.value?"Memuat items...":!C.value||C.value.length===0?"Tidak ada item tersedia":"Tidak ada item yang ditemukan",q=V=>{const h=k(V);return h>50?"success":h>20?"warning":h>0?"error":"grey"},ce=V=>{const h=k(V);return h>50?"Aman":h>20?"Rendah":h>0?"Kritis":"Habis"};Ie(()=>U.value.itemId,V=>{if(V){const h=C.value.find(K=>K.id===V);h!=null&&h.unit&&(U.value.unit=h.unit)}}),Ie(()=>y.items,V=>{V&&V.length>0,w.value=[...V]},{immediate:!0}),Ie(()=>y.modelValue,V=>{V&&y.product&&G()}),ft(()=>{X()});const ke=()=>{oe.value=!0},me=()=>w.value.some(h=>{var K;return((K=h.item)==null?void 0:K.inventory)&&h.item.inventory.current_stock<h.quantity_needed})?"error":"success",Q=()=>w.value.some(h=>{var K;return((K=h.item)==null?void 0:K.inventory)&&h.item.inventory.current_stock<h.quantity_needed})?"Stok Kritis":"Stok Aman",z=()=>{if(!f.value)return;const V=C.value.find(we=>we.id===U.value.itemId);if(!V)return;if(w.value.find(we=>{var xe;return((xe=we.item)==null?void 0:xe.id)===V.id})){i.value=`Item "${V.name}" sudah ada dalam komposisi produk ini`,c.value=!0;return}const K={id_product_item:`temp_${Date.now()}`,item:{id:String(V.id),name:V.name,inventory:{current_stock:V.current_stock||0}},quantity_needed:U.value.quantity,unit:U.value.unit,is_critical:U.value.isCritical};w.value.push(K),s()},_=(V,h)=>{var xe;if(console.log("ðŸ” EditItem called with:",V),console.log("ðŸ” Item structure:",JSON.stringify(V,null,2)),C.value.length===0){console.warn("âš ï¸ Available items not loaded yet, fetching..."),X().then(()=>{console.log("âœ… Available items loaded, retrying edit"),_(V,h)});return}p.value=!0,N.value=h;let K=((xe=V.item)==null?void 0:xe.id)||null;K!==null&&(K=K.toString()),console.log("ðŸŽ¯ Found itemId (converted to string):",K),console.log("ðŸ” Available items for reference:",C.value.map(Pe=>({id:Pe.id,name:Pe.name}))),U.value={itemId:K,quantity:parseFloat(V.quantity_needed.toString())||0,unit:V.unit,isCritical:V.is_critical},console.log("ðŸ“ Form data set for edit:",{original_quantity:V.quantity_needed,parsed_quantity:parseFloat(V.quantity_needed.toString()),form_data:U.value});const we=C.value.find(Pe=>Pe.id===K);if(we)console.log("âœ… Item found in available items:",we.name);else{console.warn("âš ï¸ Item ID not found in available items, trying alternative matching...");const Pe=C.value.find(te=>{var be;return te.name===((be=V.item)==null?void 0:be.name)});Pe?(console.log("âœ… Found item by name matching, using ID:",Pe.id),U.value.itemId=Pe.id):console.error("âŒ Could not find item in available items by ID or name")}},l=()=>{if(!f.value||N.value===-1)return;const V=C.value.find(h=>h.id===U.value.itemId);V&&(w.value[N.value]={...w.value[N.value],item:{id:String(V.id),name:V.name,inventory:{current_stock:V.current_stock||0}},quantity_needed:U.value.quantity,unit:U.value.unit,is_critical:U.value.isCritical},s())},s=()=>{p.value=!1,N.value=-1,U.value={itemId:null,quantity:1,unit:"pcs",isCritical:!1}},I=V=>{w.value.splice(V,1)},ye=async()=>{var V,h,K,we,xe,Pe,te,be,M,n,A,R,Y,T,ee,se,P,ve,_e,ze,He,Me;if(y.product){v.value=!0;try{console.log("ðŸ’¾ Saving composition for product:",y.product.name),console.log("ðŸ“¦ Items to save:",w.value);const Be=parseInt(String(((V=y.product)==null?void 0:V.id_product)||((h=y.product)==null?void 0:h.id)||"0")),qe=pe.value||[],je=w.value;console.log("ðŸ”„ Comparing items for save:",{existing_count:qe.length,current_count:je.length,existing_items:qe.map(ne=>{var Se,Fe;return{id:ne.id_product_item,item_id:(Se=ne.item)==null?void 0:Se.id,item_name:(Fe=ne.item)==null?void 0:Fe.name}}),current_items:je.map(ne=>{var Se,Fe;return{id:ne.id_product_item,item_id:(Se=ne.item)==null?void 0:Se.id,item_name:(Fe=ne.item)==null?void 0:Fe.name,quantity:ne.quantity_needed,unit:ne.unit}})}),console.log("ðŸ”„ Starting to process",je.length,"items for save...");for(const ne of je){const Se=qe.find(Ye=>{var De,le;return!!(Ye.id_product_item===ne.id_product_item||ne.id_product_item&&!ne.id_product_item.toString().startsWith("temp_")&&((De=Ye.item)==null?void 0:De.id)===((le=ne.item)==null?void 0:le.id))});if(console.log("ðŸ” Processing item:",{item_name:(K=ne.item)==null?void 0:K.name,item_id_product_item:ne.id_product_item,existing_found:!!Se,existing_id:Se==null?void 0:Se.id_product_item,is_temp:(we=ne.id_product_item)==null?void 0:we.toString().startsWith("temp_"),matching_strategy:Se?Se.id_product_item===ne.id_product_item?"exact_id":"item_product_match":"no_match"}),!((xe=ne.item)!=null&&xe.id)||parseInt(ne.item.id)===0){console.warn("âš ï¸ Skipping item with invalid item_id:",{item_name:(Pe=ne.item)==null?void 0:Pe.name,item_id:(te=ne.item)==null?void 0:te.id,full_item:ne});continue}const Fe={product_id:Be,item_id:parseInt(((be=ne.item)==null?void 0:be.id)||"0"),quantity_needed:parseFloat(ne.quantity_needed.toString()),unit:ne.unit,is_critical:ne.is_critical,notes:ne.notes||""};console.log("ðŸ“¤ API Data for item:",(M=ne.item)==null?void 0:M.name,{raw_item_id:(n=ne.item)==null?void 0:n.id,parsed_item_id:parseInt(((A=ne.item)==null?void 0:A.id)||"0"),api_data:Fe,full_item_data:{id_product_item:ne.id_product_item,item_name:(R=ne.item)==null?void 0:R.name,quantity:ne.quantity_needed,unit:ne.unit}});try{Se&&!((Y=ne.id_product_item)!=null&&Y.toString().startsWith("temp_"))?(console.log("âœï¸ Updating existing item:",{id:Se.id_product_item,item_name:(T=ne.item)==null?void 0:T.name,current_stock:(se=(ee=ne.item)==null?void 0:ee.inventory)==null?void 0:se.current_stock}),await pt.update(parseInt(Se.id_product_item||"0"),Fe)):(console.log("âž• Creating new item:",{item_name:(P=ne.item)==null?void 0:P.name,current_stock:(_e=(ve=ne.item)==null?void 0:ve.inventory)==null?void 0:_e.current_stock,id_product_item:ne.id_product_item,is_temp:(ze=ne.id_product_item)==null?void 0:ze.toString().startsWith("temp_"),existing_item_found:!!Se}),await pt.create(Fe))}catch(Ye){throw console.error("âŒ Error processing item:",Ye),(He=Ye.message)!=null&&He.includes("already assigned")?i.value=`Item "${(Me=ne.item)==null?void 0:Me.name}" sudah ditambahkan ke produk ini`:i.value=Ye.message||"Terjadi kesalahan saat menyimpan item",c.value=!0,Ye}}for(const ne of qe)if(!je.find(Fe=>Fe.id_product_item===ne.id_product_item)&&ne.id_product_item)try{console.log("ðŸ—‘ï¸ Deleting item:",ne.id_product_item),await pt.delete(parseInt(ne.id_product_item))}catch(Fe){console.error("âŒ Error deleting item:",Fe),i.value=`Gagal menghapus item: ${Fe.message}`,c.value=!0}console.log("âœ… Composition saved successfully!"),j.value="Komposisi produk berhasil disimpan!",r.value=!0,u("save",{product:y.product,items:w.value}),u("refresh"),Z()}catch(Be){console.error("âŒ Error saving composition:",Be),c.value||(i.value=Be.message||"Terjadi kesalahan saat menyimpan komposisi",c.value=!0)}finally{v.value=!1}}},Z=()=>{$.value=!1,setTimeout(()=>{w.value=[...y.items],s()},300)};return(V,h)=>{var K,we,xe,Pe;return b(),ie(Ae,null,[e(Ge,{modelValue:$.value,"onUpdate:modelValue":h[9]||(h[9]=te=>$.value=te),"max-width":"900",persistent:""},{default:t(()=>[e(ue,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-between bg-primary text-white"},{default:t(()=>{var te;return[a("div",xl,[e(S,{icon:"mdi-chef-hat",size:"24"}),a("div",null,[h[13]||(h[13]=a("h3",{class:"text-h6 font-weight-bold"},"Kelola Komposisi Item",-1)),a("p",wl,d(((te=V.product)==null?void 0:te.name)||"Produk"),1)])]),e(F,{icon:"mdi-close",variant:"text",size:"small",onClick:Z})]}),_:1}),e(fe,{class:"pa-6"},{default:t(()=>[e(ue,{variant:"tonal",class:"mb-6"},{default:t(()=>[e(fe,{class:"pa-4"},{default:t(()=>{var te,be,M,n,A;return[a("div",Vl,[e(Te,{image:(te=V.product)==null?void 0:te.image_url,size:"64"},{default:t(()=>{var R;return[(R=V.product)!=null&&R.image_url?ae("",!0):(b(),O(S,{key:0,icon:"mdi-coffee"}))]}),_:1},8,["image"]),a("div",Pl,[a("h4",Cl,d((be=V.product)==null?void 0:be.name),1),a("p",Il," SKU: "+d(((M=V.product)==null?void 0:M.sku)||"SKU-"+((n=V.product)==null?void 0:n.id_product)),1),a("p",Sl," Harga: "+d(J(st)(((A=V.product)==null?void 0:A.price)||0)),1)]),e(ge,{color:me(),variant:"tonal"},{default:t(()=>[m(d(Q()),1)]),_:1},8,["color"])])]}),_:1})]),_:1}),e(ue,{class:"mb-6",elevation:"2"},{default:t(()=>[e($e,{class:"bg-grey-lighten-4 py-3"},{default:t(()=>[a("div",$l,[a("div",Dl,[e(S,{icon:p.value?"mdi-pencil-circle":"mdi-plus-circle",class:"me-2"},null,8,["icon"]),m(" "+d(p.value?"Edit Item Komposisi":"Tambah Item Komposisi"),1)])])]),_:1}),e(fe,{class:"pa-4"},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(It,{modelValue:U.value.itemId,"onUpdate:modelValue":h[0]||(h[0]=te=>U.value.itemId=te),items:L.value,loading:re.value,"item-title":"name","item-value":"id",label:"Pilih Item",placeholder:"Cari item (termasuk yang stok kosong)...","prepend-inner-icon":"mdi-magnify",variant:"outlined",clearable:"","no-data-text":x()},{item:t(({props:te,item:be})=>[e(at,Ve(te,{class:{"text-medium-emphasis":k(be.raw)<=0}}),{prepend:t(()=>[e(Te,{size:"32",class:"me-3",color:k(be.raw)<=0?"warning":"primary",variant:"tonal"},{default:t(()=>[e(S,{icon:"mdi-package-variant",color:k(be.raw)<=0?"warning":"primary"},null,8,["color"])]),_:2},1032,["color"])]),append:t(()=>[k(be.raw)>0?(b(),O(ge,{key:0,size:"x-small",color:q(be.raw),variant:"tonal"},{default:t(()=>[m(d(ce(be.raw)),1)]),_:2},1032,["color"])):(b(),O(ge,{key:1,size:"x-small",color:"warning",variant:"tonal","prepend-icon":"mdi-alert"},{default:t(()=>h[15]||(h[15]=[m(" Kosong ")])),_:1,__:[15]}))]),default:t(()=>[e(ct,null,{default:t(()=>[m(d(be.raw.name),1)]),_:2},1024),e(mt,{class:"text-medium-emphasis"},{default:t(()=>[k(be.raw)<=0?(b(),ie("span",Tl,[e(S,{icon:"mdi-alert-circle",size:"12",class:"me-1"}),h[14]||(h[14]=m(" Stok Kosong - Masih bisa digunakan "))])):(b(),ie("span",Ul," Stok: "+d(k(be.raw))+" "+d(be.raw.unit),1))]),_:2},1024)]),_:2},1040,["class"])]),_:1},8,["modelValue","items","loading","no-data-text"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Ce,{modelValue:U.value.quantity,"onUpdate:modelValue":h[1]||(h[1]=te=>U.value.quantity=te),modelModifiers:{number:!0},type:"number",label:"Jumlah",variant:"outlined",min:"0",step:"0.01"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Ce,{modelValue:U.value.unit,"onUpdate:modelValue":h[2]||(h[2]=te=>U.value.unit=te),label:"Satuan",variant:"outlined",placeholder:"kg, pcs, ml",readonly:!!g.value,hint:g.value?`Satuan dari item: ${g.value}`:"","persistent-hint":""},null,8,["modelValue","readonly","hint"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(vt,{modelValue:U.value.isCritical,"onUpdate:modelValue":h[3]||(h[3]=te=>U.value.isCritical=te),label:"Item Kritis",color:"error","hide-details":""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(F,{color:p.value?"success":"primary",block:"","prepend-icon":p.value?"mdi-check":"mdi-plus",onClick:h[4]||(h[4]=te=>p.value?l():z()),disabled:!f.value},{default:t(()=>[m(d(p.value?"Update":"Tambah"),1)]),_:1},8,["color","prepend-icon","disabled"]),p.value?(b(),O(F,{key:0,color:"error",variant:"outlined",block:"","prepend-icon":"mdi-close",class:"mt-2",onClick:s},{default:t(()=>h[16]||(h[16]=[m(" Batal ")])),_:1,__:[16]})):ae("",!0)]),_:1})]),_:1}),W.value?(b(),O(Re,{key:0,color:"warning",variant:"tonal",class:"mt-4","prepend-icon":"mdi-alert"},{default:t(()=>[e(yt,null,{default:t(()=>h[17]||(h[17]=[m("Item Stok Kosong")])),_:1,__:[17]}),h[18]||(h[18]=a("div",null,"Item yang dipilih sedang kosong stok, namun masih bisa ditambahkan ke komposisi. Pastikan untuk memperbarui stok sebelum produksi.",-1))]),_:1,__:[18]})):ae("",!0)]),_:1})]),_:1}),e(ue,{elevation:"2"},{default:t(()=>[e($e,{class:"bg-grey-lighten-4 py-3"},{default:t(()=>[e(S,{icon:"mdi-format-list-bulleted",class:"me-2"}),m(" Daftar Item Komposisi ("+d(w.value.length)+") ",1)]),_:1}),e(fe,{class:"pa-0"},{default:t(()=>[w.value.length===0?(b(),ie("div",zl,[e(S,{icon:"mdi-package-variant-closed",size:"64",class:"text-disabled mb-4"}),h[19]||(h[19]=a("h4",{class:"text-h6 mb-2"},"Belum ada item komposisi",-1)),h[20]||(h[20]=a("p",{class:"text-body-2 text-medium-emphasis"}," Tambahkan item yang dibutuhkan untuk membuat produk ini ",-1))])):(b(),O(bt,{key:1},{default:t(()=>[(b(!0),ie(Ae,null,et(w.value,(te,be)=>(b(),O(at,{key:te.id||be,class:"border-b"},{prepend:t(()=>[e(Te,{size:"40",class:"me-3"},{default:t(()=>{var M,n;return[e(S,{icon:(M=te.item)!=null&&M.inventory&&te.item.inventory.current_stock>=te.quantity_needed?"mdi-check-circle":"mdi-alert-circle",color:(n=te.item)!=null&&n.inventory&&te.item.inventory.current_stock>=te.quantity_needed?"success":"error"},null,8,["icon","color"])]}),_:2},1024)]),append:t(()=>[a("div",El,[e(F,{icon:"mdi-pencil",variant:"text",size:"small",color:"primary",onClick:M=>_(te,be)},null,8,["onClick"]),e(F,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:M=>I(be)},null,8,["onClick"])])]),default:t(()=>[e(ct,{class:"font-weight-medium"},{default:t(()=>{var M;return[m(d(((M=te.item)==null?void 0:M.name)||"Item tidak ditemukan")+" ",1),te.is_critical?(b(),O(ge,{key:0,color:"error",size:"x-small",variant:"tonal",class:"ms-2"},{default:t(()=>h[21]||(h[21]=[m(" Kritis ")])),_:1,__:[21]})):ae("",!0)]}),_:2},1024),e(mt,null,{default:t(()=>{var M;return[a("div",Al,[a("span",null,"Dibutuhkan: "+d(te.quantity_needed)+" "+d(te.unit),1),(M=te.item)!=null&&M.inventory?(b(),ie("span",{key:0,class:tt(te.item.inventory.current_stock>=te.quantity_needed?"text-success":"text-error")}," Stok: "+d(te.item.inventory.current_stock)+" "+d(te.unit),3)):ae("",!0),te.formatted_total_cost?(b(),ie("span",Ml,d(te.formatted_total_cost),1)):ae("",!0)])]}),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(Ne,{class:"pa-6 pt-0"},{default:t(()=>[e(F,{color:"warning",variant:"outlined","prepend-icon":"mdi-calculator",onClick:ke},{default:t(()=>h[22]||(h[22]=[m(" Setting HPP ")])),_:1,__:[22]}),e(Xe),e(F,{variant:"outlined",onClick:Z},{default:t(()=>h[23]||(h[23]=[m(" Batal ")])),_:1,__:[23]}),e(F,{color:"primary",onClick:ye,loading:v.value},{default:t(()=>h[24]||(h[24]=[m(" Simpan Komposisi ")])),_:1,__:[24]},8,["loading"])]),_:1})]),_:1}),e(it,{modelValue:c.value,"onUpdate:modelValue":h[6]||(h[6]=te=>c.value=te),color:"error",location:"top",timeout:5e3},{actions:t(()=>[e(F,{color:"white",variant:"text",onClick:h[5]||(h[5]=te=>c.value=!1)},{default:t(()=>h[25]||(h[25]=[m(" Tutup ")])),_:1,__:[25]})]),default:t(()=>[m(d(i.value)+" ",1)]),_:1},8,["modelValue"]),e(it,{modelValue:r.value,"onUpdate:modelValue":h[8]||(h[8]=te=>r.value=te),color:"success",location:"top",timeout:3e3},{actions:t(()=>[e(F,{color:"white",variant:"text",onClick:h[7]||(h[7]=te=>r.value=!1)},{default:t(()=>h[26]||(h[26]=[m(" Tutup ")])),_:1,__:[26]})]),default:t(()=>[m(d(j.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),e(la,{modelValue:oe.value,"onUpdate:modelValue":h[10]||(h[10]=te=>oe.value=te),"product-id":parseInt(String(((K=V.product)==null?void 0:K.id_product)||((we=V.product)==null?void 0:we.id)||"0")),"product-name":((xe=V.product)==null?void 0:xe.product_name)||((Pe=V.product)==null?void 0:Pe.name),onHppUpdated:h[11]||(h[11]=te=>u("refresh")),onPriceUpdated:h[12]||(h[12]=te=>u("refresh"))},null,8,["modelValue","product-id","product-name"])],64)}}}),Zt=Je(Hl,[["__scopeId","data-v-33220da6"]]),Bl={class:"composition-cards"},Fl={key:1,class:"text-center pa-12"},Kl={key:2,class:"text-center pa-12"},Rl={class:"d-flex align-center gap-3"},ql={class:"flex-grow-1 min-width-0"},Ol={class:"text-h6 font-weight-bold text-truncate"},Nl={class:"text-caption text-medium-emphasis mb-0"},Ll={class:"d-flex align-center gap-2 mb-3"},jl={class:"text-body-2 font-weight-medium"},Wl={class:"composition-items"},Gl={class:"d-flex align-center gap-2 flex-grow-1 min-width-0"},Xl={class:"text-body-2 text-truncate"},Jl={class:"text-end flex-shrink-0"},Yl={class:"text-body-2 font-weight-medium"},Ql={key:0,class:"text-caption text-success"},Zl={key:1,class:"text-caption text-primary"},eo={class:"d-flex justify-between align-center mb-3"},to={class:"text-h6 font-weight-bold text-primary"},ao={class:"d-flex gap-2"},lo={class:"d-flex align-center"},oo={class:"d-flex align-center gap-4"},no={class:"flex-grow-1"},so={class:"text-h5 font-weight-bold mb-2"},io={class:"d-flex align-center gap-4 mb-2"},ro={class:"text-body-2"},uo={class:"text-h6 text-primary font-weight-bold"},co={class:"d-flex align-center mt-1 gap-4"},mo={class:"d-flex align-center"},vo={class:"d-flex align-center"},fo={key:0,class:"d-flex align-center"},po={class:"text-primary font-weight-medium"},go={key:1,class:"text-center py-8"},_o={class:"text-h6 font-weight-bold"},ko={class:"text-h6 font-weight-bold"},yo={class:"text-h6 font-weight-bold"},bo=Le({__name:"ProductCompositionCards",props:{productItems:{},loading:{type:Boolean}},emits:["refresh","edit-composition","view-details"],setup(o,{emit:B}){const y=o,u=B,$=H(!1),v=H(!1),w=H(null),c=H([]),r=H(null),i=H({search:"",stockStatus:"",itemType:"",criticalOnly:!1,sortBy:"name_asc"}),j=[{title:"Semua Status",value:""},{title:"Stok Aman",value:"safe"},{title:"Stok Kritis",value:"critical"},{title:"Stok Habis",value:"out"}],p=[{title:"Nama A-Z",value:"name_asc"},{title:"Nama Z-A",value:"name_desc"},{title:"Harga Tertinggi",value:"price_desc"},{title:"Harga Terendah",value:"price_asc"},{title:"Item Terbanyak",value:"items_desc"},{title:"Item Tersedikit",value:"items_asc"}],N=L=>{w.value=L,c.value=L.items||[],$.value=!0},oe=L=>{r.value=L,v.value=!0},U=L=>{console.log("Composition saved:",L),u("refresh")},C=()=>{i.value={search:"",stockStatus:"",itemType:"",criticalOnly:!1,sortBy:"name_asc"}},re=de(()=>!!(i.value.search||i.value.stockStatus||i.value.itemType||i.value.criticalOnly||i.value.sortBy!=="name_asc")),pe=de(()=>{let L=0;return i.value.search&&L++,i.value.stockStatus&&L++,i.value.itemType&&L++,i.value.criticalOnly&&L++,i.value.sortBy!=="name_asc"&&L++,L}),G=de(()=>{const L=new Map;y.productItems.forEach(x=>{if(!x.product)return;const q=x.product.id_product||x.product.id;L.has(q)||L.set(q,{...x.product,items:[],totalItems:0}),L.get(q).items.push(x),L.get(q).totalItems++});let k=Array.from(L.values());if(i.value.search){const x=i.value.search.toLowerCase();k=k.filter(q=>q.name.toLowerCase().includes(x)||q.sku&&q.sku.toLowerCase().includes(x)||q.items.some(ce=>{var ke;return(ke=ce.item)==null?void 0:ke.name.toLowerCase().includes(x)}))}return i.value.stockStatus&&(k=k.filter(x=>{const q=X(x);switch(i.value.stockStatus){case"safe":return q.color==="success";case"critical":return q.color==="warning";case"out":return q.color==="error";default:return!0}})),i.value.criticalOnly&&(k=k.filter(x=>x.items.some(q=>q.is_critical))),k.sort((x,q)=>{switch(i.value.sortBy){case"name_asc":return x.name.localeCompare(q.name);case"name_desc":return q.name.localeCompare(x.name);case"price_asc":return(x.price||0)-(q.price||0);case"price_desc":return(q.price||0)-(x.price||0);case"items_asc":return x.totalItems-q.totalItems;case"items_desc":return q.totalItems-x.totalItems;default:return x.name.localeCompare(q.name)}}),k}),X=L=>{let k=!1,x=!1;return L.items.forEach(q=>{var ce;if((ce=q.item)!=null&&ce.inventory){const ke=q.item.inventory.current_stock||0,me=q.quantity_needed||0;ke<=0?k=!0:(ke<me||q.is_critical)&&(x=!0)}}),k?{text:"Stok Habis",color:"error"}:x?{text:"Stok Kritis",color:"warning"}:{text:"Stok Aman",color:"success"}},f=L=>{if(!(L!=null&&L.inventory))return"grey";const k=L.inventory.current_stock||0;return k<=0?"error":k<=10?"warning":"success"},g=L=>{if(!(L!=null&&L.inventory))return"Tidak ada data";const k=L.inventory.current_stock||0;return k<=0?"Habis":k<=10?"Rendah":"Aman"},D=L=>{const k=f(L);return{"text-error":k==="error","text-warning":k==="warning","text-success":k==="success","text-grey":k==="grey"}},W=L=>`Item Komposisi (${L})`;return(L,k)=>(b(),ie("div",Bl,[e(ue,{class:"mb-6"},{default:t(()=>[e($e,{class:"d-flex align-center justify-between"},{default:t(()=>[k[12]||(k[12]=a("div",null,[a("h2",{class:"text-h5 font-weight-bold"},"Komposisi Produk"),a("p",{class:"text-body-2 text-medium-emphasis"}," Kelola komposisi bahan untuk setiap produk ")],-1)),e(F,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:k[0]||(k[0]=x=>u("refresh")),loading:L.loading},{default:t(()=>k[11]||(k[11]=[m(" Refresh ")])),_:1,__:[11]},8,["loading"])]),_:1,__:[12]})]),_:1}),e(ue,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ce,{modelValue:i.value.search,"onUpdate:modelValue":k[1]||(k[1]=x=>i.value.search=x),label:"Cari Produk",placeholder:"Nama produk, SKU, atau item...",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:i.value.stockStatus,"onUpdate:modelValue":k[2]||(k[2]=x=>i.value.stockStatus=x),items:j,label:"Status Stok",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-chart-line","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:i.value.sortBy,"onUpdate:modelValue":k[3]||(k[3]=x=>i.value.sortBy=x),items:p,label:"Urutkan",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-sort","hide-details":""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3",class:"d-flex align-center"},{default:t(()=>[e(Ha,{modelValue:i.value.criticalOnly,"onUpdate:modelValue":k[4]||(k[4]=x=>i.value.criticalOnly=x),label:"Hanya Item Kritis",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(Ue,{class:"mt-3"},{default:t(()=>[e(E,{cols:"12",md:"6",class:"d-flex align-center gap-2"},{default:t(()=>[e(F,{variant:"outlined",color:"grey",size:"small","prepend-icon":"mdi-filter-off",onClick:C,disabled:!re.value},{default:t(()=>k[13]||(k[13]=[m(" Reset Filter ")])),_:1,__:[13]},8,["disabled"]),re.value?(b(),O(ge,{key:0,color:"primary",variant:"tonal",size:"small"},{default:t(()=>[m(d(pe.value)+" filter aktif ",1)]),_:1})):ae("",!0)]),_:1}),e(E,{cols:"12",md:"6",class:"d-flex align-center justify-end"},{default:t(()=>[e(ge,{color:G.value.length>0?"success":"default",variant:"tonal","prepend-icon":"mdi-package-variant"},{default:t(()=>[m(d(G.value.length)+" Produk dengan Komposisi ",1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),!L.loading&&G.value.length===0&&re.value?(b(),O(Re,{key:0,type:"info",variant:"outlined",class:"mb-6",title:"Tidak ada hasil",text:"Tidak ada produk yang sesuai dengan filter yang dipilih. Coba ubah filter pencarian."})):ae("",!0),L.loading?(b(),ie("div",Fl,[e(Nt,{color:"primary",indeterminate:"",size:"64"}),k[14]||(k[14]=a("div",{class:"mt-4 text-h6"},"Memuat komposisi...",-1))])):G.value.length===0?(b(),ie("div",Kl,[e(S,{icon:"mdi-chef-hat-off",size:"96",class:"text-disabled mb-6"}),k[16]||(k[16]=a("h3",{class:"text-h5 font-weight-bold mb-4"},"Belum Ada Komposisi Produk",-1)),k[17]||(k[17]=a("p",{class:"text-body-1 text-medium-emphasis mb-6"}," Buat komposisi untuk produk Anda agar dapat melihat detail bahan yang dibutuhkan ",-1)),e(F,{color:"primary",size:"large","prepend-icon":"mdi-plus"},{default:t(()=>k[15]||(k[15]=[m(" Buat Komposisi Pertama ")])),_:1,__:[15]})])):(b(),O(Ue,{key:3},{default:t(()=>[(b(!0),ie(Ae,null,et(G.value,x=>(b(),O(E,{key:x.id_product,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(ue,{class:tt(["composition-card h-100",{"border-error":X(x).color==="error"}]),elevation:"2"},{default:t(()=>[e($e,{class:"pa-4 pb-2"},{default:t(()=>[a("div",Rl,[e(Te,{image:x.image_url,size:"48",class:"flex-shrink-0"},{default:t(()=>[x.image_url?ae("",!0):(b(),O(S,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"]),a("div",ql,[a("h3",Ol,d(x.name),1),a("p",Nl,d(x.sku||"SKU-"+x.id_product),1)])])]),_:2},1024),e(fe,{class:"py-2"},{default:t(()=>[e(ge,{color:X(x).color,size:"small",variant:"tonal",class:"mb-3"},{default:t(()=>[m(d(X(x).text),1)]),_:2},1032,["color"]),a("div",Ll,[e(S,{icon:"mdi-format-list-bulleted",size:"16"}),a("span",jl,d(W(x.totalItems)),1)]),a("div",Wl,[(b(!0),ie(Ae,null,et(x.items,q=>{var ce,ke,me,Q;return b(),ie("div",{key:q.id_product_item,class:"composition-item d-flex align-center justify-between mb-2"},[a("div",Gl,[e(S,{icon:(ce=q.item)!=null&&ce.inventory&&q.item.inventory.current_stock>=q.quantity_needed?"mdi-check-circle":"mdi-alert-circle",color:(ke=q.item)!=null&&ke.inventory&&q.item.inventory.current_stock>=q.quantity_needed?"success":"error",size:"16"},null,8,["icon","color"]),a("span",Xl,d(((me=q.item)==null?void 0:me.name)||"Item tidak ditemukan"),1),q.is_critical?(b(),O(ge,{key:0,color:"error",size:"x-small",variant:"tonal"},{default:t(()=>k[18]||(k[18]=[m(" Kritis ")])),_:1,__:[18]})):ae("",!0)]),a("div",Jl,[a("div",Yl,d(q.quantity_needed)+" "+d(q.unit),1),(Q=q.item)!=null&&Q.inventory?(b(),ie("div",Ql," Stok: "+d(q.item.inventory.current_stock)+" "+d(q.unit),1)):ae("",!0),q.formatted_total_cost?(b(),ie("div",Zl,d(q.formatted_total_cost),1)):ae("",!0)])])}),128))])]),_:2},1024),e(fe,{class:"pt-0"},{default:t(()=>[e(Ee,{class:"mb-3"}),a("div",eo,[k[19]||(k[19]=a("span",{class:"text-body-2"},"Harga:",-1)),a("span",to,d(J(st)(x.price||0)),1)]),a("div",ao,[e(F,{color:"primary",size:"small","prepend-icon":"mdi-eye",onClick:q=>oe(x)},{default:t(()=>k[20]||(k[20]=[m(" Detail ")])),_:2,__:[20]},1032,["onClick"]),e(F,{color:"secondary",variant:"outlined",size:"small","prepend-icon":"mdi-cog",onClick:q=>N(x)},{default:t(()=>k[21]||(k[21]=[m(" Kelola ")])),_:2,__:[21]},1032,["onClick"])])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})),e(Zt,{modelValue:$.value,"onUpdate:modelValue":k[5]||(k[5]=x=>$.value=x),product:w.value,items:c.value,onSave:U,onRefresh:k[6]||(k[6]=x=>u("refresh"))},null,8,["modelValue","product","items"]),e(Ge,{modelValue:v.value,"onUpdate:modelValue":k[10]||(k[10]=x=>v.value=x),"max-width":"900",scrollable:""},{default:t(()=>[e(ue,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",lo,[e(S,{icon:"mdi-eye",class:"mr-2",color:"primary"}),k[22]||(k[22]=a("span",null,"Detail Komposisi Produk",-1))]),e(F,{icon:"",variant:"text",onClick:k[7]||(k[7]=x=>v.value=!1)},{default:t(()=>[e(S,{icon:"mdi-close"})]),_:1})]),_:1}),e(Ee),r.value?(b(),O(fe,{key:0},{default:t(()=>[e(Ba,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(ue,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(fe,null,{default:t(()=>[a("div",oo,[e(Te,{image:r.value.image_url,size:"80"},{default:t(()=>[r.value.image_url?ae("",!0):(b(),O(S,{key:0,icon:"mdi-coffee",size:"40"}))]),_:1},8,["image"]),a("div",no,[a("h2",so,d(r.value.name),1),a("div",io,[e(ge,{color:X(r.value).color,variant:"tonal",size:"small"},{default:t(()=>[m(d(X(r.value).text),1)]),_:1},8,["color"]),a("span",ro,"SKU: "+d(r.value.sku||"-"),1)]),a("div",uo,d(J(st)(r.value.price||0)),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(ue,{variant:"outlined"},{default:t(()=>[e($e,{class:"text-h6"},{default:t(()=>[e(S,{icon:"mdi-format-list-bulleted",class:"mr-2"}),m(" Komposisi Item ("+d(r.value.totalItems||0)+") ",1)]),_:1}),e(fe,null,{default:t(()=>[r.value.items&&r.value.items.length>0?(b(),O(bt,{key:0},{default:t(()=>[(b(!0),ie(Ae,null,et(r.value.items,(x,q)=>(b(),O(at,{key:x.id_product_item,class:"px-0"},{prepend:t(()=>[e(Te,{size:"40",color:f(x.item),variant:"tonal"},{default:t(()=>{var ce;return[e(S,{icon:(ce=x.item)!=null&&ce.inventory&&x.item.inventory.current_stock>=x.quantity_needed?"mdi-check":"mdi-alert"},null,8,["icon"])]}),_:2},1032,["color"])]),append:t(()=>[e(ge,{color:f(x.item),variant:"tonal",size:"small"},{default:t(()=>[m(d(g(x.item)),1)]),_:2},1032,["color"])]),default:t(()=>[e(ct,{class:"font-weight-medium"},{default:t(()=>{var ce;return[m(d(((ce=x.item)==null?void 0:ce.name)||"Unknown Item")+" ",1),x.is_critical?(b(),O(ge,{key:0,color:"error",variant:"tonal",size:"x-small",class:"ml-2"},{default:t(()=>k[23]||(k[23]=[m(" Kritis ")])),_:1,__:[23]})):ae("",!0)]}),_:2},1024),e(mt,null,{default:t(()=>{var ce,ke;return[a("div",co,[a("div",mo,[e(S,{icon:"mdi-scale",size:"14",class:"mr-1"}),a("span",null," Kebutuhan: "+d(Number(x.quantity_needed||0).toLocaleString("id-ID"))+" "+d(x.unit),1)]),a("div",vo,[e(S,{icon:"mdi-warehouse",size:"14",class:"mr-1"}),a("span",{class:tt(D(x.item))}," Stok: "+d(Number(((ke=(ce=x.item)==null?void 0:ce.inventory)==null?void 0:ke.current_stock)||0).toLocaleString("id-ID"))+" "+d(x.unit),3)]),x.formatted_total_cost?(b(),ie("div",fo,[e(S,{icon:"mdi-currency-usd",size:"14",class:"mr-1"}),a("span",po,d(x.formatted_total_cost),1)])):ae("",!0)])]}),_:2},1024),q<r.value.items.length-1?(b(),O(Ee,{key:0,class:"mt-3"})):ae("",!0)]),_:2},1024))),128))]),_:1})):(b(),ie("div",go,[e(S,{icon:"mdi-package-variant-closed",size:"48",color:"grey-lighten-1",class:"mb-2"}),k[24]||(k[24]=a("p",{class:"text-body-1 text-grey"}," Belum ada komposisi item untuk produk ini ",-1))]))]),_:1})]),_:1})]),_:1})]),_:1}),e(Ue,{class:"mt-4"},{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(ue,{variant:"outlined",color:"primary"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[e(S,{icon:"mdi-format-list-bulleted",size:"32",class:"mb-2"}),a("div",_o,d(r.value.totalItems||0),1),k[25]||(k[25]=a("div",{class:"text-body-2"},"Total Item",-1))]),_:1,__:[25]})]),_:1})]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(ue,{variant:"outlined",color:"warning"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>{var x;return[e(S,{icon:"mdi-alert",size:"32",class:"mb-2"}),a("div",ko,d(((x=r.value.items)==null?void 0:x.filter(q=>q.is_critical).length)||0),1),k[26]||(k[26]=a("div",{class:"text-body-2"},"Item Kritis",-1))]}),_:1,__:[26]})]),_:1})]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(ue,{variant:"outlined",color:"success"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[e(S,{icon:"mdi-currency-usd",size:"32",class:"mb-2"}),a("div",yo,d(J(st)(r.value.price||0)),1),k[27]||(k[27]=a("div",{class:"text-body-2"},"Harga Jual",-1))]),_:1,__:[27]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):ae("",!0),e(Ee),e(Ne,{class:"pa-4"},{default:t(()=>[e(Xe),e(F,{variant:"outlined",onClick:k[8]||(k[8]=x=>v.value=!1)},{default:t(()=>k[28]||(k[28]=[m(" Tutup ")])),_:1,__:[28]}),e(F,{color:"secondary",variant:"outlined","prepend-icon":"mdi-cog",onClick:k[9]||(k[9]=()=>{v.value=!1,N(r.value)})},{default:t(()=>k[29]||(k[29]=[m(" Kelola Komposisi ")])),_:1,__:[29]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),ho=Je(bo,[["__scopeId","data-v-8f4d44b6"]]),xo={class:"d-flex align-center gap-2"},wo={class:"text-white"},Vo={class:"text-h6 mb-4 d-flex align-center gap-2"},Po={class:"text-h6 mb-4 d-flex align-center gap-2"},Co={class:"d-flex flex-column gap-2"},Io={key:0,class:"d-flex align-center gap-2"},So={class:"d-flex align-center gap-2 mb-2"},$o={class:"d-flex gap-2"},Do={class:"d-flex gap-2"},To={class:"d-flex align-center justify-space-between"},Uo={class:"d-flex align-center gap-2"},zo={class:"text-end"},Ao={class:"text-h6 font-weight-bold"},Mo={class:"text-caption"},Eo={class:"text-h6 mb-4 d-flex align-center gap-2"},Ho={class:"text-h6 mb-4 d-flex align-center gap-2"},Bo={class:"image-upload-container"},Fo={key:0,class:"mb-4"},Ko={class:"text-center mt-2"},Ro={class:"text-h6 mb-4 d-flex align-center gap-2"},qo={class:"text-h6 mb-4 d-flex align-center gap-2"},Oo={class:"d-flex align-center"},No={class:"text-subtitle-1"},Lo={class:"text-body-1"},jo={class:"d-flex align-center"},Wo={class:"text-subtitle-1"},Go=Le({__name:"ProductDialog",props:{modelValue:{type:Boolean},editMode:{type:Boolean},formData:{},categories:{},loading:{type:Boolean},errorMessage:{},successMessage:{},selectedImage:{},imagePreview:{},useDialogError:{type:Boolean}},emits:["update:modelValue","close","submit","image-change","remove-image","clear-error","clear-success","update-form"],setup(o,{emit:B}){var Q,z,_;const y=Lt(),{nameRules:u,categoryRules:$}=jt(),{getProductHPPBreakdown:v}=oa(),w=H(!1),c=H(!1),r=async()=>{if(!(!p.editMode||!C.id))try{const l=await fetch(`/api/products/${C.id}/items`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(l.ok){const s=await l.json();c.value=s.success&&s.data&&s.data.length>0}}catch(l){console.error("Error checking HPP status:",l)}},i=async()=>{if(C.id)try{w.value=!0;const l=await v(C.id,"latest");l&&(C.cost=l.total_hpp,oe("update-form","cost",l.total_hpp))}catch(l){console.error("Error refreshing HPP:",l)}finally{w.value=!1}},j=()=>{console.log("Open items setup for product:",C.id)},p=o,N=de(()=>p.errorMessage),oe=B,U=H(),C=wt({...p.formData});Ie(()=>p.formData,l=>{Object.assign(C,l)},{deep:!0}),Ie(C,l=>{Object.keys(l).forEach(s=>{oe("update-form",s,l[s])})},{deep:!0}),Ie(()=>p.modelValue,l=>{l&&p.editMode&&r()});const re=wt({length:((Q=p.formData.dimensions)==null?void 0:Q.length)||null,width:((z=p.formData.dimensions)==null?void 0:z.width)||null,height:((_=p.formData.dimensions)==null?void 0:_.height)||null});Ie(re,l=>{const s=l.length!==null||l.width!==null||l.height!==null;C.dimensions=s?{length:l.length!==null?l.length:void 0,width:l.width!==null?l.width:void 0,height:l.height!==null?l.height:void 0}:{}},{deep:!0});const pe=[{title:"Draft",value:"draft"},{title:"Published",value:"published"},{title:"Archived",value:"archived"}],G=de(()=>{if(!C.price||!C.cost||C.cost<=0)return 0;const l=(C.price-C.cost)/C.cost*100;return Math.ceil(l)}),X=l=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),f=l=>l<10?"error":l<25?"warning":l<50?"success":"info",g=l=>l<10?"tabler-trending-down":l<25?"tabler-trending-up":l<50?"tabler-trending-up-2":"tabler-trending-up-3",D=l=>!l||l===0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),W=l=>{if(!l||l.trim()===""||l==="Rp 0")return 0;const I=l.replace(/[^\d,.-]/g,"").replace(/\./g,"").replace(",",".");return parseFloat(I)||0},L=H(!1),k=l=>{const s=W(l);C.price=s},x=()=>{L.value=!0},q=()=>{L.value=!1},ce=async()=>{var s;const{valid:l}=await((s=U.value)==null?void 0:s.validate());l&&oe("submit",C)},ke=l=>{oe("image-change",l)},me=()=>{oe("remove-image")};return(l,s)=>(b(),O(Ge,{"model-value":l.modelValue,"max-width":"900px",persistent:"",scrollable:"","onUpdate:modelValue":s[25]||(s[25]=I=>l.$emit("update:modelValue",I))},{default:t(()=>[e(ue,{class:"product-dialog coffee-dialog"},{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between coffee-header"},{default:t(()=>[a("div",xo,[e(S,{icon:l.editMode?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),a("span",wo,d(l.editMode?"Edit Produk":"Tambah Produk Baru"),1)]),e(F,{icon:"tabler-x",variant:"text",color:"white",onClick:s[0]||(s[0]=I=>l.$emit("close"))})]),_:1}),e(Ee),e(fe,{class:"pa-6"},{default:t(()=>[e(St,{ref_key:"formRef",ref:U,onSubmit:Ct(ce,["prevent"])},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[a("h6",Vo,[e(S,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),s[26]||(s[26]=m(" Informasi Dasar "))])]),_:1}),e(E,{cols:"12",md:"8"},{default:t(()=>[e(Ce,{modelValue:C.name,"onUpdate:modelValue":s[1]||(s[1]=I=>C.name=I),label:"Nama Produk",placeholder:"Masukkan nama produk",rules:J(u),required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ce,{modelValue:C.sku,"onUpdate:modelValue":s[2]||(s[2]=I=>C.sku=I),label:"SKU",placeholder:"Auto generate jika kosong",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(At,{modelValue:C.description,"onUpdate:modelValue":s[3]||(s[3]=I=>C.description=I),label:"Deskripsi Produk",placeholder:"Masukkan deskripsi produk",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Oe,{"model-value":C.category_id,"onUpdate:modelValue":s[4]||(s[4]=I=>C.category_id=I),items:l.categories,"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Pilih kategori",rules:J($),required:"",variant:"outlined"},null,8,["model-value","items","rules"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Ce,{modelValue:C.brand,"onUpdate:modelValue":s[5]||(s[5]=I=>C.brand=I),label:"Brand/Merek",placeholder:"Masukkan brand produk",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Po,[e(S,{icon:"tabler-currency-dollar",size:"20",class:"coffee-icon"}),s[27]||(s[27]=m(" Harga & Biaya "))])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Ce,{"model-value":D(C.price),"onUpdate:modelValue":s[6]||(s[6]=I=>k(I)),label:"Harga Jual",placeholder:"Rp 0",required:"",variant:"outlined",onFocus:x,onBlur:q},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[a("div",Co,[e(Ce,{"model-value":D(C.cost),label:"Harga Pokok Penjualan (HPP)",placeholder:"Auto-calculated dari bahan baku",variant:"outlined",readonly:"","append-inner-icon":"mdi-calculator",hint:"HPP dihitung otomatis berdasarkan harga bahan baku","persistent-hint":""},null,8,["model-value"]),l.editMode?(b(),ie("div",Io,[e(ge,{color:c.value?"success":"warning",size:"small",variant:"tonal"},{default:t(()=>[e(S,{icon:c.value?"tabler-calculator":"tabler-alert-circle",size:"14",class:"me-1"},null,8,["icon"]),m(" "+d(c.value?"Auto HPP Active":"Setup Required"),1)]),_:1},8,["color"]),c.value?(b(),O(F,{key:0,size:"small",variant:"outlined",color:"primary",onClick:i,loading:w.value},{default:t(()=>[e(S,{icon:"tabler-refresh",size:"14",class:"me-1"}),s[28]||(s[28]=m(" Update HPP "))]),_:1,__:[28]},8,["loading"])):(b(),O(Ke,{key:1},{activator:t(({props:I})=>[e(ge,Ve(I,{color:"warning",size:"small",variant:"tonal"}),{default:t(()=>[e(S,{icon:"tabler-alert-circle",size:"14",class:"me-1"}),s[29]||(s[29]=m(" Belum Ada Resep "))]),_:2,__:[29]},1040)]),default:t(()=>[s[30]||(s[30]=a("span",null,"Setup resep produk untuk menghitung HPP otomatis",-1))]),_:1,__:[30]}))])):ae("",!0)])]),_:1}),l.editMode?(b(),O(E,{key:0,cols:"12"},{default:t(()=>[c.value?(b(),O(Re,{key:0,color:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[e(yt,null,{default:t(()=>[e(S,{icon:"tabler-info-circle",class:"me-2"}),s[31]||(s[31]=m(" HPP Otomatis Aktif "))]),_:1,__:[31]}),s[32]||(s[32]=a("div",{class:"mt-2"}," HPP produk ini dihitung otomatis berdasarkan item/bahan yang digunakan. Untuk mengubah HPP, silakan update harga item di menu Item Management. ",-1))]),_:1,__:[32]})):(b(),O(Re,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[e(yt,null,{default:t(()=>[e(S,{icon:"tabler-alert-triangle",class:"me-2"}),s[33]||(s[33]=m(" HPP Manual "))]),_:1,__:[33]}),s[34]||(s[34]=a("div",{class:"mt-2"}," Produk ini menggunakan HPP manual. Untuk perhitungan otomatis, tambahkan item/bahan yang digunakan untuk produk ini. ",-1))]),_:1,__:[34]}))]),_:1})):ae("",!0),e(E,{cols:"12"},{default:t(()=>[c.value&&l.editMode?(b(),O(Re,{key:0,color:"success",variant:"tonal",class:"mb-4"},{default:t(()=>[a("div",So,[e(S,{icon:"tabler-check-circle"}),s[35]||(s[35]=a("span",{class:"font-weight-medium"},"HPP Otomatis Aktif",-1))]),s[38]||(s[38]=a("div",{class:"text-body-2 mb-3"}," Produk ini sudah memiliki resep dan HPP dihitung otomatis berdasarkan harga bahan baku terkini. HPP akan update secara otomatis saat harga bahan baku berubah. ",-1)),a("div",$o,[e(F,{size:"small",color:"primary",variant:"outlined",onClick:j},{default:t(()=>[e(S,{icon:"tabler-edit",size:"14",class:"me-1"}),s[36]||(s[36]=m(" Edit Resep "))]),_:1,__:[36]}),e(F,{size:"small",variant:"outlined",color:"info",onClick:i,loading:w.value},{default:t(()=>[e(S,{icon:"tabler-refresh",size:"14",class:"me-1"}),s[37]||(s[37]=m(" Refresh HPP "))]),_:1,__:[37]},8,["loading"])])]),_:1,__:[38]})):!c.value&&l.editMode?(b(),O(Re,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[a("div",Do,[e(F,{size:"small",variant:"outlined",color:"info",onClick:s[7]||(s[7]=I=>J(y).push("/hpp-management"))},{default:t(()=>[e(S,{icon:"tabler-calculator",size:"14",class:"me-1"}),s[39]||(s[39]=m(" Lihat HPP Management "))]),_:1,__:[39]})])]),_:1})):ae("",!0)]),_:1}),e(E,{cols:"12"},{default:t(()=>[C.price&&C.cost&&C.cost>0?(b(),O(Re,{key:0,color:f(G.value),variant:"tonal",class:"mb-0"},{default:t(()=>[a("div",To,[a("div",Uo,[e(S,{icon:g(G.value)},null,8,["icon"]),s[40]||(s[40]=a("span",{class:"font-weight-medium"},"Profit Margin",-1))]),a("div",zo,[a("div",Ao,d(Math.round(G.value))+"%",1),a("div",Mo," Keuntungan: "+d(X(C.price-C.cost)),1)])])]),_:1},8,["color"])):ae("",!0)]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Eo,[e(S,{icon:"tabler-ruler",size:"20",class:"coffee-icon"}),s[41]||(s[41]=m(" Dimensi (cm) "))])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ce,{modelValue:re.length,"onUpdate:modelValue":s[8]||(s[8]=I=>re.length=I),modelModifiers:{number:!0},label:"Panjang",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ce,{modelValue:re.width,"onUpdate:modelValue":s[9]||(s[9]=I=>re.width=I),modelModifiers:{number:!0},label:"Lebar",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ce,{modelValue:re.height,"onUpdate:modelValue":s[10]||(s[10]=I=>re.height=I),modelModifiers:{number:!0},label:"Tinggi",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Ho,[e(S,{icon:"tabler-photo",size:"20",class:"coffee-icon"}),s[42]||(s[42]=m(" Gambar Produk "))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("div",Bo,[l.imagePreview?(b(),ie("div",Fo,[e(Oa,{src:l.imagePreview,"max-width":"200","max-height":"200",class:"mx-auto rounded"},null,8,["src"]),a("div",Ko,[e(F,{size:"small",color:"error",variant:"outlined",onClick:me},{default:t(()=>s[43]||(s[43]=[m(" Hapus Gambar ")])),_:1,__:[43]})])])):ae("",!0),e(Na,{"model-value":l.selectedImage,"onUpdate:modelValue":s[11]||(s[11]=I=>ke(Array.isArray(I)?I:[I])),label:"Upload Gambar","prepend-icon":"tabler-camera",accept:"image/*",variant:"outlined"},null,8,["model-value"]),s[44]||(s[44]=a("div",{class:"text-caption text-medium-emphasis mt-1"}," Format: JPG, JPEG, PNG, GIF. Maksimal 2MB. ",-1))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Ro,[e(S,{icon:"tabler-settings",size:"20",class:"coffee-icon"}),s[45]||(s[45]=m(" Pengaturan "))])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Oe,{"model-value":C.status,"onUpdate:modelValue":s[12]||(s[12]=I=>C.status=I),items:pe,label:"Status Publikasi",variant:"outlined"},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(vt,{"model-value":C.active,"onUpdate:modelValue":s[13]||(s[13]=I=>C.active=I??!1),label:"Produk Aktif",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(vt,{"model-value":C.featured,"onUpdate:modelValue":s[14]||(s[14]=I=>C.featured=I??!1),label:"Produk Unggulan",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",qo,[e(S,{icon:"tabler-seo",size:"20",class:"coffee-icon"}),s[46]||(s[46]=m(" SEO (Opsional) "))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Ce,{modelValue:C.meta_title,"onUpdate:modelValue":s[15]||(s[15]=I=>C.meta_title=I),label:"Meta Title",placeholder:"Judul untuk SEO",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(At,{modelValue:C.meta_description,"onUpdate:modelValue":s[16]||(s[16]=I=>C.meta_description=I),label:"Meta Description",placeholder:"Deskripsi untuk SEO",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(vl,{"model-value":C.tags,"onUpdate:modelValue":s[17]||(s[17]=I=>C.tags=I),label:"Tags",placeholder:"Tambah tag dan tekan Enter",multiple:"",chips:"",variant:"outlined"},null,8,["model-value"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(Ee),e(Ne,{class:"pa-6"},{default:t(()=>[e(Xe),e(F,{variant:"outlined",class:"coffee-secondary",onClick:s[18]||(s[18]=I=>l.$emit("close"))},{default:t(()=>s[47]||(s[47]=[m(" Batal ")])),_:1,__:[47]}),e(F,{color:"primary",class:"coffee-primary",loading:l.loading,onClick:ce},{default:t(()=>[m(d(l.editMode?"Perbarui":"Simpan")+" Produk ",1)]),_:1},8,["loading"])]),_:1})]),_:1}),l.useDialogError?ae("",!0):(b(),O(it,{key:0,"model-value":!!N.value,"onUpdate:modelValue":s[20]||(s[20]=I=>!I&&l.$emit("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500"},{actions:t(()=>[e(F,{icon:"tabler-x",size:"small",variant:"text",onClick:s[19]||(s[19]=I=>l.$emit("clear-error"))})]),default:t(()=>[a("div",Oo,[e(S,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),a("div",null,[s[48]||(s[48]=a("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),a("div",No,d(N.value),1)])])]),_:1},8,["model-value"])),l.useDialogError?(b(),O(Ge,{key:1,"model-value":!!N.value,"onUpdate:modelValue":s[22]||(s[22]=I=>!I&&l.$emit("clear-error")),"max-width":"400",persistent:"",class:"error-dialog"},{default:t(()=>[e(ue,null,{default:t(()=>[e($e,{class:"d-flex align-center text-error"},{default:t(()=>[e(S,{icon:"tabler-alert-circle",class:"me-2"}),s[49]||(s[49]=m(" Error Occurred "))]),_:1,__:[49]}),e(Ee),e(fe,{class:"py-4"},{default:t(()=>[a("div",Lo,d(N.value),1)]),_:1}),e(Ee),e(Ne,{class:"justify-end pa-4"},{default:t(()=>[e(F,{color:"error",variant:"outlined",onClick:s[21]||(s[21]=I=>l.$emit("clear-error"))},{default:t(()=>s[50]||(s[50]=[m(" Close ")])),_:1,__:[50]})]),_:1})]),_:1})]),_:1},8,["model-value"])):ae("",!0),e(it,{"model-value":!!l.successMessage,"onUpdate:modelValue":s[24]||(s[24]=I=>!I&&l.$emit("clear-success")),color:"success",location:"top right",timeout:4e3,vertical:"","min-width":"320","max-width":"500"},{actions:t(()=>[e(F,{icon:"tabler-x",size:"small",variant:"text",onClick:s[23]||(s[23]=I=>l.$emit("clear-success"))})]),default:t(()=>[a("div",jo,[e(S,{icon:"tabler-check-circle",class:"me-3",size:"28"}),a("div",null,[s[51]||(s[51]=a("div",{class:"text-h6 font-weight-bold"},"Berhasil!",-1)),a("div",Wo,d(l.successMessage),1)])])]),_:1},8,["model-value"])]),_:1},8,["model-value"]))}}),Xo=Je(Go,[["__scopeId","data-v-66fc4b3b"]]),Jo={key:0,class:"mt-4"},Yo={class:"d-flex align-center gap-2 mb-2"},Qo={class:"d-flex flex-wrap gap-2"},Zo=Le({__name:"ProductSearchFilters",props:{filters:{}},emits:["update:filters","search"],setup(o,{emit:B}){const y=o,u=B,{categories:$,loading:v,fetchCategories:w}=La(),c=H(!1),r=H("");ft(()=>{w(),r.value=i.search||""});const i=wt({...y.filters});Ie(()=>y.filters,X=>{Object.assign(i,X),r.value=X.search||""},{deep:!0}),Ca(r,X=>{console.log("ðŸ” Search query changed:",X),i.search=X,X.length>=3||X.length===0?(console.log("âœ… Triggering search with query:",X),c.value=!0,u("search",X),U(),setTimeout(()=>{c.value=!1},500)):console.log("â³ Query too short, waiting for more characters:",X.length)},{debounce:500,maxWait:1e3});const j=[{title:"Aktif",value:"active"},{title:"Tidak Aktif",value:"inactive"}],p=[{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],N=[{title:"Terbaru",value:"desc"},{title:"Terlama",value:"asc"}],oe=de(()=>!!(r.value||i.category_id||i.active||i.stock_status||i.featured!==null||i.min_price||i.max_price)),U=()=>{u("update:filters",{...i})},C=()=>{r.value="",Object.assign(i,{search:"",category_id:null,active:null,stock_status:null,featured:null,min_price:null,max_price:null,sort_by:"created_at",sort_order:"desc"}),U()},re=X=>{const f=$.value.find(g=>g.id_category===X);return(f==null?void 0:f.name)||"Unknown"},pe=X=>{if(!X)return"Semua";const f=j.find(g=>g.value===X);return(f==null?void 0:f.title)||String(X)},G=X=>{const f=p.find(g=>g.value===X);return(f==null?void 0:f.title)||X};return(X,f)=>(b(),O(ue,{class:"mb-6"},{default:t(()=>[e($e,{class:"d-flex align-center gap-2"},{default:t(()=>[e(S,{icon:"tabler-filter",class:"coffee-icon"}),f[11]||(f[11]=m(" Filter & Pencarian Produk "))]),_:1,__:[11]}),e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ce,{modelValue:r.value,"onUpdate:modelValue":f[0]||(f[0]=g=>r.value=g),label:"Cari produk...",placeholder:"Nama, SKU, atau deskripsi (min. 3 karakter)","prepend-inner-icon":"tabler-search",loading:c.value,clearable:"",variant:"outlined",hint:r.value.length>0&&r.value.length<3?`Ketik ${3-r.value.length} karakter lagi untuk mencari`:"","persistent-hint":""},null,8,["modelValue","loading","hint"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:i.category_id,"onUpdate:modelValue":[f[1]||(f[1]=g=>i.category_id=g),U],items:J($),"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Semua kategori","prepend-inner-icon":"tabler-category",loading:J(v),clearable:"",variant:"outlined"},null,8,["modelValue","items","loading"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Oe,{modelValue:i.active,"onUpdate:modelValue":[f[2]||(f[2]=g=>i.active=g),U],items:j,label:"Status",placeholder:"Semua status","prepend-inner-icon":"tabler-toggle-left",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Oe,{modelValue:i.stock_status,"onUpdate:modelValue":[f[3]||(f[3]=g=>i.stock_status=g),U],items:p,label:"Stok",placeholder:"Semua stok","prepend-inner-icon":"tabler-package",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"1",class:"d-flex align-center"},{default:t(()=>[e(F,{icon:"tabler-refresh",variant:"outlined",color:"coffee",onClick:C})]),_:1})]),_:1}),e(Ue,{class:"mt-3"},{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ce,{modelValue:i.min_price,"onUpdate:modelValue":f[4]||(f[4]=g=>i.min_price=g),label:"Harga Minimum",placeholder:"0","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:U},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ce,{modelValue:i.max_price,"onUpdate:modelValue":f[5]||(f[5]=g=>i.max_price=g),label:"Harga Maksimum",placeholder:"Tidak terbatas","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:U},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Oe,{modelValue:i.sort_order,"onUpdate:modelValue":[f[6]||(f[6]=g=>i.sort_order=g),U],items:N,label:"Urutan",placeholder:"Terbaru","prepend-inner-icon":"tabler-arrow-up",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),oe.value?(b(),ie("div",Jo,[a("div",Yo,[e(S,{icon:"tabler-filter-check",size:"small",class:"coffee-icon"}),f[12]||(f[12]=a("span",{class:"text-sm font-weight-medium"},"Filter Aktif:",-1))]),a("div",Qo,[r.value?(b(),O(ge,{key:0,closable:"",size:"small",color:"coffee","onClick:close":f[7]||(f[7]=g=>{r.value="",i.search="",U()})},{default:t(()=>[m(" Pencarian: "+d(r.value),1)]),_:1})):ae("",!0),i.category_id?(b(),O(ge,{key:1,closable:"",size:"small",color:"coffee","onClick:close":f[8]||(f[8]=g=>{i.category_id=null,U()})},{default:t(()=>[m(" Kategori: "+d(re(i.category_id)),1)]),_:1})):ae("",!0),i.active?(b(),O(ge,{key:2,closable:"",size:"small",color:"coffee","onClick:close":f[9]||(f[9]=g=>{i.active=null,U()})},{default:t(()=>[m(" Status: "+d(pe(i.active)),1)]),_:1})):ae("",!0),i.stock_status?(b(),O(ge,{key:3,closable:"",size:"small",color:"coffee","onClick:close":f[10]||(f[10]=g=>{i.stock_status=null,U()})},{default:t(()=>[m(" Stok: "+d(G(i.stock_status)),1)]),_:1})):ae("",!0)])])):ae("",!0)]),_:1})]),_:1}))}}),en=Je(Zo,[["__scopeId","data-v-1afc3ae3"]]),tn={class:"d-flex align-center gap-2"},an={class:"text-h6"},ln={class:"d-flex align-center gap-2"},on={class:"text-h6"},nn={class:"d-flex align-center gap-2"},sn={class:"text-h6"},rn={class:"d-flex align-center gap-2"},un={class:"text-h6"},dn={class:"d-flex align-center gap-2"},cn={class:"text-h6"},mn={class:"d-flex align-center gap-2"},vn={class:"text-h6"},fn={class:"d-flex align-center gap-2"},pn={class:"text-h6"},gn={class:"d-flex align-center gap-2"},_n={class:"text-h6"},kn=Le({__name:"ProductStatsCards",props:{stats:{}},setup(o){const B=u=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(u),y=u=>`${u.toFixed(1)}%`;return(u,$)=>(b(),O(Ue,{class:"mb-6"},{default:t(()=>[e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(ue,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var v;return[e(Te,{size:"44",rounded:"",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-package"})]),_:1}),a("div",null,[$[0]||($[0]=a("span",{class:"text-sm text-medium-emphasis"},"Total Produk",-1)),a("div",tn,[a("h6",an,d(((v=u.stats)==null?void 0:v.total_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(ue,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var v;return[e(Te,{size:"44",rounded:"",color:"success",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-check"})]),_:1}),a("div",null,[$[1]||($[1]=a("span",{class:"text-sm text-medium-emphasis"},"Produk Aktif",-1)),a("div",ln,[a("h6",on,d(((v=u.stats)==null?void 0:v.active_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(ue,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var v;return[e(Te,{size:"44",rounded:"",color:"warning",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-star"})]),_:1}),a("div",null,[$[2]||($[2]=a("span",{class:"text-sm text-medium-emphasis"},"Produk Unggulan",-1)),a("div",nn,[a("h6",sn,d(((v=u.stats)==null?void 0:v.featured_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(ue,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var v;return[e(Te,{size:"44",rounded:"",color:"error",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-alert-triangle"})]),_:1}),a("div",null,[$[3]||($[3]=a("span",{class:"text-sm text-medium-emphasis"},"Stok Rendah",-1)),a("div",rn,[a("h6",un,d(((v=u.stats)==null?void 0:v.low_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(ue,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var v;return[e(Te,{size:"44",rounded:"",color:"info",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-currency-dollar"})]),_:1}),a("div",null,[$[4]||($[4]=a("span",{class:"text-sm text-medium-emphasis"},"Nilai Stok",-1)),a("div",dn,[a("h6",cn,d(B(((v=u.stats)==null?void 0:v.total_stock_value)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(ue,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var v;return[e(Te,{size:"44",rounded:"",color:"secondary",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-chart-line"})]),_:1}),a("div",null,[$[5]||($[5]=a("span",{class:"text-sm text-medium-emphasis"},"Harga Rata-rata",-1)),a("div",mn,[a("h6",vn,d(B(((v=u.stats)==null?void 0:v.average_price)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(ue,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var v;return[e(Te,{size:"44",rounded:"",color:"coffee",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-trending-up"})]),_:1}),a("div",null,[$[6]||($[6]=a("span",{class:"text-sm text-medium-emphasis"},"Margin Rata-rata",-1)),a("div",fn,[a("h6",pn,d(y(((v=u.stats)==null?void 0:v.average_margin)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(ue,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var v;return[e(Te,{size:"44",rounded:"",color:"surface",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-x-circle"})]),_:1}),a("div",null,[$[7]||($[7]=a("span",{class:"text-sm text-medium-emphasis"},"Stok Habis",-1)),a("div",gn,[a("h6",_n,d(((v=u.stats)==null?void 0:v.out_of_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1})]),_:1}))}}),yn=Je(kn,[["__scopeId","data-v-124783ae"]]),bn={class:"d-flex align-center gap-2"},hn={class:"d-flex align-center gap-2"},xn={class:"text-center py-8"},wn={class:"d-flex align-center gap-3 py-2"},Vn={class:"font-weight-medium"},Pn={class:"text-caption text-medium-emphasis"},Cn={class:"text-end"},In={class:"font-weight-medium"},Sn={key:0,class:"text-caption text-medium-emphasis"},$n={class:"text-center profit-margin-container"},Dn={class:"text-center"},Tn={key:0,class:"text-caption text-medium-emphasis mt-1"},Un={class:"d-flex align-center gap-2"},zn={class:"text-body-2"},An={class:"text-caption text-medium-emphasis"},Mn={class:"d-flex align-center gap-1"},En=Le({__name:"ProductTable",props:{products:{},totalItems:{},loading:{type:Boolean},currentPage:{},itemsPerPage:{},selectedProducts:{},toggleLoading:{}},emits:["add-product","view-product","edit-product","manage-recipes","open-recipe-dialog","open-composition-dialog","open-variant-dialog","delete-product","toggle-active","toggle-featured","bulk-delete","update:page","update:items-per-page","update:sort-by","update:selected-products"],setup(o){const B=[{title:"Produk",key:"name",sortable:!0,width:"250px"},{title:"Kategori",key:"category",sortable:!1,width:"120px"},{title:"Harga",key:"price",sortable:!0,align:"end",width:"130px"},{title:"Margin",key:"profit_margin",sortable:!0,align:"center",width:"100px"},{title:"Stok",key:"stock",sortable:!0,align:"center",width:"100px"},{title:"Status",key:"active",sortable:!0,width:"140px"},{title:"Dibuat",key:"created_at",sortable:!0,width:"120px"},{title:"Aksi",key:"actions",sortable:!1,align:"center",width:"200px"}],y=c=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(c),u=c=>new Date(c).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),$=c=>new Date(c).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),v=(c,r)=>c<=0?"error":r&&c<=r?"warning":"success",w=c=>c<10?"error":c<25?"warning":c<50?"success":"info";return(c,r)=>(b(),O(ue,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",bn,[e(S,{icon:"tabler-list",class:"coffee-icon"}),r[7]||(r[7]=m(" Data Produk ")),c.totalItems?(b(),O(ge,{key:0,size:"small",color:"coffee",variant:"tonal"},{default:t(()=>[m(d(c.totalItems)+" item ",1)]),_:1})):ae("",!0)]),a("div",hn,[c.selectedProducts.length>0?(b(),O(F,{key:0,"prepend-icon":"tabler-trash",color:"error",variant:"outlined",onClick:r[0]||(r[0]=i=>c.$emit("bulk-delete"))},{default:t(()=>[m(" Hapus Terpilih ("+d(c.selectedProducts.length)+") ",1)]),_:1})):ae("",!0),e(F,{"prepend-icon":"tabler-plus",color:"coffee",onClick:r[1]||(r[1]=i=>c.$emit("add-product"))},{default:t(()=>r[8]||(r[8]=[m(" Tambah Produk ")])),_:1,__:[8]})])]),_:1}),e(Ee),e(Za,{"model-value":c.selectedProducts,"onUpdate:modelValue":r[3]||(r[3]=i=>c.$emit("update:selected-products",i)),headers:B,items:c.products,"items-length":c.totalItems,loading:c.loading,"items-per-page":c.itemsPerPage,page:c.currentPage,"show-select":"","item-value":"id",class:"products-table","onUpdate:page":r[4]||(r[4]=i=>c.$emit("update:page",i)),"onUpdate:itemsPerPage":r[5]||(r[5]=i=>c.$emit("update:items-per-page",i)),"onUpdate:sortBy":r[6]||(r[6]=i=>c.$emit("update:sort-by",i))},{loading:t(()=>[e(el,{type:"table-row@10"})]),"no-data":t(()=>[a("div",xn,[e(S,{icon:"tabler-package-off",size:"64",class:"mb-4 text-disabled"}),r[10]||(r[10]=a("h6",{class:"text-h6 mb-2"}," Tidak ada produk ",-1)),r[11]||(r[11]=a("p",{class:"text-body-2 text-medium-emphasis mb-4"}," Belum ada produk yang ditambahkan atau sesuai dengan filter yang dipilih. ",-1)),e(F,{"prepend-icon":"tabler-plus",color:"coffee",onClick:r[2]||(r[2]=i=>c.$emit("add-product"))},{default:t(()=>r[9]||(r[9]=[m(" Tambah Produk Pertama ")])),_:1,__:[9]})])]),"item.name":t(({item:i})=>[a("div",wn,[e(Te,{image:i.image_url,size:"40",rounded:"",class:"product-avatar"},{default:t(()=>[i.image_url?ae("",!0):(b(),O(S,{key:0,icon:"tabler-package"}))]),_:2},1032,["image"]),a("div",null,[a("div",Vn,d(i.name),1),a("div",Pn," SKU: "+d(i.sku||"-"),1)])])]),"item.category":t(({item:i})=>[e(ge,{color:"coffee",size:"small",variant:"tonal"},{default:t(()=>{var j;return[m(d(((j=i.category)==null?void 0:j.name)||"-"),1)]}),_:2},1024)]),"item.price":t(({item:i})=>[a("div",Cn,[a("div",In,d(y(i.price)),1),i.cost?(b(),ie("div",Sn," HPP: "+d(y(i.cost)),1)):ae("",!0)])]),"item.profit_margin":t(({item:i})=>[a("div",$n,[i.cost&&i.cost>0&&i.profit_margin!==void 0?(b(),O(ge,{key:0,color:w(i.profit_margin),size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>[m(d(Math.round(i.profit_margin))+"% ",1)]),_:2},1032,["color"])):(b(),O(ge,{key:1,color:"grey",size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>r[12]||(r[12]=[m(" - ")])),_:1,__:[12]}))])]),"item.stock":t(({item:i})=>[a("div",Dn,[e(ge,{color:v(i.stock,i.min_stock),size:"small",variant:"tonal"},{default:t(()=>[m(d(i.stock)+" "+d(i.unit||"pcs"),1)]),_:2},1032,["color"]),i.min_stock?(b(),ie("div",Tn," Min: "+d(i.min_stock),1)):ae("",!0)])]),"item.active":t(({item:i})=>[a("div",Un,[e(ge,{color:i.active?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[m(d(i.active?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["color"]),i.featured?(b(),O(Ke,{key:0,text:"Produk Unggulan"},{activator:t(({props:j})=>[e(S,Ve(j,{icon:"tabler-star-filled",color:"warning",size:"small"}),null,16)]),_:1})):ae("",!0)])]),"item.created_at":t(({item:i})=>[a("div",zn,d(u(i.created_at??"")),1),a("div",An,d($((i==null?void 0:i.created_at)??"")),1)]),"item.actions":t(({item:i})=>[a("div",Mn,[e(Ke,{text:"Kelola Komposisi"},{activator:t(({props:j})=>[e(F,Ve(j,{icon:"tabler-chef-hat",size:"small",variant:"text",color:"primary",onClick:p=>c.$emit("open-composition-dialog",i)}),null,16,["onClick"])]),_:2},1024),e(Ke,{text:"Kelola Variant"},{activator:t(({props:j})=>[e(F,Ve(j,{icon:"tabler-versions",size:"small",variant:"text",color:"secondary",onClick:p=>c.$emit("open-variant-dialog",i)}),null,16,["onClick"])]),_:2},1024),e(Ke,{text:"Edit Produk"},{activator:t(({props:j})=>[e(F,Ve(j,{icon:"tabler-edit",size:"small",variant:"text",color:"coffee",onClick:p=>c.$emit("edit-product",i)}),null,16,["onClick"])]),_:2},1024),e(Ke,{text:i.active?"Nonaktifkan":"Aktifkan"},{activator:t(({props:j})=>{var p;return[e(F,Ve(j,{icon:i.active?"tabler-toggle-right":"tabler-toggle-left",size:"small",variant:"text",color:i.active?"success":"error",loading:((p=c.toggleLoading)==null?void 0:p[i.id_product])||!1,onClick:N=>c.$emit("toggle-active",i)}),null,16,["icon","color","loading","onClick"])]}),_:2},1032,["text"]),e(Ke,{text:i.featured?"Hapus dari Unggulan":"Jadikan Unggulan"},{activator:t(({props:j})=>[e(F,Ve(j,{icon:i.featured?"tabler-star-filled":"tabler-star",size:"small",variant:"text",color:i.featured?"warning":"default",onClick:p=>c.$emit("toggle-featured",i)}),null,16,["icon","color","onClick"])]),_:2},1032,["text"]),e(Ke,{text:"Hapus Produk"},{activator:t(({props:j})=>[e(F,Ve(j,{icon:"tabler-trash",size:"small",variant:"text",color:"error",onClick:p=>c.$emit("delete-product",i)}),null,16,["onClick"])]),_:2},1024)])]),_:1},8,["model-value","items","items-length","loading","items-per-page","page"])]),_:1}))}}),Hn=Je(En,[["__scopeId","data-v-bbf8f372"]]),Bn={class:"d-flex align-center gap-3"},Fn={class:"text-h5 font-weight-bold"},Kn={class:"text-h6"},Rn={class:"text-body-1"},qn={class:"d-flex flex-column"},On={class:"font-weight-medium"},Nn={class:"text-caption text-grey-darken-1"},Ln={class:"font-weight-medium"},jn={key:0,class:"text-caption"},Wn={key:1,class:"text-grey-lighten-1 text-caption"},Gn={class:"v-data-table__footer"},Xn={class:"pa-4 d-flex justify-space-between align-center"},Jn={class:"text-subtitle-1 font-weight-bold"},Yn={class:"text-subtitle-2 text-uppercase"},Qn={class:"text-h6 font-weight-bold my-2"},Zn={class:"text-caption"},ea=Le({__name:"HPPVariantBreakdownDialog",props:{modelValue:{type:Boolean},variantId:{},variantName:{default:""}},emits:["update:modelValue","hpp-updated","price-updated"],setup(o,{emit:B}){const y=o,u=B,$=H(!1),v=H(null),w=H(null),c=H(!1),r=H(!1),i=H("latest"),j=H(0),p=H(0),N=H(""),oe=H(0),U=H(!1),C=H(!1),re=H(""),pe=H(""),G=[{title:"Current Cost",value:"current"},{title:"Latest Purchase",value:"latest"},{title:"Average Purchase",value:"average"}],X=[{title:"Item",value:"item_name",sortable:!0},{title:"Quantity",value:"quantity_needed",align:"end"},{title:"Cost/Unit",value:"cost_per_unit",align:"end"},{title:"Total Cost",value:"total_cost",align:"end"},{title:"Priority",value:"is_critical",align:"center"},{title:"Notes",value:"notes"}],f=Q=>!Q||Q===0?"":new Intl.NumberFormat("id-ID").format(Q),g=Q=>{if(!Q)return 0;const z=Q.replace(/[^\d]/g,"");return parseInt(z)||0},D=Q=>{var _;const z=g(Q);if(p.value=z,N.value=f(z),(_=v.value)!=null&&_.total_hpp&&z>0){const l=v.value.total_hpp;j.value=l>0?Math.round((z-l)/l*100):0}else j.value=0},W=Q=>st(Q),L=async(Q,z)=>{$.value=!0;try{await new Promise(_=>setTimeout(_,500)),v.value={total_hpp:15e4,method:z,calculated_at:new Date().toISOString(),items:[{item_name:"Tepung Terigu",item_code:"TPNG001",quantity_needed:.5,unit:"kg",cost_per_unit:15e3,total_cost:7500,is_critical:!1,notes:null},{item_name:"Gula Pasir",item_code:"GUL001",quantity_needed:.25,unit:"kg",cost_per_unit:12e3,total_cost:3e3,is_critical:!1,notes:null},{item_name:"Telur Ayam",item_code:"TLR001",quantity_needed:3,unit:"pcs",cost_per_unit:3e3,total_cost:9e3,is_critical:!0,notes:"Price volatile"}]},c.value=!0}catch(_){console.error("Error loading HPP breakdown:",_),c.value=!1}finally{$.value=!1}},k=async(Q,z)=>{$.value=!0;try{if(await new Promise(_=>setTimeout(_,1e3)),v.value){switch(z){case"latest":v.value.total_hpp=Math.round(v.value.total_hpp*1.1);break;case"average":v.value.total_hpp=Math.round(v.value.total_hpp*1.05);break;default:v.value.total_hpp=Math.round(v.value.total_hpp*1.03)}v.value.calculated_at=new Date().toISOString()}}catch(_){throw _}finally{$.value=!1}},x=async(Q,z,_,l,s)=>{$.value=!0;try{return await new Promise(I=>setTimeout(I,1e3)),{data:{new_price:_,markup_percentage:v.value?Math.round((_-v.value.total_hpp)/v.value.total_hpp*100):0}}}catch(I){throw I}finally{$.value=!1}},q=async()=>{var Q,z,_;if(y.variantId)try{const l=localStorage.getItem("token"),s=await We.get(`/api/variants/${y.variantId}`,{headers:{Authorization:`Bearer ${l}`,Accept:"application/json"}});if(s.data.success&&s.data.data){const I=s.data.data;if(I.price&&I.price>0)p.value=Number(I.price),N.value=f(Number(I.price));else if((Q=v.value)!=null&&Q.total_hpp){const ye=Math.round(v.value.total_hpp*1.2);p.value=ye,N.value=f(ye)}if((z=v.value)!=null&&z.total_hpp&&p.value>0){const ye=v.value.total_hpp;j.value=ye>0?Math.round((p.value-ye)/ye*100):0}oe.value+=1}}catch(l){console.warn("Could not load target price, using default:",l),(_=v.value)!=null&&_.total_hpp&&(p.value=Math.round(v.value.total_hpp*1.2))}},ce=async()=>{y.variantId&&(await L(y.variantId,i.value),await q())},ke=async()=>{var Q,z;if(y.variantId)try{await k(y.variantId,i.value),re.value=`HPP successfully updated using ${i.value} method!`,U.value=!0,u("hpp-updated"),await ce()}catch(_){console.error("Error updating HPP:",_),pe.value=((z=(Q=_==null?void 0:_.response)==null?void 0:Q.data)==null?void 0:z.message)||"Failed to update HPP",C.value=!0}},me=async()=>{var Q,z,_,l,s,I,ye,Z,V,h;if(y.variantId&&((Q=v.value)!=null&&Q.total_hpp)&&p.value)try{const K=await x(y.variantId,i.value,p.value,!0,!0);if((z=K==null?void 0:K.data)!=null&&z.new_price){if(p.value=K.data.new_price,N.value=f(K.data.new_price),((_=K==null?void 0:K.data)==null?void 0:_.markup_percentage)!==void 0)j.value=K.data.markup_percentage;else{const we=v.value.total_hpp;j.value=we>0?Math.round((K.data.new_price-we)/we*100):0}oe.value+=1,await _t()}y.variantId&&await L(y.variantId,i.value),re.value=`Price successfully updated to ${W(((l=K==null?void 0:K.data)==null?void 0:l.new_price)||p.value)}!`,U.value=!0,u("price-updated",{variantId:y.variantId,oldPrice:(s=K==null?void 0:K.data)==null?void 0:s.old_price,newPrice:(I=K==null?void 0:K.data)==null?void 0:I.new_price,hpp:(ye=K==null?void 0:K.data)==null?void 0:ye.hpp,markupPercentage:(Z=K==null?void 0:K.data)==null?void 0:Z.markup_percentage}),console.log("âœ… Price update successful - dialog remains open for user confirmation")}catch(K){console.error("Error applying price suggestion:",K),pe.value=((h=(V=K==null?void 0:K.response)==null?void 0:V.data)==null?void 0:h.message)||"Failed to update variant price",C.value=!0}};return Ie(()=>y.modelValue,Q=>{Q&&y.variantId&&ce()}),Ie(()=>y.variantId,Q=>{Q&&y.modelValue&&ce()}),Ie(i,async()=>{y.variantId&&await ce()}),Ie([()=>{var Q;return(Q=v.value)==null?void 0:Q.total_hpp},p],()=>{var Q;if((Q=v.value)!=null&&Q.total_hpp&&p.value>0){const z=v.value.total_hpp;j.value=z>0?Math.round((p.value-z)/z*100):0}else j.value=0}),Ie(p,Q=>{Q!==g(N.value)&&(N.value=f(Q))}),(Q,z)=>(b(),ie(Ae,null,[e(Ge,{"model-value":Q.modelValue,"max-width":"1200",scrollable:"","onUpdate:modelValue":z[6]||(z[6]=_=>Q.$emit("update:modelValue",_))},{default:t(()=>[e(ue,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",Bn,[e(S,{icon:"mdi-calculator-variant",size:"24"}),a("span",null,"HPP Breakdown - "+d(Q.variantName||"Variant"),1)]),e(F,{icon:"mdi-close",size:"small",variant:"text",onClick:z[0]||(z[0]=_=>Q.$emit("update:modelValue",!1))})]),_:1}),e(fe,null,{default:t(()=>[e(Ue,{class:"mb-4"},{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>[e(Oe,{modelValue:i.value,"onUpdate:modelValue":[z[1]||(z[1]=_=>i.value=_),ce],items:G,label:"HPP Calculation Method",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(F,{color:"primary",variant:"elevated",loading:$.value,"prepend-icon":"mdi-update",block:"",onClick:ke},{default:t(()=>[m(" Update HPP with "+d(i.value),1)]),_:1},8,["loading"])]),_:1})]),_:1}),c.value?(b(),O(ue,{key:0,variant:"tonal",color:"primary",class:"mb-4"},{default:t(()=>[e(fe,null,{default:t(()=>[e(Ue,{align:"center"},{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>{var _;return[z[11]||(z[11]=a("div",{class:"text-subtitle-2"}," Total HPP ",-1)),a("div",Fn,d(W(((_=v.value)==null?void 0:_.total_hpp)||0)),1)]}),_:1,__:[11]}),e(E,{cols:"12",md:"4"},{default:t(()=>{var _;return[z[12]||(z[12]=a("div",{class:"text-subtitle-2"}," Calculation Method ",-1)),a("div",Kn,d((_=G.find(l=>{var s;return l.value===((s=v.value)==null?void 0:s.method)}))==null?void 0:_.title),1)]}),_:1,__:[12]}),e(E,{cols:"12",md:"4"},{default:t(()=>{var _;return[z[13]||(z[13]=a("div",{class:"text-subtitle-2"}," Last Calculated ",-1)),a("div",Rn,d((_=v.value)!=null&&_.calculated_at?new Date(v.value.calculated_at).toLocaleString():"-"),1)]}),_:1,__:[13]})]),_:1})]),_:1})]),_:1})):ae("",!0),c.value?(b(),O(ue,{key:1},{default:t(()=>{var _;return[e($e,null,{default:t(()=>{var l,s;return[e(S,{icon:"mdi-format-list-bulleted",class:"me-2"}),m(" Item Breakdown ("+d(((s=(l=v.value)==null?void 0:l.items)==null?void 0:s.length)||0)+" items) ",1)]}),_:1}),e(tl,{headers:X,items:((_=v.value)==null?void 0:_.items)||[],"items-per-page":10,class:"elevation-0"},{"item.item_name":t(({item:l})=>[a("div",qn,[a("span",On,d(l.item_name),1),a("span",Nn,d(l.item_code),1)])]),"item.quantity_needed":t(({item:l})=>[a("span",Ln,d(l.quantity_needed)+" "+d(l.unit),1)]),"item.cost_per_unit":t(({item:l})=>[a("span",null,d(W(l.cost_per_unit)),1)]),"item.total_cost":t(({item:l})=>[e(ge,{color:l.is_critical?"error":"primary",variant:"elevated",size:"small"},{default:t(()=>[m(d(W(l.total_cost)),1)]),_:2},1032,["color"])]),"item.is_critical":t(({item:l})=>[e(ge,{color:l.is_critical?"error":"success","prepend-icon":l.is_critical?"mdi-alert":"mdi-check",variant:"tonal",size:"small"},{default:t(()=>[m(d(l.is_critical?"Critical":"Normal"),1)]),_:2},1032,["color","prepend-icon"])]),"item.notes":t(({item:l})=>[l.notes?(b(),ie("span",jn,d(l.notes),1)):(b(),ie("span",Wn,"â€”"))]),bottom:t(()=>{var l;return[a("div",Gn,[e(Ee),a("div",Xn,[a("div",Jn," Total HPP: "+d(W(((l=v.value)==null?void 0:l.total_hpp)||0)),1),e(ge,{color:"info",variant:"elevated"},{default:t(()=>{var s,I;return[m(d(((I=(s=v.value)==null?void 0:s.items)==null?void 0:I.length)||0)+" items ",1)]}),_:1})])])]}),_:1},8,["items"])]}),_:1})):ae("",!0),c.value?(b(),O(ue,{key:2,class:"mt-4"},{default:t(()=>[e($e,null,{default:t(()=>[e(S,{icon:"mdi-cash-multiple",class:"me-2"}),z[14]||(z[14]=m(" Price Suggestion "))]),_:1,__:[14]}),e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>{var _;return[(b(),O(Ce,{key:oe.value,modelValue:N.value,"onUpdate:modelValue":[z[2]||(z[2]=l=>N.value=l),D],label:"Target Selling Price",variant:"outlined",prefix:"Rp",hint:`Current HPP: ${W(((_=v.value)==null?void 0:_.total_hpp)||0)}`,"persistent-hint":""},null,8,["modelValue","hint"]))]}),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>{var _;return[(b(),O(Ce,{key:oe.value,modelValue:j.value,"onUpdate:modelValue":z[3]||(z[3]=l=>j.value=l),label:"Markup Percentage",variant:"outlined",type:"number",min:"0",step:"5",suffix:"%",readonly:"",hint:`Profit: ${W(p.value-(((_=v.value)==null?void 0:_.total_hpp)||0))}`,"persistent-hint":""},null,8,["modelValue","hint"]))]}),_:1})]),_:1}),e(Ue,{class:"mt-2"},{default:t(()=>[e(E,{cols:"12",md:"12"},{default:t(()=>[e(F,{color:"success",variant:"elevated","prepend-icon":"mdi-check-circle",loading:$.value,disabled:!p.value||p.value<=0,block:"",onClick:me},{default:t(()=>z[15]||(z[15]=[m(" Apply Price ")])),_:1,__:[15]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})):ae("",!0),r.value?(b(),O(ue,{key:3,variant:"tonal",color:"success",class:"mt-4"},{default:t(()=>[e($e,null,{default:t(()=>[e(S,{icon:"mdi-lightbulb",class:"me-2"}),z[16]||(z[16]=m(" Price Suggestions "))]),_:1,__:[16]}),e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[(b(!0),ie(Ae,null,et(w.value.suggestions,(_,l)=>(b(),O(E,{key:l,cols:"12",md:"4"},{default:t(()=>[e(ue,{variant:"elevated"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[a("div",Yn,d(l)+" Method ",1),a("div",Qn,d(W(_.suggested_price)),1),a("div",Zn,[m(" HPP: "+d(W(_.hpp)),1),z[17]||(z[17]=a("br",null,null,-1)),m(" Markup: "+d(_.markup_percentage.toFixed(1))+"%",1),z[18]||(z[18]=a("br",null,null,-1)),m(" Margin: "+d(_.profit_margin.toFixed(1))+"% ",1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):ae("",!0),!c.value&&!$.value?(b(),O(ue,{key:4,variant:"outlined"},{default:t(()=>[e(fe,{class:"text-center py-8"},{default:t(()=>[e(S,{icon:"mdi-calculator-variant-outline",size:"64",color:"grey",class:"mb-4"}),z[20]||(z[20]=a("div",{class:"text-h6 mb-2"}," No HPP Data Available ",-1)),z[21]||(z[21]=a("div",{class:"text-body-2 text-medium-emphasis mb-4"}," Add composition items first, then calculate HPP using the method above. ",-1)),e(F,{color:"primary","prepend-icon":"mdi-plus",onClick:z[4]||(z[4]=_=>Q.$emit("update:modelValue",!1))},{default:t(()=>z[19]||(z[19]=[m(" Add Composition Items ")])),_:1,__:[19]})]),_:1,__:[20,21]})]),_:1})):ae("",!0)]),_:1}),e(Ne,{class:"pa-4"},{default:t(()=>[e(Xe),e(F,{variant:"outlined",color:"grey","prepend-icon":"mdi-close",onClick:z[5]||(z[5]=_=>Q.$emit("update:modelValue",!1))},{default:t(()=>z[22]||(z[22]=[m(" Batal ")])),_:1,__:[22]})]),_:1})]),_:1})]),_:1},8,["model-value"]),e(it,{modelValue:U.value,"onUpdate:modelValue":z[8]||(z[8]=_=>U.value=_),color:"success",location:"top"},{actions:t(()=>[e(F,{color:"white",variant:"text",onClick:z[7]||(z[7]=_=>U.value=!1)},{default:t(()=>z[23]||(z[23]=[m(" Close ")])),_:1,__:[23]})]),default:t(()=>[m(d(re.value)+" ",1)]),_:1},8,["modelValue"]),e(it,{modelValue:C.value,"onUpdate:modelValue":z[10]||(z[10]=_=>C.value=_),color:"error",location:"top"},{actions:t(()=>[e(F,{color:"white",variant:"text",onClick:z[9]||(z[9]=_=>C.value=!1)},{default:t(()=>z[24]||(z[24]=[m(" Close ")])),_:1,__:[24]})]),default:t(()=>[m(d(pe.value)+" ",1)]),_:1},8,["modelValue"])],64))}}),es={class:"d-flex align-center gap-2"},ts={class:"pa-4",style:{"background-color":"#2A2A2A"}},as={key:0,class:"d-flex align-center gap-3"},ls={class:"text-h6 text-white font-weight-bold"},os={class:"d-flex align-center gap-4 mt-1"},ns={class:"text-caption text-grey-lighten-1"},ss={class:"text-caption text-grey-lighten-1"},is={class:"pa-4 add-item-form"},rs={class:"d-flex align-center justify-space-between mb-4"},us={class:"d-flex align-center gap-2"},ds={class:"text-h6"},cs={key:0,class:"text-error"},ms={key:1},vs={class:"d-flex align-center"},fs={class:"pa-4 text-center"},ps={class:"pa-4 pt-0"},gs={class:"d-flex align-center justify-between mb-4"},_s={class:"text-h6"},ks={key:0,class:"composition-list"},ys={class:"d-flex align-center justify-between"},bs={class:"d-flex align-center gap-3"},hs={class:"font-weight-medium"},xs={class:"text-caption text-medium-emphasis"},ws={class:"font-weight-medium text-primary"},Vs={class:"d-flex align-center gap-2"},Ps={class:"text-center"},Cs={key:0,class:"text-body-2 text-medium-emphasis"},Is={class:"text-center"},Ss={class:"text-body-1 mb-2",style:{"white-space":"pre-line"}},$s=Le({__name:"AddItemCompositionDialog",props:{modelValue:{type:Boolean},variant:{}},emits:["update:modelValue","save"],setup(o,{emit:B}){const y=o,u=B,$=H(),v=H(!1),w=H(!1),c=H([]),r=H([]),i=H(!1),j=H(null),p=H(!1),N=H(null),oe=H(!1),U=H(!1),C=H(""),re=H(""),pe=H("success"),G=H(!1),X=de({get:()=>(console.log("ðŸ”µ [DEBUG] Dialog getter called, props.modelValue:",y.modelValue),y.modelValue),set:M=>{console.log("ðŸ”µ [DEBUG] Dialog setter called with value:",M),u("update:modelValue",M)}}),f=()=>({item_id:null,quantity:1,is_critical:!1}),g=H(f()),D=de(()=>!g.value.item_id||!Array.isArray(c.value)?null:c.value.find(M=>M.id_item===g.value.item_id)),W=de(()=>!D.value||i.value&&j.value!==null?null:r.value.find(M=>{var n,A;return M.name===((n=D.value)==null?void 0:n.name)||M.id&&((A=D.value)==null?void 0:A.id_item)&&M.id===D.value.id_item})),L=de(()=>{if(!D.value)return"";if(i.value&&j.value!==null)return"Mode Edit: Mengubah quantity item yang dipilih";if(W.value){const M=W.value;return`Item sudah ada dengan quantity ${M.quantity} ${M.unit}. Quantity akan ditambahkan.`}return`Stok tersedia: ${x(D.value)} ${D.value.unit}`}),k=de(()=>Array.isArray(c.value)?c.value.filter(M=>x(M)>0):[]),x=M=>{var n,A;return((n=M.inventory)==null?void 0:n.current_stock)||((A=M.inventory)==null?void 0:A.available_stock)||M.current_stock||0},q=()=>w.value?"Memuat items...":!c.value||c.value.length===0?"Tidak ada item tersedia":k.value.length===0?"Semua item sedang stok habis":"Tidak ada item yang ditemukan",ce=M=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(M),ke=M=>{switch(M){case"overstock":return"success";case"in_stock":return"primary";case"low_stock":return"warning";case"out_of_stock":return"error";default:return"grey"}},me=M=>{switch(M){case"overstock":return"Berlebih";case"in_stock":return"Tersedia";case"low_stock":return"Menipis";case"out_of_stock":return"Habis";default:return"Unknown"}},Q=(M,n,A)=>{var P,ve,_e,ze,He,Me,Be,qe;if(!n)return!0;const R=n.toLowerCase().trim(),Y=((ve=(P=A==null?void 0:A.raw)==null?void 0:P.name)==null?void 0:ve.toLowerCase())||"",T=((ze=(_e=A==null?void 0:A.raw)==null?void 0:_e.item_code)==null?void 0:ze.toLowerCase())||"",ee=((Me=(He=A==null?void 0:A.raw)==null?void 0:He.unit)==null?void 0:Me.toLowerCase())||"",se=((qe=(Be=A==null?void 0:A.raw)==null?void 0:Be.description)==null?void 0:qe.toLowerCase())||"";return Y.includes(R)||T.includes(R)||ee.includes(R)||se.includes(R)},z=async()=>{var M,n,A;w.value=!0,console.log("Loading available items...");try{const R=await We.get("/api/items?per_page=all&include=inventory");console.log("Items API response:",R.data);const Y=((n=(M=R.data)==null?void 0:M.data)==null?void 0:n.data)||((A=R.data)==null?void 0:A.data)||R.data||[];c.value=Array.isArray(Y)?Y:[],console.log("Available items loaded:",c.value.length,"items"),console.log("Sample items with inventory:",c.value.slice(0,3))}catch(R){console.error("Error loading items:",R),R!=null&&R.response&&(console.error("API Error Status:",R.response.status),console.error("API Error Data:",R.response.data)),c.value=[]}finally{w.value=!1}},_=async()=>{var M,n,A,R,Y;if(!(!((M=y.variant)!=null&&M.id)&&!((n=y.variant)!=null&&n.id_variant)))try{const T=y.variant.id||y.variant.id_variant;console.log("Loading composition items for variant:",T);const ee=await We.get(`/api/variant-items/variant/${T}`);console.log("Composition API response:",ee.data);const se=((R=(A=ee.data)==null?void 0:A.data)==null?void 0:R.composition)||((Y=ee.data)==null?void 0:Y.composition)||[];if(!Array.isArray(se)){console.warn("API response composition is not an array:",se),r.value=[];return}r.value=se.map(P=>{var ve,_e,ze,He,Me,Be,qe,je,ne,Se;return{id:P.id_variant_item||P.id,name:((ve=P.item)==null?void 0:ve.name)||P.name,quantity:parseFloat(P.quantity_needed||P.quantity||P.qty||"1"),unit:P.unit||((_e=P.item)==null?void 0:_e.unit)||"pcs",stock:((He=(ze=P.item)==null?void 0:ze.inventory)==null?void 0:He.current_stock)||((Be=(Me=P.item)==null?void 0:Me.inventory)==null?void 0:Be.available_stock)||((qe=P.item)==null?void 0:qe.current_stock)||P.stock||0,price:parseFloat(((je=P.item)==null?void 0:je.cost_per_unit)||((ne=P.item)==null?void 0:ne.price)||P.price||"0"),is_critical:P.is_critical||!1,inventory:(Se=P.item)!=null&&Se.inventory?{current_stock:P.item.inventory.current_stock||0,available_stock:P.item.inventory.available_stock||0,stock_status:P.item.inventory.stock_status||"unknown",reorder_level:P.item.inventory.reorder_level||0}:null}}),console.log("Composition items loaded:",r.value)}catch(T){console.error("Error loading composition items:",T),T!=null&&T.response&&(console.error("API Error Status:",T.response.status),console.error("API Error Data:",T.response.data)),r.value=[]}},l=async()=>{var Y,T;const{valid:M}=await $.value.validate();if(!M||!D.value)return;const n=D.value.name,A=D.value.id_item,R=g.value.quantity;if(console.log("ðŸ” Handle save - Mode:",i.value?"EDIT":"ADD"),console.log("ðŸ” Item:",n,"ID:",A),console.log("ðŸ” Quantity:",R),i.value&&j.value!==null){console.log("âœï¸ Edit mode: Updating existing item at index",j.value);const se=r.value[j.value].quantity;console.log(`ðŸ“ Updating item "${n}":`),console.log(`   - Old quantity: ${se}`),console.log(`   - New quantity: ${R}`),r.value[j.value].quantity=R,r.value[j.value].is_critical=g.value.is_critical,console.log("âœ… Item updated successfully in edit mode"),i.value=!1,j.value=null}else{console.log("âž• Add mode: Checking for existing item");const ee=r.value.findIndex(se=>se.name===n||se.id&&A&&se.id===A);if(ee!==-1){const P=r.value[ee].quantity,ve=P+R;console.log("ðŸ“¦ Item already exists! Accumulating quantity:"),console.log(`   - Item: ${n}`),console.log(`   - Old quantity: ${P}`),console.log(`   - Adding: ${R}`),console.log(`   - New quantity: ${ve}`),r.value[ee].quantity=ve}else{console.log("âž• Adding new item to composition:",n);const se={name:n,quantity:R,unit:D.value.unit,stock:((Y=D.value.inventory)==null?void 0:Y.current_stock)||((T=D.value.inventory)==null?void 0:T.available_stock)||D.value.current_stock||0,price:D.value.cost_per_unit||0,is_critical:g.value.is_critical,inventory:D.value.inventory?{current_stock:D.value.inventory.current_stock||0,available_stock:D.value.inventory.available_stock||0,stock_status:D.value.inventory.stock_status||"unknown",reorder_level:D.value.inventory.reorder_level||0}:null};r.value.push(se),console.log("âœ… New item added successfully")}}g.value=f(),console.log("ðŸ”„ Form reset")},s=(M,n)=>{console.log("ðŸ” Edit item called:",M,n);const A=c.value.find(R=>R.name===M.name||R.id_item===M.id);A?(console.log("âœ… Found item in available items:",A),i.value=!0,j.value=n,g.value={item_id:A.id_item,quantity:M.quantity,is_critical:M.is_critical||!1},console.log("ðŸ“ Edit mode activated!"),console.log("ðŸ“ Form data set:",g.value),console.log("ðŸ“ Editing item at index:",n),setTimeout(()=>{const R=document.querySelector(".add-item-form");R&&R.scrollIntoView({behavior:"smooth",block:"start"})},100)):(console.error("âŒ Could not find item in available items"),console.log("Available items:",c.value.map(R=>({id:R.id_item,name:R.name}))),console.log("Looking for item:",{id:M.id,name:M.name}))},I=()=>{console.log("âŒ Edit mode cancelled"),i.value=!1,j.value=null,g.value=f()},ye=(M,n)=>{N.value={item:M,index:n},p.value=!0},Z=async()=>{var Y,T,ee;if(!N.value)return;const{item:M,index:n}=N.value,A=M.name,R=M.id;oe.value=!0,console.log("ðŸš€ Starting delete process for:",A,"ID:",R,"Index:",n);try{R?(console.log("ðŸ—‘ï¸ Deleting item from database:",A,"with ID:",R),await We.delete(`/api/variant-items/${R}`),console.log("âœ… Item deleted from database successfully")):console.log("ðŸ“ Item has no ID, removing from local list only"),p.value=!1,N.value=null,console.log("âœ… Delete dialog closed"),console.log("ðŸ”„ Force refreshing composition list..."),await _(),console.log("âœ… Composition list refreshed from server. New count:",r.value.length),console.log("ðŸ“¡ Emitting save event to parent component..."),u("save"),console.log("âœ… Save event emitted to parent component"),console.log("ðŸŽ‰ Item successfully deleted:",A)}catch(se){console.error("âŒ Error deleting item:",se),console.error("âŒ Error details:",(Y=se.response)==null?void 0:Y.data),alert("Gagal menghapus item: "+(((ee=(T=se.response)==null?void 0:T.data)==null?void 0:ee.message)||se.message))}finally{oe.value=!1,console.log("ðŸ Delete process completed")}},V=()=>{p.value=!1,N.value=null},h=()=>{switch(pe.value){case"success":return"mdi-check-circle";case"info":return"mdi-information";case"warning":return"mdi-alert";default:return"mdi-check-circle"}},K=()=>{switch(pe.value){case"success":return"success";case"info":return"info";case"warning":return"warning";default:return"success"}},we=()=>{switch(pe.value){case"success":return"text-success";case"info":return"text-info";case"warning":return"text-warning";default:return"text-success"}},xe=()=>{switch(pe.value){case"success":return"success";case"info":return"info";case"warning":return"warning";default:return"success"}},Pe=async()=>{var M,n,A,R;if(!((M=y.variant)!=null&&M.id)&&!((n=y.variant)!=null&&n.id_variant)){console.error("No variant ID found");return}v.value=!0;try{const Y=y.variant.id||y.variant.id_variant;console.log("ðŸ” [DEBUG] Composition items count:",r.value.length),console.log("ðŸ” [DEBUG] Raw composition items:",JSON.stringify(r.value,null,2));const T=r.value.some(ee=>ee.id);if(console.log("ðŸ” [DEBUG] Has existing items:",T),T){console.log("ï¿½ [EDIT MODE] Updating existing composition");const ee={items:r.value.map(P=>{const ve=c.value.find(_e=>_e.name===P.name);return console.log(`Mapping item "${P.name}":`),console.log("  - Found item:",ve==null?void 0:ve.id_item),console.log("  - Original ID (id_variant_item):",P.id),console.log("  - Quantity:",P.quantity),console.log("  - Unit:",P.unit),console.log("  - Is critical:",P.is_critical),{id_variant_item:P.id,quantity_needed:Number(P.quantity),unit:P.unit,is_critical:P.is_critical||!1}}).filter(P=>P.id_variant_item&&P.quantity_needed>0)};console.log("Edit payload:",JSON.stringify(ee,null,2));const se=await We.post("/api/variant-items/bulk-update",ee);console.log("Composition updated successfully:",se.data)}else{console.log("âœ¨ [CREATE MODE] Creating new composition");const ee={id_variant:Y,items:r.value.map(P=>{const ve=c.value.find(_e=>_e.name===P.name);return console.log(`Mapping item "${P.name}":`),console.log("  - Found item:",ve==null?void 0:ve.id_item),console.log("  - Quantity:",P.quantity),console.log("  - Unit:",P.unit),console.log("  - Is critical:",P.is_critical),{id_item:ve==null?void 0:ve.id_item,quantity_needed:Number(P.quantity),unit:P.unit,is_critical:P.is_critical||!1}}).filter(P=>P.id_item&&P.quantity_needed>0)};console.log("Create payload:",JSON.stringify(ee,null,2));const se=await We.post("/api/variant-items/bulk-store",ee);console.log("Composition created successfully:",se.data)}u("save"),be()}catch(Y){console.error("Error saving composition:",Y),alert("Gagal menyimpan komposisi: "+(((R=(A=Y.response)==null?void 0:A.data)==null?void 0:R.message)||Y.message))}finally{v.value=!1}},te=()=>{G.value=!0},be=()=>{X.value=!1,g.value=f(),r.value=[],i.value=!1,j.value=null};return Ie(()=>y.modelValue,M=>{M?(g.value=f(),z(),_()):(i.value=!1,j.value=null)}),Ie(()=>g.value.item_id,M=>{M&&D.value&&console.log("Item selected:",D.value.name,"Unit:",D.value.unit)}),ft(()=>{z()}),(M,n)=>{var A,R,Y;return b(),ie(Ae,null,[e(Ge,{modelValue:X.value,"onUpdate:modelValue":n[3]||(n[3]=T=>X.value=T),"max-width":"1000px",persistent:""},{default:t(()=>[e(ue,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between",style:{"background-color":"#D4A574",color:"white"}},{default:t(()=>[a("div",es,[e(S,{icon:"mdi-delete",color:"white"}),n[9]||(n[9]=a("span",null,"Kelola Komposisi Item",-1))]),e(F,{icon:"mdi-close",variant:"text",color:"white",onClick:be,disabled:v.value},null,8,["disabled"])]),_:1}),e(fe,{class:"pa-0"},{default:t(()=>[a("div",ts,[M.variant?(b(),ie("div",as,[e(S,{icon:"mdi-coffee",size:"32",color:"white"}),a("div",null,[a("h3",ls,d(M.variant.name),1),a("div",os,[a("span",ns,"SKU: "+d(M.variant.sku),1),a("span",ss,"Harga: "+d(ce(M.variant.price||0)),1),e(ge,{color:"success",size:"small",variant:"tonal"},{default:t(()=>n[10]||(n[10]=[m(" Stok Aman ")])),_:1,__:[10]})])])])):ae("",!0)]),a("div",is,[a("div",rs,[a("div",us,[e(S,{icon:"mdi-plus-circle",color:"success"}),a("h4",ds,d(i.value?"Edit Item Komposisi":"Tambah Item Komposisi"),1)])]),e(St,{ref_key:"form",ref:$,onSubmit:Ct(l,["prevent"])},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(It,{modelValue:g.value.item_id,"onUpdate:modelValue":n[0]||(n[0]=T=>g.value.item_id=T),items:k.value,"item-title":"name","item-value":"id_item",label:"Pilih Item",variant:"outlined",density:"compact",rules:[T=>!!T||"Item wajib dipilih"],loading:w.value,disabled:w.value||c.value&&c.value.length===0,"no-data-text":q(),placeholder:"Ketik untuk mencari item dengan stok...",clearable:"","menu-props":{maxHeight:"300px"},"hide-details":"auto","custom-filter":Q},{"prepend-inner":t(()=>[e(S,{icon:"mdi-package",size:"16"})]),item:t(({props:T,item:ee})=>[e(at,Ve(T,{title:ee.raw.name,disabled:x(ee.raw)<=0,class:["pa-3",{"text-disabled":x(ee.raw)<=0}]}),{prepend:t(()=>[e(S,{icon:"mdi-package-variant",color:x(ee.raw)<=0?"grey-darken-2":"grey-lighten-1",class:"me-3"},null,8,["color"])]),subtitle:t(()=>[a("div",{class:tt(["text-caption",x(ee.raw)<=0?"text-disabled":"text-medium-emphasis"])},[x(ee.raw)<=0?(b(),ie("span",cs,[e(S,{icon:"mdi-alert-circle",size:"12",class:"me-1"}),n[11]||(n[11]=m(" Stok Habis "))])):(b(),ie("span",ms," Stok: "+d(x(ee.raw))+" "+d(ee.raw.unit),1))],2)]),append:t(()=>{var se;return[x(ee.raw)>0?(b(),O(ge,{key:0,size:"x-small",color:ke(((se=ee.raw.inventory)==null?void 0:se.stock_status)||ee.raw.stock_status||"unknown"),variant:"tonal"},{default:t(()=>{var P;return[m(d(me(((P=ee.raw.inventory)==null?void 0:P.stock_status)||ee.raw.stock_status||"unknown")),1)]}),_:2},1032,["color"])):(b(),O(ge,{key:1,size:"x-small",color:"error",variant:"outlined","prepend-icon":"mdi-close-circle"},{default:t(()=>n[12]||(n[12]=[m(" Habis ")])),_:1,__:[12]}))]}),_:2},1040,["title","disabled","class"])]),selection:t(({item:T})=>[a("div",vs,[e(S,{icon:"mdi-package-variant",size:"16",class:"me-2"}),a("span",null,d(T.raw.name),1)])]),"no-data":t(()=>[a("div",fs,[e(S,{icon:"mdi-magnify",size:"48",color:"grey",class:"mb-2"}),n[13]||(n[13]=a("div",{class:"text-body-2 text-medium-emphasis"}," Tidak ada item yang ditemukan ",-1)),n[14]||(n[14]=a("div",{class:"text-caption text-disabled"}," Coba kata kunci yang berbeda ",-1))])]),_:1},8,["modelValue","items","rules","loading","disabled","no-data-text"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Ce,{modelValue:g.value.quantity,"onUpdate:modelValue":n[1]||(n[1]=T=>g.value.quantity=T),modelModifiers:{number:!0},label:"Jumlah",variant:"outlined",density:"compact",type:"number",min:"0.01",step:"0.01",rules:[T=>!!T||"Jumlah wajib diisi",T=>T>0||"Jumlah harus lebih dari 0"],hint:L.value,"persistent-hint":"",color:W.value?"warning":"primary"},null,8,["modelValue","rules","hint","color"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>{var T;return[e(Ce,{"model-value":((T=D.value)==null?void 0:T.unit)||"pcs",label:"Satuan",variant:"outlined",density:"compact",readonly:"",disabled:!D.value,placeholder:"Pilih item terlebih dahulu"},{"prepend-inner":t(()=>[e(S,{icon:"mdi-weight",size:"16"})]),_:1},8,["model-value","disabled"])]}),_:1}),e(E,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[e(vt,{modelValue:g.value.is_critical,"onUpdate:modelValue":n[2]||(n[2]=T=>g.value.is_critical=T),label:"Item Kritis",color:"warning",density:"compact","true-value":!0,"false-value":!1},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2",class:"d-flex flex-column gap-2"},{default:t(()=>[e(F,{color:i.value?"primary":W.value?"warning":"#D4A574",onClick:l,loading:v.value,disabled:!g.value.item_id||!g.value.quantity,block:""},{default:t(()=>[e(S,{icon:i.value?"mdi-content-save":W.value?"mdi-plus-box-multiple":"mdi-plus",class:"me-1"},null,8,["icon"]),m(" "+d(i.value?"Update":W.value?"Akumulasi":"Tambah"),1)]),_:1},8,["color","loading","disabled"]),i.value?(b(),O(F,{key:0,color:"grey",variant:"outlined",onClick:I,size:"small",block:""},{default:t(()=>[e(S,{icon:"mdi-close",class:"me-1"}),n[15]||(n[15]=m(" Batal "))]),_:1,__:[15]})):ae("",!0)]),_:1})]),_:1})]),_:1},512)]),a("div",ps,[a("div",gs,[a("h4",_s,"Daftar Item Komposisi ("+d(r.value.length)+")",1)]),r.value.length>0?(b(),ie("div",ks,[(b(!0),ie(Ae,null,et(r.value,(T,ee)=>(b(),O(ue,{key:ee,variant:"outlined",class:"mb-3"},{default:t(()=>[e(fe,{class:"pa-3"},{default:t(()=>{var se,P,ve,_e,ze,He,Me;return[a("div",ys,[a("div",bs,[e(S,{icon:"mdi-check-circle",color:"success"}),a("div",null,[a("div",hs,d(T.name),1),a("div",xs,[a("span",ws,"Dibutuhkan: "+d(T.quantity)+" "+d(T.unit),1),n[16]||(n[16]=m(" â€¢ ")),a("span",{class:tt({"text-success":(((se=T.inventory)==null?void 0:se.current_stock)??0)>(((P=T.inventory)==null?void 0:P.reorder_level)??0),"text-warning":(((ve=T.inventory)==null?void 0:ve.current_stock)??0)<=(((_e=T.inventory)==null?void 0:_e.reorder_level)??0)&&(((ze=T.inventory)==null?void 0:ze.current_stock)??0)>0,"text-error":(((He=T.inventory)==null?void 0:He.current_stock)??0)<=0})}," Stok: "+d(((Me=T.inventory)==null?void 0:Me.current_stock)||T.stock||0)+" "+d(T.unit),3),m(" â€¢ "+d(ce(T.price)),1)])])]),a("div",Vs,[e(F,{icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:Be=>s(T,ee)},null,8,["onClick"]),e(F,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:Be=>ye(T,ee)},null,8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128))])):(b(),O(ue,{key:1,variant:"outlined",class:"text-center pa-6"},{default:t(()=>[e(S,{icon:"mdi-package-variant-closed",size:"48",color:"grey",class:"mb-3"}),n[17]||(n[17]=a("div",{class:"text-body-2 text-medium-emphasis"}," Belum ada item komposisi ditambahkan ",-1))]),_:1,__:[17]}))])]),_:1}),e(Ne,{class:"px-6 pb-6"},{default:t(()=>[e(F,{variant:"outlined",color:"secondary","prepend-icon":"mdi-wrench",onClick:te},{default:t(()=>n[18]||(n[18]=[m(" Setting HPP ")])),_:1,__:[18]}),e(Xe),e(F,{variant:"outlined",onClick:be,disabled:v.value},{default:t(()=>n[19]||(n[19]=[m(" Batal ")])),_:1,__:[19]},8,["disabled"]),e(F,{color:"#D4A574",onClick:Pe,loading:v.value,disabled:r.value.length===0},{default:t(()=>n[20]||(n[20]=[m(" Simpan Komposisi ")])),_:1,__:[20]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ea,{modelValue:G.value,"onUpdate:modelValue":n[4]||(n[4]=T=>G.value=T),"variant-id":((A=M.variant)==null?void 0:A.id)||((R=M.variant)==null?void 0:R.id_variant),"variant-name":(Y=M.variant)==null?void 0:Y.name,onHppUpdated:n[5]||(n[5]=T=>u("save"))},null,8,["modelValue","variant-id","variant-name"]),e(Ge,{modelValue:p.value,"onUpdate:modelValue":n[6]||(n[6]=T=>p.value=T),"max-width":"400px",persistent:""},{default:t(()=>[e(ue,null,{default:t(()=>[e($e,{class:"d-flex align-center justify-center text-h6 text-error"},{default:t(()=>[e(S,{icon:"mdi-alert-circle",color:"error",class:"me-2"}),n[21]||(n[21]=m(" Konfirmasi Hapus "))]),_:1,__:[21]}),e(Ee),e(fe,{class:"pa-6"},{default:t(()=>[a("div",Ps,[e(S,{icon:"mdi-delete-alert",size:"64",color:"error",class:"mb-4"}),n[24]||(n[24]=a("p",{class:"text-body-1 mb-2"}," Apakah Anda yakin ingin menghapus item ini? ",-1)),N.value?(b(),ie("div",Cs,[a("strong",null,d(N.value.item.name),1),n[22]||(n[22]=a("br",null,null,-1)),m(" Dibutuhkan: "+d(N.value.item.quantity)+" "+d(N.value.item.unit),1)])):ae("",!0),e(Re,{type:"warning",variant:"tonal",class:"mt-4 text-start"},{default:t(()=>n[23]||(n[23]=[a("strong",null,"Perhatian:",-1),m(" Item yang sudah dihapus tidak dapat dikembalikan! ")])),_:1,__:[23]})])]),_:1}),e(Ne,{class:"px-6 pb-6"},{default:t(()=>[e(F,{variant:"outlined",onClick:V,disabled:oe.value,class:"flex-grow-1"},{default:t(()=>n[25]||(n[25]=[m(" Batal ")])),_:1,__:[25]},8,["disabled"]),e(F,{color:"error",onClick:Z,loading:oe.value,class:"flex-grow-1"},{default:t(()=>n[26]||(n[26]=[m(" Hapus ")])),_:1,__:[26]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ge,{modelValue:U.value,"onUpdate:modelValue":n[8]||(n[8]=T=>U.value=T),"max-width":"450px",persistent:""},{default:t(()=>[e(ue,null,{default:t(()=>[e($e,{class:tt(["d-flex align-center justify-center text-h6",we()])},{default:t(()=>[e(S,{icon:h(),color:K(),class:"me-2",size:"24"},null,8,["icon","color"]),m(" "+d(re.value),1)]),_:1},8,["class"]),e(Ee),e(fe,{class:"pa-6"},{default:t(()=>[a("div",Is,[e(S,{icon:h(),color:K(),size:"64",class:"mb-4"},null,8,["icon","color"]),a("div",Ss,d(C.value),1),e(Re,{type:pe.value,variant:"tonal",class:"mt-4 text-start"},{default:t(()=>[pe.value==="success"?(b(),ie(Ae,{key:0},[n[27]||(n[27]=a("strong",null,"Berhasil!",-1)),n[28]||(n[28]=m(" Perubahan telah disimpan. "))],64)):pe.value==="info"?(b(),ie(Ae,{key:1},[n[29]||(n[29]=a("strong",null,"Informasi:",-1)),n[30]||(n[30]=m(" Item telah diperbarui sesuai permintaan. "))],64)):(b(),ie(Ae,{key:2},[n[31]||(n[31]=a("strong",null,"Perhatian:",-1)),n[32]||(n[32]=m(" Silakan periksa kembali informasi. "))],64))]),_:1},8,["type"])])]),_:1}),e(Ne,{class:"px-6 pb-6"},{default:t(()=>[e(Xe),e(F,{color:xe(),onClick:n[7]||(n[7]=T=>U.value=!1),class:"px-6"},{default:t(()=>[e(S,{icon:"mdi-check",class:"me-1"}),n[33]||(n[33]=m(" OK "))]),_:1,__:[33]},8,["color"]),e(Xe)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Ds=Je($s,[["__scopeId","data-v-df449ced"]]),Ts={class:"d-flex align-center gap-2"},Us={class:"mt-2"},zs={key:0,class:"mt-1 font-weight-medium"},As={key:1,class:"mt-1 text-warning"},Ms=Le({__name:"CreateVariantDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","save"],setup(o,{emit:B}){const y=o,u=B,$=H(),v=H(!1),w=H(!1),c=H([]),r=H({name:"",selectedProduct:null,selectedProductId:null,active:!0}),i=[f=>!!f||"Nama variant wajib diisi",f=>f.length>=3||"Nama variant minimal 3 karakter"],j=[f=>!!f||"Produk wajib dipilih"],p=(f,g="success")=>{const D=document.createElement("div");D.style.cssText=`
    position: fixed;
    top: 20px;
    right: 20px;
    background: ${g==="success"?"#4CAF50":"#f44336"};
    color: white;
    padding: 16px 24px;
    border-radius: 8px;
    z-index: 9999;
    font-family: 'Roboto', sans-serif;
    font-size: 14px;
    font-weight: 500;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    display: flex;
    align-items: center;
    gap: 8px;
    animation: slideIn 0.3s ease-out;
    min-width: 300px;
  `;const W=document.createElement("span");if(W.innerHTML=g==="success"?"âœ“":"âœ•",W.style.cssText=`
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: rgba(255,255,255,0.2);
    font-weight: bold;
  `,D.appendChild(W),D.appendChild(document.createTextNode(f)),!document.querySelector("#snackbar-styles")){const L=document.createElement("style");L.id="snackbar-styles",L.textContent=`
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `,document.head.appendChild(L)}document.body.appendChild(D),setTimeout(()=>{D.style.animation="slideOut 0.3s ease-in",setTimeout(()=>{D.parentNode&&D.parentNode.removeChild(D)},300)},3e3),console.log(`${g}: ${f}`)},N=async()=>{w.value=!0;try{const f=await We.get("/api/products");c.value=f.data.data||f.data||[],console.log("Fetched products:",c.value),console.log("First product structure:",c.value[0])}catch(f){console.error("Gagal mengambil data produk:",f),c.value=[]}finally{w.value=!1}},oe=f=>{!f&&c.value.length===0&&N()},U=f=>{console.log("Product object changed:",f),r.value.selectedProduct=f,f?r.value.selectedProductId=f.id:r.value.selectedProductId=null},C=de(()=>{if(console.log("Computing selected product info..."),console.log("form.selectedProduct:",r.value.selectedProduct),console.log("form.selectedProductId:",r.value.selectedProductId),r.value.selectedProduct)return console.log("Using selectedProduct object:",r.value.selectedProduct),r.value.selectedProduct;if(r.value.selectedProductId&&c.value.length>0){console.log("Searching for product with ID:",r.value.selectedProductId),console.log("Product IDs available:",c.value.map(g=>({id:g.id,name:g.name})));const f=c.value.find(g=>g.id===r.value.selectedProductId);return console.log("Found selected product by ID:",f),f}return console.log("No product selected or no products available"),null}),re=()=>{console.log("Generating SKU...");const f=C.value;if(console.log("Product info for SKU:",f),console.log("Form name:",r.value.name),console.log("Form selectedProductId:",r.value.selectedProductId),!f||!r.value.name)return console.log("Missing productInfo or name, returning empty SKU"),"";const g=f.sku||"PROD",D=r.value.name.replace(/\s+/g,"").toUpperCase().substring(0,3),W=Date.now().toString().slice(-4),L=`${g}-${D}-${W}`;return console.log("Generated SKU:",L),L},pe=async()=>{var D,W;if(v.value)return;const{valid:f}=await $.value.validate();if(!f)return;const g=C.value;if(console.log("Product info in saveVariant:",g),!g){p("Produk tidak ditemukan","error");return}if(!g.id&&!g.id_product){p("ID Produk tidak valid","error"),console.error("Product missing ID:",g);return}v.value=!0;try{const L={id_product:g.id||g.id_product,name:r.value.name,sku:re(),price:0,cost_price:null,barcode:null,variant_values:[],active:r.value.active};console.log("Payload being sent:",L),console.log("Payload JSON:",JSON.stringify(L));const k=await We.post("/api/variants",L);if(console.log("API Response:",k.data),console.log("Response Status:",k.status),k.data.success!==!1&&(k.status===200||k.status===201))p("Variant berhasil dibuat!","success"),console.log("Created variant data:",k.data.data),u("save"),X();else throw new Error(k.data.message||"Gagal membuat variant")}catch(L){const k=((W=(D=L.response)==null?void 0:D.data)==null?void 0:W.message)||L.message||"Gagal membuat variant";p(k,"error"),console.error("Save variant error:",L)}finally{v.value=!1}},G=()=>{var f;r.value={name:"",selectedProduct:null,selectedProductId:null,active:!0},(f=$.value)==null||f.resetValidation()},X=()=>{u("update:modelValue",!1),G()};return Ie(()=>y.modelValue,f=>{f&&(G(),N())}),(f,g)=>(b(),O(Ge,{"model-value":f.modelValue,"onUpdate:modelValue":g[3]||(g[3]=D=>f.$emit("update:modelValue",D)),"max-width":"600px",persistent:""},{default:t(()=>[e(ue,null,{default:t(()=>[e($e,{class:"bg-primary text-white"},{default:t(()=>[e(S,{icon:"mdi-plus-circle",class:"me-2"}),g[4]||(g[4]=m(" Tambah Variant Baru ")),e(Xe),e(F,{icon:"mdi-close",variant:"text",color:"white",onClick:X})]),_:1,__:[4]}),e(St,{ref_key:"formRef",ref:$,onSubmit:Ct(pe,["prevent"])},{default:t(()=>[e(fe,{class:"pa-6"},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(It,{modelValue:r.value.selectedProduct,"onUpdate:modelValue":[g[0]||(g[0]=D=>r.value.selectedProduct=D),U],items:c.value,loading:w.value,"item-title":"name","return-object":"",label:"Pilih Produk *",placeholder:"Cari produk...",variant:"outlined",rules:j,required:"","no-data-text":"Tidak ada produk ditemukan","onUpdate:search":oe},{item:t(({props:D,item:W})=>[e(at,Ia(Sa(D)),{prepend:t(()=>[e(Te,{image:W.raw.image_url,size:"40"},{default:t(()=>[W.raw.image_url?ae("",!0):(b(),O(S,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"])]),default:t(()=>[e(ct,null,{default:t(()=>[m(d(W.raw.name),1)]),_:2},1024),e(mt,null,{default:t(()=>[m("SKU: "+d(W.raw.sku||"-"),1)]),_:2},1024)]),_:2},1040)]),selection:t(({item:D})=>[a("div",Ts,[e(Te,{image:D.raw.image_url,size:"24"},{default:t(()=>[D.raw.image_url?ae("",!0):(b(),O(S,{key:0,icon:"mdi-coffee",size:"16"}))]),_:2},1032,["image"]),a("span",null,d(D.raw.name),1)])]),_:1},8,["modelValue","items","loading"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Ce,{modelValue:r.value.name,"onUpdate:modelValue":g[1]||(g[1]=D=>r.value.name=D),label:"Nama Variant *",placeholder:"Contoh: Large Hot, Medium Cold, dll",variant:"outlined",rules:i,required:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Re,{color:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[e(yt,null,{default:t(()=>[e(S,{icon:"mdi-information",class:"me-2"}),g[5]||(g[5]=m(" SKU Otomatis "))]),_:1,__:[5]}),a("div",Us,[g[6]||(g[6]=m(" SKU variant akan dibuat otomatis berdasarkan nama produk dan variant ")),r.value.name&&(r.value.selectedProduct||r.value.selectedProductId)?(b(),ie("div",zs," Preview SKU: "+d(re()),1)):r.value.name&&!r.value.selectedProduct&&!r.value.selectedProductId?(b(),ie("div",As," Pilih produk terlebih dahulu untuk melihat preview SKU ")):ae("",!0)])]),_:1})]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(vt,{modelValue:r.value.active,"onUpdate:modelValue":g[2]||(g[2]=D=>r.value.active=D),label:"Variant Aktif",color:"primary",inset:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Ee),e(Ne,{class:"pa-6"},{default:t(()=>[e(Xe),e(F,{variant:"outlined",onClick:X,disabled:v.value},{default:t(()=>g[7]||(g[7]=[m(" Batal ")])),_:1,__:[7]},8,["disabled"]),e(F,{type:"submit",color:"primary",loading:v.value},{default:t(()=>g[8]||(g[8]=[m(" Simpan Variant ")])),_:1,__:[8]},8,["loading"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["model-value"]))}}),Es=Je(Ms,[["__scopeId","data-v-6f78bbf1"]]),Hs={class:"product-variant-tab"},Bs={class:"d-flex gap-2"},Fs={key:0,class:"mt-4 d-flex align-center gap-2"},Ks={key:1,class:"text-center pa-12"},Rs={key:2,class:"text-center pa-12"},qs={class:"d-flex align-center gap-3"},Os={class:"flex-grow-1 min-width-0"},Ns={class:"text-h6 font-weight-bold text-truncate"},Ls={class:"text-body-2 text-medium-emphasis mb-0"},js={class:"d-flex flex-column gap-1"},Ws={class:"text-xs"},Gs={class:"d-flex align-center gap-2"},Xs={class:"text-primary font-weight-medium"},Js={class:"d-flex gap-1"},Ys={class:"d-flex align-center justify-space-between w-100"},Qs={class:"d-flex gap-1"},Zs=Le({__name:"ProductVariantTab",props:{loading:{type:Boolean}},emits:["refresh"],setup(o,{emit:B}){const y=B,u=H(!1),$=H([]),v=H(!1),w=H(!1),c=H(null),r=H(!1),i=H(!1),j=H(!1),p=H({search:"",stockStatus:"",activeStatus:null,sortBy:"name_asc"}),N=[{title:"Semua Status",value:""},{title:"Stok Aman",value:"safe"},{title:"Stok Kritis",value:"critical"},{title:"Stok Habis",value:"out"}],oe=[{title:"Nama Produk A-Z",value:"name_asc"},{title:"Nama Produk Z-A",value:"name_desc"},{title:"Variant Terbanyak",value:"variants_desc"},{title:"Variant Tersedikit",value:"variants_asc"}],U=de(()=>!!(p.value.search||p.value.stockStatus||p.value.activeStatus!==null||p.value.sortBy!=="name_asc")),C=de(()=>{const _={};return $.value.forEach(l=>{const s=l.id_product;_[s]||(_[s]={product:l.product||{id:l.id_product,id_product:l.id_product,name:`Product ${l.id_product}`,sku:""},variants:[]}),_[s].variants.push(l)}),Object.values(_)}),re=de(()=>{let _=[...C.value];if(p.value.search){const l=p.value.search.toLowerCase();_=_.filter(s=>{var I;return s.product.name.toLowerCase().includes(l)||((I=s.product.sku)==null?void 0:I.toLowerCase().includes(l))||s.variants.some(ye=>ye.name.toLowerCase().includes(l)||ye.sku.toLowerCase().includes(l))})}switch(p.value.stockStatus&&(_=_.filter(l=>l.variants.some(s=>{var ye;return(((ye=s.composition_summary)==null?void 0:ye.stock_status)||"safe")===p.value.stockStatus}))),p.value.activeStatus!==null&&(_=_.filter(l=>l.variants.some(s=>s.is_active===p.value.activeStatus))),p.value.sortBy){case"name_asc":_.sort((l,s)=>l.product.name.localeCompare(s.product.name));break;case"name_desc":_.sort((l,s)=>s.product.name.localeCompare(l.product.name));break;case"variants_desc":_.sort((l,s)=>s.variants.length-l.variants.length);break;case"variants_asc":_.sort((l,s)=>l.variants.length-s.variants.length);break}return _}),pe=(_,l="success")=>{},G=async _=>{try{console.log("ðŸ”„ Updating variant price from HPP dialog:",_);const l=$.value.findIndex(s=>s.id_variant===_.variantId);l!==-1&&($.value[l]={...$.value[l],price:_.newPrice,cost:_.hpp},console.log("âœ… Variant price updated locally without reloading")),pe(`Price updated to ${new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(_.newPrice)}`,"success")}catch(l){console.error("Error handling price update:",l),await X()}},X=async()=>{var _,l,s;u.value=!0;try{const I=await We.get("/api/variants",{params:{per_page:1e3,with_product:!0,with_composition:!0}});if(I.data.success===!1)throw new Error(I.data.message||"Failed to load variants");const ye=((_=I.data.data)==null?void 0:_.data)||I.data.data||[];$.value=ye.map(Z=>({...Z,is_active:Z.active!==void 0?Z.active:Z.is_active,id:Z.id_variant||Z.id,id_product:Z.id_product||Z.product_id}))}catch(I){(s=(l=I.response)==null?void 0:l.data)!=null&&s.message||I.message,$.value=[]}finally{u.value=!1}},f=_=>{c.value=_,r.value=!0},g=_=>{_&&(c.value=_,i.value=!0)},D=_=>{c.value=_,v.value=!0},W=()=>{j.value=!0},L=async()=>{var _,l;if(c.value)try{w.value=!0,await We.delete(`/api/variants/${c.value.id_variant}`),pe("Variant berhasil dihapus","success"),await X(),v.value=!1}catch(s){(l=(_=s.response)==null?void 0:_.data)!=null&&l.message}finally{w.value=!1}},k=_=>{switch(_){case"critical":return"error";case"out":return"error";case"safe":return"success";default:return"primary"}},x=_=>{switch(_){case"critical":return"Kritis";case"out":return"Habis";case"safe":return"Aman";default:return"Normal"}},q=_=>{const l=_.filter(s=>s.is_active).length;return l===0?"error":l===_.length?"success":"warning"},ce=_=>_.some(l=>{var I;const s=(I=l.composition_summary)==null?void 0:I.stock_status;return s==="critical"||s==="out"}),ke=_=>{const l=_.filter(I=>I.is_active).length,s=_.filter(I=>{var Z;const ye=(Z=I.composition_summary)==null?void 0:Z.stock_status;return ye==="critical"||ye==="out"}).length;return s>0?{text:`${s} Stok Kritis`,color:"error",icon:"mdi-alert-circle"}:l===_.length?{text:"Semua Aktif",color:"success",icon:"mdi-check-circle"}:l===0?{text:"Semua Nonaktif",color:"error",icon:"mdi-close-circle"}:{text:`${l}/${_.length} Aktif`,color:"warning",icon:"mdi-minus-circle"}},me=()=>{p.value={search:"",stockStatus:"",activeStatus:null,sortBy:"name_asc"}},Q=()=>{X(),y("refresh")},z=()=>{console.log("Variant created, refreshing data..."),X(),y("refresh")};return ft(()=>{X()}),(_,l)=>{var s,I,ye;return b(),ie("div",Hs,[e(ue,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e($e,{class:"d-flex align-center justify-space-between"},{default:t(()=>[l[14]||(l[14]=a("div",null,[a("h2",{class:"text-h5 font-weight-bold"},"Variant Produk"),a("p",{class:"text-body-2 text-medium-emphasis"}," Kelola variant dan komposisi untuk produk Anda ")],-1)),a("div",Bs,[e(F,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:X,loading:u.value},{default:t(()=>l[12]||(l[12]=[m(" Refresh ")])),_:1,__:[12]},8,["loading"]),e(F,{color:"primary","prepend-icon":"mdi-plus",onClick:W},{default:t(()=>l[13]||(l[13]=[m(" Tambah Variant ")])),_:1,__:[13]})])]),_:1,__:[14]})]),_:1}),e(ue,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ce,{modelValue:p.value.search,"onUpdate:modelValue":l[0]||(l[0]=Z=>p.value.search=Z),label:"Cari Variant",placeholder:"Nama variant, SKU, atau produk...",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:p.value.stockStatus,"onUpdate:modelValue":l[1]||(l[1]=Z=>p.value.stockStatus=Z),items:N,label:"Status Stok",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:p.value.activeStatus,"onUpdate:modelValue":l[2]||(l[2]=Z=>p.value.activeStatus=Z),items:[{title:"Semua Status",value:null},{title:"Aktif",value:!0},{title:"Nonaktif",value:!1}],label:"Status Aktif",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:p.value.sortBy,"onUpdate:modelValue":l[3]||(l[3]=Z=>p.value.sortBy=Z),items:oe,label:"Urutkan",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),U.value?(b(),ie("div",Fs,[l[16]||(l[16]=a("span",{class:"text-body-2"},"Filter aktif:",-1)),p.value.search?(b(),O(ge,{key:0,size:"small",closable:"","onClick:close":l[4]||(l[4]=Z=>p.value.search="")},{default:t(()=>[m(" Pencarian: "+d(p.value.search),1)]),_:1})):ae("",!0),p.value.stockStatus?(b(),O(ge,{key:1,size:"small",closable:"","onClick:close":l[5]||(l[5]=Z=>p.value.stockStatus="")},{default:t(()=>{var Z;return[m(" Stok: "+d((Z=N.find(V=>V.value===p.value.stockStatus))==null?void 0:Z.title),1)]}),_:1})):ae("",!0),p.value.activeStatus!==null?(b(),O(ge,{key:2,size:"small",closable:"","onClick:close":l[6]||(l[6]=Z=>p.value.activeStatus=null)},{default:t(()=>[m(" Status: "+d(p.value.activeStatus?"Aktif":"Nonaktif"),1)]),_:1})):ae("",!0),e(F,{variant:"text",size:"small",color:"error",onClick:me},{default:t(()=>l[15]||(l[15]=[m(" Hapus Semua Filter ")])),_:1,__:[15]})])):ae("",!0)]),_:1})]),_:1}),!u.value&&re.value.length===0&&U.value?(b(),O(Re,{key:0,type:"info",variant:"outlined",class:"mb-6",title:"Tidak ada hasil",text:"Tidak ada variant yang sesuai dengan filter yang dipilih. Coba ubah filter pencarian."})):ae("",!0),u.value?(b(),ie("div",Ks,[e(Nt,{color:"primary",indeterminate:"",size:"64"}),l[17]||(l[17]=a("div",{class:"mt-4 text-h6"},"Memuat variant...",-1))])):C.value.length===0?(b(),ie("div",Rs,[e(S,{icon:"mdi-tune-variant",size:"96",class:"text-disabled mb-6"}),l[19]||(l[19]=a("h3",{class:"text-h5 font-weight-bold mb-4"},"Belum Ada Variant Produk",-1)),l[20]||(l[20]=a("p",{class:"text-body-1 text-medium-emphasis mb-6"}," Buat variant untuk produk Anda agar dapat menawarkan pilihan yang beragam ",-1)),e(F,{color:"primary",size:"large","prepend-icon":"mdi-plus",onClick:W},{default:t(()=>l[18]||(l[18]=[m(" Buat Variant Pertama ")])),_:1,__:[18]})])):(b(),O(Ue,{key:3},{default:t(()=>[(b(!0),ie(Ae,null,et(re.value,Z=>(b(),O(E,{key:Z.product.id_product,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(ue,{class:tt(["variant-group-card h-100",{"border-error":ce(Z.variants)}]),elevation:"2"},{default:t(()=>[e($e,{class:"pa-4 pb-2"},{default:t(()=>[a("div",qs,[e(Te,{image:Z.product.image_url,size:"48",class:"flex-shrink-0"},{default:t(()=>[Z.product.image_url?ae("",!0):(b(),O(S,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"]),a("div",Os,[a("h3",Ns,d(Z.product.name),1),a("p",Ls," SKU: "+d(Z.product.sku||"-"),1)]),e(ge,{color:q(Z.variants),size:"small",variant:"tonal"},{default:t(()=>[m(d(Z.variants.length)+" Variant ",1)]),_:2},1032,["color"])])]),_:2},1024),e(Ee),e(fe,{class:"pa-4"},{default:t(()=>[e(bt,{class:"pa-0"},{default:t(()=>[(b(!0),ie(Ae,null,et(Z.variants,(V,h)=>(b(),O(at,{key:V.id_variant,class:tt(["pa-2 rounded-lg variant-item",{"mb-2":h<Z.variants.length-1}])},{prepend:t(()=>[e(Te,{size:"32",color:V.is_active?"success":"error",variant:"tonal"},{default:t(()=>[e(S,{icon:V.is_active?"mdi-check":"mdi-close",size:"16"},null,8,["icon"])]),_:2},1032,["color"])]),append:t(()=>[a("div",Js,[e(Ke,{text:"Kelola Komposisi"},{activator:t(({props:K})=>[e(F,Ve({ref_for:!0},K,{icon:"mdi-chef-hat",size:"small",variant:"text",color:"primary",onClick:we=>f(V)}),null,16,["onClick"])]),_:2},1024),e(Ke,{text:"Hapus Variant"},{activator:t(({props:K})=>[e(F,Ve({ref_for:!0},K,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:we=>D(V)}),null,16,["onClick"])]),_:2},1024)])]),default:t(()=>[e(ct,{class:"text-sm font-weight-medium"},{default:t(()=>[m(d(V.name),1)]),_:2},1024),e(mt,null,{default:t(()=>[a("div",js,[a("span",Ws,"SKU: "+d(V.sku),1),a("div",Gs,[a("span",Xs,d(J(st)(V.price||0)),1),V.composition_summary?(b(),O(ge,{key:0,color:k(V.composition_summary.stock_status),size:"x-small",variant:"tonal"},{default:t(()=>[m(d(x(V.composition_summary.stock_status)),1)]),_:2},1032,["color"])):ae("",!0)])])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:2},1024)]),_:2},1024),e(Ee),e(Ne,{class:"pa-4"},{default:t(()=>[a("div",Ys,[a("div",null,[e(ge,{color:ke(Z.variants).color,size:"small",variant:"tonal"},{default:t(()=>[e(S,{icon:ke(Z.variants).icon,size:"14",class:"me-1"},null,8,["icon"]),m(" "+d(ke(Z.variants).text),1)]),_:2},1032,["color"])]),a("div",Qs,[e(Ke,{text:"Setting HPP Produk"},{activator:t(({props:V})=>[e(F,Ve({ref_for:!0},V,{icon:"mdi-calculator-variant",size:"small",variant:"text",color:"warning",onClick:h=>g(Z.variants[0])}),null,16,["onClick"])]),_:2},1024),e(Ke,{text:"Tambah Variant"},{activator:t(({props:V})=>[e(F,Ve({ref_for:!0},V,{icon:"mdi-plus",size:"small",variant:"text",color:"primary",onClick:W}),null,16)]),_:1}),e(Ke,{text:"Pengaturan Produk (Coming Soon)"},{activator:t(({props:V})=>[e(F,Ve({ref_for:!0},V,{icon:"mdi-cog",size:"small",variant:"text",color:"secondary",disabled:""}),null,16)]),_:1})])])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})),e(Ds,{modelValue:r.value,"onUpdate:modelValue":l[7]||(l[7]=Z=>r.value=Z),variant:c.value,onSave:Q},null,8,["modelValue","variant"]),e(ea,{modelValue:i.value,"onUpdate:modelValue":l[8]||(l[8]=Z=>i.value=Z),"variant-id":(s=c.value)==null?void 0:s.id_variant,"variant-name":(I=c.value)==null?void 0:I.name,onHppUpdated:X,onPriceUpdated:G},null,8,["modelValue","variant-id","variant-name"]),e(Es,{modelValue:j.value,"onUpdate:modelValue":l[9]||(l[9]=Z=>j.value=Z),onSave:z},null,8,["modelValue"]),e(Et,{modelValue:v.value,"onUpdate:modelValue":l[10]||(l[10]=Z=>v.value=Z),title:"Konfirmasi Hapus Variant","item-name":(ye=c.value)==null?void 0:ye.name,loading:w.value,"confirm-text":"Hapus Variant",onConfirm:L,onCancel:l[11]||(l[11]=Z=>v.value=!1)},null,8,["modelValue","item-name","loading"])])}}}),Mt=Je(Zs,[["__scopeId","data-v-edd5278d"]]),ei={class:"product-management"},ti={class:"d-flex justify-space-between align-center mb-6"},ai={class:"d-flex gap-3 align-center"},li={key:0,class:"d-flex gap-2"},oi={class:"d-flex align-center"},ni=Le({__name:"products-management",setup(o){Lt();const{productsList:B,categories:y,loading:u,saveLoading:$,deleteLoading:v,toggleLoading:w,stats:c,dialog:r,deleteDialog:i,editMode:j,selectedProduct:p,selectedProducts:N,currentPage:oe,totalItems:U,itemsPerPage:C,filters:re,errorMessage:pe,successMessage:G,modalErrorMessage:X,formData:f,selectedImage:g,imagePreview:D,canCreateEdit:W,hasSelectedProducts:L,fetchProductsList:k,fetchCategories:x,fetchStats:q,saveProduct:ce,deleteProduct:ke,bulkDeleteProducts:me,toggleActiveStatus:Q,toggleFeaturedStatus:z,openCreateDialog:_,openEditDialog:l,openDeleteDialog:s,closeDialog:I,handleImageUpload:ye,clearModalError:Z,onPageChange:V}=jt(),{dialog:h,editMode:K,formData:we,availableItems:xe,saveLoading:Pe,modalErrorMessage:te,openCreateDialog:be,closeDialog:M,saveRecipe:n,clearModalError:A,fetchAvailableItems:R}=Fa(),{productItemsList:Y,loading:T,fetchProductItemsForComposition:ee}=ta(),se=H("products"),P=H(!1),ve=H(null),_e=H(!1),ze=H(null),He=async()=>{await ke()},Me=async()=>{await me()},Be=De=>{const le=De.id_product||De.id;be(le)},qe=async De=>{ve.value=De;try{await ee({page:1,per_page:50,critical_only:!1})}catch{}P.value=!0},je=De=>{ze.value=De,_e.value=!0},ne=De=>{if(!De)return[];const le=De.id_product||De.id;return Y.value.filter(rt=>{var he;return((he=rt.product)==null?void 0:he.id_product)===le||rt.product_id===le})||[]},Se=De=>{Object.assign(re,De),k()},Fe=De=>{re.search=De,k()},Ye=()=>{g.value=null,D.value&&(D.value="")};return Ie(se,async De=>{De==="compositions"&&await ee({page:1,per_page:15,critical_only:!1})},{immediate:!1}),ft(()=>{k(),x(),q(),R()}),(De,le)=>{var rt;return b(),ie("div",ei,[a("div",ti,[le[19]||(le[19]=a("div",null,[a("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Produk & Komposisi"),a("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola produk dan komposisi untuk coffee shop Anda")],-1)),a("div",ai,[J(L)&&se.value==="products"?(b(),ie("div",li,[e(ge,{color:"primary",size:"small"},{default:t(()=>[m(d(J(N).length)+" dipilih ",1)]),_:1}),e(F,{color:"error",variant:"outlined",size:"small","prepend-icon":"mdi-delete",onClick:Me},{default:t(()=>le[17]||(le[17]=[m(" Hapus Terpilih ")])),_:1,__:[17]})])):ae("",!0),J(W)&&se.value==="products"?(b(),O(F,{key:1,color:"primary","prepend-icon":"mdi-plus",class:"coffee-btn",onClick:J(_)},{default:t(()=>le[18]||(le[18]=[m(" Tambah Produk ")])),_:1,__:[18]},8,["onClick"])):ae("",!0)])]),e(hl,{modelValue:se.value,"onUpdate:modelValue":le[0]||(le[0]=he=>se.value=he),class:"mb-6"},{default:t(()=>[e(gt,{value:"products"},{default:t(()=>[e(S,{icon:"mdi-coffee",class:"me-2"}),le[20]||(le[20]=m(" Produk "))]),_:1,__:[20]}),e(gt,{value:"compositions"},{default:t(()=>[e(S,{icon:"mdi-chef-hat",class:"me-2"}),le[21]||(le[21]=m(" Komposisi Produk "))]),_:1,__:[21]}),e(gt,{value:"variants"},{default:t(()=>[e(S,{icon:"mdi-tune-variant",class:"me-2"}),le[22]||(le[22]=m(" Variant Produk "))]),_:1,__:[22]})]),_:1},8,["modelValue"]),J(pe)?(b(),O(Re,{key:0,type:"error",variant:"outlined",class:"mb-4",text:J(pe),closable:"","onClick:close":le[1]||(le[1]=he=>pe.value="")},null,8,["text"])):ae("",!0),J(G)?(b(),O(Re,{key:1,type:"success",variant:"outlined",class:"mb-4",text:J(G),closable:"","onClick:close":le[2]||(le[2]=he=>G.value="")},null,8,["text"])):ae("",!0),e(Vt,{modelValue:se.value,"onUpdate:modelValue":le[4]||(le[4]=he=>se.value=he)},{default:t(()=>[e(dt,{value:"products"},{default:t(()=>[e(yn,{stats:J(c)},null,8,["stats"]),e(en,{filters:J(re),"onUpdate:filters":Se,onSearch:Fe},null,8,["filters"]),e(Hn,{products:J(B),loading:J(u),"current-page":J(oe),"total-items":J(U),"items-per-page":J(C),"selected-products":J(N),"toggle-loading":J(w),"onUpdate:page":J(V),onAddProduct:J(_),onEditProduct:J(l),onOpenRecipeDialog:Be,onOpenCompositionDialog:qe,onOpenVariantDialog:je,onDeleteProduct:J(s),onToggleActive:J(Q),onToggleFeatured:J(z),"onUpdate:selectedProducts":le[3]||(le[3]=he=>N.value=he)},null,8,["products","loading","current-page","total-items","items-per-page","selected-products","toggle-loading","onUpdate:page","onAddProduct","onEditProduct","onDeleteProduct","onToggleActive","onToggleFeatured"])]),_:1}),e(dt,{value:"compositions"},{default:t(()=>[e(ho,{"product-items":J(Y),loading:J(T),onRefresh:J(ee)},null,8,["product-items","loading","onRefresh"])]),_:1}),e(dt,{value:"variants"},{default:t(()=>[e(Mt,{loading:J(u),onRefresh:J(k)},null,8,["loading","onRefresh"])]),_:1})]),_:1},8,["modelValue"]),e(Xo,{modelValue:J(r),"onUpdate:modelValue":[le[5]||(le[5]=he=>ht(r)?r.value=he:null),le[6]||(le[6]=he=>r.value=he)],"edit-mode":J(j),"form-data":J(f),categories:J(y),loading:J($),"error-message":J(X),"selected-image":J(g)?[J(g)]:[],"image-preview":J(D),onClose:J(I),onSubmit:J(ce),onImageChange:J(ye),onRemoveImage:Ye,onClearError:J(Z),onUpdateForm:le[7]||(le[7]=(he,Dt)=>J(f)[he]=Dt)},null,8,["modelValue","edit-mode","form-data","categories","loading","error-message","selected-image","image-preview","onClose","onSubmit","onImageChange","onClearError"]),e(Ka,{modelValue:J(h),"onUpdate:modelValue":[le[8]||(le[8]=he=>ht(h)?h.value=he:null),le[9]||(le[9]=he=>h.value=he)],"edit-mode":J(K),"form-data":J(we),"available-items":J(xe),loading:J(Pe),"error-message":J(te),onClose:J(M),onSave:J(n),onClearError:J(A)},null,8,["modelValue","edit-mode","form-data","available-items","loading","error-message","onClose","onSave","onClearError"]),e(Et,{modelValue:J(i),"onUpdate:modelValue":le[10]||(le[10]=he=>ht(i)?i.value=he:null),title:"Konfirmasi Hapus Produk","item-name":(rt=J(p))==null?void 0:rt.name,loading:J(v),"confirm-text":"Hapus Produk",onConfirm:He,onCancel:le[11]||(le[11]=he=>i.value=!1)},null,8,["modelValue","item-name","loading"]),e(Zt,{modelValue:P.value,"onUpdate:modelValue":le[12]||(le[12]=he=>P.value=he),product:ve.value,items:ne(ve.value),onSave:le[13]||(le[13]=()=>{J(k)(),P.value=!1}),onRefresh:J(k)},null,8,["modelValue","product","items","onRefresh"]),e(Ge,{modelValue:_e.value,"onUpdate:modelValue":le[16]||(le[16]=he=>_e.value=he),"max-width":"1400px",persistent:""},{default:t(()=>[e(ue,null,{default:t(()=>[e($e,{class:"d-flex justify-between align-center"},{default:t(()=>{var he;return[a("div",oi,[e(S,{icon:"tabler-versions",class:"me-2"}),m(" Kelola Variant - "+d((he=ze.value)==null?void 0:he.name),1)]),e(F,{icon:"tabler-x",variant:"text",onClick:le[14]||(le[14]=Dt=>_e.value=!1)})]}),_:1}),e(Ee),e(fe,{class:"pa-0"},{default:t(()=>[ze.value?(b(),O(Mt,{key:0,product:ze.value},null,8,["product"])):ae("",!0)]),_:1}),e(Ee),e(Ne,null,{default:t(()=>[e(Xe),e(F,{color:"grey-darken-1",variant:"outlined",onClick:le[15]||(le[15]=he=>_e.value=!1)},{default:t(()=>[e(S,{icon:"mdi-close",class:"me-1"}),le[23]||(le[23]=m(" Tutup "))]),_:1,__:[23]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Yi=Je(ni,[["__scopeId","data-v-8c8b1097"]]);export{Yi as default};
