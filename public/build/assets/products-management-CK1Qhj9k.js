import{D as lt}from"./DeleteConfirmationDialog-9U_EePl3.js";import{a8 as at,a9 as ot,af as st,r as se,aK as ye,ag as nt,aQ as Le,bm as it,V as Y,W as rt,w as oe,bw as Ke,aX as Ne,aa as ut,b as e,p as Q,b1 as dt,cq as ct,cj as je,bk as mt,F as Ee,X as P,cp as ft,ck as pt,aM as gt,s as y,d as Pe,aD as Be,g as S,f as t,l as R,e as o,t as w,a0 as T,$ as vt,m as f,c as fe,j as bt,o as $,D as Qe,cr as kt,a5 as He}from"./main-5m4Pub-1.js";import{u as ht}from"./useHPP-Kg1WttUK.js";import{a as et,u as Vt,P as yt}from"./useProducts-DUkcQhMX.js";import{V as qe}from"./VDialog-DSzUML26.js";import{b as Se,c as Ge,V as Z}from"./VCard-CtuMQEfa.js";import{V as xe}from"./VDivider-CPeEws-u.js";import{V as le}from"./VCardText-BWtDAEKx.js";import{V as _t}from"./VForm-CS_KpFfR.js";import{V as Me,a as v}from"./VRow-DnBzc8dw.js";import{h as xt,V as O,i as Pt}from"./VTextField-D1GQQR9s.js";import{V as Je}from"./VTextarea-BTwFcsaL.js";import{u as Ct,m as wt,a as $t,V as he}from"./VSelect-AvDy_3O0.js";import{V as N}from"./VChip-eZw-rtuv.js";import{V as ke}from"./VTooltip-BZmTu8p-.js";import{V as me,a as We}from"./VAlert-UZFKvk1F.js";import{m as Dt,V as St}from"./VImg-DWwJr1BV.js";import{V as Mt,u as It}from"./useCategories-CvCVEIvj.js";import{V as Xe}from"./VSwitch-faptAC8Z.js";import{u as Ut,m as Ft,h as zt}from"./filter-Csn3SMyf.js";import{f as Rt}from"./forwardRefs-B931MWyl.js";import{e as At,t as _e,V as Tt,a as Ye}from"./VList-B6V86m45.js";import{V as Et}from"./VMenu-C34jV62A.js";import{c as Ht}from"./VCheckboxBtn-DAm4FEOM.js";import{V as ae}from"./VAvatar-CyC9YJHX.js";import{V as Bt}from"./VSpacer-CzaJ5qYN.js";import{V as Ze}from"./VSnackbar--Y8EasbE.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Ot}from"./VSkeletonLoader-DOL56g02.js";import{V as Lt}from"./VDataTableServer-CRRPZflI.js";import"./index-D-EbNoF1.js";import"./helpers-B-vn2Qqf.js";import"./VAutocomplete-ruA2572E.js";import"./CategoriesApi-CEOgVL5M.js";import"./ProductsApi-B_Xyv-9B.js";import"./VOverlay-CORAFpeJ.js";/* empty css              */import"./VDataTable-B8pa1-4W.js";import"./VTable-DKsaN7go.js";const Kt=ot({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Ft({filterKeys:["title"]}),...wt({hideNoData:!0,returnObject:!0}),...dt(Pt({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Dt({transition:!1})},"VCombobox"),Nt=at()({name:"VCombobox",props:Kt(),emits:{"update:focused":i=>!0,"update:modelValue":i=>!0,"update:search":i=>!0,"update:menu":i=>!0},setup(i,J){var we;let{emit:j,slots:p}=J;const{t:D}=st(),k=se(),E=ye(!1),d=ye(!0),m=ye(!1),a=se(),I=se(),b=ye(-1);let L=!1;const{items:ee,transformIn:H,transformOut:u}=At(i),{textColorClasses:q,textColorStyles:ne}=nt(()=>{var n;return(n=k.value)==null?void 0:n.color}),V=Le(i,"modelValue",[],n=>H(it(n)),n=>{const h=u(n);return i.multiple?h:h[0]??null}),M=xt(i),g=Y(()=>!!(i.chips||p.chip)),_=Y(()=>g.value||!!p.selection),G=ye(!i.multiple&&!_.value?((we=V.value[0])==null?void 0:we.title)??"":""),F=Y({get:()=>G.value,set:n=>{var h;if(G.value=n??"",!i.multiple&&!_.value&&(V.value=[_e(i,n)]),n&&i.multiple&&((h=i.delimiters)!=null&&h.length)){const z=n.split(new RegExp(`(?:${i.delimiters.join("|")})+`));z.length>1&&(z.forEach(x=>{x=x.trim(),x&&X(_e(i,x))}),G.value="")}n||(b.value=-1),d.value=!n}}),pe=Y(()=>typeof i.counterValue=="function"?i.counterValue(V.value):typeof i.counterValue=="number"?i.counterValue:i.multiple?V.value.length:F.value.length),{filteredItems:re,getMatches:Ve}=Ut(i,ee,()=>d.value?"":F.value),W=Y(()=>i.hideSelected?re.value.filter(n=>!V.value.some(h=>h.value===n.value)):re.value),ue=Y(()=>i.hideNoData&&!W.value.length||M.isReadonly.value||M.isDisabled.value),de=Le(i,"menu"),U=Y({get:()=>de.value,set:n=>{var h;de.value&&!n&&((h=a.value)!=null&&h.Î¨openChildren.size)||n&&ue.value||(de.value=n)}}),ge=rt(()=>U.value?i.closeText:i.openText);oe(G,n=>{L?Ne(()=>L=!1):E.value&&!U.value&&(U.value=!0),j("update:search",n)}),oe(V,n=>{var h;!i.multiple&&!_.value&&(G.value=((h=n[0])==null?void 0:h.title)??"")});const ve=Y(()=>V.value.map(n=>n.value)),ie=Y(()=>{var h;return(i.autoSelectFirst===!0||i.autoSelectFirst==="exact"&&F.value===((h=W.value[0])==null?void 0:h.title))&&W.value.length>0&&!d.value&&!m.value}),ce=se(),s=Ct(ce,k);function l(n){L=!0,i.openOnClear&&(U.value=!0)}function r(){ue.value||(U.value=!0)}function Ie(n){ue.value||(E.value&&(n.preventDefault(),n.stopPropagation()),U.value=!U.value)}function Ue(n){var h;n.key!==" "&&je(n)&&((h=k.value)==null||h.focus())}function be(n){var x,A,K,B;if(ct(n)||M.isReadonly.value)return;const h=(x=k.value)==null?void 0:x.selectionStart,z=V.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(n.key)&&n.preventDefault(),["Enter","ArrowDown"].includes(n.key)&&(U.value=!0),["Escape"].includes(n.key)&&(U.value=!1),["Enter","Escape","Tab"].includes(n.key)&&(ie.value&&["Enter","Tab"].includes(n.key)&&!V.value.some(c=>{let{value:te}=c;return te===W.value[0].value})&&X(re.value[0]),d.value=!0),n.key==="ArrowDown"&&ie.value&&((A=ce.value)==null||A.focus("next")),n.key==="Enter"&&F.value&&(X(_e(i,F.value)),_.value&&(G.value="")),["Backspace","Delete"].includes(n.key)){if(!i.multiple&&_.value&&V.value.length>0&&!F.value)return X(V.value[0],!1);if(~b.value){n.preventDefault();const c=b.value;X(V.value[b.value],!1),b.value=c>=z-1?z-2:c}else n.key==="Backspace"&&!F.value&&(b.value=z-1);return}if(i.multiple)if(n.key==="ArrowLeft"){if(b.value<0&&h&&h>0)return;const c=b.value>-1?b.value-1:z-1;V.value[c]?b.value=c:(b.value=-1,(K=k.value)==null||K.setSelectionRange(F.value.length,F.value.length))}else if(n.key==="ArrowRight"){if(b.value<0)return;const c=b.value+1;V.value[c]?b.value=c:(b.value=-1,(B=k.value)==null||B.setSelectionRange(0,0))}else~b.value&&je(n)&&(b.value=-1)}function Fe(){var n;i.eager&&((n=I.value)==null||n.calculateVisibleItems())}function ze(){var n;E.value&&(d.value=!0,(n=k.value)==null||n.focus())}function X(n){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!n||n.props.disabled))if(i.multiple){const z=V.value.findIndex(A=>(i.valueComparator||Ke)(A.value,n.value)),x=h??!~z;if(~z){const A=x?[...V.value,n]:[...V.value];A.splice(z,1),V.value=A}else x&&(V.value=[...V.value,n]);i.clearOnSelect&&(F.value="")}else{const z=h!==!1;V.value=z?[n]:[],G.value=z&&!_.value?n.title:"",Ne(()=>{U.value=!1,d.value=!0})}}function Re(n){E.value=!0,setTimeout(()=>{m.value=!0})}function Ae(n){m.value=!1}function Te(n){(n==null||n===""&&!i.multiple&&!_.value)&&(V.value=[])}return oe(E,(n,h)=>{if(!(n||n===h)&&(b.value=-1,U.value=!1,F.value)){if(i.multiple){X(_e(i,F.value));return}if(!_.value)return;V.value.some(z=>{let{title:x}=z;return x===F.value})?G.value="":X(_e(i,F.value))}}),oe(U,()=>{if(!i.hideSelected&&U.value&&V.value.length){const n=W.value.findIndex(h=>V.value.some(z=>(i.valueComparator||Ke)(z.value,h.value)));mt&&window.requestAnimationFrame(()=>{var h;n>=0&&((h=I.value)==null||h.scrollToIndex(n))})}}),oe(()=>i.items,(n,h)=>{U.value||E.value&&!h.length&&n.length&&(U.value=!0)}),ut(()=>{const n=!!(!i.hideNoData||W.value.length||p["prepend-item"]||p["append-item"]||p["no-data"]),h=V.value.length>0,z=O.filterProps(i);return e(O,Q({ref:k},z,{modelValue:F.value,"onUpdate:modelValue":[x=>F.value=x,Te],focused:E.value,"onUpdate:focused":x=>E.value=x,validationValue:V.externalValue,counterValue:pe.value,dirty:h,class:["v-combobox",{"v-combobox--active-menu":U.value,"v-combobox--chips":!!i.chips,"v-combobox--selection-slot":!!_.value,"v-combobox--selecting-index":b.value>-1,[`v-combobox--${i.multiple?"multiple":"single"}`]:!0},i.class],style:i.style,readonly:M.isReadonly.value,placeholder:h?void 0:i.placeholder,"onClick:clear":l,"onMousedown:control":r,onKeydown:be}),{...p,default:()=>e(Ee,null,[e(Et,Q({ref:a,modelValue:U.value,"onUpdate:modelValue":x=>U.value=x,activator:"parent",contentClass:"v-combobox__content",disabled:ue.value,eager:i.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:i.transition,onAfterEnter:Fe,onAfterLeave:ze},i.menuProps),{default:()=>[n&&e(Tt,Q({ref:ce,selected:ve.value,selectStrategy:i.multiple?"independent":"single-independent",onMousedown:x=>x.preventDefault(),onKeydown:Ue,onFocusin:Re,onFocusout:Ae,tabindex:"-1","aria-live":"polite",color:i.itemColor??i.color},s,i.listProps),{default:()=>{var x,A,K;return[(x=p["prepend-item"])==null?void 0:x.call(p),!W.value.length&&!i.hideNoData&&(((A=p["no-data"])==null?void 0:A.call(p))??e(Ye,{key:"no-data",title:D(i.noDataText)},null)),e($t,{ref:I,renderless:!0,items:W.value,itemKey:"value"},{default:B=>{var Oe;let{item:c,index:te,itemRef:C}=B;const $e=Q(c.props,{ref:C,key:c.value,active:ie.value&&te===0?!0:void 0,onClick:()=>X(c,null)});return((Oe=p.item)==null?void 0:Oe.call(p,{item:c,index:te,props:$e}))??e(Ye,Q($e,{role:"option"}),{prepend:De=>{let{isSelected:tt}=De;return e(Ee,null,[i.multiple&&!i.hideSelected?e(Ht,{key:c.value,modelValue:tt,ripple:!1,tabindex:"-1"},null):void 0,c.props.prependAvatar&&e(ae,{image:c.props.prependAvatar},null),c.props.prependIcon&&e(P,{icon:c.props.prependIcon},null)])},title:()=>{var De;return d.value?c.title:zt("v-combobox",c.title,(De=Ve(c))==null?void 0:De.title)}})}}),(K=p["append-item"])==null?void 0:K.call(p)]}})]}),V.value.map((x,A)=>{function K(C){C.stopPropagation(),C.preventDefault(),X(x,!1)}const B={"onClick:close":K,onKeydown(C){C.key!=="Enter"&&C.key!==" "||(C.preventDefault(),C.stopPropagation(),K(C))},onMousedown(C){C.preventDefault(),C.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},c=g.value?!!p.chip:!!p.selection,te=c?pt(g.value?p.chip({item:x,index:A,props:B}):p.selection({item:x,index:A})):void 0;if(!(c&&!te))return e("div",{key:x.value,class:["v-combobox__selection",A===b.value&&["v-combobox__selection--selected",q.value]],style:A===b.value?ne.value:{}},[g.value?p.chip?e(gt,{key:"chip-defaults",defaults:{VChip:{closable:i.closableChips,size:"small",text:x.title}}},{default:()=>[te]}):e(N,Q({key:"chip",closable:i.closableChips,size:"small",text:x.title,disabled:x.props.disabled},B),null):te??e("span",{class:"v-combobox__selection-text"},[x.title,i.multiple&&A<V.value.length-1&&e("span",{class:"v-combobox__selection-comma"},[y(",")])])])})]),"append-inner":function(){var B,c;for(var x=arguments.length,A=new Array(x),K=0;K<x;K++)A[K]=arguments[K];return e(Ee,null,[(B=p["append-inner"])==null?void 0:B.call(p,...A),(!i.hideNoData||i.items.length)&&i.menuIcon?e(P,{class:"v-combobox__menu-icon",color:(c=k.value)==null?void 0:c.fieldIconColor,icon:i.menuIcon,onMousedown:Ie,onClick:ft,"aria-label":D(ge.value),title:D(ge.value),tabindex:"-1"},null):void 0])}})}),Rt({isFocused:E,isPristine:d,menu:U,search:F,selectionIndex:b,filteredItems:re,select:X},k)}}),jt={class:"d-flex align-center gap-2"},qt={class:"text-white"},Gt={class:"text-h6 mb-4 d-flex align-center gap-2"},Jt={class:"text-h6 mb-4 d-flex align-center gap-2"},Wt={class:"d-flex flex-column gap-2"},Xt={key:0,class:"d-flex align-center gap-2"},Yt={class:"d-flex align-center gap-2 mb-2"},Zt={class:"d-flex gap-2"},Qt={class:"d-flex gap-2"},el={class:"d-flex align-center justify-space-between"},tl={class:"d-flex align-center gap-2"},ll={class:"text-end"},al={class:"text-h6 font-weight-bold"},ol={class:"text-caption"},sl={class:"text-h6 mb-4 d-flex align-center gap-2"},nl={class:"text-h6 mb-4 d-flex align-center gap-2"},il={class:"text-h6 mb-4 d-flex align-center gap-2"},rl={class:"image-upload-container"},ul={key:0,class:"mb-4"},dl={class:"text-center mt-2"},cl={class:"text-h6 mb-4 d-flex align-center gap-2"},ml={class:"text-h6 mb-4 d-flex align-center gap-2"},fl={class:"d-flex align-center"},pl={class:"text-subtitle-1"},gl={class:"text-body-1"},vl={class:"d-flex align-center"},bl={class:"text-subtitle-1"},kl=Pe({__name:"ProductDialog",props:{modelValue:{type:Boolean},editMode:{type:Boolean},formData:{},categories:{},loading:{type:Boolean},errorMessage:{},successMessage:{},selectedImage:{},imagePreview:{},useDialogError:{type:Boolean}},emits:["update:modelValue","close","submit","image-change","remove-image","clear-error","clear-success","update-form"],setup(i,{emit:J}){var ve,ie,ce;const j=bt(),{nameRules:p,categoryRules:D}=et(),{getProductHPPBreakdown:k}=ht(),E=se(!1),d=se(!1),m=async()=>{if(!(!b.editMode||!u.id))try{const s=await fetch(`/api/products/${u.id}/items`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(s.ok){const l=await s.json();d.value=l.success&&l.data&&l.data.length>0}}catch(s){console.error("Error checking HPP status:",s)}},a=async()=>{if(u.id)try{E.value=!0;const s=await k(u.id,"latest");s&&(u.cost=s.total_hpp,ee("update-form","cost",s.total_hpp))}catch(s){console.error("Error refreshing HPP:",s)}finally{E.value=!1}},I=()=>{console.log("Open items setup for product:",u.id)},b=i,L=Y(()=>b.errorMessage),ee=J,H=se(),u=Be({...b.formData});oe(()=>b.formData,s=>{Object.assign(u,s)},{deep:!0}),oe(u,s=>{Object.keys(s).forEach(l=>{ee("update-form",l,s[l])})},{deep:!0}),oe(()=>b.modelValue,s=>{s&&b.editMode&&m()});const q=Be({length:((ve=b.formData.dimensions)==null?void 0:ve.length)||null,width:((ie=b.formData.dimensions)==null?void 0:ie.width)||null,height:((ce=b.formData.dimensions)==null?void 0:ce.height)||null});oe(q,s=>{const l=s.length!==null||s.width!==null||s.height!==null;u.dimensions=l?{length:s.length!==null?s.length:void 0,width:s.width!==null?s.width:void 0,height:s.height!==null?s.height:void 0}:{}},{deep:!0});const ne=[{title:"Draft",value:"draft"},{title:"Published",value:"published"},{title:"Archived",value:"archived"}],V=Y(()=>{if(!u.price||!u.cost||u.cost<=0)return 0;const s=(u.price-u.cost)/u.cost*100;return Math.ceil(s)}),M=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),g=s=>s<10?"error":s<25?"warning":s<50?"success":"info",_=s=>s<10?"tabler-trending-down":s<25?"tabler-trending-up":s<50?"tabler-trending-up-2":"tabler-trending-up-3",G=s=>!s||s===0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),F=s=>{if(!s||s.trim()===""||s==="Rp 0")return 0;const r=s.replace(/[^\d,.-]/g,"").replace(/\./g,"").replace(",",".");return parseFloat(r)||0},pe=se(!1),re=s=>{const l=F(s);u.price=l},Ve=[s=>{const l=F(s);return!l||l<=0?"Harga harus lebih dari 0":!0}],W=()=>{pe.value=!0},ue=()=>{pe.value=!1},de=async()=>{var l;const{valid:s}=await((l=H.value)==null?void 0:l.validate());s&&ee("submit",u)},U=s=>{ee("image-change",s)},ge=()=>{ee("remove-image")};return(s,l)=>($(),S(qe,{"model-value":s.modelValue,"max-width":"900px",persistent:"",scrollable:"","onUpdate:modelValue":l[29]||(l[29]=r=>s.$emit("update:modelValue",r))},{default:t(()=>[e(Z,{class:"product-dialog coffee-dialog"},{default:t(()=>[e(Se,{class:"d-flex align-center justify-space-between coffee-header"},{default:t(()=>[o("div",jt,[e(P,{icon:s.editMode?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),o("span",qt,w(s.editMode?"Edit Produk":"Tambah Produk Baru"),1)]),e(T,{icon:"tabler-x",variant:"text",color:"white",onClick:l[0]||(l[0]=r=>s.$emit("close"))})]),_:1}),e(xe),e(le,{class:"pa-6"},{default:t(()=>[e(_t,{ref_key:"formRef",ref:H,onSubmit:vt(de,["prevent"])},{default:t(()=>[e(Me,null,{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[o("h6",Gt,[e(P,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),l[30]||(l[30]=y(" Informasi Dasar "))])]),_:1}),e(v,{cols:"12",md:"8"},{default:t(()=>[e(O,{modelValue:u.name,"onUpdate:modelValue":l[1]||(l[1]=r=>u.name=r),label:"Nama Produk",placeholder:"Masukkan nama produk",rules:f(p),required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(v,{cols:"12",md:"4"},{default:t(()=>[e(O,{modelValue:u.sku,"onUpdate:modelValue":l[2]||(l[2]=r=>u.sku=r),label:"SKU",placeholder:"Auto generate jika kosong",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12"},{default:t(()=>[e(Je,{modelValue:u.description,"onUpdate:modelValue":l[3]||(l[3]=r=>u.description=r),label:"Deskripsi Produk",placeholder:"Masukkan deskripsi produk",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"6"},{default:t(()=>[e(he,{"model-value":u.category_id,"onUpdate:modelValue":l[4]||(l[4]=r=>u.category_id=r),items:s.categories,"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Pilih kategori",rules:f(D),required:"",variant:"outlined"},null,8,["model-value","items","rules"])]),_:1}),e(v,{cols:"12",md:"6"},{default:t(()=>[e(O,{modelValue:u.brand,"onUpdate:modelValue":l[5]||(l[5]=r=>u.brand=r),label:"Brand/Merek",placeholder:"Masukkan brand produk",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12"},{default:t(()=>[o("h6",Jt,[e(P,{icon:"tabler-currency-dollar",size:"20",class:"coffee-icon"}),l[31]||(l[31]=y(" Harga & Biaya "))])]),_:1}),e(v,{cols:"12",md:"6"},{default:t(()=>[e(O,{"model-value":G(u.price),"onUpdate:modelValue":l[6]||(l[6]=r=>re(r)),label:"Harga Jual",placeholder:"Rp 0",rules:Ve,required:"",variant:"outlined",onFocus:W,onBlur:ue},null,8,["model-value"])]),_:1}),e(v,{cols:"12",md:"6"},{default:t(()=>[o("div",Wt,[e(O,{"model-value":G(u.cost),label:"Harga Pokok Penjualan (HPP)",placeholder:"Auto-calculated dari bahan baku",variant:"outlined",readonly:"","append-inner-icon":"mdi-calculator",hint:"HPP dihitung otomatis berdasarkan harga bahan baku","persistent-hint":""},null,8,["model-value"]),s.editMode?($(),fe("div",Xt,[e(N,{color:d.value?"success":"warning",size:"small",variant:"tonal"},{default:t(()=>[e(P,{icon:d.value?"tabler-calculator":"tabler-alert-circle",size:"14",class:"me-1"},null,8,["icon"]),y(" "+w(d.value?"Auto HPP Active":"Setup Required"),1)]),_:1},8,["color"]),d.value?($(),S(T,{key:0,size:"small",variant:"outlined",color:"primary",onClick:a,loading:E.value},{default:t(()=>[e(P,{icon:"tabler-refresh",size:"14",class:"me-1"}),l[32]||(l[32]=y(" Update HPP "))]),_:1,__:[32]},8,["loading"])):($(),S(ke,{key:1},{activator:t(({props:r})=>[e(N,Q(r,{color:"warning",size:"small",variant:"tonal"}),{default:t(()=>[e(P,{icon:"tabler-alert-circle",size:"14",class:"me-1"}),l[33]||(l[33]=y(" Belum Ada Resep "))]),_:2,__:[33]},1040)]),default:t(()=>[l[34]||(l[34]=o("span",null,"Setup resep produk untuk menghitung HPP otomatis",-1))]),_:1,__:[34]}))])):R("",!0)])]),_:1}),s.editMode?($(),S(v,{key:0,cols:"12"},{default:t(()=>[d.value?($(),S(me,{key:0,color:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[e(We,null,{default:t(()=>[e(P,{icon:"tabler-info-circle",class:"me-2"}),l[35]||(l[35]=y(" HPP Otomatis Aktif "))]),_:1,__:[35]}),l[36]||(l[36]=o("div",{class:"mt-2"}," HPP produk ini dihitung otomatis berdasarkan item/bahan yang digunakan. Untuk mengubah HPP, silakan update harga item di menu Item Management. ",-1))]),_:1,__:[36]})):($(),S(me,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[e(We,null,{default:t(()=>[e(P,{icon:"tabler-alert-triangle",class:"me-2"}),l[37]||(l[37]=y(" HPP Manual "))]),_:1,__:[37]}),l[38]||(l[38]=o("div",{class:"mt-2"}," Produk ini menggunakan HPP manual. Untuk perhitungan otomatis, tambahkan item/bahan yang digunakan untuk produk ini. ",-1))]),_:1,__:[38]}))]),_:1})):R("",!0),e(v,{cols:"12"},{default:t(()=>[d.value&&s.editMode?($(),S(me,{key:0,color:"success",variant:"tonal",class:"mb-4"},{default:t(()=>[o("div",Yt,[e(P,{icon:"tabler-check-circle"}),l[39]||(l[39]=o("span",{class:"font-weight-medium"},"HPP Otomatis Aktif",-1))]),l[42]||(l[42]=o("div",{class:"text-body-2 mb-3"}," Produk ini sudah memiliki resep dan HPP dihitung otomatis berdasarkan harga bahan baku terkini. HPP akan update secara otomatis saat harga bahan baku berubah. ",-1)),o("div",Zt,[e(T,{size:"small",color:"primary",variant:"outlined",onClick:I},{default:t(()=>[e(P,{icon:"tabler-edit",size:"14",class:"me-1"}),l[40]||(l[40]=y(" Edit Resep "))]),_:1,__:[40]}),e(T,{size:"small",variant:"outlined",color:"info",onClick:a,loading:E.value},{default:t(()=>[e(P,{icon:"tabler-refresh",size:"14",class:"me-1"}),l[41]||(l[41]=y(" Refresh HPP "))]),_:1,__:[41]},8,["loading"])])]),_:1,__:[42]})):!d.value&&s.editMode?($(),S(me,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[o("div",Qt,[e(T,{size:"small",variant:"outlined",color:"info",onClick:l[7]||(l[7]=r=>f(j).push("/hpp-management"))},{default:t(()=>[e(P,{icon:"tabler-calculator",size:"14",class:"me-1"}),l[43]||(l[43]=y(" Lihat HPP Management "))]),_:1,__:[43]})])]),_:1})):R("",!0)]),_:1}),e(v,{cols:"12"},{default:t(()=>[u.price&&u.cost&&u.cost>0?($(),S(me,{key:0,color:g(V.value),variant:"tonal",class:"mb-0"},{default:t(()=>[o("div",el,[o("div",tl,[e(P,{icon:_(V.value)},null,8,["icon"]),l[44]||(l[44]=o("span",{class:"font-weight-medium"},"Profit Margin",-1))]),o("div",ll,[o("div",al,w(Math.round(V.value))+"%",1),o("div",ol," Keuntungan: "+w(M(u.price-u.cost)),1)])])]),_:1},8,["color"])):R("",!0)]),_:1}),e(v,{cols:"12"},{default:t(()=>[o("h6",sl,[e(P,{icon:"tabler-package",size:"20",class:"coffee-icon"}),l[45]||(l[45]=y(" Inventori "))])]),_:1}),e(v,{cols:"12",md:"4"},{default:t(()=>[e(O,{modelValue:u.min_stock,"onUpdate:modelValue":l[8]||(l[8]=r=>u.min_stock=r),modelModifiers:{number:!0},label:"Stok Minimum",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"4"},{default:t(()=>[e(O,{modelValue:u.unit,"onUpdate:modelValue":l[9]||(l[9]=r=>u.unit=r),label:"Satuan",placeholder:"pcs, kg, liter, dll",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"6"},{default:t(()=>[e(O,{modelValue:u.barcode,"onUpdate:modelValue":l[10]||(l[10]=r=>u.barcode=r),label:"Barcode",placeholder:"Masukkan barcode",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"6"},{default:t(()=>[e(O,{modelValue:u.weight,"onUpdate:modelValue":l[11]||(l[11]=r=>u.weight=r),modelModifiers:{number:!0},label:"Berat (gram)",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12"},{default:t(()=>[o("h6",nl,[e(P,{icon:"tabler-ruler",size:"20",class:"coffee-icon"}),l[46]||(l[46]=y(" Dimensi (cm) "))])]),_:1}),e(v,{cols:"12",md:"4"},{default:t(()=>[e(O,{modelValue:q.length,"onUpdate:modelValue":l[12]||(l[12]=r=>q.length=r),modelModifiers:{number:!0},label:"Panjang",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"4"},{default:t(()=>[e(O,{modelValue:q.width,"onUpdate:modelValue":l[13]||(l[13]=r=>q.width=r),modelModifiers:{number:!0},label:"Lebar",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"4"},{default:t(()=>[e(O,{modelValue:q.height,"onUpdate:modelValue":l[14]||(l[14]=r=>q.height=r),modelModifiers:{number:!0},label:"Tinggi",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12"},{default:t(()=>[o("h6",il,[e(P,{icon:"tabler-photo",size:"20",class:"coffee-icon"}),l[47]||(l[47]=y(" Gambar Produk "))])]),_:1}),e(v,{cols:"12"},{default:t(()=>[o("div",rl,[s.imagePreview?($(),fe("div",ul,[e(St,{src:s.imagePreview,"max-width":"200","max-height":"200",class:"mx-auto rounded"},null,8,["src"]),o("div",dl,[e(T,{size:"small",color:"error",variant:"outlined",onClick:ge},{default:t(()=>l[48]||(l[48]=[y(" Hapus Gambar ")])),_:1,__:[48]})])])):R("",!0),e(Mt,{"model-value":s.selectedImage,"onUpdate:modelValue":l[15]||(l[15]=r=>U(Array.isArray(r)?r:[r])),label:"Upload Gambar","prepend-icon":"tabler-camera",accept:"image/*",variant:"outlined"},null,8,["model-value"]),l[49]||(l[49]=o("div",{class:"text-caption text-medium-emphasis mt-1"}," Format: JPG, JPEG, PNG, GIF. Maksimal 2MB. ",-1))])]),_:1}),e(v,{cols:"12"},{default:t(()=>[o("h6",cl,[e(P,{icon:"tabler-settings",size:"20",class:"coffee-icon"}),l[50]||(l[50]=y(" Pengaturan "))])]),_:1}),e(v,{cols:"12",md:"4"},{default:t(()=>[e(he,{"model-value":u.status,"onUpdate:modelValue":l[16]||(l[16]=r=>u.status=r),items:ne,label:"Status Publikasi",variant:"outlined"},null,8,["model-value"])]),_:1}),e(v,{cols:"12",md:"4"},{default:t(()=>[e(Xe,{"model-value":u.active,"onUpdate:modelValue":l[17]||(l[17]=r=>u.active=r??!1),label:"Produk Aktif",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(v,{cols:"12",md:"4"},{default:t(()=>[e(Xe,{"model-value":u.featured,"onUpdate:modelValue":l[18]||(l[18]=r=>u.featured=r??!1),label:"Produk Unggulan",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(v,{cols:"12"},{default:t(()=>[o("h6",ml,[e(P,{icon:"tabler-seo",size:"20",class:"coffee-icon"}),l[51]||(l[51]=y(" SEO (Opsional) "))])]),_:1}),e(v,{cols:"12"},{default:t(()=>[e(O,{modelValue:u.meta_title,"onUpdate:modelValue":l[19]||(l[19]=r=>u.meta_title=r),label:"Meta Title",placeholder:"Judul untuk SEO",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12"},{default:t(()=>[e(Je,{modelValue:u.meta_description,"onUpdate:modelValue":l[20]||(l[20]=r=>u.meta_description=r),label:"Meta Description",placeholder:"Deskripsi untuk SEO",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12"},{default:t(()=>[e(Nt,{"model-value":u.tags,"onUpdate:modelValue":l[21]||(l[21]=r=>u.tags=r),label:"Tags",placeholder:"Tambah tag dan tekan Enter",multiple:"",chips:"",variant:"outlined"},null,8,["model-value"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(xe),e(Ge,{class:"pa-6"},{default:t(()=>[e(Bt),e(T,{variant:"outlined",class:"coffee-secondary",onClick:l[22]||(l[22]=r=>s.$emit("close"))},{default:t(()=>l[52]||(l[52]=[y(" Batal ")])),_:1,__:[52]}),e(T,{color:"primary",class:"coffee-primary",loading:s.loading,onClick:de},{default:t(()=>[y(w(s.editMode?"Perbarui":"Simpan")+" Produk ",1)]),_:1},8,["loading"])]),_:1})]),_:1}),s.useDialogError?R("",!0):($(),S(Ze,{key:0,"model-value":!!L.value,"onUpdate:modelValue":l[24]||(l[24]=r=>!r&&s.$emit("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500"},{actions:t(()=>[e(T,{icon:"tabler-x",size:"small",variant:"text",onClick:l[23]||(l[23]=r=>s.$emit("clear-error"))})]),default:t(()=>[o("div",fl,[e(P,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),o("div",null,[l[53]||(l[53]=o("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),o("div",pl,w(L.value),1)])])]),_:1},8,["model-value"])),s.useDialogError?($(),S(qe,{key:1,"model-value":!!L.value,"onUpdate:modelValue":l[26]||(l[26]=r=>!r&&s.$emit("clear-error")),"max-width":"400",persistent:"",class:"error-dialog"},{default:t(()=>[e(Z,null,{default:t(()=>[e(Se,{class:"d-flex align-center text-error"},{default:t(()=>[e(P,{icon:"tabler-alert-circle",class:"me-2"}),l[54]||(l[54]=y(" Error Occurred "))]),_:1,__:[54]}),e(xe),e(le,{class:"py-4"},{default:t(()=>[o("div",gl,w(L.value),1)]),_:1}),e(xe),e(Ge,{class:"justify-end pa-4"},{default:t(()=>[e(T,{color:"error",variant:"outlined",onClick:l[25]||(l[25]=r=>s.$emit("clear-error"))},{default:t(()=>l[55]||(l[55]=[y(" Close ")])),_:1,__:[55]})]),_:1})]),_:1})]),_:1},8,["model-value"])):R("",!0),e(Ze,{"model-value":!!s.successMessage,"onUpdate:modelValue":l[28]||(l[28]=r=>!r&&s.$emit("clear-success")),color:"success",location:"top right",timeout:4e3,vertical:"","min-width":"320","max-width":"500"},{actions:t(()=>[e(T,{icon:"tabler-x",size:"small",variant:"text",onClick:l[27]||(l[27]=r=>s.$emit("clear-success"))})]),default:t(()=>[o("div",vl,[e(P,{icon:"tabler-check-circle",class:"me-3",size:"28"}),o("div",null,[l[56]||(l[56]=o("div",{class:"text-h6 font-weight-bold"},"Berhasil!",-1)),o("div",bl,w(s.successMessage),1)])])]),_:1},8,["model-value"])]),_:1},8,["model-value"]))}}),hl=Ce(kl,[["__scopeId","data-v-68ec6b61"]]),Vl={key:0,class:"mt-4"},yl={class:"d-flex align-center gap-2 mb-2"},_l={class:"d-flex flex-wrap gap-2"},xl=Pe({__name:"ProductSearchFilters",props:{filters:{}},emits:["update:filters","search"],setup(i,{emit:J}){const j=i,p=J,{categories:D,loading:k,fetchCategories:E}=It(),d=se(!1),m=se("");Qe(()=>{E(),m.value=a.search||""});const a=Be({...j.filters});oe(()=>j.filters,M=>{Object.assign(a,M),m.value=M.search||""},{deep:!0}),kt(m,M=>{a.search=M,(M.length>=3||M.length===0)&&(d.value=!0,p("search",M),H(),setTimeout(()=>{d.value=!1},500))},{debounce:500,maxWait:1e3});const I=[{title:"Aktif",value:"active"},{title:"Tidak Aktif",value:"inactive"}],b=[{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],L=[{title:"Terbaru",value:"desc"},{title:"Terlama",value:"asc"}],ee=Y(()=>!!(m.value||a.category_id||a.active||a.stock_status||a.featured!==null||a.min_price||a.max_price)),H=()=>{p("update:filters",{...a})},u=()=>{m.value="",Object.assign(a,{search:"",category_id:null,active:null,stock_status:null,featured:null,min_price:null,max_price:null,sort_by:"created_at",sort_order:"desc"}),H()},q=M=>{const g=D.value.find(_=>_.id_category===M);return(g==null?void 0:g.name)||"Unknown"},ne=M=>{if(!M)return"Semua";const g=I.find(_=>_.value===M);return(g==null?void 0:g.title)||String(M)},V=M=>{const g=b.find(_=>_.value===M);return(g==null?void 0:g.title)||M};return(M,g)=>($(),S(Z,{class:"mb-6"},{default:t(()=>[e(Se,{class:"d-flex align-center gap-2"},{default:t(()=>[e(P,{icon:"tabler-filter",class:"coffee-icon"}),g[11]||(g[11]=y(" Filter & Pencarian Produk "))]),_:1,__:[11]}),e(le,null,{default:t(()=>[e(Me,null,{default:t(()=>[e(v,{cols:"12",md:"4"},{default:t(()=>[e(O,{modelValue:m.value,"onUpdate:modelValue":g[0]||(g[0]=_=>m.value=_),label:"Cari produk...",placeholder:"Nama, SKU, atau deskripsi (min. 3 karakter)","prepend-inner-icon":"tabler-search",loading:d.value,clearable:"",variant:"outlined",hint:m.value.length>0&&m.value.length<3?`Ketik ${3-m.value.length} karakter lagi untuk mencari`:"","persistent-hint":""},null,8,["modelValue","loading","hint"])]),_:1}),e(v,{cols:"12",md:"3"},{default:t(()=>[e(he,{modelValue:a.category_id,"onUpdate:modelValue":[g[1]||(g[1]=_=>a.category_id=_),H],items:f(D),"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Semua kategori","prepend-inner-icon":"tabler-category",loading:f(k),clearable:"",variant:"outlined"},null,8,["modelValue","items","loading"])]),_:1}),e(v,{cols:"12",md:"2"},{default:t(()=>[e(he,{modelValue:a.active,"onUpdate:modelValue":[g[2]||(g[2]=_=>a.active=_),H],items:I,label:"Status",placeholder:"Semua status","prepend-inner-icon":"tabler-toggle-left",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"2"},{default:t(()=>[e(he,{modelValue:a.stock_status,"onUpdate:modelValue":[g[3]||(g[3]=_=>a.stock_status=_),H],items:b,label:"Stok",placeholder:"Semua stok","prepend-inner-icon":"tabler-package",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"1",class:"d-flex align-center"},{default:t(()=>[e(T,{icon:"tabler-refresh",variant:"outlined",color:"coffee",onClick:u})]),_:1})]),_:1}),e(Me,{class:"mt-3"},{default:t(()=>[e(v,{cols:"12",md:"3"},{default:t(()=>[e(O,{modelValue:a.min_price,"onUpdate:modelValue":g[4]||(g[4]=_=>a.min_price=_),label:"Harga Minimum",placeholder:"0","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:H},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"3"},{default:t(()=>[e(O,{modelValue:a.max_price,"onUpdate:modelValue":g[5]||(g[5]=_=>a.max_price=_),label:"Harga Maksimum",placeholder:"Tidak terbatas","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:H},null,8,["modelValue"])]),_:1}),e(v,{cols:"12",md:"2"},{default:t(()=>[e(he,{modelValue:a.sort_order,"onUpdate:modelValue":[g[6]||(g[6]=_=>a.sort_order=_),H],items:L,label:"Urutan",placeholder:"Terbaru","prepend-inner-icon":"tabler-arrow-up",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),ee.value?($(),fe("div",Vl,[o("div",yl,[e(P,{icon:"tabler-filter-check",size:"small",class:"coffee-icon"}),g[12]||(g[12]=o("span",{class:"text-sm font-weight-medium"},"Filter Aktif:",-1))]),o("div",_l,[m.value?($(),S(N,{key:0,closable:"",size:"small",color:"coffee","onClick:close":g[7]||(g[7]=_=>{m.value="",a.search="",H()})},{default:t(()=>[y(" Pencarian: "+w(m.value),1)]),_:1})):R("",!0),a.category_id?($(),S(N,{key:1,closable:"",size:"small",color:"coffee","onClick:close":g[8]||(g[8]=_=>{a.category_id=null,H()})},{default:t(()=>[y(" Kategori: "+w(q(a.category_id)),1)]),_:1})):R("",!0),a.active?($(),S(N,{key:2,closable:"",size:"small",color:"coffee","onClick:close":g[9]||(g[9]=_=>{a.active=null,H()})},{default:t(()=>[y(" Status: "+w(ne(a.active)),1)]),_:1})):R("",!0),a.stock_status?($(),S(N,{key:3,closable:"",size:"small",color:"coffee","onClick:close":g[10]||(g[10]=_=>{a.stock_status=null,H()})},{default:t(()=>[y(" Stok: "+w(V(a.stock_status)),1)]),_:1})):R("",!0)])])):R("",!0)]),_:1})]),_:1}))}}),Pl=Ce(xl,[["__scopeId","data-v-fc3dbf07"]]),Cl={class:"d-flex align-center gap-2"},wl={class:"text-h6"},$l={class:"d-flex align-center gap-2"},Dl={class:"text-h6"},Sl={class:"d-flex align-center gap-2"},Ml={class:"text-h6"},Il={class:"d-flex align-center gap-2"},Ul={class:"text-h6"},Fl={class:"d-flex align-center gap-2"},zl={class:"text-h6"},Rl={class:"d-flex align-center gap-2"},Al={class:"text-h6"},Tl={class:"d-flex align-center gap-2"},El={class:"text-h6"},Hl={class:"d-flex align-center gap-2"},Bl={class:"text-h6"},Ol=Pe({__name:"ProductStatsCards",props:{stats:{}},setup(i){const J=p=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(p),j=p=>`${p.toFixed(1)}%`;return(p,D)=>($(),S(Me,{class:"mb-6"},{default:t(()=>[e(v,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(Z,{class:"stats-card"},{default:t(()=>[e(le,{class:"d-flex align-center"},{default:t(()=>{var k;return[e(ae,{size:"44",rounded:"",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[e(P,{icon:"tabler-package"})]),_:1}),o("div",null,[D[0]||(D[0]=o("span",{class:"text-sm text-medium-emphasis"},"Total Produk",-1)),o("div",Cl,[o("h6",wl,w(((k=p.stats)==null?void 0:k.total_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(v,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(Z,{class:"stats-card"},{default:t(()=>[e(le,{class:"d-flex align-center"},{default:t(()=>{var k;return[e(ae,{size:"44",rounded:"",color:"success",variant:"tonal",class:"me-3"},{default:t(()=>[e(P,{icon:"tabler-check"})]),_:1}),o("div",null,[D[1]||(D[1]=o("span",{class:"text-sm text-medium-emphasis"},"Produk Aktif",-1)),o("div",$l,[o("h6",Dl,w(((k=p.stats)==null?void 0:k.active_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(v,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(Z,{class:"stats-card"},{default:t(()=>[e(le,{class:"d-flex align-center"},{default:t(()=>{var k;return[e(ae,{size:"44",rounded:"",color:"warning",variant:"tonal",class:"me-3"},{default:t(()=>[e(P,{icon:"tabler-star"})]),_:1}),o("div",null,[D[2]||(D[2]=o("span",{class:"text-sm text-medium-emphasis"},"Produk Unggulan",-1)),o("div",Sl,[o("h6",Ml,w(((k=p.stats)==null?void 0:k.featured_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(v,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(Z,{class:"stats-card"},{default:t(()=>[e(le,{class:"d-flex align-center"},{default:t(()=>{var k;return[e(ae,{size:"44",rounded:"",color:"error",variant:"tonal",class:"me-3"},{default:t(()=>[e(P,{icon:"tabler-alert-triangle"})]),_:1}),o("div",null,[D[3]||(D[3]=o("span",{class:"text-sm text-medium-emphasis"},"Stok Rendah",-1)),o("div",Il,[o("h6",Ul,w(((k=p.stats)==null?void 0:k.low_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(v,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(Z,{class:"stats-card"},{default:t(()=>[e(le,{class:"d-flex align-center"},{default:t(()=>{var k;return[e(ae,{size:"44",rounded:"",color:"info",variant:"tonal",class:"me-3"},{default:t(()=>[e(P,{icon:"tabler-currency-dollar"})]),_:1}),o("div",null,[D[4]||(D[4]=o("span",{class:"text-sm text-medium-emphasis"},"Nilai Stok",-1)),o("div",Fl,[o("h6",zl,w(J(((k=p.stats)==null?void 0:k.total_stock_value)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(v,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(Z,{class:"stats-card"},{default:t(()=>[e(le,{class:"d-flex align-center"},{default:t(()=>{var k;return[e(ae,{size:"44",rounded:"",color:"secondary",variant:"tonal",class:"me-3"},{default:t(()=>[e(P,{icon:"tabler-chart-line"})]),_:1}),o("div",null,[D[5]||(D[5]=o("span",{class:"text-sm text-medium-emphasis"},"Harga Rata-rata",-1)),o("div",Rl,[o("h6",Al,w(J(((k=p.stats)==null?void 0:k.average_price)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(v,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(Z,{class:"stats-card"},{default:t(()=>[e(le,{class:"d-flex align-center"},{default:t(()=>{var k;return[e(ae,{size:"44",rounded:"",color:"coffee",variant:"tonal",class:"me-3"},{default:t(()=>[e(P,{icon:"tabler-trending-up"})]),_:1}),o("div",null,[D[6]||(D[6]=o("span",{class:"text-sm text-medium-emphasis"},"Margin Rata-rata",-1)),o("div",Tl,[o("h6",El,w(j(((k=p.stats)==null?void 0:k.average_margin)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(v,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(Z,{class:"stats-card"},{default:t(()=>[e(le,{class:"d-flex align-center"},{default:t(()=>{var k;return[e(ae,{size:"44",rounded:"",color:"surface",variant:"tonal",class:"me-3"},{default:t(()=>[e(P,{icon:"tabler-x-circle"})]),_:1}),o("div",null,[D[7]||(D[7]=o("span",{class:"text-sm text-medium-emphasis"},"Stok Habis",-1)),o("div",Hl,[o("h6",Bl,w(((k=p.stats)==null?void 0:k.out_of_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1})]),_:1}))}}),Ll=Ce(Ol,[["__scopeId","data-v-124783ae"]]),Kl={class:"d-flex align-center gap-2"},Nl={class:"d-flex align-center gap-2"},jl={class:"text-center py-8"},ql={class:"d-flex align-center gap-3 py-2"},Gl={class:"font-weight-medium"},Jl={class:"text-caption text-medium-emphasis"},Wl={class:"text-end"},Xl={class:"font-weight-medium"},Yl={key:0,class:"text-caption text-medium-emphasis"},Zl={class:"text-center profit-margin-container"},Ql={class:"text-center"},ea={key:0,class:"text-caption text-medium-emphasis mt-1"},ta={class:"d-flex align-center gap-2"},la={class:"text-body-2"},aa={class:"text-caption text-medium-emphasis"},oa={class:"d-flex align-center gap-1"},sa=Pe({__name:"ProductTable",props:{products:{},totalItems:{},loading:{type:Boolean},currentPage:{},itemsPerPage:{},selectedProducts:{},toggleLoading:{}},emits:["add-product","view-product","edit-product","manage-recipes","open-recipe-dialog","delete-product","toggle-active","toggle-featured","bulk-delete","update:page","update:items-per-page","update:sort-by","update:selected-products"],setup(i){const J=[{title:"Produk",key:"name",sortable:!0,width:"250px"},{title:"Kategori",key:"category",sortable:!1,width:"120px"},{title:"Harga",key:"price",sortable:!0,align:"end",width:"130px"},{title:"Margin",key:"profit_margin",sortable:!0,align:"center",width:"100px"},{title:"Stok",key:"stock",sortable:!0,align:"center",width:"100px"},{title:"Status",key:"active",sortable:!0,width:"140px"},{title:"Dibuat",key:"created_at",sortable:!0,width:"120px"},{title:"Aksi",key:"actions",sortable:!1,align:"center",width:"200px"}],j=d=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(d),p=d=>new Date(d).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),D=d=>new Date(d).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),k=(d,m)=>d<=0?"error":m&&d<=m?"warning":"success",E=d=>d<10?"error":d<25?"warning":d<50?"success":"info";return(d,m)=>($(),S(Z,null,{default:t(()=>[e(Se,{class:"d-flex align-center justify-space-between"},{default:t(()=>[o("div",Kl,[e(P,{icon:"tabler-list",class:"coffee-icon"}),m[7]||(m[7]=y(" Data Produk ")),d.totalItems?($(),S(N,{key:0,size:"small",color:"coffee",variant:"tonal"},{default:t(()=>[y(w(d.totalItems)+" item ",1)]),_:1})):R("",!0)]),o("div",Nl,[d.selectedProducts.length>0?($(),S(T,{key:0,"prepend-icon":"tabler-trash",color:"error",variant:"outlined",onClick:m[0]||(m[0]=a=>d.$emit("bulk-delete"))},{default:t(()=>[y(" Hapus Terpilih ("+w(d.selectedProducts.length)+") ",1)]),_:1})):R("",!0),e(T,{"prepend-icon":"tabler-plus",color:"coffee",onClick:m[1]||(m[1]=a=>d.$emit("add-product"))},{default:t(()=>m[8]||(m[8]=[y(" Tambah Produk ")])),_:1,__:[8]})])]),_:1}),e(xe),e(Lt,{"model-value":d.selectedProducts,"onUpdate:modelValue":m[3]||(m[3]=a=>d.$emit("update:selected-products",a)),headers:J,items:d.products,"items-length":d.totalItems,loading:d.loading,"items-per-page":d.itemsPerPage,page:d.currentPage,"show-select":"","item-value":"id",class:"products-table","onUpdate:page":m[4]||(m[4]=a=>d.$emit("update:page",a)),"onUpdate:itemsPerPage":m[5]||(m[5]=a=>d.$emit("update:items-per-page",a)),"onUpdate:sortBy":m[6]||(m[6]=a=>d.$emit("update:sort-by",a))},{loading:t(()=>[e(Ot,{type:"table-row@10"})]),"no-data":t(()=>[o("div",jl,[e(P,{icon:"tabler-package-off",size:"64",class:"mb-4 text-disabled"}),m[10]||(m[10]=o("h6",{class:"text-h6 mb-2"}," Tidak ada produk ",-1)),m[11]||(m[11]=o("p",{class:"text-body-2 text-medium-emphasis mb-4"}," Belum ada produk yang ditambahkan atau sesuai dengan filter yang dipilih. ",-1)),e(T,{"prepend-icon":"tabler-plus",color:"coffee",onClick:m[2]||(m[2]=a=>d.$emit("add-product"))},{default:t(()=>m[9]||(m[9]=[y(" Tambah Produk Pertama ")])),_:1,__:[9]})])]),"item.name":t(({item:a})=>[o("div",ql,[e(ae,{image:a.image_url,size:"40",rounded:"",class:"product-avatar"},{default:t(()=>[a.image_url?R("",!0):($(),S(P,{key:0,icon:"tabler-package"}))]),_:2},1032,["image"]),o("div",null,[o("div",Gl,w(a.name),1),o("div",Jl," SKU: "+w(a.sku||"-"),1)])])]),"item.category":t(({item:a})=>[e(N,{color:"coffee",size:"small",variant:"tonal"},{default:t(()=>{var I;return[y(w(((I=a.category)==null?void 0:I.name)||"-"),1)]}),_:2},1024)]),"item.price":t(({item:a})=>[o("div",Wl,[o("div",Xl,w(j(a.price)),1),a.cost?($(),fe("div",Yl," HPP: "+w(j(a.cost)),1)):R("",!0)])]),"item.profit_margin":t(({item:a})=>[o("div",Zl,[a.cost&&a.cost>0&&a.profit_margin!==void 0?($(),S(N,{key:0,color:E(a.profit_margin),size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>[y(w(Math.round(a.profit_margin))+"% ",1)]),_:2},1032,["color"])):($(),S(N,{key:1,color:"grey",size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>m[12]||(m[12]=[y(" - ")])),_:1,__:[12]}))])]),"item.stock":t(({item:a})=>[o("div",Ql,[e(N,{color:k(a.stock,a.min_stock),size:"small",variant:"tonal"},{default:t(()=>[y(w(a.stock)+" "+w(a.unit||"pcs"),1)]),_:2},1032,["color"]),a.min_stock?($(),fe("div",ea," Min: "+w(a.min_stock),1)):R("",!0)])]),"item.active":t(({item:a})=>[o("div",ta,[e(N,{color:a.active?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[y(w(a.active?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["color"]),a.featured?($(),S(ke,{key:0,text:"Produk Unggulan"},{activator:t(({props:I})=>[e(P,Q(I,{icon:"tabler-star-filled",color:"warning",size:"small"}),null,16)]),_:1})):R("",!0)])]),"item.created_at":t(({item:a})=>[o("div",la,w(p(a.created_at??"")),1),o("div",aa,w(D((a==null?void 0:a.created_at)??"")),1)]),"item.actions":t(({item:a})=>[o("div",oa,[e(ke,{text:"Edit Produk"},{activator:t(({props:I})=>[e(T,Q(I,{icon:"tabler-edit",size:"small",variant:"text",color:"coffee",onClick:b=>d.$emit("edit-product",a)}),null,16,["onClick"])]),_:2},1024),e(ke,{text:a.active?"Nonaktifkan":"Aktifkan"},{activator:t(({props:I})=>{var b;return[e(T,Q(I,{icon:a.active?"tabler-toggle-right":"tabler-toggle-left",size:"small",variant:"text",color:a.active?"success":"error",loading:((b=d.toggleLoading)==null?void 0:b[a.id_product])||!1,onClick:L=>d.$emit("toggle-active",a)}),null,16,["icon","color","loading","onClick"])]}),_:2},1032,["text"]),e(ke,{text:a.featured?"Hapus dari Unggulan":"Jadikan Unggulan"},{activator:t(({props:I})=>[e(T,Q(I,{icon:a.featured?"tabler-star-filled":"tabler-star",size:"small",variant:"text",color:a.featured?"warning":"default",onClick:b=>d.$emit("toggle-featured",a)}),null,16,["icon","color","onClick"])]),_:2},1032,["text"]),e(ke,{text:"Hapus Produk"},{activator:t(({props:I})=>[e(T,Q(I,{icon:"tabler-trash",size:"small",variant:"text",color:"error",onClick:b=>d.$emit("delete-product",a)}),null,16,["onClick"])]),_:2},1024)])]),_:1},8,["model-value","items","items-length","loading","items-per-page","page"])]),_:1}))}}),na=Ce(sa,[["__scopeId","data-v-c3b46ca7"]]),ia={class:"product-management"},ra={class:"d-flex justify-space-between align-center mb-6"},ua={class:"d-flex gap-3 align-center"},da={key:0,class:"d-flex gap-2"},ca=Pe({__name:"products-management",setup(i){const{productsList:J,categories:j,loading:p,saveLoading:D,deleteLoading:k,toggleLoading:E,stats:d,dialog:m,deleteDialog:a,editMode:I,selectedProduct:b,selectedProducts:L,currentPage:ee,totalItems:H,itemsPerPage:u,filters:q,errorMessage:ne,successMessage:V,modalErrorMessage:M,formData:g,selectedImage:_,imagePreview:G,canCreateEdit:F,hasSelectedProducts:pe,fetchProductsList:re,fetchCategories:Ve,fetchStats:W,saveProduct:ue,deleteProduct:de,bulkDeleteProducts:U,toggleActiveStatus:ge,toggleFeaturedStatus:ve,openCreateDialog:ie,openEditDialog:ce,openDeleteDialog:s,closeDialog:l,handleImageUpload:r,clearModalError:Ie,onPageChange:Ue}=et(),{dialog:be,editMode:Fe,formData:ze,availableItems:X,saveLoading:Re,modalErrorMessage:Ae,openCreateDialog:Te,closeDialog:we,saveRecipe:n,clearModalError:h,fetchAvailableItems:z}=Vt(),x=async()=>{await de()},A=async()=>{await U()},K=B=>{console.log("ð³ Opening recipe dialog for product:",B.name),Te(B.id_product||B.id)};return Qe(()=>{re(),Ve(),W(),z()}),(B,c)=>{var te;return $(),fe("div",ia,[o("div",ra,[c[13]||(c[13]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Produk"),o("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola produk dan inventori untuk coffee shop Anda")],-1)),o("div",ua,[f(pe)?($(),fe("div",da,[e(N,{color:"primary",size:"small"},{default:t(()=>[y(w(f(L).length)+" dipilih ",1)]),_:1}),e(T,{color:"error",variant:"outlined",size:"small","prepend-icon":"mdi-delete",onClick:A},{default:t(()=>c[11]||(c[11]=[y(" Hapus Terpilih ")])),_:1,__:[11]})])):R("",!0),f(F)?($(),S(T,{key:1,color:"primary","prepend-icon":"mdi-plus",class:"coffee-btn",onClick:f(ie)},{default:t(()=>c[12]||(c[12]=[y(" Tambah Produk ")])),_:1,__:[12]},8,["onClick"])):R("",!0)])]),f(ne)?($(),S(me,{key:0,type:"error",variant:"outlined",class:"mb-4",text:f(ne),closable:"","onClick:close":c[0]||(c[0]=C=>ne.value="")},null,8,["text"])):R("",!0),f(V)?($(),S(me,{key:1,type:"success",variant:"outlined",class:"mb-4",text:f(V),closable:"","onClick:close":c[1]||(c[1]=C=>V.value="")},null,8,["text"])):R("",!0),e(Ll,{stats:f(d)},null,8,["stats"]),e(Pl,{filters:f(q),"onUpdate:filters":B.handleFiltersUpdate},null,8,["filters","onUpdate:filters"]),e(na,{products:f(J),loading:f(p),"current-page":f(ee),"total-items":f(H),"items-per-page":f(u),"selected-products":f(L),"toggle-loading":f(E),"onUpdate:page":f(Ue),onAddProduct:f(ie),onEditProduct:f(ce),onManageRecipes:c[2]||(c[2]=C=>{console.log("Product data:",C),console.log("Product ID:",C.id),console.log("Product ID_Product:",C.id_product),B.$router.push(`/product-recipes/${C.id_product||C.id}`)}),onOpenRecipeDialog:K,onDeleteProduct:f(s),onToggleActive:f(ge),onToggleFeatured:f(ve),"onUpdate:selectedProducts":c[3]||(c[3]=C=>L.value=C)},null,8,["products","loading","current-page","total-items","items-per-page","selected-products","toggle-loading","onUpdate:page","onAddProduct","onEditProduct","onDeleteProduct","onToggleActive","onToggleFeatured"]),e(hl,{modelValue:f(m),"onUpdate:modelValue":[c[4]||(c[4]=C=>He(m)?m.value=C:null),c[5]||(c[5]=C=>m.value=C)],"edit-mode":f(I),"form-data":f(g),categories:f(j),loading:f(D),"error-message":f(M),"selected-image":f(_)?[f(_)]:[],"image-preview":f(G),onClose:f(l),onSubmit:f(ue),onImageChange:f(r),onRemoveImage:B.removeImage,onClearError:f(Ie),onUpdateForm:c[6]||(c[6]=(C,$e)=>f(g)[C]=$e)},null,8,["modelValue","edit-mode","form-data","categories","loading","error-message","selected-image","image-preview","onClose","onSubmit","onImageChange","onRemoveImage","onClearError"]),e(yt,{modelValue:f(be),"onUpdate:modelValue":[c[7]||(c[7]=C=>He(be)?be.value=C:null),c[8]||(c[8]=C=>be.value=C)],"edit-mode":f(Fe),"form-data":f(ze),"available-items":f(X),loading:f(Re),"error-message":f(Ae),onClose:f(we),onSave:f(n),onClearError:f(h)},null,8,["modelValue","edit-mode","form-data","available-items","loading","error-message","onClose","onSave","onClearError"]),e(lt,{modelValue:f(a),"onUpdate:modelValue":c[9]||(c[9]=C=>He(a)?a.value=C:null),title:"Konfirmasi Hapus Produk","item-name":(te=f(b))==null?void 0:te.name,loading:f(k),"confirm-text":"Hapus Produk",onConfirm:x,onCancel:c[10]||(c[10]=C=>a.value=!1)},null,8,["modelValue","item-name","loading"])])}}}),Ya=Ce(ca,[["__scopeId","data-v-e5bf1985"]]);export{Ya as default};
