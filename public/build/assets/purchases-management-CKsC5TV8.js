import{g as W}from"./auth-CuuXRWj5.js";import{d as ge,V as ae,r as k,w as _e,D as $e,g as E,o as w,f as a,b as e,e as t,X as Q,s as c,c as B,l as I,t as i,a0 as P,am as Pe,an as Te,i as we,p as Se,F as xe,av as G,b8 as De,v as Ce}from"./main-BkLglF7t.js";import{V as he}from"./VDialog-DB8TEzq0.js";import{b as J,V as T,c as be}from"./VCard-BS__dGOO.js";import{V as N}from"./VCardText-BOTswayt.js";import{V as ze}from"./VForm-CmZC-fy-.js";import{V as se,a as $}from"./VRow-yY4fG0sB.js";import{V as ye}from"./VSelect-B9qIr49F.js";import{a as ce,b as pe,d as Ie,V as Ue}from"./VList-D0K_6S33.js";import{V as Y}from"./VTextField-CEzXoRfQ.js";import{V as je}from"./VTextarea-j8PBoJ9o.js";import{V as qe}from"./VTable-BXXBU8Pu.js";import{V as Ne}from"./VAutocomplete-BAS7R5_S.js";import{V as ve}from"./VDivider-BZHAFeBt.js";import{V as Ve}from"./VSpacer-CX-6HcGf.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as le}from"./VChip-CxhAj40j.js";import{V as Ae,a as Be}from"./VDataTable-DCnuhqB_.js";import{V as Re}from"./VContainer-D6MWEg81.js";import{V as Fe}from"./VDataTableServer-C_-91Q-F.js";import{V as Ee}from"./VMenu-DvnoRXb3.js";import{V as Oe,a as Le}from"./VAlert-DFmPVfw3.js";import{V as Me}from"./VSnackbar-DrwRC8Dd.js";import"./VOverlay-ecUBiCQA.js";import"./forwardRefs-B931MWyl.js";import"./VImg-C910MdjQ.js";import"./VAvatar-ChsJyCUu.js";/* empty css              */import"./VCheckboxBtn-BH3ZQAdA.js";import"./filter-CgeN0Sso.js";const He={class:"d-flex align-center gap-2"},Qe={class:"d-flex flex-column"},Ke={key:0,class:"text-caption text-medium-emphasis"},Ge={class:"mt-6"},Xe={class:"d-flex justify-space-between align-center mb-4"},Je={key:0},We={class:"text-center font-weight-medium"},Ye={class:"text-center font-weight-medium"},Ze={class:"text-end"},et={class:"d-flex justify-space-between mb-2"},tt={class:"font-weight-medium"},at={class:"d-flex justify-space-between mb-2"},lt={class:"text-success"},st={class:"d-flex justify-space-between"},nt={class:"text-h6 font-weight-bold text-primary"},ot=ge({__name:"PurchaseDialog",props:{modelValue:{type:Boolean},purchase:{default:null},mode:{default:"create"}},emits:["update:modelValue","saved"],setup(ue,{emit:Z}){const h=ue,O=Z,A=ae({get:()=>h.modelValue,set:u=>O("update:modelValue",u)}),U=k(),j=k(!1),S=k(!1),C=k(!1),R=k(!1),H=k([]),F=k([]),_=k({id_supplier:null,purchase_date:new Date().toISOString().split("T")[0],notes:"",discount_amount:0,discount_amount_display:"0",items:[]}),p=ae(()=>h.mode==="edit"?"Edit Purchase Order":"Buat Purchase Order Baru"),s=ae(()=>{const u=_.value.items.reduce((g,d)=>g+(d.total_cost||0),0),n=Number.parseFloat(String(_.value.discount_amount_display).replace(/\D/g,""))||0,r=0,y=u-n+r;return{subtotal:u,discount:n,tax:r,total:y}}),V=ae(()=>j.value&&(_.value.items.length===0||_.value.items.every(u=>u.id_item&&u.quantity>0&&u.unit_cost>0))),z={required:u=>!!u||"Field ini wajib diisi"},D=async()=>{try{C.value=!0;const u=W(),n={"Content-Type":"application/json",Accept:"application/json"};u&&(n.Authorization=`Bearer ${u}`);const r=await G.get("/api/suppliers",{headers:n});H.value=r.data.data||[]}catch(u){console.error("Error loading suppliers:",u)}finally{C.value=!1}},L=async()=>{var u;try{R.value=!0;const n=W(),r={"Content-Type":"application/json",Accept:"application/json"};n&&(r.Authorization=`Bearer ${n}`);const y=await G.get("/api/items?per_page=all",{headers:r}),g=y.data.data;g&&g.data?F.value=g.data||[]:F.value=y.data.data||[]}catch(n){console.error("Error loading items:",n),console.error("Error response:",(u=n.response)==null?void 0:u.data)}finally{R.value=!1}},ne=u=>{try{const n=_.value.items[u];if(!n){console.warn("Item not found at index:",u);return}n.quantity>0&&n.total_cost>0?(n.unit_cost=n.total_cost/n.quantity,n.unit_cost_display=M(n.unit_cost).replace("Rp ","").replace(/\./g,"")):(n.unit_cost=0,n.unit_cost_display="0")}catch(n){console.error("Error in calculateUnitCost:",n)}},K=u=>{try{const n=_.value.items[u];if(!n){console.warn("Item not found at index:",u);return}n.quantity>0&&n.unit_cost>0?(n.total_cost=n.quantity*n.unit_cost,n.total_cost_display=new Intl.NumberFormat("id-ID").format(n.total_cost)):(n.total_cost=0,n.total_cost_display="0")}catch(n){console.error("Error in calculateTotalCost:",n)}},me=(u,n)=>{try{const r=_.value.items[u];if(!r||!n)return;const y=F.value.find(g=>g.id_item===n);y&&(r.unit=y.unit||"")}catch(r){console.error("Error in onItemChange:",r)}},ee=()=>{try{const u={id_item:null,quantity:0,unit:"",unit_cost:0,unit_cost_display:"0",total_cost:0,total_cost_display:"0"};_.value.items.push(u)}catch(u){console.error("Error in addItem:",u)}},re=u=>{_.value.items.splice(u,1)},f=(u,n)=>{var g;const r=(g=n.target)==null?void 0:g.value,y=_.value.items[u];r===""||r===null||r===void 0?y.quantity=0:y.quantity=Number.parseFloat(r)||1,K(u)},v=(u,n)=>{var d;const r=(d=n.target)==null?void 0:d.value,y=(r==null?void 0:r.replace(/\D/g,""))||"",g=_.value.items[u];y===""?(g.total_cost=0,g.total_cost_display="0"):(g.total_cost=Number.parseFloat(y),g.total_cost_display=new Intl.NumberFormat("id-ID").format(g.total_cost)),ne(u)},m=u=>{var y;const n=(y=u.target)==null?void 0:y.value,r=(n==null?void 0:n.replace(/\D/g,""))||"";r===""?_.value.discount_amount_display="0":_.value.discount_amount_display=new Intl.NumberFormat("id-ID").format(Number.parseInt(r))},x=()=>{},M=u=>Number.isNaN(u)||u===null||u===void 0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(u),X=()=>{var u,n,r;if(h.mode==="edit"&&h.purchase){const y=h.purchase.supplier_id||h.purchase.id_supplier||((u=h.purchase.supplier)==null?void 0:u.id_supplier)||((n=h.purchase.supplier)==null?void 0:n.id),g=y?Number.parseInt(String(y)):null,d=h.purchase.purchase_date?new Date(h.purchase.purchase_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0];_.value={id_supplier:g,purchase_date:d,notes:h.purchase.notes||"",discount_amount:h.purchase.discount_amount||0,discount_amount_display:new Intl.NumberFormat("id-ID").format(h.purchase.discount_amount||0),items:((r=h.purchase.items)==null?void 0:r.map(l=>{var te,ie;const o=Number.parseFloat(l.quantity_ordered||l.quantity||0)||0,b=Number.parseFloat(l.unit_cost||0)||0,q=o*b;return{id_item:((te=l.item)==null?void 0:te.id_item)||l.id_item,quantity:o,unit:((ie=l.item)==null?void 0:ie.unit)||l.unit||"",unit_cost:b,unit_cost_display:new Intl.NumberFormat("id-ID").format(b),total_cost:q,total_cost_display:new Intl.NumberFormat("id-ID").format(q)}}))||[]}}else _.value={id_supplier:null,purchase_date:new Date().toISOString().split("T")[0],notes:"",discount_amount:0,discount_amount_display:"0",items:[]}},de=async()=>{var u,n,r;if((u=U.value)!=null&&u.validate())try{S.value=!0;const y=W(),g={"Content-Type":"application/json",Accept:"application/json"};y&&(g.Authorization=`Bearer ${y}`);const d={supplier_id:_.value.id_supplier,purchase_date:_.value.purchase_date,notes:_.value.notes,discount_amount:Number.parseFloat(_.value.discount_amount_display.replace(/\D/g,""))||0,items:_.value.items.map(l=>({id_item:l.id_item,quantity:l.quantity,unit_cost:l.unit_cost}))};h.mode==="edit"?await G.put(`/api/purchases/${h.purchase.id_purchase}`,d,{headers:g}):await G.post("/api/purchases",d,{headers:g}),O("saved")}catch(y){console.error("Error saving purchase:",y),console.error("Error saving purchase:",((r=(n=y.response)==null?void 0:n.data)==null?void 0:r.message)||y.message)}finally{S.value=!1}},oe=()=>{A.value=!1},fe=()=>{_.value.items.forEach((u,n)=>{if(u.id_item&&!u.unit){const r=F.value.find(y=>y.id_item===u.id_item);r&&(u.unit=r.unit)}})};return _e(()=>h.modelValue,async u=>{u&&(await Promise.all([D(),L()]),await De(),X(),fe())}),_e(()=>h.purchase,async u=>{u&&h.mode==="edit"&&(H.value.length===0&&await D(),F.value.length===0&&await L(),await De(),X(),fe())},{deep:!0,immediate:!0}),$e(()=>{D(),L()}),(u,n)=>(w(),E(he,{modelValue:A.value,"onUpdate:modelValue":n[5]||(n[5]=r=>A.value=r),"max-width":"1200",persistent:""},{default:a(()=>[e(T,null,{default:a(()=>[e(J,{class:"d-flex align-center justify-space-between"},{default:a(()=>{var r;return[t("div",He,[e(Q,null,{default:a(()=>n[6]||(n[6]=[c("mdi-cart-plus")])),_:1,__:[6]}),t("div",Qe,[t("span",null,i(p.value),1),h.mode==="edit"&&((r=h.purchase)!=null&&r.purchase_number)?(w(),B("span",Ke," No. Order: "+i(h.purchase.purchase_number),1)):I("",!0)])]),e(P,{icon:"mdi-close",size:"small",variant:"text",onClick:oe})]}),_:1}),e(N,null,{default:a(()=>[e(ze,{ref_key:"form",ref:U,modelValue:j.value,"onUpdate:modelValue":n[3]||(n[3]=r=>j.value=r)},{default:a(()=>[e(se,null,{default:a(()=>[e($,{cols:"12",md:"6"},{default:a(()=>[e(ye,{modelValue:_.value.id_supplier,"onUpdate:modelValue":n[0]||(n[0]=r=>_.value.id_supplier=r),label:"Supplier *",items:H.value,"item-title":"name","item-value":"id_supplier",variant:"outlined",rules:[z.required],loading:C.value},{item:a(({props:r,item:y})=>[e(ce,Pe(Te(r)),{default:a(()=>[e(pe,null,{default:a(()=>[c(i(y.raw.name),1)]),_:2},1024),e(Ie,null,{default:a(()=>[c(i(y.raw.phone)+" - "+i(y.raw.email),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","rules","loading"])]),_:1}),e($,{cols:"12",md:"3"},{default:a(()=>[e(Y,{modelValue:_.value.purchase_date,"onUpdate:modelValue":n[1]||(n[1]=r=>_.value.purchase_date=r),label:"Tanggal Purchase *",type:"date",variant:"outlined",rules:[z.required]},null,8,["modelValue","rules"])]),_:1}),e($,{cols:"12"},{default:a(()=>[e(je,{modelValue:_.value.notes,"onUpdate:modelValue":n[2]||(n[2]=r=>_.value.notes=r),label:"Catatan",variant:"outlined",rows:"2",placeholder:"Catatan tambahan untuk purchase order ini..."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t("div",Ge,[t("div",Xe,[n[9]||(n[9]=t("h3",{class:"text-h6"}," Items Purchase ",-1)),e(P,{color:"primary",variant:"tonal",onClick:ee},{default:a(()=>[e(Q,{start:""},{default:a(()=>n[7]||(n[7]=[c(" mdi-plus ")])),_:1,__:[7]}),n[8]||(n[8]=c(" Tambah Item "))]),_:1,__:[8]})]),e(T,{variant:"outlined"},{default:a(()=>[e(qe,null,{default:a(()=>[n[11]||(n[11]=t("thead",null,[t("tr",null,[t("th",{style:{"inline-size":"35%"}}," Item "),t("th",{style:{"inline-size":"12%"}}," Quantity "),t("th",{style:{"inline-size":"10%"}}," Unit "),t("th",{style:{"inline-size":"15%"}}," Total Harga "),t("th",{style:{"inline-size":"15%"}}," Harga Satuan "),t("th",{style:{"inline-size":"13%"}}," Action ")])],-1)),t("tbody",null,[_.value.items.length===0?(w(),B("tr",Je,n[10]||(n[10]=[t("td",{colspan:"6",class:"text-center py-8 text-medium-emphasis"},' Belum ada item. Klik "Tambah Item" untuk menambah item purchase. ',-1)]))):I("",!0),(w(!0),B(xe,null,we(_.value.items,(r,y)=>(w(),B("tr",{key:y},[t("td",null,[e(Ne,{modelValue:r.id_item,"onUpdate:modelValue":[g=>r.id_item=g,g=>me(y,g)],label:"Pilih Item",items:F.value,"item-title":"name","item-value":"id_item",variant:"outlined",density:"compact",loading:R.value,clearable:"","no-data-text":"Tidak ada item ditemukan"},{item:a(({props:g,item:d})=>[e(ce,Se({ref_for:!0},g),{default:a(()=>[e(pe,null,{default:a(()=>[c(i(d.raw.name),1)]),_:2},1024),e(Ie,null,{default:a(()=>{var l;return[c(i((l=d.raw.category)==null?void 0:l.name)+" - SKU: "+i(d.raw.sku),1)]}),_:2},1024)]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","items","loading"])]),t("td",null,[e(Y,{modelValue:r.quantity,"onUpdate:modelValue":g=>r.quantity=g,label:"Qty",type:"number",min:"1",step:"1",variant:"outlined",density:"compact",onInput:g=>f(y,g),onBlur:g=>ne(y)},null,8,["modelValue","onUpdate:modelValue","onInput","onBlur"])]),t("td",null,[t("div",We,i(r.unit||"-"),1)]),t("td",null,[e(Y,{modelValue:r.total_cost_display,"onUpdate:modelValue":g=>r.total_cost_display=g,label:"Total Harga",variant:"outlined",density:"compact",prefix:"Rp",onInput:g=>v(y,g),onBlur:g=>ne(y)},null,8,["modelValue","onUpdate:modelValue","onInput","onBlur"])]),t("td",null,[t("div",Ye,i(M(r.unit_cost)),1)]),t("td",null,[e(P,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:g=>re(y)},null,8,["onClick"])])]))),128))])]),_:1,__:[11]})]),_:1}),e(T,{class:"mt-4",variant:"outlined"},{default:a(()=>[e(N,null,{default:a(()=>[e(se,null,{default:a(()=>[e($,{cols:"12",md:"8"},{default:a(()=>[e(Y,{modelValue:_.value.discount_amount_display,"onUpdate:modelValue":n[4]||(n[4]=r=>_.value.discount_amount_display=r),label:"Diskon",variant:"outlined",prefix:"Rp",placeholder:"0",onInput:m,onBlur:x},null,8,["modelValue"])]),_:1}),e($,{cols:"12",md:"4"},{default:a(()=>[t("div",Ze,[t("div",et,[n[12]||(n[12]=t("span",null,"Subtotal:",-1)),t("span",tt,i(M(s.value.subtotal)),1)]),t("div",at,[n[13]||(n[13]=t("span",null,"Diskon:",-1)),t("span",lt,"-"+i(M(s.value.discount)),1)]),e(ve,{class:"my-2"}),t("div",st,[n[14]||(n[14]=t("span",{class:"text-h6 font-weight-bold"},"Total:",-1)),t("span",nt,i(M(s.value.total)),1)])])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),e(be,{class:"pa-4"},{default:a(()=>[e(Ve),e(P,{variant:"text",onClick:oe},{default:a(()=>n[15]||(n[15]=[c(" Batal ")])),_:1,__:[15]}),e(P,{color:"primary",loading:S.value,disabled:!V.value,onClick:de},{default:a(()=>[c(i(u.mode==="edit"?"Update":"Simpan"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),it=ke(ot,[["__scopeId","data-v-e977d637"]]),ut={class:"d-flex align-center gap-3"},rt={class:"d-flex justify-space-between align-center"},dt={class:"text-h6"},ct={class:"text-body-1"},pt={class:"font-weight-medium"},mt={class:"text-caption text-medium-emphasis"},vt={class:"font-weight-medium"},ft={class:"d-flex justify-space-between"},_t={class:"font-weight-medium"},yt=ge({__name:"PurchaseReceiveDialog",props:{modelValue:{type:Boolean},purchase:{}},emits:["update:modelValue","success"],setup(ue,{emit:Z}){const h=ue,O=Z,A=k(!1),U=k(!1),j=k(new Date().toISOString().split("T")[0]),S=k([]),C=ae({get:()=>h.modelValue,set:f=>O("update:modelValue",f)}),R=ae(()=>j.value&&s()>0&&!U.value),H=[{title:"Item",key:"item_name",sortable:!1,width:"250px"},{title:"Ordered",key:"quantity_ordered",sortable:!1,width:"110px"},{title:"Received",key:"quantity_received",sortable:!1,width:"110px"},{title:"Remaining",key:"remaining",sortable:!1,width:"110px"},{title:"Receive Qty",key:"receive_quantity",sortable:!1,width:"140px"},{title:"Quality",key:"quality_check",sortable:!1,width:"140px"},{title:"Notes",key:"notes",sortable:!1,width:"200px"},{title:"Status",key:"status",sortable:!1,width:"120px"}],F=[{title:"✅ Good",value:"good"},{title:"❌ Damaged",value:"damaged"},{title:"⏰ Expired",value:"expired"},{title:"⚠️ Issues",value:"partial"}],_=f=>f.quantity_ordered-(f.quantity_received||0),p=f=>{const v=_(f);return v<=0?"text-success":v<f.quantity_ordered*.5?"text-warning":""},s=()=>S.value.filter(f=>f.receive_quantity&&f.receive_quantity>0).length,V=f=>{const v=_(f);f.receive_quantity>v&&(f.receive_quantity=v),f.receive_quantity<0&&(f.receive_quantity=0)},z=f=>({pending:"warning",ordered:"info",partial:"primary",received:"success",completed:"success",cancelled:"error"})[f]||"default",D=f=>({pending:"Pending",ordered:"Ordered",partial:"Partial",received:"Received",completed:"Completed",cancelled:"Cancelled"})[f]||f,L=f=>({pending:"warning",partial:"primary",received:"success"})[f]||"default",ne=f=>({pending:"Pending",partial:"Partial",received:"Complete"})[f]||f,K=f=>new Date(f).toLocaleDateString("id-ID"),me=async()=>{var f,v;if((f=h.purchase)!=null&&f.id_purchase){A.value=!0;try{if(h.purchase.items&&h.purchase.items.length>0){S.value=h.purchase.items.map(x=>({...x,receive_quantity:0,quality_condition:"good",receive_notes:""})),A.value=!1;return}const m=await G.get(`/api/purchases/${h.purchase.id_purchase}`,{headers:{Authorization:`Bearer ${W()}`}});m.data.success&&((v=m.data.data)!=null&&v.items)&&(S.value=m.data.data.items.map(x=>({...x,receive_quantity:0,quality_condition:"good",receive_notes:""})))}catch(m){console.error("Error loading purchase items:",m)}finally{A.value=!1}}},ee=async()=>{if(!R.value)return;const f=S.value.filter(v=>v.receive_quantity&&v.receive_quantity>0).map(v=>({id_purchase_item:v.id_purchase_item,quantity_received:v.receive_quantity,quality_check:{condition:v.quality_condition,checked_at:new Date().toISOString(),checked_by:"current_user"},notes:v.receive_notes||null}));if(f.length!==0){U.value=!0;try{const v=await G.post(`/api/purchases/${h.purchase.id_purchase}/receive`,{items:f,delivery_date:j.value},{headers:{Authorization:`Bearer ${W()}`}});v.data.success&&(O("success",v.data),re())}catch(v){console.error("Error receiving items:",v)}finally{U.value=!1}}},re=()=>{C.value=!1,S.value=[],j.value=new Date().toISOString().split("T")[0]};return _e(C,f=>{f&&h.purchase&&me()}),(f,v)=>(w(),E(he,{modelValue:C.value,"onUpdate:modelValue":v[1]||(v[1]=m=>C.value=m),"max-width":"1400px",persistent:""},{default:a(()=>[e(T,null,{default:a(()=>[e(J,{class:"pa-4"},{default:a(()=>{var m;return[t("div",ut,[e(Q,{icon:"mdi-package-variant"}),t("span",null,"Receive Items - Purchase #"+i((m=f.purchase)==null?void 0:m.purchase_number),1)])]}),_:1}),e(ve),e(N,{class:"pa-4"},{default:a(()=>[e(T,{variant:"outlined",class:"mb-4"},{default:a(()=>[e(N,{class:"pa-3"},{default:a(()=>{var m,x,M,X;return[t("div",rt,[t("div",null,[v[2]||(v[2]=t("div",{class:"text-body-2 text-medium-emphasis"}," Supplier ",-1)),t("div",dt,i((x=(m=f.purchase)==null?void 0:m.supplier)==null?void 0:x.name),1)]),t("div",null,[v[3]||(v[3]=t("div",{class:"text-body-2 text-medium-emphasis"}," Order Date ",-1)),t("div",ct,i(K((M=f.purchase)==null?void 0:M.purchase_date)),1)]),t("div",null,[v[4]||(v[4]=t("div",{class:"text-body-2 text-medium-emphasis"}," Status ",-1)),e(le,{color:z((X=f.purchase)==null?void 0:X.status),variant:"tonal",size:"small"},{default:a(()=>{var de;return[c(i(D((de=f.purchase)==null?void 0:de.status)),1)]}),_:1},8,["color"])])])]}),_:1})]),_:1}),e(se,{class:"mb-4"},{default:a(()=>[e($,{cols:"12",md:"6"},{default:a(()=>[e(Y,{modelValue:j.value,"onUpdate:modelValue":v[0]||(v[0]=m=>j.value=m),label:"Delivery Date",type:"date",variant:"outlined",rules:[m=>!!m||"Delivery date is required"],required:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),v[7]||(v[7]=t("div",{class:"text-h6 mb-3"}," Items to Receive ",-1)),e(Ae,{headers:H,items:S.value,loading:A.value,"item-key":"id_purchase_item",class:"border rounded",density:"compact"},{"item.item_name":a(({item:m})=>{var x,M;return[t("div",null,[t("div",pt,i((x=m.item)==null?void 0:x.name),1),t("div",mt,i((M=m.item)==null?void 0:M.item_code),1)])]}),"item.quantity_ordered":a(({item:m})=>{var x;return[t("span",vt,i(parseInt(m.quantity_ordered))+" "+i((x=m.item)==null?void 0:x.unit),1)]}),"item.quantity_received":a(({item:m})=>{var x;return[t("span",{class:Ce(m.quantity_received>0?"text-success":"")},i(m.quantity_received||0)+" "+i((x=m.item)==null?void 0:x.unit),3)]}),"item.remaining":a(({item:m})=>{var x;return[t("span",{class:Ce(["font-weight-medium",p(m)])},i(_(m))+" "+i((x=m.item)==null?void 0:x.unit),3)]}),"item.receive_quantity":a(({item:m})=>[e(Y,{modelValue:m.receive_quantity,"onUpdate:modelValue":x=>m.receive_quantity=x,modelModifiers:{number:!0},type:"number",min:0,max:_(m),step:"0.001",density:"compact",variant:"outlined",style:{"inline-size":"140px"},disabled:_(m)<=0,onInput:x=>V(m)},null,8,["modelValue","onUpdate:modelValue","max","disabled","onInput"])]),"item.quality_check":a(({item:m})=>[e(ye,{modelValue:m.quality_condition,"onUpdate:modelValue":x=>m.quality_condition=x,items:F,density:"compact",variant:"outlined",style:{"inline-size":"140px"},disabled:!m.receive_quantity||m.receive_quantity<=0},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.notes":a(({item:m})=>[e(Y,{modelValue:m.receive_notes,"onUpdate:modelValue":x=>m.receive_notes=x,placeholder:"Notes...",density:"compact",variant:"outlined",style:{"inline-size":"200px"},disabled:!m.receive_quantity||m.receive_quantity<=0},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.status":a(({item:m})=>[e(le,{color:L(m.status),variant:"tonal",size:"small"},{default:a(()=>[c(i(ne(m.status)),1)]),_:2},1032,["color"])]),_:1},8,["items","loading"]),e(T,{variant:"outlined",class:"mt-4"},{default:a(()=>[e(N,{class:"pa-3"},{default:a(()=>[v[6]||(v[6]=t("div",{class:"text-body-2 text-medium-emphasis mb-2"}," Receive Summary ",-1)),t("div",ft,[v[5]||(v[5]=t("span",null,"Items to receive:",-1)),t("span",_t,i(s()),1)])]),_:1,__:[6]})]),_:1})]),_:1,__:[7]}),e(ve),e(be,{class:"pa-4"},{default:a(()=>[e(Ve),e(P,{variant:"outlined",disabled:U.value,onClick:re},{default:a(()=>v[8]||(v[8]=[c(" Cancel ")])),_:1,__:[8]},8,["disabled"]),e(P,{color:"primary",loading:U.value,disabled:!R.value,onClick:ee},{default:a(()=>[e(Q,{start:"",icon:"mdi-check"}),v[9]||(v[9]=c(" Confirm Receipt "))]),_:1,__:[9]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),gt={class:"d-flex align-center gap-2"},ht={class:"mb-2"},bt={class:"text-primary font-weight-medium"},Vt={class:"mb-2"},wt={class:"mb-2"},xt={key:0,class:"mb-2"},kt={key:1},Dt={class:"mb-2"},Ct={class:"mb-2"},It={class:"mb-2"},$t={class:"mb-1 font-weight-medium"},St={key:0,class:"text-caption text-medium-emphasis mb-0"},qt={key:1,class:"text-caption text-medium-emphasis mb-0"},Pt={class:"text-center"},Tt={key:0},zt={class:"text-right font-weight-medium"},Ut={class:"text-right font-weight-medium"},jt={class:"text-center"},Nt={class:"mb-0"},At={class:"mb-2"},Bt={key:0},Rt={class:"d-flex justify-space-between mb-2"},Ft={class:"font-weight-medium"},Et={key:0,class:"d-flex justify-space-between mb-2"},Ot={class:"text-success"},Lt={class:"d-flex justify-space-between"},Mt={class:"text-h6 font-weight-bold text-primary"},Ht=ge({__name:"PurchaseViewDialog",props:{modelValue:{type:Boolean},purchase:{default:null}},emits:["update:modelValue"],setup(ue,{emit:Z}){const h=ue,O=Z,A=ae({get:()=>h.modelValue,set:p=>O("update:modelValue",p)}),U=ae(()=>h.purchase&&h.purchase.status!=="cancelled"),j=()=>{A.value=!1},S=p=>{const s=typeof p=="string"?parseFloat(p):p;return isNaN(s)||s===null||s===void 0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s)},C=p=>p?new Date(p).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"}):"-",R=p=>p?new Date(p).toLocaleString("id-ID",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",H=p=>({pending:"warning",partial:"info",received:"success",cancelled:"error"})[p]||"default",F=p=>({pending:"Pending",partial:"Sebagian",received:"Diterima",cancelled:"Dibatalkan"})[p]||p,_=()=>{window.print()};return(p,s)=>(w(),E(he,{modelValue:A.value,"onUpdate:modelValue":s[0]||(s[0]=V=>A.value=V),"max-width":"900",persistent:""},{default:a(()=>[e(T,null,{default:a(()=>[e(J,{class:"d-flex align-center justify-space-between"},{default:a(()=>[t("div",gt,[e(Q,null,{default:a(()=>s[1]||(s[1]=[c("mdi-file-document-outline")])),_:1,__:[1]}),s[2]||(s[2]=t("span",null,"Purchase Order Detail",-1))]),e(P,{icon:"mdi-close",size:"small",variant:"text",onClick:j})]),_:1}),p.purchase?(w(),E(N,{key:0},{default:a(()=>[e(se,{class:"mb-6"},{default:a(()=>[e($,{cols:"12",md:"6"},{default:a(()=>[e(T,{variant:"outlined"},{default:a(()=>[e(J,{class:"text-subtitle-1"},{default:a(()=>s[3]||(s[3]=[c("Purchase Information")])),_:1,__:[3]}),e(N,null,{default:a(()=>[t("div",ht,[s[4]||(s[4]=t("strong",null,"Purchase Number:",-1)),s[5]||(s[5]=t("br",null,null,-1)),t("span",bt,i(p.purchase.purchase_number),1)]),t("div",Vt,[s[6]||(s[6]=t("strong",null,"Status:",-1)),s[7]||(s[7]=t("br",null,null,-1)),e(le,{color:H(p.purchase.status),size:"small",variant:"elevated"},{default:a(()=>[c(i(F(p.purchase.status)),1)]),_:1},8,["color"])]),t("div",wt,[s[8]||(s[8]=t("strong",null,"Tanggal Purchase:",-1)),s[9]||(s[9]=t("br",null,null,-1)),c(" "+i(C(p.purchase.purchase_date)),1)]),p.purchase.expected_delivery_date?(w(),B("div",xt,[s[10]||(s[10]=t("strong",null,"Tanggal Kirim Diharapkan:",-1)),s[11]||(s[11]=t("br",null,null,-1)),c(" "+i(C(p.purchase.expected_delivery_date)),1)])):I("",!0),p.purchase.actual_delivery_date?(w(),B("div",kt,[s[12]||(s[12]=t("strong",null,"Tanggal Kirim Aktual:",-1)),s[13]||(s[13]=t("br",null,null,-1)),c(" "+i(C(p.purchase.actual_delivery_date)),1)])):I("",!0)]),_:1})]),_:1})]),_:1}),e($,{cols:"12",md:"6"},{default:a(()=>[e(T,{variant:"outlined"},{default:a(()=>[e(J,{class:"text-subtitle-1"},{default:a(()=>s[14]||(s[14]=[c("Supplier Information")])),_:1,__:[14]}),e(N,null,{default:a(()=>{var V,z,D,L;return[t("div",Dt,[s[15]||(s[15]=t("strong",null,"Nama Supplier:",-1)),s[16]||(s[16]=t("br",null,null,-1)),c(" "+i(((V=p.purchase.supplier)==null?void 0:V.name)||"-"),1)]),t("div",Ct,[s[17]||(s[17]=t("strong",null,"Telepon:",-1)),s[18]||(s[18]=t("br",null,null,-1)),c(" "+i(((z=p.purchase.supplier)==null?void 0:z.phone)||"-"),1)]),t("div",It,[s[19]||(s[19]=t("strong",null,"Email:",-1)),s[20]||(s[20]=t("br",null,null,-1)),c(" "+i(((D=p.purchase.supplier)==null?void 0:D.email)||"-"),1)]),t("div",null,[s[21]||(s[21]=t("strong",null,"Alamat:",-1)),s[22]||(s[22]=t("br",null,null,-1)),c(" "+i(((L=p.purchase.supplier)==null?void 0:L.address)||"-"),1)])]}),_:1})]),_:1})]),_:1})]),_:1}),e(T,{variant:"outlined",class:"mb-6"},{default:a(()=>[e(J,{class:"text-subtitle-1"},{default:a(()=>s[23]||(s[23]=[c("Items Purchase")])),_:1,__:[23]}),e(qe,null,{default:a(()=>[s[24]||(s[24]=t("thead",null,[t("tr",null,[t("th",null,"Item"),t("th",{class:"text-center"},"Qty"),t("th",{class:"text-right"},"Unit Cost"),t("th",{class:"text-right"},"Total Cost"),t("th",{class:"text-center"},"Status")])],-1)),t("tbody",null,[(w(!0),B(xe,null,we(p.purchase.items,V=>{var z,D,L;return w(),B("tr",{key:V.id_purchase_item},[t("td",null,[t("div",null,[t("p",$t,i(((z=V.item)==null?void 0:z.name)||"-"),1),(D=V.item)!=null&&D.code?(w(),B("p",St," Code: "+i(V.item.code),1)):I("",!0),(L=V.item)!=null&&L.description?(w(),B("p",qt,i(V.item.description),1)):I("",!0)])]),t("td",Pt,[e(le,{size:"small",variant:"outlined"},{default:a(()=>[c(i(parseInt(V.quantity_ordered))+" "+i(V.unit||"pcs"),1)]),_:2},1024),V.quantity_received>0?(w(),B("br",Tt)):I("",!0),V.quantity_received>0?(w(),E(le,{key:1,size:"x-small",variant:"tonal",color:"success",class:"mt-1"},{default:a(()=>[c(" Received: "+i(parseInt(V.quantity_received)),1)]),_:2},1024)):I("",!0)]),t("td",zt,i(S(V.unit_cost)),1),t("td",Ut,i(S(V.total_cost)),1),t("td",jt,[e(le,{color:H(V.status),size:"small",variant:"tonal"},{default:a(()=>[c(i(F(V.status)),1)]),_:2},1032,["color"])])])}),128))])]),_:1,__:[24]})]),_:1}),e(se,null,{default:a(()=>[e($,{cols:"12",md:"6"},{default:a(()=>[p.purchase.notes?(w(),E(T,{key:0,variant:"outlined"},{default:a(()=>[e(J,{class:"text-subtitle-1"},{default:a(()=>s[25]||(s[25]=[c("Catatan")])),_:1,__:[25]}),e(N,null,{default:a(()=>[t("p",Nt,i(p.purchase.notes),1)]),_:1})]),_:1})):I("",!0),e(T,{variant:"outlined",class:"mt-4"},{default:a(()=>[e(J,{class:"text-subtitle-1"},{default:a(()=>s[26]||(s[26]=[c("Purchase History")])),_:1,__:[26]}),e(N,null,{default:a(()=>{var V,z;return[t("div",At,[s[27]||(s[27]=t("strong",null,"Dibuat oleh:",-1)),s[28]||(s[28]=t("br",null,null,-1)),c(" "+i(((V=p.purchase.creator)==null?void 0:V.name)||"-")+" • "+i(R(p.purchase.created_at)),1)]),p.purchase.updated_at&&p.purchase.updated_at!==p.purchase.created_at?(w(),B("div",Bt,[s[29]||(s[29]=t("strong",null,"Diupdate oleh:",-1)),s[30]||(s[30]=t("br",null,null,-1)),c(" "+i(((z=p.purchase.updater)==null?void 0:z.name)||"-")+" • "+i(R(p.purchase.updated_at)),1)])):I("",!0)]}),_:1})]),_:1})]),_:1}),e($,{cols:"12",md:"6"},{default:a(()=>[e(T,{variant:"outlined"},{default:a(()=>[e(J,{class:"text-subtitle-1"},{default:a(()=>s[31]||(s[31]=[c("Total Summary")])),_:1,__:[31]}),e(N,null,{default:a(()=>[t("div",Rt,[s[32]||(s[32]=t("span",null,"Subtotal:",-1)),t("span",Ft,i(S(p.purchase.subtotal)),1)]),p.purchase.discount_amount>0?(w(),B("div",Et,[s[33]||(s[33]=t("span",null,"Diskon:",-1)),t("span",Ot,"-"+i(S(p.purchase.discount_amount)),1)])):I("",!0),e(ve,{class:"my-3"}),t("div",Lt,[s[34]||(s[34]=t("span",{class:"text-h6 font-weight-bold"},"Total:",-1)),t("span",Mt,i(S(p.purchase.total_amount)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):I("",!0),e(be,{class:"pa-4"},{default:a(()=>[e(Ve),e(P,{variant:"text",onClick:j},{default:a(()=>s[35]||(s[35]=[c(" Tutup ")])),_:1,__:[35]}),U.value?(w(),E(P,{key:0,color:"primary",variant:"tonal","prepend-icon":"mdi-printer",onClick:_},{default:a(()=>s[36]||(s[36]=[c(" Print ")])),_:1,__:[36]})):I("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Qt=ke(Ht,[["__scopeId","data-v-da47fee6"]]),Kt={class:"d-flex justify-space-between align-center"},Gt={class:"d-flex justify-space-between align-center"},Xt={class:"text-h4 font-weight-bold text-white"},Jt={class:"d-flex justify-space-between align-center"},Wt={class:"text-h4 font-weight-bold text-white"},Yt={class:"d-flex justify-space-between align-center"},Zt={class:"text-h4 font-weight-bold text-white"},ea={class:"d-flex justify-space-between align-center"},ta={class:"text-h4 font-weight-bold text-white"},aa={class:"d-flex align-center"},la={class:"mb-0 font-weight-medium"},sa={class:"text-caption text-medium-emphasis mb-0"},na={class:"font-weight-medium"},oa={class:"d-flex gap-1"},ia={class:"d-flex justify-center pt-2"},ua={key:0,class:"bg-grey-lighten-4 pa-3 rounded mt-3"},ra={class:"d-flex justify-space-between mb-2"},da={class:"d-flex justify-space-between mb-2"},ca={class:"d-flex justify-space-between mb-2"},pa={class:"d-flex justify-space-between mb-2"},ma={class:"d-flex justify-space-between"},va={class:"max-height-150 overflow-y-auto"},fa=ge({__name:"purchases-management",setup(ue){const Z=k([]),h=k([]),O=k({}),A=k(!1),U=k(1),j=k(15),S=k(0),C=k({show:!1,message:"",color:"success"}),R=k(!1),H=k(!1),F=k(!1),_=k(!1),p=k(null),s=k(null),V=k(!1),z=k("create"),D=k({search:"",status:"",supplier_id:"",start_date:"",end_date:""}),L=[{title:"Purchase Number",key:"purchase_number",sortable:!0},{title:"Supplier",key:"supplier.name",sortable:!1},{title:"Tanggal",key:"purchase_date",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Total",key:"total_amount",sortable:!0},{title:"Actions",key:"actions",sortable:!1,width:"150px"}],ne=[{label:"Semua Status",value:""},{label:"Pending",value:"pending"},{label:"Ordered",value:"ordered"},{label:"Received",value:"received"},{label:"Completed",value:"completed"},{label:"Cancelled",value:"cancelled"}],K=async()=>{var d,l;try{A.value=!0;const o={page:U.value,per_page:j.value};Object.keys(D.value).forEach(ie=>{D.value[ie]&&D.value[ie]!==""&&(o[ie]=D.value[ie])});const b=W(),q={"Content-Type":"application/json",Accept:"application/json"};b&&(q.Authorization=`Bearer ${b}`);const te=await G.get("/api/purchases",{params:o,headers:q});Z.value=te.data.data.data||[],S.value=te.data.data.total||0}catch(o){console.error("Error loading purchases:",o),C.value={show:!0,message:"Error loading purchases: "+(((l=(d=o.response)==null?void 0:d.data)==null?void 0:l.message)||o.message),color:"error"}}finally{A.value=!1}},me=async()=>{try{const d=W(),l={"Content-Type":"application/json",Accept:"application/json"};d&&(l.Authorization=`Bearer ${d}`);const o=await G.get("/api/suppliers",{headers:l});h.value=o.data.data||[]}catch(d){console.error("Error loading suppliers:",d)}},ee=async()=>{try{const d=W(),l={"Content-Type":"application/json",Accept:"application/json"};d&&(l.Authorization=`Bearer ${d}`);const o=await G.get("/api/purchases/statistics",{headers:l});O.value=o.data.data||{}}catch(d){console.error("Error loading statistics:",d)}},re=()=>{p.value=null,z.value="create",R.value=!0},f=d=>{p.value=d,z.value="edit",R.value=!0},v=d=>{p.value=d,H.value=!0},m=d=>{p.value=d,F.value=!0},x=d=>{s.value=d,_.value=!0},M=async()=>{var d,l;if(s.value){V.value=!0;try{const o=W(),b={"Content-Type":"application/json",Accept:"application/json"};o&&(b.Authorization=`Bearer ${o}`),await G.delete(`/api/purchases/${s.value.id_purchase}`,{headers:b}),C.value={show:!0,message:`Purchase ${s.value.purchase_number} berhasil dihapus`,color:"success"},_.value=!1,s.value=null,K(),ee()}catch(o){console.error("Error deleting purchase:",o),C.value={show:!0,message:"Error menghapus purchase: "+(((l=(d=o.response)==null?void 0:d.data)==null?void 0:l.message)||o.message),color:"error"}}finally{V.value=!1}}},X=async(d,l)=>{var o,b;try{const q=W(),te={"Content-Type":"application/json",Accept:"application/json"};q&&(te.Authorization=`Bearer ${q}`),await G.patch(`/api/purchases/${d.id_purchase}/status`,{status:l},{headers:te}),K(),ee(),C.value={show:!0,message:`Purchase status berhasil diubah ke ${l}!`,color:"success"}}catch(q){console.error("Error updating purchase status:",q),C.value={show:!0,message:"Error updating status: "+(((b=(o=q.response)==null?void 0:o.data)==null?void 0:b.message)||q.message),color:"error"}}},de=()=>{R.value=!1,K(),ee(),C.value={show:!0,message:z.value==="create"?"Purchase order berhasil dibuat!":"Purchase order berhasil diperbarui!",color:"success"}},oe=d=>{const l=typeof d=="string"?parseFloat(d):d;return isNaN(l)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(l)},fe=d=>d?new Date(d).toLocaleDateString("id-ID"):"-",u=d=>!d.items||!Array.isArray(d.items)?0:d.items.reduce((o,b)=>{const q=parseInt(b.quantity_ordered)||0;return o+q},0),n=d=>({pending:"warning",ordered:"info",received:"primary",completed:"success",cancelled:"error"})[d]||"default",r=d=>({pending:"Pending",ordered:"Dipesan",received:"Diterima",completed:"Selesai",cancelled:"Dibatalkan"})[d]||d,y=d=>["pending","ordered","received","completed"].includes(d.status),g=d=>["pending","received","completed"].includes(d.status);return _e(D,()=>{U.value=1,K()},{deep:!0}),$e(()=>{K(),me(),ee()}),(d,l)=>(w(),E(Re,{fluid:""},{default:a(()=>[e(se,{class:"mb-4"},{default:a(()=>[e($,{cols:"12"},{default:a(()=>[t("div",Kt,[l[17]||(l[17]=t("div",null,[t("h1",{class:"text-h4 font-weight-bold"},"Purchase Management"),t("p",{class:"text-body-1 text-medium-emphasis"},"Kelola pembelian barang dari supplier")],-1)),e(P,{color:"primary",size:"large",onClick:re},{default:a(()=>[e(Q,{start:""},{default:a(()=>l[15]||(l[15]=[c("mdi-plus")])),_:1,__:[15]}),l[16]||(l[16]=c(" Buat Purchase Order "))]),_:1,__:[16]})])]),_:1})]),_:1}),e(se,{class:"mb-6"},{default:a(()=>[e($,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(T,{color:"primary"},{default:a(()=>[e(N,null,{default:a(()=>[t("div",Gt,[t("div",null,[l[18]||(l[18]=t("p",{class:"text-caption text-white mb-1"},"Total Purchase",-1)),t("p",Xt,i(O.value.total_purchases||0),1)]),e(Q,{size:"40",class:"text-white"},{default:a(()=>l[19]||(l[19]=[c("mdi-cart")])),_:1,__:[19]})])]),_:1})]),_:1})]),_:1}),e($,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(T,{color:"warning"},{default:a(()=>[e(N,null,{default:a(()=>[t("div",Jt,[t("div",null,[l[20]||(l[20]=t("p",{class:"text-caption text-white mb-1"},"Pending",-1)),t("p",Wt,i(O.value.pending_purchases||0),1)]),e(Q,{size:"40",class:"text-white"},{default:a(()=>l[21]||(l[21]=[c("mdi-clock")])),_:1,__:[21]})])]),_:1})]),_:1})]),_:1}),e($,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(T,{color:"success"},{default:a(()=>[e(N,null,{default:a(()=>[t("div",Yt,[t("div",null,[l[22]||(l[22]=t("p",{class:"text-caption text-white mb-1"},"Completed",-1)),t("p",Zt,i(O.value.completed_purchases||0),1)]),e(Q,{size:"40",class:"text-white"},{default:a(()=>l[23]||(l[23]=[c("mdi-check-circle")])),_:1,__:[23]})])]),_:1})]),_:1})]),_:1}),e($,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(T,{color:"info"},{default:a(()=>[e(N,null,{default:a(()=>[t("div",ea,[t("div",null,[l[24]||(l[24]=t("p",{class:"text-caption text-white mb-1"},"Bulan Ini",-1)),t("p",ta,i(oe(O.value.total_amount_this_month||0)),1)]),e(Q,{size:"40",class:"text-white"},{default:a(()=>l[25]||(l[25]=[c("mdi-currency-usd")])),_:1,__:[25]})])]),_:1})]),_:1})]),_:1})]),_:1}),e(T,{class:"mb-6"},{default:a(()=>[e(N,null,{default:a(()=>[e(se,null,{default:a(()=>[e($,{cols:"12",md:"3"},{default:a(()=>[e(Y,{modelValue:D.value.search,"onUpdate:modelValue":l[0]||(l[0]=o=>D.value.search=o),label:"Cari Purchase Number atau Supplier",placeholder:"Masukkan nomor purchase atau nama supplier","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"","onClick:clear":l[1]||(l[1]=o=>D.value.search="")},null,8,["modelValue"])]),_:1}),e($,{cols:"12",md:"2"},{default:a(()=>[e(ye,{modelValue:D.value.status,"onUpdate:modelValue":l[2]||(l[2]=o=>D.value.status=o),label:"Status",items:ne,"item-title":"label","item-value":"value",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e($,{cols:"12",md:"2"},{default:a(()=>[e(ye,{modelValue:D.value.supplier_id,"onUpdate:modelValue":l[3]||(l[3]=o=>D.value.supplier_id=o),label:"Supplier",items:h.value,"item-title":"name","item-value":"id_supplier",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),e($,{cols:"12",md:"2"},{default:a(()=>[e(Y,{modelValue:D.value.start_date,"onUpdate:modelValue":l[4]||(l[4]=o=>D.value.start_date=o),label:"Tanggal Mulai",type:"date",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e($,{cols:"12",md:"2"},{default:a(()=>[e(Y,{modelValue:D.value.end_date,"onUpdate:modelValue":l[5]||(l[5]=o=>D.value.end_date=o),label:"Tanggal Akhir",type:"date",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e($,{cols:"12",md:"1"},{default:a(()=>[e(P,{color:"primary",variant:"tonal",icon:"mdi-refresh",onClick:K})]),_:1})]),_:1})]),_:1})]),_:1}),e(T,null,{default:a(()=>[e(Fe,{"items-per-page":j.value,"onUpdate:itemsPerPage":l[7]||(l[7]=o=>j.value=o),page:U.value,"onUpdate:page":l[8]||(l[8]=o=>U.value=o),headers:L,items:Z.value,"items-length":S.value,loading:A.value,"item-value":"id_purchase","onUpdate:options":K},{"item.purchase_number":a(({item:o})=>[t("div",aa,[e(P,{variant:"text",color:"primary",size:"small",onClick:b=>v(o)},{default:a(()=>[c(i(o.purchase_number),1)]),_:2},1032,["onClick"])])]),"item.supplier.name":a(({item:o})=>{var b,q;return[t("div",null,[t("p",la,i(((b=o.supplier)==null?void 0:b.name)||"-"),1),t("p",sa,i(((q=o.supplier)==null?void 0:q.phone)||"-"),1)])]}),"item.purchase_date":a(({item:o})=>[c(i(fe(o.purchase_date)),1)]),"item.status":a(({item:o})=>[e(le,{color:n(o.status),size:"small",variant:"elevated"},{default:a(()=>[c(i(r(o.status)),1)]),_:2},1032,["color"])]),"item.total_amount":a(({item:o})=>[t("span",na,i(oe(o.total_amount)),1)]),"item.actions":a(({item:o})=>[t("div",oa,[e(P,{icon:"mdi-eye",size:"small",variant:"text",color:"info",onClick:b=>v(o)},null,8,["onClick"]),y(o)?(w(),E(P,{key:0,icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:b=>f(o)},null,8,["onClick"])):I("",!0),["ordered","received","completed"].includes(o.status)?(w(),E(P,{key:1,icon:"mdi-truck-delivery",size:"small",variant:"text",color:"success",onClick:b=>m(o)},null,8,["onClick"])):I("",!0),g(o)?(w(),E(P,{key:2,icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:b=>x(o)},null,8,["onClick"])):I("",!0),e(Ee,null,{activator:a(({props:b})=>[e(P,Se({icon:"mdi-dots-vertical",size:"small",variant:"text"},b),null,16)]),default:a(()=>[e(Ue,null,{default:a(()=>[o.status==="pending"?(w(),E(ce,{key:0,onClick:b=>X(o,"ordered")},{default:a(()=>[e(pe,null,{default:a(()=>l[26]||(l[26]=[c("Mark as Ordered")])),_:1,__:[26]})]),_:2},1032,["onClick"])):I("",!0),o.status==="ordered"?(w(),E(ce,{key:1,onClick:b=>X(o,"received")},{default:a(()=>[e(pe,null,{default:a(()=>l[27]||(l[27]=[c("Mark as Received")])),_:1,__:[27]})]),_:2},1032,["onClick"])):I("",!0),o.status==="received"?(w(),E(ce,{key:2,onClick:b=>X(o,"completed")},{default:a(()=>[e(pe,null,{default:a(()=>l[28]||(l[28]=[c("Mark as Completed")])),_:1,__:[28]})]),_:2},1032,["onClick"])):I("",!0),["pending","ordered"].includes(o.status)?(w(),E(ce,{key:3,onClick:b=>X(o,"cancelled")},{default:a(()=>[e(pe,{class:"text-error"},{default:a(()=>l[29]||(l[29]=[c("Cancel Purchase")])),_:1,__:[29]})]),_:2},1032,["onClick"])):I("",!0)]),_:2},1024)]),_:2},1024)])]),bottom:a(()=>[t("div",ia,[e(Be,{modelValue:U.value,"onUpdate:modelValue":l[6]||(l[6]=o=>U.value=o),length:Math.ceil(S.value/j.value),"total-visible":5},null,8,["modelValue","length"])])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1}),e(it,{modelValue:R.value,"onUpdate:modelValue":l[9]||(l[9]=o=>R.value=o),purchase:p.value,mode:z.value,onSaved:de},null,8,["modelValue","purchase","mode"]),e(Qt,{modelValue:H.value,"onUpdate:modelValue":l[10]||(l[10]=o=>H.value=o),purchase:p.value},null,8,["modelValue","purchase"]),e(yt,{modelValue:F.value,"onUpdate:modelValue":l[11]||(l[11]=o=>F.value=o),purchase:p.value,onSuccess:d.onReceiveSuccess},null,8,["modelValue","purchase","onSuccess"]),e(he,{modelValue:_.value,"onUpdate:modelValue":l[13]||(l[13]=o=>_.value=o),"max-width":"500"},{default:a(()=>[e(T,null,{default:a(()=>[e(J,{class:"text-h5 d-flex align-center"},{default:a(()=>[e(Q,{color:"error",class:"me-2"},{default:a(()=>l[30]||(l[30]=[c("mdi-delete-alert")])),_:1,__:[30]}),l[31]||(l[31]=c(" Konfirmasi Hapus Purchase "))]),_:1,__:[31]}),e(N,null,{default:a(()=>{var o;return[e(Oe,{type:"warning",variant:"tonal",class:"mb-4"},{default:a(()=>[e(Le,null,{default:a(()=>l[32]||(l[32]=[c("Peringatan!")])),_:1,__:[32]}),l[33]||(l[33]=c(" Tindakan ini tidak dapat dibatalkan. Purchase yang sudah dihapus tidak dapat dikembalikan. "))]),_:1,__:[33]}),l[40]||(l[40]=t("p",{class:"text-body-1"}," Apakah Anda yakin ingin menghapus purchase berikut? ",-1)),s.value?(w(),B("div",ua,[t("div",ra,[l[34]||(l[34]=t("span",{class:"font-weight-medium"},"Purchase Number:",-1)),t("span",null,i(s.value.purchase_number),1)]),t("div",da,[l[35]||(l[35]=t("span",{class:"font-weight-medium"},"Supplier:",-1)),t("span",null,i((o=s.value.supplier)==null?void 0:o.name),1)]),t("div",ca,[l[36]||(l[36]=t("span",{class:"font-weight-medium"},"Total Item:",-1)),t("span",null,i(u(s.value))+" item",1)]),t("div",pa,[l[37]||(l[37]=t("span",{class:"font-weight-medium"},"Total Harga:",-1)),t("span",null,i(oe(s.value.total_amount)),1)]),t("div",ma,[l[38]||(l[38]=t("span",{class:"font-weight-medium"},"Status:",-1)),e(le,{color:n(s.value.status),size:"small"},{default:a(()=>[c(i(r(s.value.status)),1)]),_:1},8,["color"])]),e(ve,{class:"my-3"}),l[39]||(l[39]=t("div",{class:"text-caption text-medium-emphasis mb-2"},"Detail Items:",-1)),t("div",va,[(w(!0),B(xe,null,we(s.value.items,b=>{var q;return w(),B("div",{key:b.id_purchase_item,class:"d-flex justify-space-between text-caption mb-1"},[t("span",null,i(((q=b.item)==null?void 0:q.name)||"Unknown Item"),1),t("span",null,i(b.quantity_ordered)+" x "+i(oe(b.unit_cost)),1)])}),128))])])):I("",!0)]}),_:1,__:[40]}),e(be,null,{default:a(()=>[e(Ve),e(P,{color:"grey",variant:"text",onClick:l[12]||(l[12]=o=>_.value=!1)},{default:a(()=>l[41]||(l[41]=[c(" Batal ")])),_:1,__:[41]}),e(P,{color:"error",variant:"flat",loading:V.value,onClick:M},{default:a(()=>[e(Q,{start:""},{default:a(()=>l[42]||(l[42]=[c("mdi-delete")])),_:1,__:[42]}),l[43]||(l[43]=c(" Hapus Purchase "))]),_:1,__:[43]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Me,{modelValue:C.value.show,"onUpdate:modelValue":l[14]||(l[14]=o=>C.value.show=o),color:C.value.color,timeout:4e3,location:"top right"},{default:a(()=>[c(i(C.value.message),1)]),_:1},8,["modelValue","color"])]),_:1}))}}),Qa=ke(fa,[["__scopeId","data-v-2fcfa56e"]]);export{Qa as default};
