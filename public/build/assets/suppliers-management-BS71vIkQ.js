import{D as ze}from"./DeleteConfirmationDialog-DKGtL7HT.js";import{d as pe,V as N,r as f,w as ve,g as C,f as t,a5 as w,m as o,b as e,l as M,e as r,X as F,t as k,a0 as J,$ as Le,s as P,o as v,aX as Me,c as $,aF as Ke,F as Re,i as Ie,aI as X,aD as ke,D as Be}from"./main-DjqmDiIz.js";import{V as je}from"./VDialog-CO1Pg2O1.js";import{b as Oe,c as Ge,V as O}from"./VCard-Dc0kmm9d.js";import{V as Ve}from"./VDivider-oMNJlvlT.js";import{V as G}from"./VCardText-R2xf0xyg.js";import{V as We}from"./VForm-BHdjQAko.js";import{V as he,a as _}from"./VRow-Bd9KaDfF.js";import{V as A}from"./VTextField-Cr70duVL.js";import{V as $e}from"./VSelect-DlqmIY7r.js";import{V as xe}from"./VTextarea-BUyrZjpa.js";import{V as Xe}from"./VSpacer-6KgkCcbL.js";import{V as He}from"./VSnackbar-B3PcGBVZ.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ie}from"./VChip-DjKKKdJh.js";import{V as ee}from"./VAvatar-Clbtu_25.js";import{V as te}from"./VSkeletonLoader-CCt2dZOX.js";import{V as Je}from"./VDataTableServer-xUjGghgs.js";import{V as Se}from"./VTooltip-B62-6El3.js";import{V as we}from"./VAlert-Cg4Lq4pq.js";import"./VOverlay-CZFIfHxA.js";import"./forwardRefs-B931MWyl.js";import"./VImg-DDXPFBq2.js";/* empty css              */import"./VList-DCB4Qb1M.js";import"./VMenu-D3ibQp-y.js";import"./VCheckboxBtn-DRXImS0r.js";import"./VDataTable-BVT_g1uz.js";import"./VTable-DQqaxhye.js";import"./filter-9vv_0SEG.js";const qe={class:"d-flex align-center justify-space-between"},Qe={class:"d-flex align-center gap-2"},Ye={class:"text-h6 text-white"},Ze={class:"text-h6 mb-4 d-flex align-center gap-2"},et={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},tt={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},at={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},lt={class:"d-flex align-center"},st={class:"text-subtitle-1"},ot=pe({__name:"SupplierDialog",props:{modelValue:{type:Boolean},supplier:{},loading:{type:Boolean},errorMessage:{},useDialogError:{type:Boolean}},emits:["update:modelValue","save","clear-error","close"],setup(U,{emit:u}){const i=U,g=u,m=N({get:()=>i.modelValue,set:s=>g("update:modelValue",s)}),y=f(""),V=f(""),x=f(""),E=f(""),S=f(""),b=f(""),l=f(""),d=f(""),p=f(""),K=f(""),I=f(""),R=f(""),D=f(""),T=f(""),z=f("active"),B=N(()=>({code:y.value,name:V.value,email:x.value,phone:E.value,address:S.value,city:b.value,province:l.value,postal_code:d.value,contact_person:p.value,tax_number:K.value,bank_name:I.value,bank_account:R.value,bank_account_name:D.value,notes:T.value,status:z.value}));ve(B,s=>{console.log("Form data changed:",s)},{deep:!0});const q=f(!1),Y=f(),W={code:[s=>!!s||"Kode supplier wajib diisi",s=>s&&s.length>=2||"Kode supplier minimal 2 karakter",s=>s&&s.length<=20||"Kode supplier maksimal 20 karakter"],name:[s=>!!s||"Nama supplier wajib diisi",s=>s&&s.length>=2||"Nama supplier minimal 2 karakter",s=>s&&s.length<=100||"Nama supplier maksimal 100 karakter"],email:[s=>s?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)||"Format email tidak valid":!0],phone:[s=>s?/^[\d\s\-\+\(\)]+$/.test(s)||"Format nomor telepon tidak valid":!0],postal_code:[s=>s?/^\d{5}$/.test(s)||"Kode pos harus 5 digit":!0]},re=[{title:"Aktif",value:"active"},{title:"Nonaktif",value:"inactive"}],Q=N(()=>!!i.supplier),ue=N(()=>Q.value?"Edit Supplier":"Tambah Supplier"),de=N(()=>Q.value?"Update":"Simpan"),ae=N(()=>i.errorMessage||null),le=()=>{y.value="",V.value="",x.value="",E.value="",S.value="",b.value="",l.value="",d.value="",p.value="",K.value="",I.value="",R.value="",D.value="",T.value="",z.value="active",Me(()=>{var s;(s=Y.value)==null||s.resetValidation()})};ve(()=>i.supplier,s=>{s?(y.value=s.code,V.value=s.name,x.value=s.email||"",E.value=s.phone||"",S.value=s.address||"",b.value=s.city||"",l.value=s.province||"",d.value=s.postal_code||"",p.value=s.contact_person||"",K.value=s.tax_number||"",I.value=s.bank_name||"",R.value=s.bank_account||"",D.value=s.bank_account_name||"",T.value=s.notes||"",z.value=s.status):le()},{immediate:!0}),ve(m,s=>{s||le()});const se=async()=>{var n;console.log("Form data before save:",B.value),console.log("Form data stringified:",JSON.stringify(B.value));const{valid:s}=await((n=Y.value)==null?void 0:n.validate());if(console.log("Form validation result:",s),s){const c={...B.value};console.log("Payload to emit:",c),g("save",c)}},oe=()=>{m.value=!1,g("close")};return(s,n)=>(v(),C(je,{modelValue:o(m),"onUpdate:modelValue":n[18]||(n[18]=c=>w(m)?m.value=c:null),"max-width":"900px",persistent:"",scrollable:""},{default:t(()=>[e(O,{class:"supplier-dialog coffee-dialog"},{default:t(()=>[e(Oe,{class:"pa-6 pb-4 coffee-header"},{default:t(()=>[r("div",qe,[r("div",Qe,[e(F,{icon:o(Q)?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),r("span",Ye,k(o(ue)),1)]),e(J,{icon:"tabler-x",variant:"text",color:"white",size:"small",onClick:oe})])]),_:1}),e(Ve),e(G,{class:"pa-6"},{default:t(()=>[e(We,{ref_key:"formRef",ref:Y,modelValue:o(q),"onUpdate:modelValue":n[15]||(n[15]=c=>w(q)?q.value=c:null),onSubmit:Le(se,["prevent"])},{default:t(()=>[e(he,null,{default:t(()=>[e(_,{cols:"12"},{default:t(()=>[r("h6",Ze,[e(F,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),n[19]||(n[19]=P(" Informasi Dasar "))])]),_:1}),e(_,{cols:"12",md:"4"},{default:t(()=>[e(A,{modelValue:o(y),"onUpdate:modelValue":n[0]||(n[0]=c=>w(y)?y.value=c:null),label:"Kode Supplier *",rules:W.code,disabled:o(Q),placeholder:"Masukkan kode supplier",variant:"outlined"},null,8,["modelValue","rules","disabled"])]),_:1}),e(_,{cols:"12",md:"8"},{default:t(()=>[e(A,{modelValue:o(V),"onUpdate:modelValue":n[1]||(n[1]=c=>w(V)?V.value=c:null),label:"Nama Supplier *",rules:W.name,placeholder:"Masukkan nama supplier",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[e(A,{modelValue:o(x),"onUpdate:modelValue":n[2]||(n[2]=c=>w(x)?x.value=c:null),label:"Email",rules:W.email,placeholder:"supplier@email.com",type:"email",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[e(A,{modelValue:o(E),"onUpdate:modelValue":n[3]||(n[3]=c=>w(E)?E.value=c:null),label:"Nomor Telepon",rules:W.phone,placeholder:"08123456789",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(_,{cols:"12",md:"8"},{default:t(()=>[e(A,{modelValue:o(p),"onUpdate:modelValue":n[4]||(n[4]=c=>w(p)?p.value=c:null),label:"Nama Kontak",placeholder:"Nama person in charge",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"4"},{default:t(()=>[e($e,{modelValue:o(z),"onUpdate:modelValue":n[5]||(n[5]=c=>w(z)?z.value=c:null),label:"Status *",items:re,"item-title":"title","item-value":"value",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:t(()=>[r("h6",et,[e(F,{icon:"tabler-map-pin",size:"20",class:"coffee-icon"}),n[20]||(n[20]=P(" Informasi Alamat "))])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(xe,{modelValue:o(S),"onUpdate:modelValue":n[6]||(n[6]=c=>w(S)?S.value=c:null),label:"Alamat",placeholder:"Masukkan alamat lengkap",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"4"},{default:t(()=>[e(A,{modelValue:o(b),"onUpdate:modelValue":n[7]||(n[7]=c=>w(b)?b.value=c:null),label:"Kota",placeholder:"Nama kota",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"4"},{default:t(()=>[e(A,{modelValue:o(l),"onUpdate:modelValue":n[8]||(n[8]=c=>w(l)?l.value=c:null),label:"Provinsi",placeholder:"Nama provinsi",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"4"},{default:t(()=>[e(A,{modelValue:o(d),"onUpdate:modelValue":n[9]||(n[9]=c=>w(d)?d.value=c:null),label:"Kode Pos",rules:W.postal_code,placeholder:"12345",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(_,{cols:"12"},{default:t(()=>[r("h6",tt,[e(F,{icon:"tabler-credit-card",size:"20",class:"coffee-icon"}),n[21]||(n[21]=P(" Informasi Keuangan "))])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[e(A,{modelValue:o(K),"onUpdate:modelValue":n[10]||(n[10]=c=>w(K)?K.value=c:null),label:"NPWP",placeholder:"Nomor NPWP",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[e(A,{modelValue:o(I),"onUpdate:modelValue":n[11]||(n[11]=c=>w(I)?I.value=c:null),label:"Nama Bank",placeholder:"Nama bank",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[e(A,{modelValue:o(R),"onUpdate:modelValue":n[12]||(n[12]=c=>w(R)?R.value=c:null),label:"Nomor Rekening",placeholder:"Nomor rekening bank",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"6"},{default:t(()=>[e(A,{modelValue:o(D),"onUpdate:modelValue":n[13]||(n[13]=c=>w(D)?D.value=c:null),label:"Nama Pemilik Rekening",placeholder:"Nama pemilik rekening",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:t(()=>[r("h6",at,[e(F,{icon:"tabler-notes",size:"20",class:"coffee-icon"}),n[22]||(n[22]=P(" Informasi Tambahan "))])]),_:1}),e(_,{cols:"12"},{default:t(()=>[e(xe,{modelValue:o(T),"onUpdate:modelValue":n[14]||(n[14]=c=>w(T)?T.value=c:null),label:"Catatan",placeholder:"Catatan tambahan tentang supplier",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(Ve),e(Ge,{class:"pa-6"},{default:t(()=>[e(Xe),e(J,{color:"secondary",variant:"outlined",class:"coffee-secondary",onClick:oe},{default:t(()=>n[23]||(n[23]=[P(" Batal ")])),_:1,__:[23]}),e(J,{color:"primary",class:"coffee-primary",loading:s.loading,disabled:!o(q),onClick:se},{default:t(()=>[P(k(o(de)),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),s.useDialogError?M("",!0):(v(),C(He,{key:0,"model-value":!!o(ae),"onUpdate:modelValue":n[17]||(n[17]=c=>!c&&s.$emit("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500",class:"coffee-error"},{actions:t(()=>[e(J,{icon:"tabler-x",size:"small",variant:"text",onClick:n[16]||(n[16]=c=>s.$emit("clear-error"))})]),default:t(()=>[r("div",lt,[e(F,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),r("div",null,[n[24]||(n[24]=r("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),r("div",st,k(o(ae)),1)])])]),_:1},8,["model-value"]))]),_:1},8,["modelValue"]))}}),nt=Ce(ot,[["__scopeId","data-v-7e584f6b"]]),it={class:"d-flex gap-2"},rt={key:0,class:"mt-4"},ut={class:"d-flex align-center gap-2 flex-wrap"},dt=pe({__name:"SupplierSearchFilters",props:{filters:{},loading:{type:Boolean,default:!1}},emits:["update:filters","search","reset"],setup(U,{emit:u}){const i=U,g=u,m=f({...i.filters});ve(()=>i.filters,b=>{m.value={...b}},{deep:!0});const y=(b,l)=>{m.value[b]=l,g("update:filters",{...m.value})},V=()=>{g("search")},x=()=>{const b={search:"",status:void 0,city:"",province:""};m.value={...b},g("update:filters",b),g("reset")},E=[{title:"Semua Status",value:void 0},{title:"Aktif",value:"active"},{title:"Nonaktif",value:"inactive"}],S=N(()=>!!(m.value.search||m.value.status||m.value.city||m.value.province));return(b,l)=>(v(),C(O,null,{default:t(()=>[e(G,null,{default:t(()=>[e(he,null,{default:t(()=>[e(_,{cols:"12",md:"4"},{default:t(()=>[e(A,{modelValue:m.value.search,"onUpdate:modelValue":[l[0]||(l[0]=d=>m.value.search=d),l[1]||(l[1]=d=>y("search",d))],placeholder:"Cari nama, kode, atau email supplier...","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined",onKeydown:Ke(V,["enter"])},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"2"},{default:t(()=>[e($e,{modelValue:m.value.status,"onUpdate:modelValue":[l[2]||(l[2]=d=>m.value.status=d),l[3]||(l[3]=d=>y("status",d))],items:E,"item-title":"title","item-value":"value",placeholder:"Status",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"2"},{default:t(()=>[e(A,{modelValue:m.value.city,"onUpdate:modelValue":[l[4]||(l[4]=d=>m.value.city=d),l[5]||(l[5]=d=>y("city",d))],placeholder:"Kota",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"2"},{default:t(()=>[e(A,{modelValue:m.value.province,"onUpdate:modelValue":[l[6]||(l[6]=d=>m.value.province=d),l[7]||(l[7]=d=>y("province",d))],placeholder:"Provinsi",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"2"},{default:t(()=>[r("div",it,[e(J,{color:"primary",loading:b.loading,onClick:V},{default:t(()=>[e(F,{icon:"tabler-search"}),l[12]||(l[12]=P(" Cari "))]),_:1,__:[12]},8,["loading"]),S.value?(v(),C(J,{key:0,variant:"outlined",color:"secondary",onClick:x},{default:t(()=>[e(F,{icon:"tabler-x"}),l[13]||(l[13]=P(" Reset "))]),_:1,__:[13]})):M("",!0)])]),_:1})]),_:1}),S.value?(v(),$("div",rt,[r("div",ut,[l[14]||(l[14]=r("span",{class:"text-caption text-medium-emphasis"},"Filter aktif:",-1)),m.value.search?(v(),C(ie,{key:0,size:"small",closable:"","onClick:close":l[8]||(l[8]=d=>y("search",""))},{default:t(()=>[P(" Pencarian: "+k(m.value.search),1)]),_:1})):M("",!0),m.value.status?(v(),C(ie,{key:1,size:"small",closable:"","onClick:close":l[9]||(l[9]=d=>y("status",void 0))},{default:t(()=>[P(" Status: "+k(m.value.status==="active"?"Aktif":"Nonaktif"),1)]),_:1})):M("",!0),m.value.city?(v(),C(ie,{key:2,size:"small",closable:"","onClick:close":l[10]||(l[10]=d=>y("city",""))},{default:t(()=>[P(" Kota: "+k(m.value.city),1)]),_:1})):M("",!0),m.value.province?(v(),C(ie,{key:3,size:"small",closable:"","onClick:close":l[11]||(l[11]=d=>y("province",""))},{default:t(()=>[P(" Provinsi: "+k(m.value.province),1)]),_:1})):M("",!0)])])):M("",!0)]),_:1})]),_:1}))}}),ct={class:"d-flex align-center"},pt={class:"text-h6 font-weight-semibold"},mt={key:1},vt={class:"d-flex align-center"},ft={class:"text-h6 font-weight-semibold"},gt={key:1},ht={class:"d-flex align-center"},_t={class:"text-h6 font-weight-semibold"},bt={key:1},yt={class:"d-flex align-center"},kt={class:"text-h6 font-weight-semibold"},Vt={key:1},xt={class:"d-flex align-center"},St={class:"text-h6 font-weight-semibold"},wt={key:1},$t={class:"d-flex align-center"},Ct={class:"text-h6 font-weight-semibold"},Pt={key:1},Et=pe({__name:"SupplierStatsCards",props:{stats:{},loading:{type:Boolean,default:!1}},setup(U){return(u,i)=>(v(),C(he,null,{default:t(()=>[e(_,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",ct,[e(ee,{color:"primary",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(F,{icon:"tabler-building-store"})]),_:1}),r("div",null,[i[0]||(i[0]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Supplier",-1)),r("h6",pt,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",mt,k(u.stats.total_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(_,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",vt,[e(ee,{color:"success",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(F,{icon:"tabler-check"})]),_:1}),r("div",null,[i[1]||(i[1]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Supplier Aktif",-1)),r("h6",ft,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",gt,k(u.stats.active_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(_,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",ht,[e(ee,{color:"info",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(F,{icon:"tabler-shopping-cart"})]),_:1}),r("div",null,[i[2]||(i[2]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Dengan Pembelian",-1)),r("h6",_t,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",bt,k(u.stats.suppliers_with_purchases.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(_,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",yt,[e(ee,{color:"warning",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(F,{icon:"tabler-map-pin"})]),_:1}),r("div",null,[i[3]||(i[3]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Kota",-1)),r("h6",kt,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",Vt,k(u.stats.total_cities.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(_,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",xt,[e(ee,{color:"error",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(F,{icon:"tabler-x"})]),_:1}),r("div",null,[i[4]||(i[4]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Supplier Nonaktif",-1)),r("h6",St,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",wt,k(u.stats.inactive_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(_,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(O,null,{default:t(()=>[e(G,null,{default:t(()=>[r("div",$t,[e(ee,{color:"secondary",variant:"tonal",size:"42",class:"me-3"},{default:t(()=>[e(F,{icon:"tabler-map"})]),_:1}),r("div",null,[i[5]||(i[5]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Provinsi",-1)),r("h6",Ct,[u.loading?(v(),C(te,{key:0,type:"text",width:"60"})):(v(),$("span",Pt,k(u.stats.total_provinces.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1})]),_:1}))}}),Ft={class:"font-weight-medium"},Ut={class:"d-flex align-center"},Dt={class:"text-sm font-weight-medium"},Nt={class:"font-weight-medium"},At={key:0,class:"text-caption text-medium-emphasis"},Tt=["href"],zt={key:1,class:"text-medium-emphasis"},Lt=["href"],Mt={key:1,class:"text-medium-emphasis"},Kt={key:0},Rt={key:0,class:"font-weight-medium"},It={key:1,class:"text-caption text-medium-emphasis"},Bt={key:1,class:"text-medium-emphasis"},jt={class:"d-flex gap-1"},Ot={class:"text-center py-8"},Gt=pe({__name:"SupplierTable",props:{suppliers:{},loading:{type:Boolean,default:!1},totalItems:{default:0},page:{default:1},itemsPerPage:{default:10}},emits:["edit","delete","update:page","update:itemsPerPage","sort"],setup(U,{emit:u}){const i=u,g=[{title:"Kode",key:"code",sortable:!0},{title:"Nama",key:"name",sortable:!0},{title:"Email",key:"email",sortable:!0},{title:"Telepon",key:"phone",sortable:!1},{title:"Kota",key:"city",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Aksi",key:"actions",sortable:!1,align:"center"}],m=l=>l==="active"?"success":"error",y=l=>l==="active"?"Aktif":"Nonaktif",V=l=>{i("edit",l)},x=l=>{i("delete",l)},E=l=>{i("update:page",l)},S=l=>{i("update:itemsPerPage",l)},b=l=>{if(l&&l.length>0){const d=l[0],p=d.order==="desc"?"-":"";i("sort",`${p}${d.key}`)}};return(l,d)=>(v(),C(O,null,{default:t(()=>[e(G,{class:"pa-0"},{default:t(()=>[e(Je,{page:l.page,"items-per-page":l.itemsPerPage,headers:g,items:l.suppliers,"items-length":l.totalItems,loading:l.loading,"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],"loading-text":"Memuat data supplier...","no-data-text":"Tidak ada data supplier","items-per-page-text":"Supplier per halaman:","page-text":"{0}-{1} dari {2}",class:"text-no-wrap","onUpdate:page":E,"onUpdate:itemsPerPage":S,"onUpdate:sortBy":b},{"item.code":t(({item:p})=>[r("div",Ft,k(p.code),1)]),"item.name":t(({item:p})=>[r("div",Ut,[e(ee,{size:"32",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[r("span",Dt,k(p.name.charAt(0).toUpperCase()),1)]),_:2},1024),r("div",null,[r("div",Nt,k(p.name),1),p.contact_person?(v(),$("div",At,k(p.contact_person),1)):M("",!0)])])]),"item.email":t(({item:p})=>[p.email?(v(),$("a",{key:0,href:`mailto:${p.email}`,class:"text-decoration-none"},k(p.email),9,Tt)):(v(),$("span",zt,"-"))]),"item.phone":t(({item:p})=>[p.phone?(v(),$("a",{key:0,href:`tel:${p.phone}`,class:"text-decoration-none"},k(p.phone),9,Lt)):(v(),$("span",Mt,"-"))]),"item.city":t(({item:p})=>[p.city||p.province?(v(),$("div",Kt,[p.city?(v(),$("div",Rt,k(p.city),1)):M("",!0),p.province?(v(),$("div",It,k(p.province),1)):M("",!0)])):(v(),$("span",Bt,"-"))]),"item.status":t(({item:p})=>[e(ie,{color:m(p.status),variant:"tonal",size:"small"},{default:t(()=>[P(k(y(p.status)),1)]),_:2},1032,["color"])]),"item.actions":t(({item:p})=>[r("div",jt,[e(J,{icon:"",size:"small",color:"primary",variant:"text",onClick:K=>V(p)},{default:t(()=>[e(F,{icon:"tabler-edit"}),e(Se,{activator:"parent",location:"top"},{default:t(()=>d[0]||(d[0]=[P(" Edit Supplier ")])),_:1,__:[0]})]),_:2},1032,["onClick"]),e(J,{icon:"",size:"small",color:"error",variant:"text",onClick:K=>x(p)},{default:t(()=>[e(F,{icon:"tabler-trash"}),e(Se,{activator:"parent",location:"top"},{default:t(()=>d[1]||(d[1]=[P(" Hapus Supplier ")])),_:1,__:[1]})]),_:2},1032,["onClick"])])]),loading:t(()=>[(v(),$(Re,null,Ie(5,p=>e(te,{key:p,type:"table-row",class:"border-b"})),64))]),"no-data":t(()=>[r("div",Ot,[e(F,{icon:"tabler-building-store",size:"48",class:"text-medium-emphasis mb-4"}),d[2]||(d[2]=r("div",{class:"text-h6 mb-2"},"Tidak ada data supplier",-1)),d[3]||(d[3]=r("p",{class:"text-medium-emphasis mb-0"}," Silakan tambah supplier baru atau ubah filter pencarian ",-1))])]),_:1},8,["page","items-per-page","items","items-length","loading"])]),_:1})]),_:1}))}}),H="/api/suppliers";class j{static async getAll(u={}){var i;try{const g=new URLSearchParams;return Object.entries(u).forEach(([y,V])=>{V!=null&&V!==""&&g.append(y,String(V))}),(await X.get(`${H}?${g.toString()}`)).data}catch(g){throw((i=g.response)==null?void 0:i.data)||{success:!1,message:"Failed to fetch suppliers"}}}static async getById(u){var i;try{return(await X.get(`${H}/${u}`)).data}catch(g){throw((i=g.response)==null?void 0:i.data)||{success:!1,message:"Failed to fetch supplier"}}}static async create(u){var i;try{return(await X.post(H,u)).data}catch(g){throw((i=g.response)==null?void 0:i.data)||{success:!1,message:"Failed to create supplier"}}}static async update(u,i){var g;try{return(await X.put(`${H}/${u}`,i)).data}catch(m){throw((g=m.response)==null?void 0:g.data)||{success:!1,message:"Failed to update supplier"}}}static async delete(u){var i;try{return(await X.delete(`${H}/${u}`)).data}catch(g){throw((i=g.response)==null?void 0:i.data)||{success:!1,message:"Failed to delete supplier"}}}static async toggleActive(u){var i;try{return(await X.put(`${H}/${u}/toggle-active`)).data}catch(g){throw((i=g.response)==null?void 0:i.data)||{success:!1,message:"Failed to toggle supplier status"}}}static async getStats(){var u;try{return(await X.get(`${H}/stats`)).data}catch(i){throw((u=i.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch supplier statistics"}}}static async getCities(){var u;try{return(await X.get(`${H}/cities`)).data}catch(i){throw((u=i.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch cities"}}}static async getProvinces(){var u;try{return(await X.get(`${H}/provinces`)).data}catch(i){throw((u=i.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch provinces"}}}static validateEmail(u){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)?{valid:!0}:{valid:!1,error:"Please enter a valid email address"}}static validatePhone(u){return/^[\+]?[\d\s\-\(\)]{7,20}$/.test(u)?{valid:!0}:{valid:!1,error:"Please enter a valid phone number"}}static validateCode(u){return u.length<3?{valid:!1,error:"Supplier code must be at least 3 characters"}:u.length>50?{valid:!1,error:"Supplier code must not exceed 50 characters"}:{valid:!0}}}const Wt=()=>{const U=f([]),u=f([]),i=f([]),g=f(!1),m=f(!1),y=f(!1),V=f({}),x=f({total_suppliers:0,active_suppliers:0,inactive_suppliers:0,suppliers_with_purchases:0,total_cities:0,total_provinces:0}),E=f(!1),S=f(!1),b=f(!1),l=f(null),d=f([]),p=f(1),K=f(0),I=f(15),R=ke({search:"",status:void 0,city:"",province:"",sort_by:"created_at",sort_order:"desc"}),D=f(""),T=f(""),z=f(""),B=ke({name:"",code:"",contact_person:"",phone:"",email:"",address:"",city:"",province:"",postal_code:"",tax_number:"",bank_name:"",bank_account:"",bank_account_name:"",status:"active",notes:""}),q=[a=>!!a||"Nama supplier wajib diisi",a=>a.length>=2||"Nama supplier minimal 2 karakter",a=>a.length<=255||"Nama supplier maksimal 255 karakter"],Y=[a=>{if(!a)return!0;const h=j.validateCode(a);return h.valid||h.error}],W=[a=>{if(!a)return!0;const h=j.validateEmail(a);return h.valid||h.error}],re=[a=>{if(!a)return!0;const h=j.validatePhone(a);return h.valid||h.error}],Q=N(()=>!0),ue=N(()=>!0),de=N(()=>x.value.active_suppliers),ae=N(()=>x.value.inactive_suppliers),le=N(()=>x.value.suppliers_with_purchases),se=N(()=>x.value.total_cities),oe=N(()=>x.value.total_provinces),s=N(()=>d.value.length>0),n=N(()=>U.value.length),c=async()=>{try{g.value=!0,D.value="";const a={...R,page:p.value,per_page:I.value};Object.keys(a).forEach(ne=>{(a[ne]===""||a[ne]==="all")&&delete a[ne]});const h=await j.getAll(a);if(h.success)U.value=h.data,h.pagination&&(K.value=h.pagination.total,p.value=h.pagination.current_page);else throw new Error(h.message)}catch(a){console.error("Error fetching suppliers:",a),D.value=a.message||"Gagal mengambil data supplier",U.value=[]}finally{g.value=!1}},fe=async()=>{try{const a=await j.getCities();a.success&&(u.value=a.data)}catch(a){console.error("Error fetching cities:",a)}},ge=async()=>{try{const a=await j.getProvinces();a.success&&(i.value=a.data)}catch(a){console.error("Error fetching provinces:",a)}},ce=async()=>{try{const a=await j.getStats();a.success&&(x.value=a.data)}catch(a){console.error("Error fetching stats:",a)}},L=async a=>{try{m.value=!0,z.value="",console.log("Saving supplier with data:",a);let h;if(b.value&&l.value?h=await j.update(l.value.id_supplier,a):h=await j.create(a),h.success)T.value=h.message||"Supplier saved successfully",_e(),await c(),await ce();else throw new Error(h.message)}catch(h){console.error("Error saving supplier:",h),z.value=h.errors||h.message}finally{m.value=!1}},me=async()=>{if(l.value)try{y.value=!0;const a=await j.delete(l.value.id_supplier);if(a.success)T.value=a.message,S.value=!1,await c(),await ce();else throw new Error(a.message)}catch(a){console.error("Error deleting supplier:",a),D.value=a.message||"Gagal menghapus supplier"}finally{y.value=!1}},Z=async a=>{try{V.value[a.id_supplier]=!0;const h=await j.toggleActive(a.id_supplier);if(h.success){const ne=U.value.findIndex(Te=>Te.id_supplier===a.id_supplier);ne!==-1&&(U.value[ne]=h.data),await ce()}else throw new Error(h.message)}catch(h){console.error("Error toggling active status:",h),D.value=h.message||"Gagal mengubah status supplier"}finally{V.value[a.id]=!1}},Pe=()=>{b.value=!1,l.value=null,be(),E.value=!0},Ee=a=>{b.value=!0,l.value=a,Ue(a),E.value=!0},Fe=a=>{l.value=a,S.value=!0},_e=()=>{E.value=!1,z.value="",be()},be=()=>{Object.assign(B,{name:"",code:"",contact_person:"",phone:"",email:"",address:"",city:"",province:"",postal_code:"",tax_number:"",payment_terms:null,active:!0,notes:""})},Ue=a=>{Object.assign(B,{name:a.name,code:a.code||"",contact_person:a.contact_person||"",phone:a.phone||"",email:a.email||"",address:a.address||"",city:a.city||"",province:a.province||"",postal_code:a.postal_code||"",tax_number:a.tax_number||"",bank_name:a.bank_name||"",bank_account:a.bank_account||"",bank_account_name:a.bank_account_name||"",status:a.status,notes:a.notes||""})},De=()=>{z.value=""},Ne=a=>{p.value=a,c()},Ae=()=>{p.value=1,c()},ye=()=>{p.value=1,c()};return{suppliersList:U,cities:u,provinces:i,loading:g,saveLoading:m,deleteLoading:y,toggleLoading:V,stats:x,dialog:E,deleteDialog:S,editMode:b,selectedSupplier:l,selectedSuppliers:d,currentPage:p,totalItems:K,itemsPerPage:I,filters:R,errorMessage:D,successMessage:T,modalErrorMessage:z,formData:B,nameRules:q,codeRules:Y,emailRules:W,phoneRules:re,canCreateEdit:Q,canDelete:ue,totalActiveSuppliers:de,totalInactiveSuppliers:ae,totalSuppliersWithPurchases:le,totalCities:se,totalProvinces:oe,hasSelectedSuppliers:s,filteredSuppliersCount:n,fetchSuppliersList:c,fetchCities:fe,fetchProvinces:ge,fetchStats:ce,saveSupplier:L,deleteSupplier:me,toggleActiveStatus:Z,openCreateDialog:Pe,openEditDialog:Ee,openDeleteDialog:Fe,closeDialog:_e,clearModalError:De,onPageChange:Ne,onSearch:Ae,onFilterChange:ye,handleFiltersUpdate:a=>{Object.assign(R,a),ye()},onSortChange:()=>{p.value=1,c()},resetFilters:()=>{Object.assign(R,{search:"",active:"all",city:"",province:"",sort_by:"created_at",sort_order:"desc"}),p.value=1,c()},toggleSupplierSelection:a=>{const h=d.value.indexOf(a);h>-1?d.value.splice(h,1):d.value.push(a)},selectAllSuppliers:()=>{d.value.length===U.value.length?d.value=[]:d.value=U.value.map(a=>a.id)}}},Xt={class:"supplier-management"},Ht={class:"d-flex justify-space-between align-center mb-6"},Jt={class:"d-flex gap-3 align-center"},qt={key:0,class:"d-flex gap-2"},Qt=pe({__name:"suppliers-management",setup(U){const{suppliersList:u,cities:i,provinces:g,loading:m,saveLoading:y,deleteLoading:V,toggleLoading:x,stats:E,dialog:S,deleteDialog:b,selectedSupplier:l,selectedSuppliers:d,currentPage:p,totalItems:K,itemsPerPage:I,filters:R,errorMessage:D,successMessage:T,modalErrorMessage:z,canCreateEdit:B,hasSelectedSuppliers:q,fetchSuppliersList:Y,fetchCities:W,fetchProvinces:re,fetchStats:Q,saveSupplier:ue,deleteSupplier:de,toggleActiveStatus:ae,openCreateDialog:le,openEditDialog:se,openDeleteDialog:oe,closeDialog:s,clearModalError:n,onPageChange:c,handleFiltersUpdate:fe}=Wt(),ge=async()=>{await de()};return Be(()=>{Y(),W(),re(),Q()}),(ce,L)=>{var me;return v(),$("div",Xt,[r("div",Ht,[L[5]||(L[5]=r("div",null,[r("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Supplier"),r("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola data supplier dan vendor untuk coffee shop Anda")],-1)),r("div",Jt,[o(q)?(v(),$("div",qt,[e(ie,{color:"primary",size:"small"},{default:t(()=>[P(k(o(d).length)+" dipilih ",1)]),_:1})])):M("",!0),o(B)?(v(),C(J,{key:1,color:"primary",variant:"elevated","prepend-icon":"tabler-plus",onClick:o(le)},{default:t(()=>L[4]||(L[4]=[P(" Tambah Supplier ")])),_:1,__:[4]},8,["onClick"])):M("",!0)])]),e(Et,{stats:o(E),loading:o(m),class:"mb-6"},null,8,["stats","loading"]),e(dt,{filters:o(R),cities:o(i),provinces:o(g),loading:o(m),onFiltersUpdate:o(fe),class:"mb-6"},null,8,["filters","cities","provinces","loading","onFiltersUpdate"]),o(T)?(v(),C(we,{key:0,type:"success",variant:"tonal",closable:"",class:"mb-4","onClick:close":L[0]||(L[0]=Z=>T.value="")},{default:t(()=>[P(k(o(T)),1)]),_:1})):M("",!0),o(D)?(v(),C(we,{key:1,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":L[1]||(L[1]=Z=>D.value="")},{default:t(()=>[P(k(o(D)),1)]),_:1})):M("",!0),e(O,null,{default:t(()=>[e(G,{class:"pa-0"},{default:t(()=>[e(Gt,{suppliers:o(u),loading:o(m),"toggle-loading":o(x),"current-page":o(p),"total-items":o(K),"items-per-page":o(I),"selected-suppliers":o(d),"can-create-edit":o(B),onEdit:o(se),onDelete:o(oe),onToggleActive:o(ae),onPageChange:o(c)},null,8,["suppliers","loading","toggle-loading","current-page","total-items","items-per-page","selected-suppliers","can-create-edit","onEdit","onDelete","onToggleActive","onPageChange"])]),_:1})]),_:1}),e(nt,{modelValue:o(S),"onUpdate:modelValue":L[2]||(L[2]=Z=>w(S)?S.value=Z:null),supplier:o(l),loading:o(y),"error-message":o(z),onSave:o(ue),onClose:o(s),onClearError:o(n)},null,8,["modelValue","supplier","loading","error-message","onSave","onClose","onClearError"]),e(ze,{modelValue:o(b),"onUpdate:modelValue":L[3]||(L[3]=Z=>w(b)?b.value=Z:null),loading:o(V),"item-name":(me=o(l))==null?void 0:me.name,"item-type":"supplier",onConfirm:ge},null,8,["modelValue","loading","item-name"])])}}}),Na=Ce(Qt,[["__scopeId","data-v-c026a977"]]);export{Na as default};
