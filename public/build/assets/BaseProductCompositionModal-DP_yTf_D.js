import{d as Ae,ax as $e,r as q,V as K,w as le,g as x,f as r,o as p,b as i,e as o,X as f,l as $,aw as Te,t as l,s as b,c as T,F as de,i as ue,$ as Be,ap as ce,aq as me,a0 as U,v as _e,ay as B,a3 as Ee}from"./main-CEdDHaBP.js";import{g as Me}from"./auth-CuuXRWj5.js";import{V as je}from"./VDialog-BwBmrRdG.js";import{V as w,b as Q,c as De}from"./VCard-D0qU2pyL.js";import{V as P}from"./VCardText-CpJ4_XPv.js";import{V as Ke}from"./VOverlay-BucaTrB2.js";import{V as X}from"./VAvatar-ilH9Vx6e.js";import{V as pe}from"./VImg-2rEuQgrS.js";import{V as fe}from"./VChip-8IEsPNpL.js";import{V as W,a as y}from"./VRow-BnPui3Gq.js";import{V as Y}from"./VDivider-__oD30Ho.js";import{V as ge}from"./VAlert-OTpr7hc8.js";import{V as Ue}from"./VForm-DlLJypXg.js";import{V as ve}from"./VAutocomplete-hcKezor8.js";import{a as be,b as ye,d as he}from"./VList-CI7kntfD.js";import{V as xe}from"./VTextField-SECKjXQ7.js";import{V as Le}from"./VSwitch-DuJeUrge.js";import{V as ke}from"./VTooltip-Do8gY9Rc.js";import{V as Fe}from"./VSpacer-RnxZE5Fq.js";import{_ as Re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./forwardRefs-B931MWyl.js";/* empty css              */import"./VSelect-BtLJelrg.js";import"./VMenu-BG2gk3Sp.js";import"./VCheckboxBtn-Do7TbMRw.js";import"./filter-B_qp2GbA.js";const Ge={class:"d-flex align-center gap-4"},Oe={class:"flex-grow-1"},He={class:"text-h6 font-weight-bold mb-1"},Je={class:"text-body-2 text-medium-emphasis mb-1"},Qe={class:"text-body-2 text-medium-emphasis mb-2"},Xe={class:"text-body-2 font-weight-bold"},We={class:"text-body-1 font-weight-bold"},Ye={class:"text-body-1 font-weight-bold"},Ze={class:"text-body-1 font-weight-bold"},et={class:"text-subtitle-1 font-weight-bold"},tt={class:"text-h6 font-weight-bold text-primary"},at={class:"d-flex align-center gap-2"},it={key:0,class:"text-center pa-8"},st={key:1,class:"pa-4"},rt={class:"d-flex align-center gap-3 flex-grow-1"},nt={class:"flex-grow-1"},ot={class:"font-weight-medium text-body-2 mb-1"},lt={class:"text-caption text-medium-emphasis",style:{"font-size":"0.75rem"}},dt={class:"d-flex align-center gap-2"},ut=Ae({__name:"BaseProductCompositionModal",props:{show:{type:Boolean},composition:{},baseProducts:{},baseProductsLoading:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1}},emits:["close","save","notification"],setup(Ve,{emit:we}){const G=Ve,S=we,s=$e({base_product_id:0,ingredient_base_product_id:0,ingredient_item_id:0,quantity:0,notes:"",is_active:!0,is_critical:!1}),h=q(!1),g=q({}),u=q(null),_=q(null),c=q([]),k=q([]),z=q(!1),E=q(!1),Ie=K(()=>k.value||[]),Z=K(()=>s.base_product_id&&(s.ingredient_item_id||s.ingredient_base_product_id)&&s.quantity>0&&!O.value),ee=K(()=>{if(!_.value||!s.quantity)return 0;try{const t=_.value.cost_per_unit||0,e=Number(s.quantity)||0;return t*e}catch(t){return console.error("Error calculating cost:",t),0}}),te=K(()=>{if(!_.value||!s.quantity)return 0;try{const t=Number(_.value.current_stock)||0,e=Number(s.quantity)||0;return e>0?Math.floor(t/e):0}catch(t){return console.error("Error calculating max quantity:",t),0}}),O=K(()=>!s.ingredient_item_id&&!s.ingredient_base_product_id?!1:c.value.some(e=>!!(s.ingredient_item_id&&e.ingredient_item_id===s.ingredient_item_id||s.ingredient_base_product_id&&e.ingredient_base_product_id===s.ingredient_base_product_id))),L=t=>{if(t==null)return"0";const e=typeof t=="string"?parseFloat(t):Number(t);return isNaN(e)?"0":e.toLocaleString("id-ID")},A=t=>{if(t==null)return"Rp 0";const e=typeof t=="string"?parseFloat(t):Number(t);return isNaN(e)?"Rp 0":`Rp ${e.toLocaleString("id-ID")}`},F=t=>{var e,a;try{return(e=t.ingredient_item)!=null&&e.name?t.ingredient_item.name:(a=t.ingredient_base_product)!=null&&a.name?t.ingredient_base_product.name:"Unknown Item"}catch{return"Unknown Item"}},Ce=t=>{var e,a;try{return((e=t.ingredient_item)==null?void 0:e.current_stock)!==void 0?t.ingredient_item.current_stock:((a=t.ingredient_base_product)==null?void 0:a.current_stock)!==void 0?t.ingredient_base_product.current_stock:0}catch{return 0}},H=t=>{var e,a;try{return(e=t.ingredient_item)!=null&&e.unit?t.ingredient_item.unit:(a=t.ingredient_base_product)!=null&&a.unit?t.ingredient_base_product.unit:"pcs"}catch{return"pcs"}},Ne=()=>{if(!u.value)return 0;const t=u.value.selling_price||0,e=u.value.cost_per_unit||0;return t-e},qe=()=>{Object.keys(s).forEach(t=>{t==="is_active"?s[t]=!0:t==="is_critical"?s[t]=!1:t==="quantity"||t==="base_product_id"||t==="ingredient_item_id"||t==="ingredient_base_product_id"?s[t]=0:s[t]=""}),_.value=null,g.value={}},ae=async()=>{const t=Number(s.base_product_id);t?(u.value=G.baseProducts.find(e=>e.id_base_product===t)||null,await J()):(u.value=null,c.value=[])},ie=()=>{const t=Number(s.ingredient_item_id);t?_.value=k.value.find(e=>e.id_item===t)||null:_.value=null},se=async()=>{E.value||await re()},re=async()=>{if(!(E.value&&k.value.length>0))try{z.value=!0;const t=await B.get("/api/items?per_page=all&active=true");if(t.data.success&&t.data.data){let e=[];Array.isArray(t.data.data.data)?e=t.data.data.data:Array.isArray(t.data.data)&&(e=t.data.data),k.value=e,E.value=!0}else console.error("API response not successful:",t),k.value=[]}catch(t){console.error("Error loading items with $api:",t);try{const a=await(await fetch("/api/items?per_page=all&active=true",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ee("accessToken").value}`}})).json();if(a.success&&a.data){let n=[];Array.isArray(a.data.data)?n=a.data.data:Array.isArray(a.data)&&(n=a.data),k.value=n,E.value=!0}}catch(e){console.error("Items fallback also failed:",e),k.value=[]}k.value=[]}finally{z.value=!1}},J=async()=>{if(s.base_product_id)try{const t=await B.get(`/api/base-product-compositions/base-product/${s.base_product_id}`);if(t.data.success){const e=t.data.data||[];e.forEach(a=>{if(a.is_temporary=!1,a.ingredient_item_id&&!a.ingredient_item){const n=k.value.find(I=>I.id_item===a.ingredient_item_id);n&&(a.ingredient_item=n)}}),c.value=e,e.length>0}else console.error("API response not successful:",t.data),c.value=[]}catch(t){console.error("Error loading compositions:",t),t.response&&console.error("Error response:",t.response.data),c.value=[]}};le(()=>G.show,async t=>{t&&(E.value||await re(),s.base_product_id&&J())},{immediate:!0}),le(()=>G.composition,t=>{t?(Object.keys(s).forEach(e=>{const a=t[e];e==="is_active"?s[e]=a!==void 0?a:!0:e==="is_critical"?s[e]=a!==void 0?a:!1:e==="quantity"||e==="base_product_id"||e==="ingredient_item_id"?s[e]=a!==void 0?Number(a):0:s[e]=a||""}),ae(),ie()):qe(),g.value={}},{immediate:!0});const Pe=()=>{},ne=async()=>{var e,a,n,I,C,V;if(!Z.value)return;if(c.value.some(d=>!!(s.ingredient_item_id&&d.ingredient_item_id===s.ingredient_item_id||s.ingredient_base_product_id&&d.ingredient_base_product_id===s.ingredient_base_product_id))){const d=s.ingredient_item_id?(e=_.value)==null?void 0:e.name:(a=_.value)==null?void 0:a.name;g.value={general:`Item "${d||"yang dipilih"}" sudah ada dalam daftar komposisi. Silakan pilih item yang berbeda.`};return}h.value=!0,g.value={};try{const d={id:Date.now(),base_product_id:Number(s.base_product_id),ingredient_base_product_id:s.ingredient_base_product_id>0?Number(s.ingredient_base_product_id):null,ingredient_item_id:s.ingredient_item_id>0?Number(s.ingredient_item_id):null,quantity:Number(s.quantity),notes:s.notes||null,is_active:s.is_active,is_critical:s.is_critical,ingredient_item:s.ingredient_item_id>0?_.value:null,ingredient_base_product:s.ingredient_base_product_id>0?_.value:null,total_cost:ee.value,is_temporary:!0};c.value.push(d),s.ingredient_base_product_id=0,s.ingredient_item_id=0,s.quantity=0,s.notes="",s.is_critical=!1,_.value=null}catch(d){console.error("Error adding composition:",d),(I=(n=d.response)==null?void 0:n.data)!=null&&I.errors?g.value=d.response.data.errors:g.value={general:((V=(C=d.response)==null?void 0:C.data)==null?void 0:V.message)||"Failed to add composition"}}finally{h.value=!1}},Se=async t=>{s.base_product_id=t.base_product_id,s.quantity=t.quantity,s.notes=t.notes||"",s.is_active=t.is_active,s.is_critical=t.is_critical||!1,t.ingredient_item_id?(s.ingredient_item_id=t.ingredient_item_id,s.ingredient_base_product_id=0,_.value=t.ingredient_item):t.ingredient_base_product_id&&(s.ingredient_base_product_id=t.ingredient_base_product_id,s.ingredient_item_id=0,_.value=t.ingredient_base_product),await oe(t),g.value={},setTimeout(()=>{const e=document.querySelector(".composition-modal .v-card-text");e&&e.scrollTo({top:0,behavior:"smooth"})},100)},oe=async t=>{var e,a;h.value=!0;try{const n=t.id_base_product_composition||t.id,I=t.is_temporary===!0;if(n&&!I){const V=Me(),d={"Content-Type":"application/json",Accept:"application/json"};V&&(d.Authorization=`Bearer ${V}`),(await B.delete(`/api/base-product-compositions/${n}`,{headers:d})).data.success?S("notification","Item komposisi berhasil dihapus dari database","success"):S("notification","Gagal menghapus item komposisi","error")}else S("notification","Item komposisi berhasil dihapus","success");const C=c.value.findIndex(V=>V.id===t.id);C>-1&&c.value.splice(C,1)}catch(n){console.error("Error deleting composition:",n),S("notification",((a=(e=n.response)==null?void 0:e.data)==null?void 0:a.message)||"Gagal menghapus item komposisi","error")}finally{h.value=!1}},ze=async()=>{var a,n,I,C,V;if(c.value.length===0)return;h.value=!0,g.value={};let t=0,e=[];try{const d=c.value.filter(N=>N.is_temporary&&N.base_product_id&&N.quantity>0);if(d.length===0)return;for(let N=d.length-1;N>=0;N--){const m=d[N];if(!m.base_product_id||m.quantity<=0){console.error("Invalid composition data:",m),e.push(`Invalid composition data for ${F(m)}`);continue}try{const v={};if(v.base_product_id=Number(m.base_product_id),v.quantity=Number(m.quantity),v.is_active=!!m.is_active,v.is_critical=!!m.is_critical,v.notes=m.notes||null,m.ingredient_item_id&&Number(m.ingredient_item_id)>0&&(v.ingredient_item_id=Number(m.ingredient_item_id)),m.ingredient_base_product_id&&Number(m.ingredient_base_product_id)>0&&(v.ingredient_base_product_id=Number(m.ingredient_base_product_id)),!v.ingredient_item_id&&!v.ingredient_base_product_id){console.error("No ingredient provided for composition:",m),e.push(`${F(m)}: No ingredient selected`);continue}const M=B.interceptors.request.use(D=>D),R=await B.post("/api/base-product-compositions",v,{headers:{"Content-Type":"application/json",Accept:"application/json"}});B.interceptors.request.eject(M),t++;const j=c.value.findIndex(D=>D.id===m.id);j>-1&&c.value.splice(j,1)}catch(v){console.error("Error saving individual composition:",v);const M=F(m);if(((a=v.response)==null?void 0:a.status)===422){const R=((I=(n=v.response)==null?void 0:n.data)==null?void 0:I.message)||"";if(R.includes("already exists")||R.includes("Composition already exists")){e.push(`${M}: Item sudah ada dalam komposisi database`);const j=c.value.findIndex(D=>D.id===m.id);j>-1&&c.value.splice(j,1)}else e.push(`${M}: ${R}`)}else e.push(`${M}: ${((V=(C=v.response)==null?void 0:C.data)==null?void 0:V.message)||"Gagal menyimpan"}`)}}t>0&&e.length===0?(S("save",{success:!0}),S("close")):t>0&&e.length>0?(g.value={general:`${t} item berhasil disimpan. Errors: ${e.join(", ")}`},await J()):g.value={general:`Gagal menyimpan komposisi: ${e.join(", ")}`}}catch(d){console.error("Error saving compositions:",d),g.value={general:"Failed to save compositions: "+(d.message||"Unknown error")}}finally{h.value=!1}};return window.console=console,(t,e)=>(p(),x(je,{"model-value":t.show,"max-width":"1000px",persistent:"",scrollable:"","onUpdate:modelValue":e[6]||(e[6]=a=>!a&&t.$emit("close"))},{default:r(()=>[i(w,{class:"composition-modal"},{default:r(()=>[i(Q,{class:"composition-header"},{default:r(()=>[i(f,{icon:"mdi-chef-hat",class:"me-2"}),e[7]||(e[7]=o("span",null,"Kelola Komposisi Base Product",-1))]),_:1,__:[7]}),i(P,{class:"pa-6"},{default:r(()=>[i(Ke,{modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=a=>z.value=a),contained:"",persistent:"",class:"d-flex align-center justify-center"},{default:r(()=>[i(w,{class:"pa-6 text-center","min-width":"250"},{default:r(()=>[i(Te,{indeterminate:"",color:"primary",size:"50",class:"mb-4"}),e[8]||(e[8]=o("div",{class:"text-h6 mb-2"},"Memuat Data...",-1)),e[9]||(e[9]=o("div",{class:"text-body-2 text-medium-emphasis"},"Mohon tunggu sebentar",-1))]),_:1,__:[8,9]})]),_:1},8,["modelValue"]),u.value?(p(),x(w,{key:0,variant:"tonal",color:"primary",class:"mb-6"},{default:r(()=>[i(P,{class:"pa-4"},{default:r(()=>{var a;return[o("div",Ge,[i(X,{size:"60",rounded:""},{default:r(()=>[u.value.image_url?(p(),x(pe,{key:0,src:u.value.image_url,alt:u.value.name},null,8,["src","alt"])):(p(),x(f,{key:1,icon:"tabler-package",size:"30"}))]),_:1}),o("div",Oe,[o("h3",He,l(u.value.name),1),o("div",Je," SKU: "+l(u.value.sku||"No SKU"),1),o("div",Qe," Kategori: "+l(((a=u.value.category)==null?void 0:a.name)||"Tidak ada kategori"),1),i(fe,{color:u.value.current_stock>u.value.min_stock?"success":"warning",size:"small",variant:"flat",class:"mt-1"},{default:r(()=>[b(l(u.value.current_stock>u.value.min_stock?"Stok Aman":"Stok Menipis"),1)]),_:1},8,["color"])])])]}),_:1})]),_:1})):$("",!0),u.value?(p(),x(W,{key:1,class:"mb-6"},{default:r(()=>[i(y,{cols:"6",md:"3"},{default:r(()=>[i(w,{variant:"outlined",class:"stats-card"},{default:r(()=>[i(P,{class:"text-center pa-3"},{default:r(()=>{var a;return[i(f,{icon:"mdi-tag",color:"info",class:"mb-1",size:"20"}),o("div",Xe,l(((a=u.value.category)==null?void 0:a.name)||"No Category"),1),e[10]||(e[10]=o("div",{class:"text-caption text-medium-emphasis"},"Kategori",-1))]}),_:1,__:[10]})]),_:1})]),_:1}),i(y,{cols:"6",md:"3"},{default:r(()=>[i(w,{variant:"outlined",class:"stats-card"},{default:r(()=>[i(P,{class:"text-center pa-3"},{default:r(()=>[i(f,{icon:"mdi-package-variant",color:"primary",class:"mb-1",size:"20"}),o("div",We,l(A(u.value.cost_per_unit||0)),1),e[11]||(e[11]=o("div",{class:"text-caption text-medium-emphasis"},"HPP",-1))]),_:1,__:[11]})]),_:1})]),_:1}),i(y,{cols:"6",md:"3"},{default:r(()=>[i(w,{variant:"outlined",class:"stats-card"},{default:r(()=>[i(P,{class:"text-center pa-3"},{default:r(()=>[i(f,{icon:"mdi-currency-usd",color:"success",class:"mb-1",size:"20"}),o("div",Ye,l(A(u.value.selling_price||0)),1),e[12]||(e[12]=o("div",{class:"text-caption text-medium-emphasis"},"Harga Jual",-1))]),_:1,__:[12]})]),_:1})]),_:1}),i(y,{cols:"6",md:"3"},{default:r(()=>[i(w,{variant:"outlined",class:"stats-card"},{default:r(()=>[i(P,{class:"text-center pa-3"},{default:r(()=>[i(f,{icon:"mdi-trending-up",color:"warning",class:"mb-1",size:"20"}),o("div",Ze,l(A(Ne())),1),e[13]||(e[13]=o("div",{class:"text-caption text-medium-emphasis"},"Margin",-1))]),_:1,__:[13]})]),_:1})]),_:1})]),_:1})):$("",!0),i(w,{class:"mb-6"},{default:r(()=>[i(Q,{class:"d-flex align-center gap-2 pa-4"},{default:r(()=>[i(f,{icon:"mdi-plus-circle",color:"primary"}),e[14]||(e[14]=o("span",null,"Tambah Item Komposisi",-1))]),_:1,__:[14]}),i(Y),i(P,{class:"pa-4"},{default:r(()=>[Object.keys(g.value).length>0?(p(),x(ge,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:r(()=>[(p(!0),T(de,null,ue(g.value,(a,n)=>(p(),T("div",{key:n},[o("strong",null,l(n)+":",1),b(" "+l(Array.isArray(a)?a[0]:a),1)]))),128))]),_:1})):$("",!0),i(Ue,{onSubmit:Be(ne,["prevent"])},{default:r(()=>[i(W,null,{default:r(()=>[!t.editMode&&!s.base_product_id?(p(),x(y,{key:0,cols:"12",md:"6"},{default:r(()=>[i(ve,{modelValue:s.base_product_id,"onUpdate:modelValue":[e[1]||(e[1]=a=>s.base_product_id=a),ae],items:t.baseProducts,loading:t.baseProductsLoading,"item-title":"name","item-value":"id_base_product",label:"Pilih Base Product",placeholder:"Pilih base product","prepend-inner-icon":"tabler-package",clearable:"","error-messages":g.value.base_product_id},{item:r(({props:a,item:n})=>[i(be,ce(me(a)),{prepend:r(()=>[i(X,{size:"30"},{default:r(()=>[n.raw.image_url?(p(),x(pe,{key:0,src:n.raw.image_url,alt:n.raw.name},null,8,["src","alt"])):(p(),x(f,{key:1,icon:"tabler-package",size:"16"}))]),_:2},1024)]),default:r(()=>[i(ye,null,{default:r(()=>[b(l(n.raw.name),1)]),_:2},1024),i(he,null,{default:r(()=>[b(" Stock: "+l(L(n.raw.current_stock))+" "+l(n.raw.unit)+" | "+l(n.raw.formatted_cost),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","loading","error-messages"])]),_:1})):$("",!0),i(y,{cols:"12",md:!t.editMode&&!s.base_product_id?6:4},{default:r(()=>[i(ve,{modelValue:s.ingredient_item_id,"onUpdate:modelValue":[e[2]||(e[2]=a=>s.ingredient_item_id=a),ie],items:Ie.value,loading:z.value,"item-title":"name","item-value":"id_item",label:"Pilih Item",placeholder:"Pilih item komposisi","prepend-inner-icon":"tabler-package",clearable:"","error-messages":g.value.ingredient_item_id,color:O.value?"warning":"primary","onClick:prependInner":se,onFocus:se,"no-data-text":z.value?"Memuat item...":k.value.length===0?"Tidak ada item tersedia":"Ketik untuk mencari..."},{item:r(({props:a,item:n})=>[i(be,ce(me(a)),{prepend:r(()=>[i(X,{size:"30"},{default:r(()=>[i(f,{icon:"tabler-package",size:"16"})]),_:1})]),default:r(()=>[i(ye,null,{default:r(()=>[b(l(n.raw.name),1)]),_:2},1024),i(he,null,{default:r(()=>[b(" Stok: "+l(L(n.raw.current_stock||0))+" "+l(n.raw.unit||"pcs")+" | Rp "+l(A(n.raw.cost_per_unit||0)),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","loading","error-messages","color","no-data-text"]),O.value?(p(),x(ge,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mt-2"},{default:r(()=>[i(f,{icon:"mdi-alert",class:"me-2"}),e[15]||(e[15]=b(" Item ini sudah ada dalam daftar komposisi "))]),_:1,__:[15]})):$("",!0)]),_:1},8,["md"]),i(y,{cols:"6",md:!t.editMode&&!s.base_product_id?6:4},{default:r(()=>{var a;return[i(xe,{modelValue:s.quantity,"onUpdate:modelValue":e[3]||(e[3]=n=>s.quantity=n),type:"number",step:"0.01",min:"0",label:"Jumlah",placeholder:"1",suffix:((a=_.value)==null?void 0:a.unit)||"pcs","prepend-inner-icon":"mdi-numeric","error-messages":g.value.quantity,onInput:Pe},null,8,["modelValue","suffix","error-messages"])]}),_:1},8,["md"]),i(y,{cols:"6",md:!t.editMode&&!s.base_product_id?6:2},{default:r(()=>{var a;return[i(xe,{"model-value":((a=_.value)==null?void 0:a.unit)||"pcs",label:"Satuan",readonly:"","prepend-inner-icon":"mdi-scale-balance"},null,8,["model-value"])]}),_:1},8,["md"]),i(y,{cols:"6",md:"2"},{default:r(()=>[i(Le,{modelValue:s.is_critical,"onUpdate:modelValue":e[4]||(e[4]=a=>s.is_critical=a),label:"Item Kritis",color:"warning","hide-details":""},null,8,["modelValue"])]),_:1}),i(y,{cols:"6",md:"2",class:"d-flex align-center"},{default:r(()=>[i(U,{color:"primary",loading:h.value,disabled:!Z.value,onClick:ne,block:""},{default:r(()=>[i(f,{icon:"mdi-plus",class:"me-1"}),e[16]||(e[16]=b(" Tambah ke List "))]),_:1,__:[16]},8,["loading","disabled"])]),_:1})]),_:1}),_.value&&s.quantity?(p(),x(w,{key:0,variant:"tonal",color:"success",class:"mt-4"},{default:r(()=>[i(P,{class:"pa-3"},{default:r(()=>[i(W,null,{default:r(()=>[i(y,{cols:"12",md:"4"},{default:r(()=>{var a;return[e[17]||(e[17]=o("div",{class:"text-caption text-medium-emphasis"},"Cost per Unit:",-1)),o("div",et,l(A(((a=_.value)==null?void 0:a.cost_per_unit)||0)),1)]}),_:1,__:[17]}),i(y,{cols:"12",md:"4"},{default:r(()=>[e[18]||(e[18]=o("div",{class:"text-caption text-medium-emphasis"},"Total Cost:",-1)),o("div",tt,l(A(ee.value)),1)]),_:1,__:[18]}),i(y,{cols:"12",md:"4"},{default:r(()=>[e[19]||(e[19]=o("div",{class:"text-caption text-medium-emphasis"},"Available Stock:",-1)),o("div",{class:_e(["text-h6 font-weight-bold",te.value>0?"text-success":"text-error"])},l(te.value)+" portions ",3)]),_:1,__:[19]})]),_:1})]),_:1})]),_:1})):$("",!0)]),_:1})]),_:1})]),_:1}),i(w,null,{default:r(()=>[i(Q,{class:"d-flex align-center justify-space-between pa-4"},{default:r(()=>[o("div",at,[i(f,{icon:"mdi-format-list-bulleted",color:"primary"}),o("span",null,"Daftar Item Komposisi ("+l(c.value.length)+")",1)])]),_:1}),i(Y),c.value.length===0?(p(),T("div",it,[i(f,{icon:"mdi-package-variant-closed",size:"64",color:"grey-lighten-2",class:"mb-4"}),e[20]||(e[20]=o("h3",{class:"text-h6 text-medium-emphasis mb-2"},"Belum ada item komposisi",-1)),e[21]||(e[21]=o("p",{class:"text-body-2 text-medium-emphasis mb-4"}," Tambahkan item yang dibutuhkan untuk membuat base product ini ",-1))])):(p(),T("div",st,[(p(!0),T(de,null,ue(c.value,a=>(p(),T("div",{key:a.id||a.base_product_id,class:_e(["composition-item d-flex align-center justify-space-between pa-3 mb-3 rounded-lg border",{"bg-green-lighten-5 border-success":a.is_temporary}])},[o("div",rt,[i(f,{icon:"mdi-check-circle",color:"success",size:"18"}),o("div",nt,[o("div",ot,l(F(a)),1),o("div",lt,[b(" Dibutuhkan: "+l(L(a.quantity||0))+" "+l(H(a))+" ",1),e[22]||(e[22]=o("span",{class:"mx-2"},"•",-1)),b(" Stok: "+l(L(Ce(a)))+" "+l(H(a)),1)])])]),o("div",dt,[i(fe,{size:"x-small",variant:"outlined",color:"primary"},{default:r(()=>[b(l(H(a)),1)]),_:2},1024),i(U,{icon:"",size:"x-small",variant:"text",color:"primary",onClick:n=>Se(a),disabled:a.is_temporary||h.value},{default:r(()=>[i(f,{icon:"mdi-pencil",size:"16"}),i(ke,{activator:"parent",location:"top"},{default:r(()=>e[23]||(e[23]=[b(" Edit Komposisi ")])),_:1,__:[23]})]),_:2},1032,["onClick","disabled"]),i(U,{icon:"",size:"x-small",variant:"text",color:"error",disabled:h.value,onClick:n=>oe(a)},{default:r(()=>[i(f,{icon:"mdi-delete",size:"16"}),i(ke,{activator:"parent",location:"top"},{default:r(()=>e[24]||(e[24]=[b(" Hapus Komposisi ")])),_:1,__:[24]})]),_:2},1032,["disabled","onClick"])])],2))),128))]))]),_:1})]),_:1}),i(Y),i(De,{class:"pa-4"},{default:r(()=>[i(Fe),i(U,{variant:"outlined",onClick:e[5]||(e[5]=a=>t.$emit("close")),disabled:h.value},{default:r(()=>e[25]||(e[25]=[b(" Batal ")])),_:1,__:[25]},8,["disabled"]),i(U,{color:"primary",onClick:ze,loading:h.value,disabled:c.value.length===0},{default:r(()=>[i(f,{icon:"mdi-content-save",class:"me-1"}),b(" Simpan Komposisi ("+l(c.value.filter(a=>a.is_temporary).length)+") ",1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),Mt=Re(ut,[["__scopeId","data-v-51007991"]]);export{Mt as default};
