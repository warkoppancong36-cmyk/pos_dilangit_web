import{D as At}from"./DeleteConfirmationDialog-C6Dep5ZT.js";import{f as tt}from"./formatters-BD6tdLx_.js";import{P as vt,u as ta}from"./useProductItems-CBTOxOrZ.js";import{I as aa}from"./ItemsApi-BKAIfLOA.js";import{H as la,u as oa}from"./HPPBreakdownDialog-U-8GJLeO.js";import{V as Oe}from"./VDialog-BjDvMKUR.js";import{V as de,b as Ce,c as Ke}from"./VCard-BApJpBbq.js";import{cq as Mt,a8 as Qe,a9 as Ze,as as sa,aF as na,af as Et,bT as ia,r as H,V as me,aG as We,w as Pe,W as je,b as e,a0 as K,aa as et,ak as ra,ab as Ht,ac as Bt,H as Ft,ba as ua,L as da,N as Kt,bZ as ca,b_ as ma,b9 as pt,aJ as bt,I as va,ag as Rt,aM as gt,bj as fa,bt as $t,p as he,be as wt,cr as pa,c8 as Dt,bh as ga,F as Te,X as S,cp as _a,c9 as ka,aI as ya,s as f,cs as ba,a$ as ha,ad as xa,aH as wa,b3 as Va,b5 as Pa,d as Re,D as ut,c as se,f as t,e as a,t as c,g as L,l as ae,m as Y,i as Ge,v as Xe,o as b,aw as qt,ax as ht,$ as Vt,j as Ot,ct as Ca,aA as qe,ap as Ia,aq as Sa,a5 as yt}from"./main-CfzN74Is.js";import{V as fe}from"./VCardText-CWNgHRbp.js";import{V as Se}from"./VAvatar-_cNK4U2C.js";import{V as pe,m as $a,b as Tt}from"./VChip-CStzVWNn.js";import{V as $e,a as E}from"./VRow-CqQ0Lg11.js";import{V as Pt}from"./VAutocomplete-asIwAOVq.js";import{u as Da,e as Ta,t as ot,V as kt,a as Je,b as nt,d as it}from"./VList-Ced8qjT5.js";import{u as Ua,V as Ve,m as za}from"./VTextField-vqz0Dorj.js";import{V as rt}from"./VSwitch-C72r7leZ.js";import{a as _t,V as He}from"./VAlert-WNg-F2Oo.js";import{V as Le}from"./VSpacer-CEiYNYav.js";import{V as at}from"./VSnackbar-DqWS3STY.js";import{_ as Ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Aa,m as Ma,a as Ea,V as Be}from"./VSelect-C2PIusrS.js";import{V as Ha}from"./VCheckbox-YZWW2I33.js";import{V as ze}from"./VDivider-CPgxjiYx.js";import{V as Ba}from"./VContainer-Mb2xujoC.js";import{a as Lt,u as Fa,P as Ka}from"./useProducts-BclGffS1.js";import{V as Ct}from"./VForm--llX9cFS.js";import{V as Ut}from"./VTextarea-1LnmbqGg.js";import{V as Ee}from"./VTooltip-BWE5CxcT.js";import{M as Ra,m as qa,V as Oa}from"./VImg-CsFsJmgD.js";import{V as La,u as Na}from"./useCategories-gNrcuhE_.js";import{u as ja,m as Wa,h as Ga}from"./filter-BIlDRjCP.js";import{f as Nt,a as Xa,s as Ja}from"./forwardRefs-B931MWyl.js";import{V as Ya}from"./VMenu-DUjCa5CV.js";import{V as Qa}from"./VCheckboxBtn-D-stTB1y.js";import{V as Za}from"./VDataTableServer-BtlgyKky.js";import{V as el}from"./VSkeletonLoader-oKEnb2LL.js";import{V as tl}from"./VDataTable-BVcSRCBd.js";import{c as al,d as ll,u as ol}from"./VOverlay-B283C59D.js";import"./ProductsApi-BRb2Hc1W.js";import"./api-Bbnl0j0Y.js";import"./index-D-EbNoF1.js";/* empty css              */import"./helpers-B-vn2Qqf.js";import"./CategoriesApi-ATzQT6q-.js";import"./VTable-DMv_rRjr.js";const sl=l=>{const{touchstartX:F,touchendX:y,touchstartY:d,touchendY:z}=l,p=.5,P=16;l.offsetX=y-F,l.offsetY=z-d,Math.abs(l.offsetY)<p*Math.abs(l.offsetX)&&(l.left&&y<F-P&&l.left(l),l.right&&y>F+P&&l.right(l)),Math.abs(l.offsetX)<p*Math.abs(l.offsetY)&&(l.up&&z<d-P&&l.up(l),l.down&&z>d+P&&l.down(l))};function nl(l,F){var d;const y=l.changedTouches[0];F.touchstartX=y.clientX,F.touchstartY=y.clientY,(d=F.start)==null||d.call(F,{originalEvent:l,...F})}function il(l,F){var d;const y=l.changedTouches[0];F.touchendX=y.clientX,F.touchendY=y.clientY,(d=F.end)==null||d.call(F,{originalEvent:l,...F}),sl(F)}function rl(l,F){var d;const y=l.changedTouches[0];F.touchmoveX=y.clientX,F.touchmoveY=y.clientY,(d=F.move)==null||d.call(F,{originalEvent:l,...F})}function ul(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const F={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:l.left,right:l.right,up:l.up,down:l.down,start:l.start,move:l.move,end:l.end};return{touchstart:y=>nl(y,F),touchend:y=>il(y,F),touchmove:y=>rl(y,F)}}function dl(l,F){var m;const y=F.value,d=y!=null&&y.parent?l.parentElement:l,z=(y==null?void 0:y.options)??{passive:!0},p=(m=F.instance)==null?void 0:m.$.uid;if(!d||!p)return;const P=ul(F.value);d._touchHandlers=d._touchHandlers??Object.create(null),d._touchHandlers[p]=P,Mt(P).forEach(r=>{d.addEventListener(r,P[r],z)})}function cl(l,F){var p,P;const y=(p=F.value)!=null&&p.parent?l.parentElement:l,d=(P=F.instance)==null?void 0:P.$.uid;if(!(y!=null&&y._touchHandlers)||!d)return;const z=y._touchHandlers[d];Mt(z).forEach(m=>{y.removeEventListener(m,z[m])}),delete y._touchHandlers[d]}const jt={mounted:dl,unmounted:cl},Wt=Symbol.for("vuetify:v-window"),Gt=Symbol.for("vuetify:v-window-group"),Xt=Ze({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:l=>typeof l=="boolean"||l==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Bt(),...Ht(),...ra()},"VWindow"),xt=Qe()({name:"VWindow",directives:{Touch:jt},props:Xt(),emits:{"update:modelValue":l=>!0},setup(l,F){let{slots:y}=F;const{themeClasses:d}=sa(l),{isRtl:z}=na(),{t:p}=Et(),P=ia(l,Gt),m=H(),r=me(()=>z.value?!l.reverse:l.reverse),s=We(!1),G=me(()=>{const g=l.direction==="vertical"?"y":"x",$=(r.value?!s.value:s.value)?"-reverse":"";return`v-window-${g}${$}-transition`}),_=We(0),N=H(void 0),oe=me(()=>P.items.value.findIndex(g=>P.selected.value.includes(g.id)));Pe(oe,(g,k)=>{const $=P.items.value.length,X=$-1;$<=2?s.value=g<k:g===X&&k===0?s.value=!0:g===0&&k===X?s.value=!1:s.value=g<k}),da(Wt,{transition:G,isReversed:s,transitionCount:_,transitionHeight:N,rootRef:m});const T=je(()=>l.continuous||oe.value!==0),I=je(()=>l.continuous||oe.value!==P.items.value.length-1);function re(){T.value&&P.prev()}function ge(){I.value&&P.next()}const R=me(()=>{const g=[],k={icon:z.value?l.nextIcon:l.prevIcon,class:`v-window__${r.value?"right":"left"}`,onClick:P.prev,"aria-label":p("$vuetify.carousel.prev")};g.push(T.value?y.prev?y.prev({props:k}):e(K,k,null):e("div",null,null));const $={icon:z.value?l.prevIcon:l.nextIcon,class:`v-window__${r.value?"left":"right"}`,onClick:P.next,"aria-label":p("$vuetify.carousel.next")};return g.push(I.value?y.next?y.next({props:$}):e(K,$,null):e("div",null,null)),g}),Z=me(()=>l.touch===!1?l.touch:{...{left:()=>{r.value?re():ge()},right:()=>{r.value?ge():re()},start:k=>{let{originalEvent:$}=k;$.stopPropagation()}},...l.touch===!0?{}:l.touch});return et(()=>Ft(e(l.tag,{ref:m,class:["v-window",{"v-window--show-arrows-on-hover":l.showArrows==="hover"},d.value,l.class],style:l.style},{default:()=>{var g,k;return[e("div",{class:"v-window__container",style:{height:N.value}},[(g=y.default)==null?void 0:g.call(y,{group:P}),l.showArrows!==!1&&e("div",{class:"v-window__controls"},[R.value])]),(k=y.additional)==null?void 0:k.call(y,{group:P})]}}),[[ua("touch"),Z.value]])),{group:P}}}),Jt=Ze({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Bt(),...ma(),...ll()},"VWindowItem"),st=Qe()({name:"VWindowItem",directives:{Touch:jt},props:Jt(),emits:{"group:selected":l=>!0},setup(l,F){let{slots:y}=F;const d=Kt(Wt),z=ca(l,Gt),{isBooted:p}=Da();if(!d||!z)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const P=We(!1),m=me(()=>p.value&&(d.isReversed.value?l.reverseTransition!==!1:l.transition!==!1));function r(){!P.value||!d||(P.value=!1,d.transitionCount.value>0&&(d.transitionCount.value-=1,d.transitionCount.value===0&&(d.transitionHeight.value=void 0)))}function s(){var T;P.value||!d||(P.value=!0,d.transitionCount.value===0&&(d.transitionHeight.value=bt((T=d.rootRef.value)==null?void 0:T.clientHeight)),d.transitionCount.value+=1)}function G(){r()}function _(T){P.value&&pt(()=>{!m.value||!P.value||!d||(d.transitionHeight.value=bt(T.clientHeight))})}const N=me(()=>{const T=d.isReversed.value?l.reverseTransition:l.transition;return m.value?{name:typeof T!="string"?d.transition.value:T,onBeforeEnter:s,onAfterEnter:r,onEnterCancelled:G,onBeforeLeave:s,onAfterLeave:r,onLeaveCancelled:G,onEnter:_}:!1}),{hasContent:oe}=al(l,z.isSelected);return et(()=>e(Ra,{transition:N.value,disabled:!p.value},{default:()=>{var T;return[Ft(e("div",{class:["v-window-item",z.selectedClass.value,l.class],style:l.style},[oe.value&&((T=y.default)==null?void 0:T.call(y))]),[[va,z.isSelected.value]])]}})),{groupItem:z}}}),ml=Ze({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Wa({filterKeys:["title"]}),...Ma({hideNoData:!0,returnObject:!0}),...wt(za({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...qa({transition:!1})},"VCombobox"),vl=Qe()({name:"VCombobox",props:ml(),emits:{"update:focused":l=>!0,"update:modelValue":l=>!0,"update:search":l=>!0,"update:menu":l=>!0},setup(l,F){var O;let{emit:y,slots:d}=F;const{t:z}=Et(),p=H(),P=We(!1),m=We(!0),r=We(!1),s=H(),G=H(),_=We(-1);let N=!1;const{items:oe,transformIn:T,transformOut:I}=Ta(l),{textColorClasses:re,textColorStyles:ge}=Rt(()=>{var o;return(o=p.value)==null?void 0:o.color}),R=gt(l,"modelValue",[],o=>T(fa(o)),o=>{const U=I(o);return l.multiple?U:U[0]??null}),Z=Ua(l),g=me(()=>!!(l.chips||d.chip)),k=me(()=>g.value||!!d.selection),$=We(!l.multiple&&!k.value?((O=R.value[0])==null?void 0:O.title)??"":""),X=me({get:()=>$.value,set:o=>{var U;if($.value=o??"",!l.multiple&&!k.value&&(R.value=[ot(l,o)]),o&&l.multiple&&((U=l.delimiters)!=null&&U.length)){const j=o.split(new RegExp(`(?:${l.delimiters.join("|")})+`));j.length>1&&(j.forEach(J=>{J=J.trim(),J&&_e(ot(l,J))}),$.value="")}o||(_.value=-1),m.value=!o}}),B=me(()=>typeof l.counterValue=="function"?l.counterValue(R.value):typeof l.counterValue=="number"?l.counterValue:l.multiple?R.value.length:X.value.length),{filteredItems:h,getMatches:V}=ja(l,oe,()=>m.value?"":X.value),q=me(()=>l.hideSelected?h.value.filter(o=>!R.value.some(U=>U.value===o.value)):h.value),ue=me(()=>l.hideNoData&&!q.value.length||Z.isReadonly.value||Z.isDisabled.value),ye=gt(l,"menu"),ve=me({get:()=>ye.value,set:o=>{var U;ye.value&&!o&&((U=s.value)!=null&&U.Î¨openChildren.size)||o&&ue.value||(ye.value=o)}}),Q=je(()=>ve.value?l.closeText:l.openText);Pe($,o=>{N?pt(()=>N=!1):P.value&&!ve.value&&(ve.value=!0),y("update:search",o)}),Pe(R,o=>{var U;!l.multiple&&!k.value&&($.value=((U=o[0])==null?void 0:U.title)??"")});const v=me(()=>R.value.map(o=>o.value)),u=me(()=>{var U;return(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&X.value===((U=q.value[0])==null?void 0:U.title))&&q.value.length>0&&!m.value&&!r.value}),n=H(),i=Aa(n,p);function A(o){N=!0,l.openOnClear&&(ve.value=!0)}function M(){ue.value||(ve.value=!0)}function C(o){ue.value||(P.value&&(o.preventDefault(),o.stopPropagation()),ve.value=!ve.value)}function x(o){var U;o.key!==" "&&Dt(o)&&((U=p.value)==null||U.focus())}function ne(o){var J,D,ee,W;if(pa(o)||Z.isReadonly.value)return;const U=(J=p.value)==null?void 0:J.selectionStart,j=R.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(o.key)&&o.preventDefault(),["Enter","ArrowDown"].includes(o.key)&&(ve.value=!0),["Escape"].includes(o.key)&&(ve.value=!1),["Enter","Escape","Tab"].includes(o.key)&&(u.value&&["Enter","Tab"].includes(o.key)&&!R.value.some(w=>{let{value:ie}=w;return ie===q.value[0].value})&&_e(h.value[0]),m.value=!0),o.key==="ArrowDown"&&u.value&&((D=n.value)==null||D.focus("next")),o.key==="Enter"&&X.value&&(_e(ot(l,X.value)),k.value&&($.value="")),["Backspace","Delete"].includes(o.key)){if(!l.multiple&&k.value&&R.value.length>0&&!X.value)return _e(R.value[0],!1);if(~_.value){o.preventDefault();const w=_.value;_e(R.value[_.value],!1),_.value=w>=j-1?j-2:w}else o.key==="Backspace"&&!X.value&&(_.value=j-1);return}if(l.multiple)if(o.key==="ArrowLeft"){if(_.value<0&&U&&U>0)return;const w=_.value>-1?_.value-1:j-1;R.value[w]?_.value=w:(_.value=-1,(ee=p.value)==null||ee.setSelectionRange(X.value.length,X.value.length))}else if(o.key==="ArrowRight"){if(_.value<0)return;const w=_.value+1;R.value[w]?_.value=w:(_.value=-1,(W=p.value)==null||W.setSelectionRange(0,0))}else~_.value&&Dt(o)&&(_.value=-1)}function xe(){var o;l.eager&&((o=G.value)==null||o.calculateVisibleItems())}function Ie(){var o;P.value&&(m.value=!0,(o=p.value)==null||o.focus())}function _e(o){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!o||o.props.disabled))if(l.multiple){const j=R.value.findIndex(D=>(l.valueComparator||$t)(D.value,o.value)),J=U??!~j;if(~j){const D=J?[...R.value,o]:[...R.value];D.splice(j,1),R.value=D}else J&&(R.value=[...R.value,o]);l.clearOnSelect&&(X.value="")}else{const j=U!==!1;R.value=j?[o]:[],$.value=j&&!k.value?o.title:"",pt(()=>{ve.value=!1,m.value=!0})}}function te(o){P.value=!0,setTimeout(()=>{r.value=!0})}function be(o){r.value=!1}function we(o){(o==null||o===""&&!l.multiple&&!k.value)&&(R.value=[])}return Pe(P,(o,U)=>{if(!(o||o===U)&&(_.value=-1,ve.value=!1,X.value)){if(l.multiple){_e(ot(l,X.value));return}if(!k.value)return;R.value.some(j=>{let{title:J}=j;return J===X.value})?$.value="":_e(ot(l,X.value))}}),Pe(ve,()=>{if(!l.hideSelected&&ve.value&&R.value.length){const o=q.value.findIndex(U=>R.value.some(j=>(l.valueComparator||$t)(j.value,U.value)));ga&&window.requestAnimationFrame(()=>{var U;o>=0&&((U=G.value)==null||U.scrollToIndex(o))})}}),Pe(()=>l.items,(o,U)=>{ve.value||P.value&&!U.length&&o.length&&(ve.value=!0)}),et(()=>{const o=!!(!l.hideNoData||q.value.length||d["prepend-item"]||d["append-item"]||d["no-data"]),U=R.value.length>0,j=Ve.filterProps(l);return e(Ve,he({ref:p},j,{modelValue:X.value,"onUpdate:modelValue":[J=>X.value=J,we],focused:P.value,"onUpdate:focused":J=>P.value=J,validationValue:R.externalValue,counterValue:B.value,dirty:U,class:["v-combobox",{"v-combobox--active-menu":ve.value,"v-combobox--chips":!!l.chips,"v-combobox--selection-slot":!!k.value,"v-combobox--selecting-index":_.value>-1,[`v-combobox--${l.multiple?"multiple":"single"}`]:!0},l.class],style:l.style,readonly:Z.isReadonly.value,placeholder:U?void 0:l.placeholder,"onClick:clear":A,"onMousedown:control":M,onKeydown:ne}),{...d,default:()=>e(Te,null,[e(Ya,he({ref:s,modelValue:ve.value,"onUpdate:modelValue":J=>ve.value=J,activator:"parent",contentClass:"v-combobox__content",disabled:ue.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterEnter:xe,onAfterLeave:Ie},l.menuProps),{default:()=>[o&&e(kt,he({ref:n,selected:v.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:J=>J.preventDefault(),onKeydown:x,onFocusin:te,onFocusout:be,tabindex:"-1","aria-live":"polite",color:l.itemColor??l.color},i,l.listProps),{default:()=>{var J,D,ee;return[(J=d["prepend-item"])==null?void 0:J.call(d),!q.value.length&&!l.hideNoData&&(((D=d["no-data"])==null?void 0:D.call(d))??e(Je,{key:"no-data",title:z(l.noDataText)},null)),e(Ea,{ref:G,renderless:!0,items:q.value,itemKey:"value"},{default:W=>{var Ae;let{item:w,index:ie,itemRef:ce}=W;const De=he(w.props,{ref:ce,key:w.value,active:u.value&&ie===0?!0:void 0,onClick:()=>_e(w,null)});return((Ae=d.item)==null?void 0:Ae.call(d,{item:w,index:ie,props:De}))??e(Je,he(De,{role:"option"}),{prepend:Me=>{let{isSelected:Fe}=Me;return e(Te,null,[l.multiple&&!l.hideSelected?e(Qa,{key:w.value,modelValue:Fe,ripple:!1,tabindex:"-1"},null):void 0,w.props.prependAvatar&&e(Se,{image:w.props.prependAvatar},null),w.props.prependIcon&&e(S,{icon:w.props.prependIcon},null)])},title:()=>{var Me;return m.value?w.title:Ga("v-combobox",w.title,(Me=V(w))==null?void 0:Me.title)}})}}),(ee=d["append-item"])==null?void 0:ee.call(d)]}})]}),R.value.map((J,D)=>{function ee(ce){ce.stopPropagation(),ce.preventDefault(),_e(J,!1)}const W={"onClick:close":ee,onKeydown(ce){ce.key!=="Enter"&&ce.key!==" "||(ce.preventDefault(),ce.stopPropagation(),ee(ce))},onMousedown(ce){ce.preventDefault(),ce.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},w=g.value?!!d.chip:!!d.selection,ie=w?ka(g.value?d.chip({item:J,index:D,props:W}):d.selection({item:J,index:D})):void 0;if(!(w&&!ie))return e("div",{key:J.value,class:["v-combobox__selection",D===_.value&&["v-combobox__selection--selected",re.value]],style:D===_.value?ge.value:{}},[g.value?d.chip?e(ya,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:J.title}}},{default:()=>[ie]}):e(pe,he({key:"chip",closable:l.closableChips,size:"small",text:J.title,disabled:J.props.disabled},W),null):ie??e("span",{class:"v-combobox__selection-text"},[J.title,l.multiple&&D<R.value.length-1&&e("span",{class:"v-combobox__selection-comma"},[f(",")])])])})]),"append-inner":function(){var W,w;for(var J=arguments.length,D=new Array(J),ee=0;ee<J;ee++)D[ee]=arguments[ee];return e(Te,null,[(W=d["append-inner"])==null?void 0:W.call(d,...D),(!l.hideNoData||l.items.length)&&l.menuIcon?e(S,{class:"v-combobox__menu-icon",color:(w=p.value)==null?void 0:w.fieldIconColor,icon:l.menuIcon,onMousedown:C,onClick:_a,"aria-label":z(Q.value),title:z(Q.value),tabindex:"-1"},null):void 0])}})}),Nt({isFocused:P,isPristine:m,menu:ve,search:X,selectionIndex:_,filteredItems:h,select:_e},p)}}),It=Symbol.for("vuetify:v-tabs"),fl=Ze({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...wt(ba({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),ft=Qe()({name:"VTab",props:fl(),setup(l,F){let{slots:y,attrs:d}=F;const{textColorClasses:z,textColorStyles:p}=Rt(()=>l.sliderColor),P=H(),m=H(),r=me(()=>l.direction==="horizontal"),s=me(()=>{var _,N;return((N=(_=P.value)==null?void 0:_.group)==null?void 0:N.isSelected.value)??!1});function G(_){var oe,T;let{value:N}=_;if(N){const I=(T=(oe=P.value)==null?void 0:oe.$el.parentElement)==null?void 0:T.querySelector(".v-tab--selected .v-tab__slider"),re=m.value;if(!I||!re)return;const ge=getComputedStyle(I).color,R=I.getBoundingClientRect(),Z=re.getBoundingClientRect(),g=r.value?"x":"y",k=r.value?"X":"Y",$=r.value?"right":"bottom",X=r.value?"width":"height",B=R[g],h=Z[g],V=B>h?R[$]-Z[$]:R[g]-Z[g],q=Math.sign(V)>0?r.value?"right":"bottom":Math.sign(V)<0?r.value?"left":"top":"center",ye=(Math.abs(V)+(Math.sign(V)<0?R[X]:Z[X]))/Math.max(R[X],Z[X])||0,ve=R[X]/Z[X]||0,Q=1.5;Xa(re,{backgroundColor:[ge,"currentcolor"],transform:[`translate${k}(${V}px) scale${k}(${ve})`,`translate${k}(${V/Q}px) scale${k}(${(ye-1)/Q+1})`,"none"],transformOrigin:Array(3).fill(q)},{duration:225,easing:Ja})}}return et(()=>{const _=K.filterProps(l);return e(K,he({symbol:It,ref:P,class:["v-tab",l.class],style:l.style,tabindex:s.value?0:-1,role:"tab","aria-selected":String(s.value),active:!1},_,d,{block:l.fixed,maxWidth:l.fixed?300:void 0,"onGroup:selected":G}),{...y,default:()=>{var N;return e(Te,null,[((N=y.default)==null?void 0:N.call(y))??l.text,!l.hideSlider&&e("div",{ref:m,class:["v-tab__slider",z.value],style:p.value},null)])}})}),Nt({},P)}}),pl=Ze({...wt(Xt(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),gl=Qe()({name:"VTabsWindow",props:pl(),emits:{"update:modelValue":l=>!0},setup(l,F){let{slots:y}=F;const d=Kt(It,null),z=gt(l,"modelValue"),p=me({get(){var P;return z.value!=null||!d?z.value:(P=d.items.value.find(m=>d.selected.value.includes(m.id)))==null?void 0:P.value},set(P){z.value=P}});return et(()=>{const P=xt.filterProps(l);return e(xt,he({_as:"VTabsWindow"},P,{modelValue:p.value,"onUpdate:modelValue":m=>p.value=m,class:["v-tabs-window",l.class],style:l.style,mandatory:!1,touch:!1}),y)}),{}}}),_l=Ze({...Jt()},"VTabsWindowItem"),kl=Qe()({name:"VTabsWindowItem",props:_l(),setup(l,F){let{slots:y}=F;return et(()=>{const d=st.filterProps(l);return e(st,he({_as:"VTabsWindowItem"},d,{class:["v-tabs-window-item",l.class],style:l.style}),y)}),{}}});function yl(l){return l?l.map(F=>Pa(F)?F:{text:F,value:F}):[]}const bl=Ze({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...$a({mandatory:"force",selectedClass:"v-tab-item--selected"}),...Va(),...Ht()},"VTabs"),hl=Qe()({name:"VTabs",props:bl(),emits:{"update:modelValue":l=>!0},setup(l,F){let{attrs:y,slots:d}=F;const z=gt(l,"modelValue"),p=me(()=>yl(l.items)),{densityClasses:P}=ha(l),{backgroundColorClasses:m,backgroundColorStyles:r}=xa(()=>l.bgColor),{scopeId:s}=ol();return wa({VTab:{color:je(()=>l.color),direction:je(()=>l.direction),stacked:je(()=>l.stacked),fixed:je(()=>l.fixedTabs),sliderColor:je(()=>l.sliderColor),hideSlider:je(()=>l.hideSlider)}}),et(()=>{const G=Tt.filterProps(l),_=!!(d.window||l.items.length>0);return e(Te,null,[e(Tt,he(G,{modelValue:z.value,"onUpdate:modelValue":N=>z.value=N,class:["v-tabs",`v-tabs--${l.direction}`,`v-tabs--align-tabs-${l.alignTabs}`,{"v-tabs--fixed-tabs":l.fixedTabs,"v-tabs--grow":l.grow,"v-tabs--stacked":l.stacked},P.value,m.value,l.class],style:[{"--v-tabs-height":bt(l.height)},r.value,l.style],role:"tablist",symbol:It},s,y),{default:()=>{var N;return[((N=d.default)==null?void 0:N.call(d))??p.value.map(oe=>{var T;return((T=d.tab)==null?void 0:T.call(d,{item:oe}))??e(ft,he(oe,{key:oe.text,value:oe.value}),{default:d[`tab.${oe.value}`]?()=>{var I;return(I=d[`tab.${oe.value}`])==null?void 0:I.call(d,{item:oe})}:void 0})})]}}),_&&e(gl,he({modelValue:z.value,"onUpdate:modelValue":N=>z.value=N,key:"tabs-window"},s),{default:()=>{var N;return[p.value.map(oe=>{var T;return((T=d.item)==null?void 0:T.call(d,{item:oe}))??e(kl,{value:oe.value},{default:()=>{var I;return(I=d[`item.${oe.value}`])==null?void 0:I.call(d,{item:oe})}})}),(N=d.window)==null?void 0:N.call(d)]}})])}),{}}}),xl={class:"d-flex align-center gap-3"},wl={class:"text-body-2 ma-0 opacity-90"},Vl={class:"d-flex align-center gap-4"},Pl={class:"flex-grow-1"},Cl={class:"text-h6 font-weight-bold mb-1"},Il={class:"text-body-2 text-medium-emphasis mb-1"},Sl={class:"text-body-2 text-medium-emphasis mb-0"},$l={class:"d-flex align-center justify-space-between w-100"},Dl={class:"d-flex align-center"},Tl={key:0,class:"text-warning"},Ul={key:1},zl={key:0,class:"text-center pa-8"},Al={class:"d-flex align-center gap-4 mt-1"},Ml={key:1,class:"text-primary"},El={class:"d-flex gap-2"},Hl=Re({__name:"ProductCompositionDialog",props:{modelValue:{type:Boolean},product:{},items:{}},emits:["update:modelValue","save","refresh"],setup(l,{emit:F}){const y=l,d=F,z=me({get:()=>y.modelValue,set:C=>d("update:modelValue",C)}),p=H(!1),P=H([]),m=H(!1),r=H(!1),s=H(""),G=H(""),_=H(!1),N=H(-1),oe=H(!1),T=H({itemId:null,quantity:1,unit:"pcs",isCritical:!1}),I=H([]),re=H(!1),ge=async()=>{var C;if(y.product)try{const x=y.product.id_product||y.product.id;console.log("ðŸ”„ Fetching composition for product ID:",x);const ne=await vt.getAll({product_id:x,page:1,per_page:1e5});ne.success&&((C=ne.data)!=null&&C.data)&&(P.value=ne.data.data)}catch(x){console.error("Error fetching product composition:",x)}},R=async()=>{var C;re.value=!0;try{const x=await aa.getAll({page:1,per_page:1e5,active:!0});x.success&&((C=x.data)!=null&&C.data)&&(I.value=x.data.data.map(ne=>{var xe,Ie,_e;return{id:((xe=ne.id_item)==null?void 0:xe.toString())||((Ie=ne.id)==null?void 0:Ie.toString()),name:ne.name,current_stock:((_e=ne.inventory)==null?void 0:_e.current_stock)||0,unit:ne.unit||"pcs"}}))}catch(x){console.error("Error fetching available items:",x),I.value=[]}finally{re.value=!1}},Z=me(()=>T.value.itemId&&T.value.quantity>0&&T.value.unit.trim().length>0),g=me(()=>{if(!T.value.itemId)return null;const C=I.value.find(x=>x.id===T.value.itemId);return(C==null?void 0:C.unit)||null}),k=me(()=>{if(!T.value.itemId)return null;const C=I.value.find(x=>x.id===T.value.itemId);return C?B(C):null}),$=me(()=>k.value!==null&&k.value<=0),X=me(()=>Array.isArray(I.value)?I.value:[]),B=C=>C.current_stock||C.stock||0,h=()=>re.value?"Memuat items...":!I.value||I.value.length===0?"Tidak ada item tersedia":"Tidak ada item yang ditemukan",V=C=>{const x=B(C);return x>50?"success":x>20?"warning":x>0?"error":"grey"},q=C=>{const x=B(C);return x>50?"Aman":x>20?"Rendah":x>0?"Kritis":"Habis"};Pe(()=>T.value.itemId,C=>{if(C){const x=I.value.find(ne=>ne.id===C);x!=null&&x.unit&&(T.value.unit=x.unit)}}),Pe(()=>y.items,C=>{C&&C.length>0,P.value=[...C]},{immediate:!0}),Pe(()=>y.modelValue,C=>{C&&y.product&&ge()}),ut(()=>{R()});const ue=()=>{oe.value=!0},ye=()=>P.value.some(x=>{var ne;return((ne=x.item)==null?void 0:ne.inventory)&&x.item.inventory.current_stock<x.quantity_needed})?"error":"success",ve=()=>P.value.some(x=>{var ne;return((ne=x.item)==null?void 0:ne.inventory)&&x.item.inventory.current_stock<x.quantity_needed})?"Stok Kritis":"Stok Aman",Q=()=>{if(!Z.value)return;const C=I.value.find(xe=>xe.id===T.value.itemId);if(!C)return;if(P.value.find(xe=>{var Ie;return((Ie=xe.item)==null?void 0:Ie.id)===C.id})){s.value=`Item "${C.name}" sudah ada dalam komposisi produk ini`,m.value=!0;return}const ne={id_product_item:`temp_${Date.now()}`,item:{id:String(C.id),name:C.name,inventory:{current_stock:C.current_stock||0}},quantity_needed:T.value.quantity,unit:T.value.unit,is_critical:T.value.isCritical};P.value.push(ne),n()},v=(C,x)=>{var Ie;if(console.log("ðŸ” EditItem called with:",C),console.log("ðŸ” Item structure:",JSON.stringify(C,null,2)),I.value.length===0){console.warn("âš ï¸ Available items not loaded yet, fetching..."),R().then(()=>{console.log("âœ… Available items loaded, retrying edit"),v(C,x)});return}_.value=!0,N.value=x;let ne=((Ie=C.item)==null?void 0:Ie.id)||null;ne!==null&&(ne=ne.toString()),console.log("ðŸŽ¯ Found itemId (converted to string):",ne),console.log("ðŸ” Available items for reference:",I.value.map(_e=>({id:_e.id,name:_e.name}))),T.value={itemId:ne,quantity:C.quantity_needed,unit:C.unit,isCritical:C.is_critical},console.log("ðŸ“ Form data set for edit:",T.value);const xe=I.value.find(_e=>_e.id===ne);if(xe)console.log("âœ… Item found in available items:",xe.name);else{console.warn("âš ï¸ Item ID not found in available items, trying alternative matching...");const _e=I.value.find(te=>{var be;return te.name===((be=C.item)==null?void 0:be.name)});_e?(console.log("âœ… Found item by name matching, using ID:",_e.id),T.value.itemId=_e.id):console.error("âŒ Could not find item in available items by ID or name")}},u=()=>{if(!Z.value||N.value===-1)return;const C=I.value.find(x=>x.id===T.value.itemId);C&&(P.value[N.value]={...P.value[N.value],item:{id:String(C.id),name:C.name,inventory:{current_stock:C.current_stock||0}},quantity_needed:T.value.quantity,unit:T.value.unit,is_critical:T.value.isCritical},n())},n=()=>{_.value=!1,N.value=-1,T.value={itemId:null,quantity:1,unit:"pcs",isCritical:!1}},i=C=>{P.value.splice(C,1)},A=async()=>{var C,x,ne,xe,Ie,_e,te,be,we,O,o,U,j;if(y.product){p.value=!0;try{console.log("ðŸ’¾ Saving composition for product:",y.product.name),console.log("ðŸ“¦ Items to save:",P.value);const J=parseInt(String(((C=y.product)==null?void 0:C.id_product)||((x=y.product)==null?void 0:x.id)||"0")),D=y.items||[],ee=P.value;for(const W of ee){const w=D.find(ce=>{var De,Ae;return ce.id_product_item===W.id_product_item||((De=ce.item)==null?void 0:De.id)===((Ae=W.item)==null?void 0:Ae.id)&&ce.product_id===J});console.log("ðŸ” Processing item:",{item_name:(ne=W.item)==null?void 0:ne.name,item_id_product_item:W.id_product_item,existing_found:!!w,existing_id:w==null?void 0:w.id_product_item,is_temp:(xe=W.id_product_item)==null?void 0:xe.toString().startsWith("temp_")});const ie={product_id:J,item_id:parseInt(((Ie=W.item)==null?void 0:Ie.id)||"0"),quantity_needed:W.quantity_needed,unit:W.unit,is_critical:W.is_critical,notes:W.notes||""};console.log("ðŸ“¤ API Data:",ie);try{w&&!((_e=W.id_product_item)!=null&&_e.toString().startsWith("temp_"))?(console.log("âœï¸ Updating existing item:",{id:w.id_product_item,item_name:(te=W.item)==null?void 0:te.name,stock:(be=W.item)==null?void 0:be.stock}),await vt.update(parseInt(w.id_product_item||"0"),ie)):(console.log("âž• Creating new item:",{item_name:(we=W.item)==null?void 0:we.name,stock:(O=W.item)==null?void 0:O.stock,id_product_item:W.id_product_item,is_temp:(o=W.id_product_item)==null?void 0:o.toString().startsWith("temp_"),existing_item_found:!!w}),await vt.create(ie))}catch(ce){throw console.error("âŒ Error processing item:",ce),(U=ce.message)!=null&&U.includes("already assigned")?s.value=`Item "${(j=W.item)==null?void 0:j.name}" sudah ditambahkan ke produk ini`:s.value=ce.message||"Terjadi kesalahan saat menyimpan item",m.value=!0,ce}}for(const W of D)if(!ee.find(ie=>ie.id_product_item===W.id_product_item)&&W.id_product_item)try{console.log("ðŸ—‘ï¸ Deleting item:",W.id_product_item),await vt.delete(parseInt(W.id_product_item))}catch(ie){console.error("âŒ Error deleting item:",ie),s.value=`Gagal menghapus item: ${ie.message}`,m.value=!0}console.log("âœ… Composition saved successfully!"),G.value="Komposisi produk berhasil disimpan!",r.value=!0,d("save",{product:y.product,items:P.value}),d("refresh"),M()}catch(J){console.error("âŒ Error saving composition:",J),m.value||(s.value=J.message||"Terjadi kesalahan saat menyimpan komposisi",m.value=!0)}finally{p.value=!1}}},M=()=>{z.value=!1,setTimeout(()=>{P.value=[...y.items],n()},300)};return(C,x)=>{var ne,xe,Ie,_e;return b(),se(Te,null,[e(Oe,{modelValue:z.value,"onUpdate:modelValue":x[9]||(x[9]=te=>z.value=te),"max-width":"900",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ce,{class:"d-flex align-center justify-between bg-primary text-white"},{default:t(()=>{var te;return[a("div",xl,[e(S,{icon:"mdi-chef-hat",size:"24"}),a("div",null,[x[13]||(x[13]=a("h3",{class:"text-h6 font-weight-bold"},"Kelola Komposisi Item",-1)),a("p",wl,c(((te=C.product)==null?void 0:te.name)||"Produk"),1)])]),e(K,{icon:"mdi-close",variant:"text",size:"small",onClick:M})]}),_:1}),e(fe,{class:"pa-6"},{default:t(()=>[e(de,{variant:"tonal",class:"mb-6"},{default:t(()=>[e(fe,{class:"pa-4"},{default:t(()=>{var te,be,we,O,o;return[a("div",Vl,[e(Se,{image:(te=C.product)==null?void 0:te.image_url,size:"64"},{default:t(()=>{var U;return[(U=C.product)!=null&&U.image_url?ae("",!0):(b(),L(S,{key:0,icon:"mdi-coffee"}))]}),_:1},8,["image"]),a("div",Pl,[a("h4",Cl,c((be=C.product)==null?void 0:be.name),1),a("p",Il," SKU: "+c(((we=C.product)==null?void 0:we.sku)||"SKU-"+((O=C.product)==null?void 0:O.id_product)),1),a("p",Sl," Harga: "+c(Y(tt)(((o=C.product)==null?void 0:o.price)||0)),1)]),e(pe,{color:ye(),variant:"tonal"},{default:t(()=>[f(c(ve()),1)]),_:1},8,["color"])])]}),_:1})]),_:1}),e(de,{class:"mb-6",elevation:"2"},{default:t(()=>[e(Ce,{class:"bg-grey-lighten-4 py-3"},{default:t(()=>[a("div",$l,[a("div",Dl,[e(S,{icon:_.value?"mdi-pencil-circle":"mdi-plus-circle",class:"me-2"},null,8,["icon"]),f(" "+c(_.value?"Edit Item Komposisi":"Tambah Item Komposisi"),1)])])]),_:1}),e(fe,{class:"pa-4"},{default:t(()=>[e($e,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(Pt,{modelValue:T.value.itemId,"onUpdate:modelValue":x[0]||(x[0]=te=>T.value.itemId=te),items:X.value,loading:re.value,"item-title":"name","item-value":"id",label:"Pilih Item",placeholder:"Cari item (termasuk yang stok kosong)...","prepend-inner-icon":"mdi-magnify",variant:"outlined",clearable:"","no-data-text":h()},{item:t(({props:te,item:be})=>[e(Je,he(te,{class:{"text-medium-emphasis":B(be.raw)<=0}}),{prepend:t(()=>[e(Se,{size:"32",class:"me-3",color:B(be.raw)<=0?"warning":"primary",variant:"tonal"},{default:t(()=>[e(S,{icon:"mdi-package-variant",color:B(be.raw)<=0?"warning":"primary"},null,8,["color"])]),_:2},1032,["color"])]),append:t(()=>[B(be.raw)>0?(b(),L(pe,{key:0,size:"x-small",color:V(be.raw),variant:"tonal"},{default:t(()=>[f(c(q(be.raw)),1)]),_:2},1032,["color"])):(b(),L(pe,{key:1,size:"x-small",color:"warning",variant:"tonal","prepend-icon":"mdi-alert"},{default:t(()=>x[15]||(x[15]=[f(" Kosong ")])),_:1,__:[15]}))]),default:t(()=>[e(nt,null,{default:t(()=>[f(c(be.raw.name),1)]),_:2},1024),e(it,{class:"text-medium-emphasis"},{default:t(()=>[B(be.raw)<=0?(b(),se("span",Tl,[e(S,{icon:"mdi-alert-circle",size:"12",class:"me-1"}),x[14]||(x[14]=f(" Stok Kosong - Masih bisa digunakan "))])):(b(),se("span",Ul," Stok: "+c(B(be.raw))+" "+c(be.raw.unit),1))]),_:2},1024)]),_:2},1040,["class"])]),_:1},8,["modelValue","items","loading","no-data-text"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Ve,{modelValue:T.value.quantity,"onUpdate:modelValue":x[1]||(x[1]=te=>T.value.quantity=te),modelModifiers:{number:!0},type:"number",label:"Jumlah",variant:"outlined",min:"0",step:"0.01"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Ve,{modelValue:T.value.unit,"onUpdate:modelValue":x[2]||(x[2]=te=>T.value.unit=te),label:"Satuan",variant:"outlined",placeholder:"kg, pcs, ml",readonly:!!g.value,hint:g.value?`Satuan dari item: ${g.value}`:"","persistent-hint":""},null,8,["modelValue","readonly","hint"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(rt,{modelValue:T.value.isCritical,"onUpdate:modelValue":x[3]||(x[3]=te=>T.value.isCritical=te),label:"Item Kritis",color:"error","hide-details":""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(K,{color:_.value?"success":"primary",block:"","prepend-icon":_.value?"mdi-check":"mdi-plus",onClick:x[4]||(x[4]=te=>_.value?u():Q()),disabled:!Z.value},{default:t(()=>[f(c(_.value?"Update":"Tambah"),1)]),_:1},8,["color","prepend-icon","disabled"]),_.value?(b(),L(K,{key:0,color:"error",variant:"outlined",block:"","prepend-icon":"mdi-close",class:"mt-2",onClick:n},{default:t(()=>x[16]||(x[16]=[f(" Batal ")])),_:1,__:[16]})):ae("",!0)]),_:1})]),_:1}),$.value?(b(),L(He,{key:0,color:"warning",variant:"tonal",class:"mt-4","prepend-icon":"mdi-alert"},{default:t(()=>[e(_t,null,{default:t(()=>x[17]||(x[17]=[f("Item Stok Kosong")])),_:1,__:[17]}),x[18]||(x[18]=a("div",null,"Item yang dipilih sedang kosong stok, namun masih bisa ditambahkan ke komposisi. Pastikan untuk memperbarui stok sebelum produksi.",-1))]),_:1,__:[18]})):ae("",!0)]),_:1})]),_:1}),e(de,{elevation:"2"},{default:t(()=>[e(Ce,{class:"bg-grey-lighten-4 py-3"},{default:t(()=>[e(S,{icon:"mdi-format-list-bulleted",class:"me-2"}),f(" Daftar Item Komposisi ("+c(P.value.length)+") ",1)]),_:1}),e(fe,{class:"pa-0"},{default:t(()=>[P.value.length===0?(b(),se("div",zl,[e(S,{icon:"mdi-package-variant-closed",size:"64",class:"text-disabled mb-4"}),x[19]||(x[19]=a("h4",{class:"text-h6 mb-2"},"Belum ada item komposisi",-1)),x[20]||(x[20]=a("p",{class:"text-body-2 text-medium-emphasis"}," Tambahkan item yang dibutuhkan untuk membuat produk ini ",-1))])):(b(),L(kt,{key:1},{default:t(()=>[(b(!0),se(Te,null,Ge(P.value,(te,be)=>(b(),L(Je,{key:te.id||be,class:"border-b"},{prepend:t(()=>[e(Se,{size:"40",class:"me-3"},{default:t(()=>{var we,O;return[e(S,{icon:(we=te.item)!=null&&we.inventory&&te.item.inventory.current_stock>=te.quantity_needed?"mdi-check-circle":"mdi-alert-circle",color:(O=te.item)!=null&&O.inventory&&te.item.inventory.current_stock>=te.quantity_needed?"success":"error"},null,8,["icon","color"])]}),_:2},1024)]),append:t(()=>[a("div",El,[e(K,{icon:"mdi-pencil",variant:"text",size:"small",color:"primary",onClick:we=>v(te,be)},null,8,["onClick"]),e(K,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:we=>i(be)},null,8,["onClick"])])]),default:t(()=>[e(nt,{class:"font-weight-medium"},{default:t(()=>{var we;return[f(c(((we=te.item)==null?void 0:we.name)||"Item tidak ditemukan")+" ",1),te.is_critical?(b(),L(pe,{key:0,color:"error",size:"x-small",variant:"tonal",class:"ms-2"},{default:t(()=>x[21]||(x[21]=[f(" Kritis ")])),_:1,__:[21]})):ae("",!0)]}),_:2},1024),e(it,null,{default:t(()=>{var we;return[a("div",Al,[a("span",null,"Dibutuhkan: "+c(te.quantity_needed)+" "+c(te.unit),1),(we=te.item)!=null&&we.inventory?(b(),se("span",{key:0,class:Xe(te.item.inventory.current_stock>=te.quantity_needed?"text-success":"text-error")}," Stok: "+c(te.item.inventory.current_stock)+" "+c(te.unit),3)):ae("",!0),te.formatted_total_cost?(b(),se("span",Ml,c(te.formatted_total_cost),1)):ae("",!0)])]}),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(Ke,{class:"pa-6 pt-0"},{default:t(()=>[e(K,{color:"warning",variant:"outlined","prepend-icon":"mdi-calculator",onClick:ue},{default:t(()=>x[22]||(x[22]=[f(" Setting HPP ")])),_:1,__:[22]}),e(Le),e(K,{variant:"outlined",onClick:M},{default:t(()=>x[23]||(x[23]=[f(" Batal ")])),_:1,__:[23]}),e(K,{color:"primary",onClick:A,loading:p.value},{default:t(()=>x[24]||(x[24]=[f(" Simpan Komposisi ")])),_:1,__:[24]},8,["loading"])]),_:1})]),_:1}),e(at,{modelValue:m.value,"onUpdate:modelValue":x[6]||(x[6]=te=>m.value=te),color:"error",location:"top",timeout:5e3},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:x[5]||(x[5]=te=>m.value=!1)},{default:t(()=>x[25]||(x[25]=[f(" Tutup ")])),_:1,__:[25]})]),default:t(()=>[f(c(s.value)+" ",1)]),_:1},8,["modelValue"]),e(at,{modelValue:r.value,"onUpdate:modelValue":x[8]||(x[8]=te=>r.value=te),color:"success",location:"top",timeout:3e3},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:x[7]||(x[7]=te=>r.value=!1)},{default:t(()=>x[26]||(x[26]=[f(" Tutup ")])),_:1,__:[26]})]),default:t(()=>[f(c(G.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),e(la,{modelValue:oe.value,"onUpdate:modelValue":x[10]||(x[10]=te=>oe.value=te),"product-id":parseInt(String(((ne=C.product)==null?void 0:ne.id_product)||((xe=C.product)==null?void 0:xe.id)||"0")),"product-name":((Ie=C.product)==null?void 0:Ie.product_name)||((_e=C.product)==null?void 0:_e.name),onHppUpdated:x[11]||(x[11]=te=>d("refresh")),onPriceUpdated:x[12]||(x[12]=te=>d("refresh"))},null,8,["modelValue","product-id","product-name"])],64)}}}),Yt=Ne(Hl,[["__scopeId","data-v-74244d09"]]),Bl={class:"composition-cards"},Fl={key:1,class:"text-center pa-12"},Kl={key:2,class:"text-center pa-12"},Rl={class:"d-flex align-center gap-3"},ql={class:"flex-grow-1 min-width-0"},Ol={class:"text-h6 font-weight-bold text-truncate"},Ll={class:"text-caption text-medium-emphasis mb-0"},Nl={class:"d-flex align-center gap-2 mb-3"},jl={class:"text-body-2 font-weight-medium"},Wl={class:"composition-items"},Gl={class:"d-flex align-center gap-2 flex-grow-1 min-width-0"},Xl={class:"text-body-2 text-truncate"},Jl={class:"text-end flex-shrink-0"},Yl={class:"text-body-2 font-weight-medium"},Ql={key:0,class:"text-caption text-success"},Zl={key:1,class:"text-caption text-primary"},eo={class:"d-flex justify-between align-center mb-3"},to={class:"text-h6 font-weight-bold text-primary"},ao={class:"d-flex gap-2"},lo={class:"d-flex align-center"},oo={class:"d-flex align-center gap-4"},so={class:"flex-grow-1"},no={class:"text-h5 font-weight-bold mb-2"},io={class:"d-flex align-center gap-4 mb-2"},ro={class:"text-body-2"},uo={class:"text-h6 text-primary font-weight-bold"},co={class:"d-flex align-center mt-1 gap-4"},mo={class:"d-flex align-center"},vo={class:"d-flex align-center"},fo={key:0,class:"d-flex align-center"},po={class:"text-primary font-weight-medium"},go={key:1,class:"text-center py-8"},_o={class:"text-h6 font-weight-bold"},ko={class:"text-h6 font-weight-bold"},yo={class:"text-h6 font-weight-bold"},bo=Re({__name:"ProductCompositionCards",props:{productItems:{},loading:{type:Boolean}},emits:["refresh","edit-composition","view-details"],setup(l,{emit:F}){const y=l,d=F,z=H(!1),p=H(!1),P=H(null),m=H([]),r=H(null),s=H({search:"",stockStatus:"",itemType:"",criticalOnly:!1,sortBy:"name_asc"}),G=[{title:"Semua Status",value:""},{title:"Stok Aman",value:"safe"},{title:"Stok Kritis",value:"critical"},{title:"Stok Habis",value:"out"}],_=[{title:"Nama A-Z",value:"name_asc"},{title:"Nama Z-A",value:"name_desc"},{title:"Harga Tertinggi",value:"price_desc"},{title:"Harga Terendah",value:"price_asc"},{title:"Item Terbanyak",value:"items_desc"},{title:"Item Tersedikit",value:"items_asc"}],N=B=>{P.value=B,m.value=B.items||[],z.value=!0},oe=B=>{r.value=B,p.value=!0},T=B=>{console.log("Composition saved:",B),d("refresh")},I=()=>{s.value={search:"",stockStatus:"",itemType:"",criticalOnly:!1,sortBy:"name_asc"}},re=me(()=>!!(s.value.search||s.value.stockStatus||s.value.itemType||s.value.criticalOnly||s.value.sortBy!=="name_asc")),ge=me(()=>{let B=0;return s.value.search&&B++,s.value.stockStatus&&B++,s.value.itemType&&B++,s.value.criticalOnly&&B++,s.value.sortBy!=="name_asc"&&B++,B}),R=me(()=>{const B=new Map;y.productItems.forEach(V=>{if(!V.product)return;const q=V.product.id_product||V.product.id;B.has(q)||B.set(q,{...V.product,items:[],totalItems:0}),B.get(q).items.push(V),B.get(q).totalItems++});let h=Array.from(B.values());if(s.value.search){const V=s.value.search.toLowerCase();h=h.filter(q=>q.name.toLowerCase().includes(V)||q.sku&&q.sku.toLowerCase().includes(V)||q.items.some(ue=>{var ye;return(ye=ue.item)==null?void 0:ye.name.toLowerCase().includes(V)}))}return s.value.stockStatus&&(h=h.filter(V=>{const q=Z(V);switch(s.value.stockStatus){case"safe":return q.color==="success";case"critical":return q.color==="warning";case"out":return q.color==="error";default:return!0}})),s.value.criticalOnly&&(h=h.filter(V=>V.items.some(q=>q.is_critical))),h.sort((V,q)=>{switch(s.value.sortBy){case"name_asc":return V.name.localeCompare(q.name);case"name_desc":return q.name.localeCompare(V.name);case"price_asc":return(V.price||0)-(q.price||0);case"price_desc":return(q.price||0)-(V.price||0);case"items_asc":return V.totalItems-q.totalItems;case"items_desc":return q.totalItems-V.totalItems;default:return V.name.localeCompare(q.name)}}),h}),Z=B=>{let h=!1,V=!1;return B.items.forEach(q=>{var ue;if((ue=q.item)!=null&&ue.inventory){const ye=q.item.inventory.current_stock||0,ve=q.quantity_needed||0;ye<=0?h=!0:(ye<ve||q.is_critical)&&(V=!0)}}),h?{text:"Stok Habis",color:"error"}:V?{text:"Stok Kritis",color:"warning"}:{text:"Stok Aman",color:"success"}},g=B=>{if(!(B!=null&&B.inventory))return"grey";const h=B.inventory.current_stock||0;return h<=0?"error":h<=10?"warning":"success"},k=B=>{if(!(B!=null&&B.inventory))return"Tidak ada data";const h=B.inventory.current_stock||0;return h<=0?"Habis":h<=10?"Rendah":"Aman"},$=B=>{const h=g(B);return{"text-error":h==="error","text-warning":h==="warning","text-success":h==="success","text-grey":h==="grey"}},X=B=>`Item Komposisi (${B})`;return(B,h)=>(b(),se("div",Bl,[e(de,{class:"mb-6"},{default:t(()=>[e(Ce,{class:"d-flex align-center justify-between"},{default:t(()=>[h[12]||(h[12]=a("div",null,[a("h2",{class:"text-h5 font-weight-bold"},"Komposisi Produk"),a("p",{class:"text-body-2 text-medium-emphasis"}," Kelola komposisi bahan untuk setiap produk ")],-1)),e(K,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:h[0]||(h[0]=V=>d("refresh")),loading:B.loading},{default:t(()=>h[11]||(h[11]=[f(" Refresh ")])),_:1,__:[11]},8,["loading"])]),_:1,__:[12]})]),_:1}),e(de,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(fe,null,{default:t(()=>[e($e,null,{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ve,{modelValue:s.value.search,"onUpdate:modelValue":h[1]||(h[1]=V=>s.value.search=V),label:"Cari Produk",placeholder:"Nama produk, SKU, atau item...",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Be,{modelValue:s.value.stockStatus,"onUpdate:modelValue":h[2]||(h[2]=V=>s.value.stockStatus=V),items:G,label:"Status Stok",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-chart-line","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Be,{modelValue:s.value.sortBy,"onUpdate:modelValue":h[3]||(h[3]=V=>s.value.sortBy=V),items:_,label:"Urutkan",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-sort","hide-details":""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3",class:"d-flex align-center"},{default:t(()=>[e(Ha,{modelValue:s.value.criticalOnly,"onUpdate:modelValue":h[4]||(h[4]=V=>s.value.criticalOnly=V),label:"Hanya Item Kritis",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e($e,{class:"mt-3"},{default:t(()=>[e(E,{cols:"12",md:"6",class:"d-flex align-center gap-2"},{default:t(()=>[e(K,{variant:"outlined",color:"grey",size:"small","prepend-icon":"mdi-filter-off",onClick:I,disabled:!re.value},{default:t(()=>h[13]||(h[13]=[f(" Reset Filter ")])),_:1,__:[13]},8,["disabled"]),re.value?(b(),L(pe,{key:0,color:"primary",variant:"tonal",size:"small"},{default:t(()=>[f(c(ge.value)+" filter aktif ",1)]),_:1})):ae("",!0)]),_:1}),e(E,{cols:"12",md:"6",class:"d-flex align-center justify-end"},{default:t(()=>[e(pe,{color:R.value.length>0?"success":"default",variant:"tonal","prepend-icon":"mdi-package-variant"},{default:t(()=>[f(c(R.value.length)+" Produk dengan Komposisi ",1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),!B.loading&&R.value.length===0&&re.value?(b(),L(He,{key:0,type:"info",variant:"outlined",class:"mb-6",title:"Tidak ada hasil",text:"Tidak ada produk yang sesuai dengan filter yang dipilih. Coba ubah filter pencarian."})):ae("",!0),B.loading?(b(),se("div",Fl,[e(qt,{color:"primary",indeterminate:"",size:"64"}),h[14]||(h[14]=a("div",{class:"mt-4 text-h6"},"Memuat komposisi...",-1))])):R.value.length===0?(b(),se("div",Kl,[e(S,{icon:"mdi-chef-hat-off",size:"96",class:"text-disabled mb-6"}),h[16]||(h[16]=a("h3",{class:"text-h5 font-weight-bold mb-4"},"Belum Ada Komposisi Produk",-1)),h[17]||(h[17]=a("p",{class:"text-body-1 text-medium-emphasis mb-6"}," Buat komposisi untuk produk Anda agar dapat melihat detail bahan yang dibutuhkan ",-1)),e(K,{color:"primary",size:"large","prepend-icon":"mdi-plus"},{default:t(()=>h[15]||(h[15]=[f(" Buat Komposisi Pertama ")])),_:1,__:[15]})])):(b(),L($e,{key:3},{default:t(()=>[(b(!0),se(Te,null,Ge(R.value,V=>(b(),L(E,{key:V.id_product,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(de,{class:Xe(["composition-card h-100",{"border-error":Z(V).color==="error"}]),elevation:"2"},{default:t(()=>[e(Ce,{class:"pa-4 pb-2"},{default:t(()=>[a("div",Rl,[e(Se,{image:V.image_url,size:"48",class:"flex-shrink-0"},{default:t(()=>[V.image_url?ae("",!0):(b(),L(S,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"]),a("div",ql,[a("h3",Ol,c(V.name),1),a("p",Ll,c(V.sku||"SKU-"+V.id_product),1)])])]),_:2},1024),e(fe,{class:"py-2"},{default:t(()=>[e(pe,{color:Z(V).color,size:"small",variant:"tonal",class:"mb-3"},{default:t(()=>[f(c(Z(V).text),1)]),_:2},1032,["color"]),a("div",Nl,[e(S,{icon:"mdi-format-list-bulleted",size:"16"}),a("span",jl,c(X(V.totalItems)),1)]),a("div",Wl,[(b(!0),se(Te,null,Ge(V.items,q=>{var ue,ye,ve,Q;return b(),se("div",{key:q.id_product_item,class:"composition-item d-flex align-center justify-between mb-2"},[a("div",Gl,[e(S,{icon:(ue=q.item)!=null&&ue.inventory&&q.item.inventory.current_stock>=q.quantity_needed?"mdi-check-circle":"mdi-alert-circle",color:(ye=q.item)!=null&&ye.inventory&&q.item.inventory.current_stock>=q.quantity_needed?"success":"error",size:"16"},null,8,["icon","color"]),a("span",Xl,c(((ve=q.item)==null?void 0:ve.name)||"Item tidak ditemukan"),1),q.is_critical?(b(),L(pe,{key:0,color:"error",size:"x-small",variant:"tonal"},{default:t(()=>h[18]||(h[18]=[f(" Kritis ")])),_:1,__:[18]})):ae("",!0)]),a("div",Jl,[a("div",Yl,c(q.quantity_needed)+" "+c(q.unit),1),(Q=q.item)!=null&&Q.inventory?(b(),se("div",Ql," Stok: "+c(q.item.inventory.current_stock)+" "+c(q.unit),1)):ae("",!0),q.formatted_total_cost?(b(),se("div",Zl,c(q.formatted_total_cost),1)):ae("",!0)])])}),128))])]),_:2},1024),e(fe,{class:"pt-0"},{default:t(()=>[e(ze,{class:"mb-3"}),a("div",eo,[h[19]||(h[19]=a("span",{class:"text-body-2"},"Harga:",-1)),a("span",to,c(Y(tt)(V.price||0)),1)]),a("div",ao,[e(K,{color:"primary",size:"small","prepend-icon":"mdi-eye",onClick:q=>oe(V)},{default:t(()=>h[20]||(h[20]=[f(" Detail ")])),_:2,__:[20]},1032,["onClick"]),e(K,{color:"secondary",variant:"outlined",size:"small","prepend-icon":"mdi-cog",onClick:q=>N(V)},{default:t(()=>h[21]||(h[21]=[f(" Kelola ")])),_:2,__:[21]},1032,["onClick"])])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})),e(Yt,{modelValue:z.value,"onUpdate:modelValue":h[5]||(h[5]=V=>z.value=V),product:P.value,items:m.value,onSave:T,onRefresh:h[6]||(h[6]=V=>d("refresh"))},null,8,["modelValue","product","items"]),e(Oe,{modelValue:p.value,"onUpdate:modelValue":h[10]||(h[10]=V=>p.value=V),"max-width":"900",scrollable:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ce,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",lo,[e(S,{icon:"mdi-eye",class:"mr-2",color:"primary"}),h[22]||(h[22]=a("span",null,"Detail Komposisi Produk",-1))]),e(K,{icon:"",variant:"text",onClick:h[7]||(h[7]=V=>p.value=!1)},{default:t(()=>[e(S,{icon:"mdi-close"})]),_:1})]),_:1}),e(ze),r.value?(b(),L(fe,{key:0},{default:t(()=>[e(Ba,null,{default:t(()=>[e($e,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(de,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(fe,null,{default:t(()=>[a("div",oo,[e(Se,{image:r.value.image_url,size:"80"},{default:t(()=>[r.value.image_url?ae("",!0):(b(),L(S,{key:0,icon:"mdi-coffee",size:"40"}))]),_:1},8,["image"]),a("div",so,[a("h2",no,c(r.value.name),1),a("div",io,[e(pe,{color:Z(r.value).color,variant:"tonal",size:"small"},{default:t(()=>[f(c(Z(r.value).text),1)]),_:1},8,["color"]),a("span",ro,"SKU: "+c(r.value.sku||"-"),1)]),a("div",uo,c(Y(tt)(r.value.price||0)),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e($e,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(de,{variant:"outlined"},{default:t(()=>[e(Ce,{class:"text-h6"},{default:t(()=>[e(S,{icon:"mdi-format-list-bulleted",class:"mr-2"}),f(" Komposisi Item ("+c(r.value.totalItems||0)+") ",1)]),_:1}),e(fe,null,{default:t(()=>[r.value.items&&r.value.items.length>0?(b(),L(kt,{key:0},{default:t(()=>[(b(!0),se(Te,null,Ge(r.value.items,(V,q)=>(b(),L(Je,{key:V.id_product_item,class:"px-0"},{prepend:t(()=>[e(Se,{size:"40",color:g(V.item),variant:"tonal"},{default:t(()=>{var ue;return[e(S,{icon:(ue=V.item)!=null&&ue.inventory&&V.item.inventory.current_stock>=V.quantity_needed?"mdi-check":"mdi-alert"},null,8,["icon"])]}),_:2},1032,["color"])]),append:t(()=>[e(pe,{color:g(V.item),variant:"tonal",size:"small"},{default:t(()=>[f(c(k(V.item)),1)]),_:2},1032,["color"])]),default:t(()=>[e(nt,{class:"font-weight-medium"},{default:t(()=>{var ue;return[f(c(((ue=V.item)==null?void 0:ue.name)||"Unknown Item")+" ",1),V.is_critical?(b(),L(pe,{key:0,color:"error",variant:"tonal",size:"x-small",class:"ml-2"},{default:t(()=>h[23]||(h[23]=[f(" Kritis ")])),_:1,__:[23]})):ae("",!0)]}),_:2},1024),e(it,null,{default:t(()=>{var ue,ye;return[a("div",co,[a("div",mo,[e(S,{icon:"mdi-scale",size:"14",class:"mr-1"}),a("span",null," Kebutuhan: "+c(Number(V.quantity_needed||0).toLocaleString("id-ID"))+" "+c(V.unit),1)]),a("div",vo,[e(S,{icon:"mdi-warehouse",size:"14",class:"mr-1"}),a("span",{class:Xe($(V.item))}," Stok: "+c(Number(((ye=(ue=V.item)==null?void 0:ue.inventory)==null?void 0:ye.current_stock)||0).toLocaleString("id-ID"))+" "+c(V.unit),3)]),V.formatted_total_cost?(b(),se("div",fo,[e(S,{icon:"mdi-currency-usd",size:"14",class:"mr-1"}),a("span",po,c(V.formatted_total_cost),1)])):ae("",!0)])]}),_:2},1024),q<r.value.items.length-1?(b(),L(ze,{key:0,class:"mt-3"})):ae("",!0)]),_:2},1024))),128))]),_:1})):(b(),se("div",go,[e(S,{icon:"mdi-package-variant-closed",size:"48",color:"grey-lighten-1",class:"mb-2"}),h[24]||(h[24]=a("p",{class:"text-body-1 text-grey"}," Belum ada komposisi item untuk produk ini ",-1))]))]),_:1})]),_:1})]),_:1})]),_:1}),e($e,{class:"mt-4"},{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"outlined",color:"primary"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[e(S,{icon:"mdi-format-list-bulleted",size:"32",class:"mb-2"}),a("div",_o,c(r.value.totalItems||0),1),h[25]||(h[25]=a("div",{class:"text-body-2"},"Total Item",-1))]),_:1,__:[25]})]),_:1})]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"outlined",color:"warning"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>{var V;return[e(S,{icon:"mdi-alert",size:"32",class:"mb-2"}),a("div",ko,c(((V=r.value.items)==null?void 0:V.filter(q=>q.is_critical).length)||0),1),h[26]||(h[26]=a("div",{class:"text-body-2"},"Item Kritis",-1))]}),_:1,__:[26]})]),_:1})]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"outlined",color:"success"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[e(S,{icon:"mdi-currency-usd",size:"32",class:"mb-2"}),a("div",yo,c(Y(tt)(r.value.price||0)),1),h[27]||(h[27]=a("div",{class:"text-body-2"},"Harga Jual",-1))]),_:1,__:[27]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):ae("",!0),e(ze),e(Ke,{class:"pa-4"},{default:t(()=>[e(Le),e(K,{variant:"outlined",onClick:h[8]||(h[8]=V=>p.value=!1)},{default:t(()=>h[28]||(h[28]=[f(" Tutup ")])),_:1,__:[28]}),e(K,{color:"secondary",variant:"outlined","prepend-icon":"mdi-cog",onClick:h[9]||(h[9]=()=>{p.value=!1,N(r.value)})},{default:t(()=>h[29]||(h[29]=[f(" Kelola Komposisi ")])),_:1,__:[29]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),ho=Ne(bo,[["__scopeId","data-v-8f4d44b6"]]),xo={class:"d-flex align-center gap-2"},wo={class:"text-white"},Vo={class:"text-h6 mb-4 d-flex align-center gap-2"},Po={class:"text-h6 mb-4 d-flex align-center gap-2"},Co={class:"d-flex flex-column gap-2"},Io={key:0,class:"d-flex align-center gap-2"},So={class:"d-flex align-center gap-2 mb-2"},$o={class:"d-flex gap-2"},Do={class:"d-flex gap-2"},To={class:"d-flex align-center justify-space-between"},Uo={class:"d-flex align-center gap-2"},zo={class:"text-end"},Ao={class:"text-h6 font-weight-bold"},Mo={class:"text-caption"},Eo={class:"text-h6 mb-4 d-flex align-center gap-2"},Ho={class:"text-h6 mb-4 d-flex align-center gap-2"},Bo={class:"image-upload-container"},Fo={key:0,class:"mb-4"},Ko={class:"text-center mt-2"},Ro={class:"text-h6 mb-4 d-flex align-center gap-2"},qo={class:"text-h6 mb-4 d-flex align-center gap-2"},Oo={class:"d-flex align-center"},Lo={class:"text-subtitle-1"},No={class:"text-body-1"},jo={class:"d-flex align-center"},Wo={class:"text-subtitle-1"},Go=Re({__name:"ProductDialog",props:{modelValue:{type:Boolean},editMode:{type:Boolean},formData:{},categories:{},loading:{type:Boolean},errorMessage:{},successMessage:{},selectedImage:{},imagePreview:{},useDialogError:{type:Boolean}},emits:["update:modelValue","close","submit","image-change","remove-image","clear-error","clear-success","update-form"],setup(l,{emit:F}){var Q,v,u;const y=Ot(),{nameRules:d,categoryRules:z}=Lt(),{getProductHPPBreakdown:p}=oa(),P=H(!1),m=H(!1),r=async()=>{if(!(!_.editMode||!I.id))try{const n=await fetch(`/api/products/${I.id}/items`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(n.ok){const i=await n.json();m.value=i.success&&i.data&&i.data.length>0}}catch(n){console.error("Error checking HPP status:",n)}},s=async()=>{if(I.id)try{P.value=!0;const n=await p(I.id,"latest");n&&(I.cost=n.total_hpp,oe("update-form","cost",n.total_hpp))}catch(n){console.error("Error refreshing HPP:",n)}finally{P.value=!1}},G=()=>{console.log("Open items setup for product:",I.id)},_=l,N=me(()=>_.errorMessage),oe=F,T=H(),I=ht({..._.formData});Pe(()=>_.formData,n=>{Object.assign(I,n)},{deep:!0}),Pe(I,n=>{Object.keys(n).forEach(i=>{oe("update-form",i,n[i])})},{deep:!0}),Pe(()=>_.modelValue,n=>{n&&_.editMode&&r()});const re=ht({length:((Q=_.formData.dimensions)==null?void 0:Q.length)||null,width:((v=_.formData.dimensions)==null?void 0:v.width)||null,height:((u=_.formData.dimensions)==null?void 0:u.height)||null});Pe(re,n=>{const i=n.length!==null||n.width!==null||n.height!==null;I.dimensions=i?{length:n.length!==null?n.length:void 0,width:n.width!==null?n.width:void 0,height:n.height!==null?n.height:void 0}:{}},{deep:!0});const ge=[{title:"Draft",value:"draft"},{title:"Published",value:"published"},{title:"Archived",value:"archived"}],R=me(()=>{if(!I.price||!I.cost||I.cost<=0)return 0;const n=(I.price-I.cost)/I.cost*100;return Math.ceil(n)}),Z=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),g=n=>n<10?"error":n<25?"warning":n<50?"success":"info",k=n=>n<10?"tabler-trending-down":n<25?"tabler-trending-up":n<50?"tabler-trending-up-2":"tabler-trending-up-3",$=n=>!n||n===0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),X=n=>{if(!n||n.trim()===""||n==="Rp 0")return 0;const A=n.replace(/[^\d,.-]/g,"").replace(/\./g,"").replace(",",".");return parseFloat(A)||0},B=H(!1),h=n=>{const i=X(n);I.price=i},V=()=>{B.value=!0},q=()=>{B.value=!1},ue=async()=>{var i;const{valid:n}=await((i=T.value)==null?void 0:i.validate());n&&oe("submit",I)},ye=n=>{oe("image-change",n)},ve=()=>{oe("remove-image")};return(n,i)=>(b(),L(Oe,{"model-value":n.modelValue,"max-width":"900px",persistent:"",scrollable:"","onUpdate:modelValue":i[25]||(i[25]=A=>n.$emit("update:modelValue",A))},{default:t(()=>[e(de,{class:"product-dialog coffee-dialog"},{default:t(()=>[e(Ce,{class:"d-flex align-center justify-space-between coffee-header"},{default:t(()=>[a("div",xo,[e(S,{icon:n.editMode?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),a("span",wo,c(n.editMode?"Edit Produk":"Tambah Produk Baru"),1)]),e(K,{icon:"tabler-x",variant:"text",color:"white",onClick:i[0]||(i[0]=A=>n.$emit("close"))})]),_:1}),e(ze),e(fe,{class:"pa-6"},{default:t(()=>[e(Ct,{ref_key:"formRef",ref:T,onSubmit:Vt(ue,["prevent"])},{default:t(()=>[e($e,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[a("h6",Vo,[e(S,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),i[26]||(i[26]=f(" Informasi Dasar "))])]),_:1}),e(E,{cols:"12",md:"8"},{default:t(()=>[e(Ve,{modelValue:I.name,"onUpdate:modelValue":i[1]||(i[1]=A=>I.name=A),label:"Nama Produk",placeholder:"Masukkan nama produk",rules:Y(d),required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ve,{modelValue:I.sku,"onUpdate:modelValue":i[2]||(i[2]=A=>I.sku=A),label:"SKU",placeholder:"Auto generate jika kosong",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Ut,{modelValue:I.description,"onUpdate:modelValue":i[3]||(i[3]=A=>I.description=A),label:"Deskripsi Produk",placeholder:"Masukkan deskripsi produk",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Be,{"model-value":I.category_id,"onUpdate:modelValue":i[4]||(i[4]=A=>I.category_id=A),items:n.categories,"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Pilih kategori",rules:Y(z),required:"",variant:"outlined"},null,8,["model-value","items","rules"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Ve,{modelValue:I.brand,"onUpdate:modelValue":i[5]||(i[5]=A=>I.brand=A),label:"Brand/Merek",placeholder:"Masukkan brand produk",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Po,[e(S,{icon:"tabler-currency-dollar",size:"20",class:"coffee-icon"}),i[27]||(i[27]=f(" Harga & Biaya "))])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Ve,{"model-value":$(I.price),"onUpdate:modelValue":i[6]||(i[6]=A=>h(A)),label:"Harga Jual",placeholder:"Rp 0",required:"",variant:"outlined",onFocus:V,onBlur:q},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[a("div",Co,[e(Ve,{"model-value":$(I.cost),label:"Harga Pokok Penjualan (HPP)",placeholder:"Auto-calculated dari bahan baku",variant:"outlined",readonly:"","append-inner-icon":"mdi-calculator",hint:"HPP dihitung otomatis berdasarkan harga bahan baku","persistent-hint":""},null,8,["model-value"]),n.editMode?(b(),se("div",Io,[e(pe,{color:m.value?"success":"warning",size:"small",variant:"tonal"},{default:t(()=>[e(S,{icon:m.value?"tabler-calculator":"tabler-alert-circle",size:"14",class:"me-1"},null,8,["icon"]),f(" "+c(m.value?"Auto HPP Active":"Setup Required"),1)]),_:1},8,["color"]),m.value?(b(),L(K,{key:0,size:"small",variant:"outlined",color:"primary",onClick:s,loading:P.value},{default:t(()=>[e(S,{icon:"tabler-refresh",size:"14",class:"me-1"}),i[28]||(i[28]=f(" Update HPP "))]),_:1,__:[28]},8,["loading"])):(b(),L(Ee,{key:1},{activator:t(({props:A})=>[e(pe,he(A,{color:"warning",size:"small",variant:"tonal"}),{default:t(()=>[e(S,{icon:"tabler-alert-circle",size:"14",class:"me-1"}),i[29]||(i[29]=f(" Belum Ada Resep "))]),_:2,__:[29]},1040)]),default:t(()=>[i[30]||(i[30]=a("span",null,"Setup resep produk untuk menghitung HPP otomatis",-1))]),_:1,__:[30]}))])):ae("",!0)])]),_:1}),n.editMode?(b(),L(E,{key:0,cols:"12"},{default:t(()=>[m.value?(b(),L(He,{key:0,color:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[e(_t,null,{default:t(()=>[e(S,{icon:"tabler-info-circle",class:"me-2"}),i[31]||(i[31]=f(" HPP Otomatis Aktif "))]),_:1,__:[31]}),i[32]||(i[32]=a("div",{class:"mt-2"}," HPP produk ini dihitung otomatis berdasarkan item/bahan yang digunakan. Untuk mengubah HPP, silakan update harga item di menu Item Management. ",-1))]),_:1,__:[32]})):(b(),L(He,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[e(_t,null,{default:t(()=>[e(S,{icon:"tabler-alert-triangle",class:"me-2"}),i[33]||(i[33]=f(" HPP Manual "))]),_:1,__:[33]}),i[34]||(i[34]=a("div",{class:"mt-2"}," Produk ini menggunakan HPP manual. Untuk perhitungan otomatis, tambahkan item/bahan yang digunakan untuk produk ini. ",-1))]),_:1,__:[34]}))]),_:1})):ae("",!0),e(E,{cols:"12"},{default:t(()=>[m.value&&n.editMode?(b(),L(He,{key:0,color:"success",variant:"tonal",class:"mb-4"},{default:t(()=>[a("div",So,[e(S,{icon:"tabler-check-circle"}),i[35]||(i[35]=a("span",{class:"font-weight-medium"},"HPP Otomatis Aktif",-1))]),i[38]||(i[38]=a("div",{class:"text-body-2 mb-3"}," Produk ini sudah memiliki resep dan HPP dihitung otomatis berdasarkan harga bahan baku terkini. HPP akan update secara otomatis saat harga bahan baku berubah. ",-1)),a("div",$o,[e(K,{size:"small",color:"primary",variant:"outlined",onClick:G},{default:t(()=>[e(S,{icon:"tabler-edit",size:"14",class:"me-1"}),i[36]||(i[36]=f(" Edit Resep "))]),_:1,__:[36]}),e(K,{size:"small",variant:"outlined",color:"info",onClick:s,loading:P.value},{default:t(()=>[e(S,{icon:"tabler-refresh",size:"14",class:"me-1"}),i[37]||(i[37]=f(" Refresh HPP "))]),_:1,__:[37]},8,["loading"])])]),_:1,__:[38]})):!m.value&&n.editMode?(b(),L(He,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[a("div",Do,[e(K,{size:"small",variant:"outlined",color:"info",onClick:i[7]||(i[7]=A=>Y(y).push("/hpp-management"))},{default:t(()=>[e(S,{icon:"tabler-calculator",size:"14",class:"me-1"}),i[39]||(i[39]=f(" Lihat HPP Management "))]),_:1,__:[39]})])]),_:1})):ae("",!0)]),_:1}),e(E,{cols:"12"},{default:t(()=>[I.price&&I.cost&&I.cost>0?(b(),L(He,{key:0,color:g(R.value),variant:"tonal",class:"mb-0"},{default:t(()=>[a("div",To,[a("div",Uo,[e(S,{icon:k(R.value)},null,8,["icon"]),i[40]||(i[40]=a("span",{class:"font-weight-medium"},"Profit Margin",-1))]),a("div",zo,[a("div",Ao,c(Math.round(R.value))+"%",1),a("div",Mo," Keuntungan: "+c(Z(I.price-I.cost)),1)])])]),_:1},8,["color"])):ae("",!0)]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Eo,[e(S,{icon:"tabler-ruler",size:"20",class:"coffee-icon"}),i[41]||(i[41]=f(" Dimensi (cm) "))])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ve,{modelValue:re.length,"onUpdate:modelValue":i[8]||(i[8]=A=>re.length=A),modelModifiers:{number:!0},label:"Panjang",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ve,{modelValue:re.width,"onUpdate:modelValue":i[9]||(i[9]=A=>re.width=A),modelModifiers:{number:!0},label:"Lebar",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ve,{modelValue:re.height,"onUpdate:modelValue":i[10]||(i[10]=A=>re.height=A),modelModifiers:{number:!0},label:"Tinggi",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Ho,[e(S,{icon:"tabler-photo",size:"20",class:"coffee-icon"}),i[42]||(i[42]=f(" Gambar Produk "))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("div",Bo,[n.imagePreview?(b(),se("div",Fo,[e(Oa,{src:n.imagePreview,"max-width":"200","max-height":"200",class:"mx-auto rounded"},null,8,["src"]),a("div",Ko,[e(K,{size:"small",color:"error",variant:"outlined",onClick:ve},{default:t(()=>i[43]||(i[43]=[f(" Hapus Gambar ")])),_:1,__:[43]})])])):ae("",!0),e(La,{"model-value":n.selectedImage,"onUpdate:modelValue":i[11]||(i[11]=A=>ye(Array.isArray(A)?A:[A])),label:"Upload Gambar","prepend-icon":"tabler-camera",accept:"image/*",variant:"outlined"},null,8,["model-value"]),i[44]||(i[44]=a("div",{class:"text-caption text-medium-emphasis mt-1"}," Format: JPG, JPEG, PNG, GIF. Maksimal 2MB. ",-1))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Ro,[e(S,{icon:"tabler-settings",size:"20",class:"coffee-icon"}),i[45]||(i[45]=f(" Pengaturan "))])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Be,{"model-value":I.status,"onUpdate:modelValue":i[12]||(i[12]=A=>I.status=A),items:ge,label:"Status Publikasi",variant:"outlined"},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(rt,{"model-value":I.active,"onUpdate:modelValue":i[13]||(i[13]=A=>I.active=A??!1),label:"Produk Aktif",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(rt,{"model-value":I.featured,"onUpdate:modelValue":i[14]||(i[14]=A=>I.featured=A??!1),label:"Produk Unggulan",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",qo,[e(S,{icon:"tabler-seo",size:"20",class:"coffee-icon"}),i[46]||(i[46]=f(" SEO (Opsional) "))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Ve,{modelValue:I.meta_title,"onUpdate:modelValue":i[15]||(i[15]=A=>I.meta_title=A),label:"Meta Title",placeholder:"Judul untuk SEO",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Ut,{modelValue:I.meta_description,"onUpdate:modelValue":i[16]||(i[16]=A=>I.meta_description=A),label:"Meta Description",placeholder:"Deskripsi untuk SEO",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(vl,{"model-value":I.tags,"onUpdate:modelValue":i[17]||(i[17]=A=>I.tags=A),label:"Tags",placeholder:"Tambah tag dan tekan Enter",multiple:"",chips:"",variant:"outlined"},null,8,["model-value"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(ze),e(Ke,{class:"pa-6"},{default:t(()=>[e(Le),e(K,{variant:"outlined",class:"coffee-secondary",onClick:i[18]||(i[18]=A=>n.$emit("close"))},{default:t(()=>i[47]||(i[47]=[f(" Batal ")])),_:1,__:[47]}),e(K,{color:"primary",class:"coffee-primary",loading:n.loading,onClick:ue},{default:t(()=>[f(c(n.editMode?"Perbarui":"Simpan")+" Produk ",1)]),_:1},8,["loading"])]),_:1})]),_:1}),n.useDialogError?ae("",!0):(b(),L(at,{key:0,"model-value":!!N.value,"onUpdate:modelValue":i[20]||(i[20]=A=>!A&&n.$emit("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500"},{actions:t(()=>[e(K,{icon:"tabler-x",size:"small",variant:"text",onClick:i[19]||(i[19]=A=>n.$emit("clear-error"))})]),default:t(()=>[a("div",Oo,[e(S,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),a("div",null,[i[48]||(i[48]=a("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),a("div",Lo,c(N.value),1)])])]),_:1},8,["model-value"])),n.useDialogError?(b(),L(Oe,{key:1,"model-value":!!N.value,"onUpdate:modelValue":i[22]||(i[22]=A=>!A&&n.$emit("clear-error")),"max-width":"400",persistent:"",class:"error-dialog"},{default:t(()=>[e(de,null,{default:t(()=>[e(Ce,{class:"d-flex align-center text-error"},{default:t(()=>[e(S,{icon:"tabler-alert-circle",class:"me-2"}),i[49]||(i[49]=f(" Error Occurred "))]),_:1,__:[49]}),e(ze),e(fe,{class:"py-4"},{default:t(()=>[a("div",No,c(N.value),1)]),_:1}),e(ze),e(Ke,{class:"justify-end pa-4"},{default:t(()=>[e(K,{color:"error",variant:"outlined",onClick:i[21]||(i[21]=A=>n.$emit("clear-error"))},{default:t(()=>i[50]||(i[50]=[f(" Close ")])),_:1,__:[50]})]),_:1})]),_:1})]),_:1},8,["model-value"])):ae("",!0),e(at,{"model-value":!!n.successMessage,"onUpdate:modelValue":i[24]||(i[24]=A=>!A&&n.$emit("clear-success")),color:"success",location:"top right",timeout:4e3,vertical:"","min-width":"320","max-width":"500"},{actions:t(()=>[e(K,{icon:"tabler-x",size:"small",variant:"text",onClick:i[23]||(i[23]=A=>n.$emit("clear-success"))})]),default:t(()=>[a("div",jo,[e(S,{icon:"tabler-check-circle",class:"me-3",size:"28"}),a("div",null,[i[51]||(i[51]=a("div",{class:"text-h6 font-weight-bold"},"Berhasil!",-1)),a("div",Wo,c(n.successMessage),1)])])]),_:1},8,["model-value"])]),_:1},8,["model-value"]))}}),Xo=Ne(Go,[["__scopeId","data-v-66fc4b3b"]]),Jo={key:0,class:"mt-4"},Yo={class:"d-flex align-center gap-2 mb-2"},Qo={class:"d-flex flex-wrap gap-2"},Zo=Re({__name:"ProductSearchFilters",props:{filters:{}},emits:["update:filters","search"],setup(l,{emit:F}){const y=l,d=F,{categories:z,loading:p,fetchCategories:P}=Na(),m=H(!1),r=H("");ut(()=>{P(),r.value=s.search||""});const s=ht({...y.filters});Pe(()=>y.filters,Z=>{Object.assign(s,Z),r.value=Z.search||""},{deep:!0}),Ca(r,Z=>{console.log("ðŸ” Search query changed:",Z),s.search=Z,Z.length>=3||Z.length===0?(console.log("âœ… Triggering search with query:",Z),m.value=!0,d("search",Z),T(),setTimeout(()=>{m.value=!1},500)):console.log("â³ Query too short, waiting for more characters:",Z.length)},{debounce:500,maxWait:1e3});const G=[{title:"Aktif",value:"active"},{title:"Tidak Aktif",value:"inactive"}],_=[{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],N=[{title:"Terbaru",value:"desc"},{title:"Terlama",value:"asc"}],oe=me(()=>!!(r.value||s.category_id||s.active||s.stock_status||s.featured!==null||s.min_price||s.max_price)),T=()=>{d("update:filters",{...s})},I=()=>{r.value="",Object.assign(s,{search:"",category_id:null,active:null,stock_status:null,featured:null,min_price:null,max_price:null,sort_by:"created_at",sort_order:"desc"}),T()},re=Z=>{const g=z.value.find(k=>k.id_category===Z);return(g==null?void 0:g.name)||"Unknown"},ge=Z=>{if(!Z)return"Semua";const g=G.find(k=>k.value===Z);return(g==null?void 0:g.title)||String(Z)},R=Z=>{const g=_.find(k=>k.value===Z);return(g==null?void 0:g.title)||Z};return(Z,g)=>(b(),L(de,{class:"mb-6"},{default:t(()=>[e(Ce,{class:"d-flex align-center gap-2"},{default:t(()=>[e(S,{icon:"tabler-filter",class:"coffee-icon"}),g[11]||(g[11]=f(" Filter & Pencarian Produk "))]),_:1,__:[11]}),e(fe,null,{default:t(()=>[e($e,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(Ve,{modelValue:r.value,"onUpdate:modelValue":g[0]||(g[0]=k=>r.value=k),label:"Cari produk...",placeholder:"Nama, SKU, atau deskripsi (min. 3 karakter)","prepend-inner-icon":"tabler-search",loading:m.value,clearable:"",variant:"outlined",hint:r.value.length>0&&r.value.length<3?`Ketik ${3-r.value.length} karakter lagi untuk mencari`:"","persistent-hint":""},null,8,["modelValue","loading","hint"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Be,{modelValue:s.category_id,"onUpdate:modelValue":[g[1]||(g[1]=k=>s.category_id=k),T],items:Y(z),"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Semua kategori","prepend-inner-icon":"tabler-category",loading:Y(p),clearable:"",variant:"outlined"},null,8,["modelValue","items","loading"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Be,{modelValue:s.active,"onUpdate:modelValue":[g[2]||(g[2]=k=>s.active=k),T],items:G,label:"Status",placeholder:"Semua status","prepend-inner-icon":"tabler-toggle-left",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Be,{modelValue:s.stock_status,"onUpdate:modelValue":[g[3]||(g[3]=k=>s.stock_status=k),T],items:_,label:"Stok",placeholder:"Semua stok","prepend-inner-icon":"tabler-package",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"1",class:"d-flex align-center"},{default:t(()=>[e(K,{icon:"tabler-refresh",variant:"outlined",color:"coffee",onClick:I})]),_:1})]),_:1}),e($e,{class:"mt-3"},{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ve,{modelValue:s.min_price,"onUpdate:modelValue":g[4]||(g[4]=k=>s.min_price=k),label:"Harga Minimum",placeholder:"0","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:T},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ve,{modelValue:s.max_price,"onUpdate:modelValue":g[5]||(g[5]=k=>s.max_price=k),label:"Harga Maksimum",placeholder:"Tidak terbatas","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:T},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Be,{modelValue:s.sort_order,"onUpdate:modelValue":[g[6]||(g[6]=k=>s.sort_order=k),T],items:N,label:"Urutan",placeholder:"Terbaru","prepend-inner-icon":"tabler-arrow-up",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),oe.value?(b(),se("div",Jo,[a("div",Yo,[e(S,{icon:"tabler-filter-check",size:"small",class:"coffee-icon"}),g[12]||(g[12]=a("span",{class:"text-sm font-weight-medium"},"Filter Aktif:",-1))]),a("div",Qo,[r.value?(b(),L(pe,{key:0,closable:"",size:"small",color:"coffee","onClick:close":g[7]||(g[7]=k=>{r.value="",s.search="",T()})},{default:t(()=>[f(" Pencarian: "+c(r.value),1)]),_:1})):ae("",!0),s.category_id?(b(),L(pe,{key:1,closable:"",size:"small",color:"coffee","onClick:close":g[8]||(g[8]=k=>{s.category_id=null,T()})},{default:t(()=>[f(" Kategori: "+c(re(s.category_id)),1)]),_:1})):ae("",!0),s.active?(b(),L(pe,{key:2,closable:"",size:"small",color:"coffee","onClick:close":g[9]||(g[9]=k=>{s.active=null,T()})},{default:t(()=>[f(" Status: "+c(ge(s.active)),1)]),_:1})):ae("",!0),s.stock_status?(b(),L(pe,{key:3,closable:"",size:"small",color:"coffee","onClick:close":g[10]||(g[10]=k=>{s.stock_status=null,T()})},{default:t(()=>[f(" Stok: "+c(R(s.stock_status)),1)]),_:1})):ae("",!0)])])):ae("",!0)]),_:1})]),_:1}))}}),es=Ne(Zo,[["__scopeId","data-v-1afc3ae3"]]),ts={class:"d-flex align-center gap-2"},as={class:"text-h6"},ls={class:"d-flex align-center gap-2"},os={class:"text-h6"},ss={class:"d-flex align-center gap-2"},ns={class:"text-h6"},is={class:"d-flex align-center gap-2"},rs={class:"text-h6"},us={class:"d-flex align-center gap-2"},ds={class:"text-h6"},cs={class:"d-flex align-center gap-2"},ms={class:"text-h6"},vs={class:"d-flex align-center gap-2"},fs={class:"text-h6"},ps={class:"d-flex align-center gap-2"},gs={class:"text-h6"},_s=Re({__name:"ProductStatsCards",props:{stats:{}},setup(l){const F=d=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(d),y=d=>`${d.toFixed(1)}%`;return(d,z)=>(b(),L($e,{class:"mb-6"},{default:t(()=>[e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Se,{size:"44",rounded:"",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-package"})]),_:1}),a("div",null,[z[0]||(z[0]=a("span",{class:"text-sm text-medium-emphasis"},"Total Produk",-1)),a("div",ts,[a("h6",as,c(((p=d.stats)==null?void 0:p.total_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Se,{size:"44",rounded:"",color:"success",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-check"})]),_:1}),a("div",null,[z[1]||(z[1]=a("span",{class:"text-sm text-medium-emphasis"},"Produk Aktif",-1)),a("div",ls,[a("h6",os,c(((p=d.stats)==null?void 0:p.active_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Se,{size:"44",rounded:"",color:"warning",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-star"})]),_:1}),a("div",null,[z[2]||(z[2]=a("span",{class:"text-sm text-medium-emphasis"},"Produk Unggulan",-1)),a("div",ss,[a("h6",ns,c(((p=d.stats)==null?void 0:p.featured_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Se,{size:"44",rounded:"",color:"error",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-alert-triangle"})]),_:1}),a("div",null,[z[3]||(z[3]=a("span",{class:"text-sm text-medium-emphasis"},"Stok Rendah",-1)),a("div",is,[a("h6",rs,c(((p=d.stats)==null?void 0:p.low_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Se,{size:"44",rounded:"",color:"info",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-currency-dollar"})]),_:1}),a("div",null,[z[4]||(z[4]=a("span",{class:"text-sm text-medium-emphasis"},"Nilai Stok",-1)),a("div",us,[a("h6",ds,c(F(((p=d.stats)==null?void 0:p.total_stock_value)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Se,{size:"44",rounded:"",color:"secondary",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-chart-line"})]),_:1}),a("div",null,[z[5]||(z[5]=a("span",{class:"text-sm text-medium-emphasis"},"Harga Rata-rata",-1)),a("div",cs,[a("h6",ms,c(F(((p=d.stats)==null?void 0:p.average_price)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Se,{size:"44",rounded:"",color:"coffee",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-trending-up"})]),_:1}),a("div",null,[z[6]||(z[6]=a("span",{class:"text-sm text-medium-emphasis"},"Margin Rata-rata",-1)),a("div",vs,[a("h6",fs,c(y(((p=d.stats)==null?void 0:p.average_margin)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Se,{size:"44",rounded:"",color:"surface",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-x-circle"})]),_:1}),a("div",null,[z[7]||(z[7]=a("span",{class:"text-sm text-medium-emphasis"},"Stok Habis",-1)),a("div",ps,[a("h6",gs,c(((p=d.stats)==null?void 0:p.out_of_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1})]),_:1}))}}),ks=Ne(_s,[["__scopeId","data-v-124783ae"]]),ys={class:"d-flex align-center gap-2"},bs={class:"d-flex align-center gap-2"},hs={class:"text-center py-8"},xs={class:"d-flex align-center gap-3 py-2"},ws={class:"font-weight-medium"},Vs={class:"text-caption text-medium-emphasis"},Ps={class:"text-end"},Cs={class:"font-weight-medium"},Is={key:0,class:"text-caption text-medium-emphasis"},Ss={class:"text-center profit-margin-container"},$s={class:"text-center"},Ds={key:0,class:"text-caption text-medium-emphasis mt-1"},Ts={class:"d-flex align-center gap-2"},Us={class:"text-body-2"},zs={class:"text-caption text-medium-emphasis"},As={class:"d-flex align-center gap-1"},Ms=Re({__name:"ProductTable",props:{products:{},totalItems:{},loading:{type:Boolean},currentPage:{},itemsPerPage:{},selectedProducts:{},toggleLoading:{}},emits:["add-product","view-product","edit-product","manage-recipes","open-recipe-dialog","open-composition-dialog","open-variant-dialog","delete-product","toggle-active","toggle-featured","bulk-delete","update:page","update:items-per-page","update:sort-by","update:selected-products"],setup(l){const F=[{title:"Produk",key:"name",sortable:!0,width:"250px"},{title:"Kategori",key:"category",sortable:!1,width:"120px"},{title:"Harga",key:"price",sortable:!0,align:"end",width:"130px"},{title:"Margin",key:"profit_margin",sortable:!0,align:"center",width:"100px"},{title:"Stok",key:"stock",sortable:!0,align:"center",width:"100px"},{title:"Status",key:"active",sortable:!0,width:"140px"},{title:"Dibuat",key:"created_at",sortable:!0,width:"120px"},{title:"Aksi",key:"actions",sortable:!1,align:"center",width:"200px"}],y=m=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(m),d=m=>new Date(m).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),z=m=>new Date(m).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),p=(m,r)=>m<=0?"error":r&&m<=r?"warning":"success",P=m=>m<10?"error":m<25?"warning":m<50?"success":"info";return(m,r)=>(b(),L(de,null,{default:t(()=>[e(Ce,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",ys,[e(S,{icon:"tabler-list",class:"coffee-icon"}),r[7]||(r[7]=f(" Data Produk ")),m.totalItems?(b(),L(pe,{key:0,size:"small",color:"coffee",variant:"tonal"},{default:t(()=>[f(c(m.totalItems)+" item ",1)]),_:1})):ae("",!0)]),a("div",bs,[m.selectedProducts.length>0?(b(),L(K,{key:0,"prepend-icon":"tabler-trash",color:"error",variant:"outlined",onClick:r[0]||(r[0]=s=>m.$emit("bulk-delete"))},{default:t(()=>[f(" Hapus Terpilih ("+c(m.selectedProducts.length)+") ",1)]),_:1})):ae("",!0),e(K,{"prepend-icon":"tabler-plus",color:"coffee",onClick:r[1]||(r[1]=s=>m.$emit("add-product"))},{default:t(()=>r[8]||(r[8]=[f(" Tambah Produk ")])),_:1,__:[8]})])]),_:1}),e(ze),e(Za,{"model-value":m.selectedProducts,"onUpdate:modelValue":r[3]||(r[3]=s=>m.$emit("update:selected-products",s)),headers:F,items:m.products,"items-length":m.totalItems,loading:m.loading,"items-per-page":m.itemsPerPage,page:m.currentPage,"show-select":"","item-value":"id",class:"products-table","onUpdate:page":r[4]||(r[4]=s=>m.$emit("update:page",s)),"onUpdate:itemsPerPage":r[5]||(r[5]=s=>m.$emit("update:items-per-page",s)),"onUpdate:sortBy":r[6]||(r[6]=s=>m.$emit("update:sort-by",s))},{loading:t(()=>[e(el,{type:"table-row@10"})]),"no-data":t(()=>[a("div",hs,[e(S,{icon:"tabler-package-off",size:"64",class:"mb-4 text-disabled"}),r[10]||(r[10]=a("h6",{class:"text-h6 mb-2"}," Tidak ada produk ",-1)),r[11]||(r[11]=a("p",{class:"text-body-2 text-medium-emphasis mb-4"}," Belum ada produk yang ditambahkan atau sesuai dengan filter yang dipilih. ",-1)),e(K,{"prepend-icon":"tabler-plus",color:"coffee",onClick:r[2]||(r[2]=s=>m.$emit("add-product"))},{default:t(()=>r[9]||(r[9]=[f(" Tambah Produk Pertama ")])),_:1,__:[9]})])]),"item.name":t(({item:s})=>[a("div",xs,[e(Se,{image:s.image_url,size:"40",rounded:"",class:"product-avatar"},{default:t(()=>[s.image_url?ae("",!0):(b(),L(S,{key:0,icon:"tabler-package"}))]),_:2},1032,["image"]),a("div",null,[a("div",ws,c(s.name),1),a("div",Vs," SKU: "+c(s.sku||"-"),1)])])]),"item.category":t(({item:s})=>[e(pe,{color:"coffee",size:"small",variant:"tonal"},{default:t(()=>{var G;return[f(c(((G=s.category)==null?void 0:G.name)||"-"),1)]}),_:2},1024)]),"item.price":t(({item:s})=>[a("div",Ps,[a("div",Cs,c(y(s.price)),1),s.cost?(b(),se("div",Is," HPP: "+c(y(s.cost)),1)):ae("",!0)])]),"item.profit_margin":t(({item:s})=>[a("div",Ss,[s.cost&&s.cost>0&&s.profit_margin!==void 0?(b(),L(pe,{key:0,color:P(s.profit_margin),size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>[f(c(Math.round(s.profit_margin))+"% ",1)]),_:2},1032,["color"])):(b(),L(pe,{key:1,color:"grey",size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>r[12]||(r[12]=[f(" - ")])),_:1,__:[12]}))])]),"item.stock":t(({item:s})=>[a("div",$s,[e(pe,{color:p(s.stock,s.min_stock),size:"small",variant:"tonal"},{default:t(()=>[f(c(s.stock)+" "+c(s.unit||"pcs"),1)]),_:2},1032,["color"]),s.min_stock?(b(),se("div",Ds," Min: "+c(s.min_stock),1)):ae("",!0)])]),"item.active":t(({item:s})=>[a("div",Ts,[e(pe,{color:s.active?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[f(c(s.active?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["color"]),s.featured?(b(),L(Ee,{key:0,text:"Produk Unggulan"},{activator:t(({props:G})=>[e(S,he(G,{icon:"tabler-star-filled",color:"warning",size:"small"}),null,16)]),_:1})):ae("",!0)])]),"item.created_at":t(({item:s})=>[a("div",Us,c(d(s.created_at??"")),1),a("div",zs,c(z((s==null?void 0:s.created_at)??"")),1)]),"item.actions":t(({item:s})=>[a("div",As,[e(Ee,{text:"Kelola Komposisi"},{activator:t(({props:G})=>[e(K,he(G,{icon:"tabler-chef-hat",size:"small",variant:"text",color:"primary",onClick:_=>m.$emit("open-composition-dialog",s)}),null,16,["onClick"])]),_:2},1024),e(Ee,{text:"Kelola Variant"},{activator:t(({props:G})=>[e(K,he(G,{icon:"tabler-versions",size:"small",variant:"text",color:"secondary",onClick:_=>m.$emit("open-variant-dialog",s)}),null,16,["onClick"])]),_:2},1024),e(Ee,{text:"Edit Produk"},{activator:t(({props:G})=>[e(K,he(G,{icon:"tabler-edit",size:"small",variant:"text",color:"coffee",onClick:_=>m.$emit("edit-product",s)}),null,16,["onClick"])]),_:2},1024),e(Ee,{text:s.active?"Nonaktifkan":"Aktifkan"},{activator:t(({props:G})=>{var _;return[e(K,he(G,{icon:s.active?"tabler-toggle-right":"tabler-toggle-left",size:"small",variant:"text",color:s.active?"success":"error",loading:((_=m.toggleLoading)==null?void 0:_[s.id_product])||!1,onClick:N=>m.$emit("toggle-active",s)}),null,16,["icon","color","loading","onClick"])]}),_:2},1032,["text"]),e(Ee,{text:s.featured?"Hapus dari Unggulan":"Jadikan Unggulan"},{activator:t(({props:G})=>[e(K,he(G,{icon:s.featured?"tabler-star-filled":"tabler-star",size:"small",variant:"text",color:s.featured?"warning":"default",onClick:_=>m.$emit("toggle-featured",s)}),null,16,["icon","color","onClick"])]),_:2},1032,["text"]),e(Ee,{text:"Hapus Produk"},{activator:t(({props:G})=>[e(K,he(G,{icon:"tabler-trash",size:"small",variant:"text",color:"error",onClick:_=>m.$emit("delete-product",s)}),null,16,["onClick"])]),_:2},1024)])]),_:1},8,["model-value","items","items-length","loading","items-per-page","page"])]),_:1}))}}),Es=Ne(Ms,[["__scopeId","data-v-bbf8f372"]]),Hs={class:"d-flex align-center gap-3"},Bs={class:"text-h5 font-weight-bold"},Fs={class:"text-h6"},Ks={class:"text-body-1"},Rs={class:"d-flex flex-column"},qs={class:"font-weight-medium"},Os={class:"text-caption text-grey-darken-1"},Ls={class:"font-weight-medium"},Ns={key:0,class:"text-caption"},js={key:1,class:"text-grey-lighten-1 text-caption"},Ws={class:"v-data-table__footer"},Gs={class:"pa-4 d-flex justify-space-between align-center"},Xs={class:"text-subtitle-1 font-weight-bold"},Js={class:"text-subtitle-2 text-uppercase"},Ys={class:"text-h6 font-weight-bold my-2"},Qs={class:"text-caption"},Qt=Re({__name:"HPPVariantBreakdownDialog",props:{modelValue:{type:Boolean},variantId:{},variantName:{default:""}},emits:["update:modelValue","hpp-updated","price-updated"],setup(l,{emit:F}){const y=l,d=F,z=H(!1),p=H(null),P=H(null),m=H(!1),r=H(!1),s=H("latest"),G=H(0),_=H(0),N=H(""),oe=H(0),T=H(!1),I=H(!1),re=H(""),ge=H(""),R=[{title:"Current Cost",value:"current"},{title:"Latest Purchase",value:"latest"},{title:"Average Purchase",value:"average"}],Z=[{title:"Item",value:"item_name",sortable:!0},{title:"Quantity",value:"quantity_needed",align:"end"},{title:"Cost/Unit",value:"cost_per_unit",align:"end"},{title:"Total Cost",value:"total_cost",align:"end"},{title:"Priority",value:"is_critical",align:"center"},{title:"Notes",value:"notes"}],g=Q=>!Q||Q===0?"":new Intl.NumberFormat("id-ID").format(Q),k=Q=>{if(!Q)return 0;const v=Q.replace(/[^\d]/g,"");return parseInt(v)||0},$=Q=>{var u;const v=k(Q);if(_.value=v,N.value=g(v),(u=p.value)!=null&&u.total_hpp&&v>0){const n=p.value.total_hpp;G.value=n>0?Math.round((v-n)/n*100):0}else G.value=0},X=Q=>tt(Q),B=async(Q,v)=>{z.value=!0;try{await new Promise(u=>setTimeout(u,500)),p.value={total_hpp:15e4,method:v,calculated_at:new Date().toISOString(),items:[{item_name:"Tepung Terigu",item_code:"TPNG001",quantity_needed:.5,unit:"kg",cost_per_unit:15e3,total_cost:7500,is_critical:!1,notes:null},{item_name:"Gula Pasir",item_code:"GUL001",quantity_needed:.25,unit:"kg",cost_per_unit:12e3,total_cost:3e3,is_critical:!1,notes:null},{item_name:"Telur Ayam",item_code:"TLR001",quantity_needed:3,unit:"pcs",cost_per_unit:3e3,total_cost:9e3,is_critical:!0,notes:"Price volatile"}]},m.value=!0}catch(u){console.error("Error loading HPP breakdown:",u),m.value=!1}finally{z.value=!1}},h=async(Q,v)=>{z.value=!0;try{if(await new Promise(u=>setTimeout(u,1e3)),p.value){switch(v){case"latest":p.value.total_hpp=Math.round(p.value.total_hpp*1.1);break;case"average":p.value.total_hpp=Math.round(p.value.total_hpp*1.05);break;default:p.value.total_hpp=Math.round(p.value.total_hpp*1.03)}p.value.calculated_at=new Date().toISOString()}}catch(u){throw u}finally{z.value=!1}},V=async(Q,v,u,n,i)=>{z.value=!0;try{return await new Promise(A=>setTimeout(A,1e3)),{data:{new_price:u,markup_percentage:p.value?Math.round((u-p.value.total_hpp)/p.value.total_hpp*100):0}}}catch(A){throw A}finally{z.value=!1}},q=async()=>{var Q,v,u;if(y.variantId)try{const n=localStorage.getItem("token"),i=await qe.get(`/api/variants/${y.variantId}`,{headers:{Authorization:`Bearer ${n}`,Accept:"application/json"}});if(i.data.success&&i.data.data){const A=i.data.data;if(A.price&&A.price>0)_.value=Number(A.price),N.value=g(Number(A.price));else if((Q=p.value)!=null&&Q.total_hpp){const M=Math.round(p.value.total_hpp*1.2);_.value=M,N.value=g(M)}if((v=p.value)!=null&&v.total_hpp&&_.value>0){const M=p.value.total_hpp;G.value=M>0?Math.round((_.value-M)/M*100):0}oe.value+=1}}catch(n){console.warn("Could not load target price, using default:",n),(u=p.value)!=null&&u.total_hpp&&(_.value=Math.round(p.value.total_hpp*1.2))}},ue=async()=>{y.variantId&&(await B(y.variantId,s.value),await q())},ye=async()=>{var Q,v;if(y.variantId)try{await h(y.variantId,s.value),re.value=`HPP successfully updated using ${s.value} method!`,T.value=!0,d("hpp-updated"),await ue()}catch(u){console.error("Error updating HPP:",u),ge.value=((v=(Q=u==null?void 0:u.response)==null?void 0:Q.data)==null?void 0:v.message)||"Failed to update HPP",I.value=!0}},ve=async()=>{var Q,v,u,n,i,A;if(y.variantId&&((Q=p.value)!=null&&Q.total_hpp)&&_.value)try{const M=await V(y.variantId,s.value,_.value,!0,!0);if((v=M==null?void 0:M.data)!=null&&v.new_price){if(_.value=M.data.new_price,N.value=g(M.data.new_price),((u=M==null?void 0:M.data)==null?void 0:u.markup_percentage)!==void 0)G.value=M.data.markup_percentage;else{const C=p.value.total_hpp;G.value=C>0?Math.round((M.data.new_price-C)/C*100):0}oe.value+=1,await pt()}await ue(),re.value=`Price successfully updated to ${X(((n=M==null?void 0:M.data)==null?void 0:n.new_price)||_.value)}!`,T.value=!0,d("price-updated")}catch(M){console.error("Error applying price suggestion:",M),ge.value=((A=(i=M==null?void 0:M.response)==null?void 0:i.data)==null?void 0:A.message)||"Failed to update variant price",I.value=!0}};return Pe(()=>y.modelValue,Q=>{Q&&y.variantId&&ue()}),Pe(()=>y.variantId,Q=>{Q&&y.modelValue&&ue()}),Pe(s,async()=>{y.variantId&&await ue()}),Pe([()=>{var Q;return(Q=p.value)==null?void 0:Q.total_hpp},_],()=>{var Q;if((Q=p.value)!=null&&Q.total_hpp&&_.value>0){const v=p.value.total_hpp;G.value=v>0?Math.round((_.value-v)/v*100):0}else G.value=0}),Pe(_,Q=>{Q!==k(N.value)&&(N.value=g(Q))}),(Q,v)=>(b(),se(Te,null,[e(Oe,{"model-value":Q.modelValue,"max-width":"1200",scrollable:"","onUpdate:modelValue":v[6]||(v[6]=u=>Q.$emit("update:modelValue",u))},{default:t(()=>[e(de,null,{default:t(()=>[e(Ce,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",Hs,[e(S,{icon:"mdi-calculator-variant",size:"24"}),a("span",null,"HPP Breakdown - "+c(Q.variantName||"Variant"),1)]),e(K,{icon:"mdi-close",size:"small",variant:"text",onClick:v[0]||(v[0]=u=>Q.$emit("update:modelValue",!1))})]),_:1}),e(fe,null,{default:t(()=>[e($e,{class:"mb-4"},{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>[e(Be,{modelValue:s.value,"onUpdate:modelValue":[v[1]||(v[1]=u=>s.value=u),ue],items:R,label:"HPP Calculation Method",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(K,{color:"primary",variant:"elevated",loading:z.value,"prepend-icon":"mdi-update",block:"",onClick:ye},{default:t(()=>[f(" Update HPP with "+c(s.value),1)]),_:1},8,["loading"])]),_:1})]),_:1}),m.value?(b(),L(de,{key:0,variant:"tonal",color:"primary",class:"mb-4"},{default:t(()=>[e(fe,null,{default:t(()=>[e($e,{align:"center"},{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>{var u;return[v[11]||(v[11]=a("div",{class:"text-subtitle-2"}," Total HPP ",-1)),a("div",Bs,c(X(((u=p.value)==null?void 0:u.total_hpp)||0)),1)]}),_:1,__:[11]}),e(E,{cols:"12",md:"4"},{default:t(()=>{var u;return[v[12]||(v[12]=a("div",{class:"text-subtitle-2"}," Calculation Method ",-1)),a("div",Fs,c((u=R.find(n=>{var i;return n.value===((i=p.value)==null?void 0:i.method)}))==null?void 0:u.title),1)]}),_:1,__:[12]}),e(E,{cols:"12",md:"4"},{default:t(()=>{var u;return[v[13]||(v[13]=a("div",{class:"text-subtitle-2"}," Last Calculated ",-1)),a("div",Ks,c((u=p.value)!=null&&u.calculated_at?new Date(p.value.calculated_at).toLocaleString():"-"),1)]}),_:1,__:[13]})]),_:1})]),_:1})]),_:1})):ae("",!0),m.value?(b(),L(de,{key:1},{default:t(()=>{var u;return[e(Ce,null,{default:t(()=>{var n,i;return[e(S,{icon:"mdi-format-list-bulleted",class:"me-2"}),f(" Item Breakdown ("+c(((i=(n=p.value)==null?void 0:n.items)==null?void 0:i.length)||0)+" items) ",1)]}),_:1}),e(tl,{headers:Z,items:((u=p.value)==null?void 0:u.items)||[],"items-per-page":10,class:"elevation-0"},{"item.item_name":t(({item:n})=>[a("div",Rs,[a("span",qs,c(n.item_name),1),a("span",Os,c(n.item_code),1)])]),"item.quantity_needed":t(({item:n})=>[a("span",Ls,c(n.quantity_needed)+" "+c(n.unit),1)]),"item.cost_per_unit":t(({item:n})=>[a("span",null,c(X(n.cost_per_unit)),1)]),"item.total_cost":t(({item:n})=>[e(pe,{color:n.is_critical?"error":"primary",variant:"elevated",size:"small"},{default:t(()=>[f(c(X(n.total_cost)),1)]),_:2},1032,["color"])]),"item.is_critical":t(({item:n})=>[e(pe,{color:n.is_critical?"error":"success","prepend-icon":n.is_critical?"mdi-alert":"mdi-check",variant:"tonal",size:"small"},{default:t(()=>[f(c(n.is_critical?"Critical":"Normal"),1)]),_:2},1032,["color","prepend-icon"])]),"item.notes":t(({item:n})=>[n.notes?(b(),se("span",Ns,c(n.notes),1)):(b(),se("span",js,"â€”"))]),bottom:t(()=>{var n;return[a("div",Ws,[e(ze),a("div",Gs,[a("div",Xs," Total HPP: "+c(X(((n=p.value)==null?void 0:n.total_hpp)||0)),1),e(pe,{color:"info",variant:"elevated"},{default:t(()=>{var i,A;return[f(c(((A=(i=p.value)==null?void 0:i.items)==null?void 0:A.length)||0)+" items ",1)]}),_:1})])])]}),_:1},8,["items"])]}),_:1})):ae("",!0),m.value?(b(),L(de,{key:2,class:"mt-4"},{default:t(()=>[e(Ce,null,{default:t(()=>[e(S,{icon:"mdi-cash-multiple",class:"me-2"}),v[14]||(v[14]=f(" Price Suggestion "))]),_:1,__:[14]}),e(fe,null,{default:t(()=>[e($e,null,{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>{var u;return[(b(),L(Ve,{key:oe.value,modelValue:N.value,"onUpdate:modelValue":[v[2]||(v[2]=n=>N.value=n),$],label:"Target Selling Price",variant:"outlined",prefix:"Rp",hint:`Current HPP: ${X(((u=p.value)==null?void 0:u.total_hpp)||0)}`,"persistent-hint":""},null,8,["modelValue","hint"]))]}),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>{var u;return[(b(),L(Ve,{key:oe.value,modelValue:G.value,"onUpdate:modelValue":v[3]||(v[3]=n=>G.value=n),label:"Markup Percentage",variant:"outlined",type:"number",min:"0",step:"5",suffix:"%",readonly:"",hint:`Profit: ${X(_.value-(((u=p.value)==null?void 0:u.total_hpp)||0))}`,"persistent-hint":""},null,8,["modelValue","hint"]))]}),_:1})]),_:1}),e($e,{class:"mt-2"},{default:t(()=>[e(E,{cols:"12",md:"12"},{default:t(()=>[e(K,{color:"success",variant:"elevated","prepend-icon":"mdi-check-circle",loading:z.value,disabled:!_.value||_.value<=0,block:"",onClick:ve},{default:t(()=>v[15]||(v[15]=[f(" Apply Price ")])),_:1,__:[15]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})):ae("",!0),r.value?(b(),L(de,{key:3,variant:"tonal",color:"success",class:"mt-4"},{default:t(()=>[e(Ce,null,{default:t(()=>[e(S,{icon:"mdi-lightbulb",class:"me-2"}),v[16]||(v[16]=f(" Price Suggestions "))]),_:1,__:[16]}),e(fe,null,{default:t(()=>[e($e,null,{default:t(()=>[(b(!0),se(Te,null,Ge(P.value.suggestions,(u,n)=>(b(),L(E,{key:n,cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"elevated"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[a("div",Js,c(n)+" Method ",1),a("div",Ys,c(X(u.suggested_price)),1),a("div",Qs,[f(" HPP: "+c(X(u.hpp)),1),v[17]||(v[17]=a("br",null,null,-1)),f(" Markup: "+c(u.markup_percentage.toFixed(1))+"%",1),v[18]||(v[18]=a("br",null,null,-1)),f(" Margin: "+c(u.profit_margin.toFixed(1))+"% ",1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):ae("",!0),!m.value&&!z.value?(b(),L(de,{key:4,variant:"outlined"},{default:t(()=>[e(fe,{class:"text-center py-8"},{default:t(()=>[e(S,{icon:"mdi-calculator-variant-outline",size:"64",color:"grey",class:"mb-4"}),v[20]||(v[20]=a("div",{class:"text-h6 mb-2"}," No HPP Data Available ",-1)),v[21]||(v[21]=a("div",{class:"text-body-2 text-medium-emphasis mb-4"}," Add composition items first, then calculate HPP using the method above. ",-1)),e(K,{color:"primary","prepend-icon":"mdi-plus",onClick:v[4]||(v[4]=u=>Q.$emit("update:modelValue",!1))},{default:t(()=>v[19]||(v[19]=[f(" Add Composition Items ")])),_:1,__:[19]})]),_:1,__:[20,21]})]),_:1})):ae("",!0)]),_:1}),e(Ke,{class:"pa-4"},{default:t(()=>[e(Le),e(K,{variant:"outlined",color:"grey","prepend-icon":"mdi-close",onClick:v[5]||(v[5]=u=>Q.$emit("update:modelValue",!1))},{default:t(()=>v[22]||(v[22]=[f(" Batal ")])),_:1,__:[22]})]),_:1})]),_:1})]),_:1},8,["model-value"]),e(at,{modelValue:T.value,"onUpdate:modelValue":v[8]||(v[8]=u=>T.value=u),color:"success",location:"top"},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:v[7]||(v[7]=u=>T.value=!1)},{default:t(()=>v[23]||(v[23]=[f(" Close ")])),_:1,__:[23]})]),default:t(()=>[f(c(re.value)+" ",1)]),_:1},8,["modelValue"]),e(at,{modelValue:I.value,"onUpdate:modelValue":v[10]||(v[10]=u=>I.value=u),color:"error",location:"top"},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:v[9]||(v[9]=u=>I.value=!1)},{default:t(()=>v[24]||(v[24]=[f(" Close ")])),_:1,__:[24]})]),default:t(()=>[f(c(ge.value)+" ",1)]),_:1},8,["modelValue"])],64))}}),Zs={class:"d-flex align-center gap-2"},en={class:"pa-4",style:{"background-color":"#2A2A2A"}},tn={key:0,class:"d-flex align-center gap-3"},an={class:"text-h6 text-white font-weight-bold"},ln={class:"d-flex align-center gap-4 mt-1"},on={class:"text-caption text-grey-lighten-1"},sn={class:"text-caption text-grey-lighten-1"},nn={class:"pa-4 add-item-form"},rn={class:"d-flex align-center justify-space-between mb-4"},un={class:"d-flex align-center gap-2"},dn={class:"text-h6"},cn={key:0,class:"text-error"},mn={key:1},vn={class:"d-flex align-center"},fn={class:"pa-4 text-center"},pn={class:"pa-4 pt-0"},gn={class:"d-flex align-center justify-between mb-4"},_n={class:"text-h6"},kn={key:0,class:"composition-list"},yn={class:"d-flex align-center justify-between"},bn={class:"d-flex align-center gap-3"},hn={class:"font-weight-medium"},xn={class:"text-caption text-medium-emphasis"},wn={class:"font-weight-medium text-primary"},Vn={class:"d-flex align-center gap-2"},Pn={class:"text-center"},Cn={key:0,class:"text-body-2 text-medium-emphasis"},In={class:"text-center"},Sn={class:"text-body-1 mb-2",style:{"white-space":"pre-line"}},$n=Re({__name:"AddItemCompositionDialog",props:{modelValue:{type:Boolean},variant:{}},emits:["update:modelValue","save"],setup(l,{emit:F}){const y=l,d=F,z=H(),p=H(!1),P=H(!1),m=H([]),r=H([]),s=H(!1),G=H(null),_=H(!1),N=H(null),oe=H(!1),T=H(!1),I=H(""),re=H(""),ge=H("success"),R=H(!1),Z=me({get:()=>(console.log("ðŸ”µ [DEBUG] Dialog getter called, props.modelValue:",y.modelValue),y.modelValue),set:O=>{console.log("ðŸ”µ [DEBUG] Dialog setter called with value:",O),d("update:modelValue",O)}}),g=()=>({item_id:null,quantity:1,is_critical:!1}),k=H(g()),$=me(()=>!k.value.item_id||!Array.isArray(m.value)?null:m.value.find(O=>O.id_item===k.value.item_id)),X=me(()=>!$.value||s.value&&G.value!==null?null:r.value.find(O=>{var o,U;return O.name===((o=$.value)==null?void 0:o.name)||O.id&&((U=$.value)==null?void 0:U.id_item)&&O.id===$.value.id_item})),B=me(()=>{if(!$.value)return"";if(s.value&&G.value!==null)return"Mode Edit: Mengubah quantity item yang dipilih";if(X.value){const O=X.value;return`Item sudah ada dengan quantity ${O.quantity} ${O.unit}. Quantity akan ditambahkan.`}return`Stok tersedia: ${V($.value)} ${$.value.unit}`}),h=me(()=>Array.isArray(m.value)?m.value.filter(O=>V(O)>0):[]),V=O=>{var o,U;return((o=O.inventory)==null?void 0:o.current_stock)||((U=O.inventory)==null?void 0:U.available_stock)||O.current_stock||0},q=()=>P.value?"Memuat items...":!m.value||m.value.length===0?"Tidak ada item tersedia":h.value.length===0?"Semua item sedang stok habis":"Tidak ada item yang ditemukan",ue=O=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(O),ye=O=>{switch(O){case"overstock":return"success";case"in_stock":return"primary";case"low_stock":return"warning";case"out_of_stock":return"error";default:return"grey"}},ve=O=>{switch(O){case"overstock":return"Berlebih";case"in_stock":return"Tersedia";case"low_stock":return"Menipis";case"out_of_stock":return"Habis";default:return"Unknown"}},Q=(O,o,U)=>{var w,ie,ce,De,Ae,Me,Fe,Ye;if(!o)return!0;const j=o.toLowerCase().trim(),J=((ie=(w=U==null?void 0:U.raw)==null?void 0:w.name)==null?void 0:ie.toLowerCase())||"",D=((De=(ce=U==null?void 0:U.raw)==null?void 0:ce.item_code)==null?void 0:De.toLowerCase())||"",ee=((Me=(Ae=U==null?void 0:U.raw)==null?void 0:Ae.unit)==null?void 0:Me.toLowerCase())||"",W=((Ye=(Fe=U==null?void 0:U.raw)==null?void 0:Fe.description)==null?void 0:Ye.toLowerCase())||"";return J.includes(j)||D.includes(j)||ee.includes(j)||W.includes(j)},v=async()=>{var O,o,U;P.value=!0,console.log("Loading available items...");try{const j=await qe.get("/api/items?per_page=all&include=inventory");console.log("Items API response:",j.data);const J=((o=(O=j.data)==null?void 0:O.data)==null?void 0:o.data)||((U=j.data)==null?void 0:U.data)||j.data||[];m.value=Array.isArray(J)?J:[],console.log("Available items loaded:",m.value.length,"items"),console.log("Sample items with inventory:",m.value.slice(0,3))}catch(j){console.error("Error loading items:",j),j!=null&&j.response&&(console.error("API Error Status:",j.response.status),console.error("API Error Data:",j.response.data)),m.value=[]}finally{P.value=!1}},u=async()=>{var O,o,U,j,J;if(!(!((O=y.variant)!=null&&O.id)&&!((o=y.variant)!=null&&o.id_variant)))try{const D=y.variant.id||y.variant.id_variant;console.log("Loading composition items for variant:",D);const ee=await qe.get(`/api/variant-items/variant/${D}`);console.log("Composition API response:",ee.data);const W=((j=(U=ee.data)==null?void 0:U.data)==null?void 0:j.composition)||((J=ee.data)==null?void 0:J.composition)||[];if(!Array.isArray(W)){console.warn("API response composition is not an array:",W),r.value=[];return}r.value=W.map(w=>{var ie,ce,De,Ae,Me,Fe,Ye,dt,ct,mt;return{id:w.id_variant_item||w.id,name:((ie=w.item)==null?void 0:ie.name)||w.name,quantity:parseFloat(w.quantity_needed||w.quantity||w.qty||"1"),unit:w.unit||((ce=w.item)==null?void 0:ce.unit)||"pcs",stock:((Ae=(De=w.item)==null?void 0:De.inventory)==null?void 0:Ae.current_stock)||((Fe=(Me=w.item)==null?void 0:Me.inventory)==null?void 0:Fe.available_stock)||((Ye=w.item)==null?void 0:Ye.current_stock)||w.stock||0,price:parseFloat(((dt=w.item)==null?void 0:dt.cost_per_unit)||((ct=w.item)==null?void 0:ct.price)||w.price||"0"),is_critical:w.is_critical||!1,inventory:(mt=w.item)!=null&&mt.inventory?{current_stock:w.item.inventory.current_stock||0,available_stock:w.item.inventory.available_stock||0,stock_status:w.item.inventory.stock_status||"unknown",reorder_level:w.item.inventory.reorder_level||0}:null}}),console.log("Composition items loaded:",r.value)}catch(D){console.error("Error loading composition items:",D),D!=null&&D.response&&(console.error("API Error Status:",D.response.status),console.error("API Error Data:",D.response.data)),r.value=[]}},n=async()=>{var J,D;const{valid:O}=await z.value.validate();if(!O||!$.value)return;const o=$.value.name,U=$.value.id_item,j=k.value.quantity;if(console.log("ðŸ” Handle save - Mode:",s.value?"EDIT":"ADD"),console.log("ðŸ” Item:",o,"ID:",U),console.log("ðŸ” Quantity:",j),s.value&&G.value!==null){console.log("âœï¸ Edit mode: Updating existing item at index",G.value);const W=r.value[G.value].quantity;console.log(`ðŸ“ Updating item "${o}":`),console.log(`   - Old quantity: ${W}`),console.log(`   - New quantity: ${j}`),r.value[G.value].quantity=j,r.value[G.value].is_critical=k.value.is_critical,console.log("âœ… Item updated successfully in edit mode"),s.value=!1,G.value=null}else{console.log("âž• Add mode: Checking for existing item");const ee=r.value.findIndex(W=>W.name===o||W.id&&U&&W.id===U);if(ee!==-1){const w=r.value[ee].quantity,ie=w+j;console.log("ðŸ“¦ Item already exists! Accumulating quantity:"),console.log(`   - Item: ${o}`),console.log(`   - Old quantity: ${w}`),console.log(`   - Adding: ${j}`),console.log(`   - New quantity: ${ie}`),r.value[ee].quantity=ie}else{console.log("âž• Adding new item to composition:",o);const W={name:o,quantity:j,unit:$.value.unit,stock:((J=$.value.inventory)==null?void 0:J.current_stock)||((D=$.value.inventory)==null?void 0:D.available_stock)||$.value.current_stock||0,price:$.value.cost_per_unit||0,is_critical:k.value.is_critical,inventory:$.value.inventory?{current_stock:$.value.inventory.current_stock||0,available_stock:$.value.inventory.available_stock||0,stock_status:$.value.inventory.stock_status||"unknown",reorder_level:$.value.inventory.reorder_level||0}:null};r.value.push(W),console.log("âœ… New item added successfully")}}k.value=g(),console.log("ðŸ”„ Form reset")},i=(O,o)=>{console.log("ðŸ” Edit item called:",O,o);const U=m.value.find(j=>j.name===O.name||j.id_item===O.id);U?(console.log("âœ… Found item in available items:",U),s.value=!0,G.value=o,k.value={item_id:U.id_item,quantity:O.quantity,is_critical:O.is_critical||!1},console.log("ðŸ“ Edit mode activated!"),console.log("ðŸ“ Form data set:",k.value),console.log("ðŸ“ Editing item at index:",o),setTimeout(()=>{const j=document.querySelector(".add-item-form");j&&j.scrollIntoView({behavior:"smooth",block:"start"})},100)):(console.error("âŒ Could not find item in available items"),console.log("Available items:",m.value.map(j=>({id:j.id_item,name:j.name}))),console.log("Looking for item:",{id:O.id,name:O.name}))},A=()=>{console.log("âŒ Edit mode cancelled"),s.value=!1,G.value=null,k.value=g()},M=(O,o)=>{N.value={item:O,index:o},_.value=!0},C=async()=>{var J,D,ee;if(!N.value)return;const{item:O,index:o}=N.value,U=O.name,j=O.id;oe.value=!0,console.log("ðŸš€ Starting delete process for:",U,"ID:",j,"Index:",o);try{j?(console.log("ðŸ—‘ï¸ Deleting item from database:",U,"with ID:",j),await qe.delete(`/api/variant-items/${j}`),console.log("âœ… Item deleted from database successfully")):console.log("ðŸ“ Item has no ID, removing from local list only"),_.value=!1,N.value=null,console.log("âœ… Delete dialog closed"),console.log("ðŸ”„ Force refreshing composition list..."),await u(),console.log("âœ… Composition list refreshed from server. New count:",r.value.length),console.log("ðŸ“¡ Emitting save event to parent component..."),d("save"),console.log("âœ… Save event emitted to parent component"),console.log("ðŸŽ‰ Item successfully deleted:",U)}catch(W){console.error("âŒ Error deleting item:",W),console.error("âŒ Error details:",(J=W.response)==null?void 0:J.data),alert("Gagal menghapus item: "+(((ee=(D=W.response)==null?void 0:D.data)==null?void 0:ee.message)||W.message))}finally{oe.value=!1,console.log("ðŸ Delete process completed")}},x=()=>{_.value=!1,N.value=null},ne=()=>{switch(ge.value){case"success":return"mdi-check-circle";case"info":return"mdi-information";case"warning":return"mdi-alert";default:return"mdi-check-circle"}},xe=()=>{switch(ge.value){case"success":return"success";case"info":return"info";case"warning":return"warning";default:return"success"}},Ie=()=>{switch(ge.value){case"success":return"text-success";case"info":return"text-info";case"warning":return"text-warning";default:return"text-success"}},_e=()=>{switch(ge.value){case"success":return"success";case"info":return"info";case"warning":return"warning";default:return"success"}},te=async()=>{var O,o,U,j;if(!((O=y.variant)!=null&&O.id)&&!((o=y.variant)!=null&&o.id_variant)){console.error("No variant ID found");return}p.value=!0;try{const J=y.variant.id||y.variant.id_variant;console.log("ðŸ” [DEBUG] Composition items count:",r.value.length),console.log("ðŸ” [DEBUG] Raw composition items:",JSON.stringify(r.value,null,2));const D=r.value.some(ee=>ee.id);if(console.log("ðŸ” [DEBUG] Has existing items:",D),D){console.log("ï¿½ [EDIT MODE] Updating existing composition");const ee={items:r.value.map(w=>{const ie=m.value.find(ce=>ce.name===w.name);return console.log(`Mapping item "${w.name}":`),console.log("  - Found item:",ie==null?void 0:ie.id_item),console.log("  - Original ID (id_variant_item):",w.id),console.log("  - Quantity:",w.quantity),console.log("  - Unit:",w.unit),console.log("  - Is critical:",w.is_critical),{id_variant_item:w.id,quantity_needed:Number(w.quantity),unit:w.unit,is_critical:w.is_critical||!1}}).filter(w=>w.id_variant_item&&w.quantity_needed>0)};console.log("Edit payload:",JSON.stringify(ee,null,2));const W=await qe.post("/api/variant-items/bulk-update",ee);console.log("Composition updated successfully:",W.data)}else{console.log("âœ¨ [CREATE MODE] Creating new composition");const ee={id_variant:J,items:r.value.map(w=>{const ie=m.value.find(ce=>ce.name===w.name);return console.log(`Mapping item "${w.name}":`),console.log("  - Found item:",ie==null?void 0:ie.id_item),console.log("  - Quantity:",w.quantity),console.log("  - Unit:",w.unit),console.log("  - Is critical:",w.is_critical),{id_item:ie==null?void 0:ie.id_item,quantity_needed:Number(w.quantity),unit:w.unit,is_critical:w.is_critical||!1}}).filter(w=>w.id_item&&w.quantity_needed>0)};console.log("Create payload:",JSON.stringify(ee,null,2));const W=await qe.post("/api/variant-items/bulk-store",ee);console.log("Composition created successfully:",W.data)}d("save"),we()}catch(J){console.error("Error saving composition:",J),alert("Gagal menyimpan komposisi: "+(((j=(U=J.response)==null?void 0:U.data)==null?void 0:j.message)||J.message))}finally{p.value=!1}},be=()=>{R.value=!0},we=()=>{Z.value=!1,k.value=g(),r.value=[],s.value=!1,G.value=null};return Pe(()=>y.modelValue,O=>{O?(k.value=g(),v(),u()):(s.value=!1,G.value=null)}),Pe(()=>k.value.item_id,O=>{O&&$.value&&console.log("Item selected:",$.value.name,"Unit:",$.value.unit)}),ut(()=>{v()}),(O,o)=>{var U,j,J;return b(),se(Te,null,[e(Oe,{modelValue:Z.value,"onUpdate:modelValue":o[3]||(o[3]=D=>Z.value=D),"max-width":"1000px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ce,{class:"d-flex align-center justify-space-between",style:{"background-color":"#D4A574",color:"white"}},{default:t(()=>[a("div",Zs,[e(S,{icon:"mdi-delete",color:"white"}),o[9]||(o[9]=a("span",null,"Kelola Komposisi Item",-1))]),e(K,{icon:"mdi-close",variant:"text",color:"white",onClick:we,disabled:p.value},null,8,["disabled"])]),_:1}),e(fe,{class:"pa-0"},{default:t(()=>[a("div",en,[O.variant?(b(),se("div",tn,[e(S,{icon:"mdi-coffee",size:"32",color:"white"}),a("div",null,[a("h3",an,c(O.variant.name),1),a("div",ln,[a("span",on,"SKU: "+c(O.variant.sku),1),a("span",sn,"Harga: "+c(ue(O.variant.price||0)),1),e(pe,{color:"success",size:"small",variant:"tonal"},{default:t(()=>o[10]||(o[10]=[f(" Stok Aman ")])),_:1,__:[10]})])])])):ae("",!0)]),a("div",nn,[a("div",rn,[a("div",un,[e(S,{icon:"mdi-plus-circle",color:"success"}),a("h4",dn,c(s.value?"Edit Item Komposisi":"Tambah Item Komposisi"),1)])]),e(Ct,{ref_key:"form",ref:z,onSubmit:Vt(n,["prevent"])},{default:t(()=>[e($e,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(Pt,{modelValue:k.value.item_id,"onUpdate:modelValue":o[0]||(o[0]=D=>k.value.item_id=D),items:h.value,"item-title":"name","item-value":"id_item",label:"Pilih Item",variant:"outlined",density:"compact",rules:[D=>!!D||"Item wajib dipilih"],loading:P.value,disabled:P.value||m.value&&m.value.length===0,"no-data-text":q(),placeholder:"Ketik untuk mencari item dengan stok...",clearable:"","menu-props":{maxHeight:"300px"},"hide-details":"auto","custom-filter":Q},{"prepend-inner":t(()=>[e(S,{icon:"mdi-package",size:"16"})]),item:t(({props:D,item:ee})=>[e(Je,he(D,{title:ee.raw.name,disabled:V(ee.raw)<=0,class:["pa-3",{"text-disabled":V(ee.raw)<=0}]}),{prepend:t(()=>[e(S,{icon:"mdi-package-variant",color:V(ee.raw)<=0?"grey-darken-2":"grey-lighten-1",class:"me-3"},null,8,["color"])]),subtitle:t(()=>[a("div",{class:Xe(["text-caption",V(ee.raw)<=0?"text-disabled":"text-medium-emphasis"])},[V(ee.raw)<=0?(b(),se("span",cn,[e(S,{icon:"mdi-alert-circle",size:"12",class:"me-1"}),o[11]||(o[11]=f(" Stok Habis "))])):(b(),se("span",mn," Stok: "+c(V(ee.raw))+" "+c(ee.raw.unit),1))],2)]),append:t(()=>{var W;return[V(ee.raw)>0?(b(),L(pe,{key:0,size:"x-small",color:ye(((W=ee.raw.inventory)==null?void 0:W.stock_status)||ee.raw.stock_status||"unknown"),variant:"tonal"},{default:t(()=>{var w;return[f(c(ve(((w=ee.raw.inventory)==null?void 0:w.stock_status)||ee.raw.stock_status||"unknown")),1)]}),_:2},1032,["color"])):(b(),L(pe,{key:1,size:"x-small",color:"error",variant:"outlined","prepend-icon":"mdi-close-circle"},{default:t(()=>o[12]||(o[12]=[f(" Habis ")])),_:1,__:[12]}))]}),_:2},1040,["title","disabled","class"])]),selection:t(({item:D})=>[a("div",vn,[e(S,{icon:"mdi-package-variant",size:"16",class:"me-2"}),a("span",null,c(D.raw.name),1)])]),"no-data":t(()=>[a("div",fn,[e(S,{icon:"mdi-magnify",size:"48",color:"grey",class:"mb-2"}),o[13]||(o[13]=a("div",{class:"text-body-2 text-medium-emphasis"}," Tidak ada item yang ditemukan ",-1)),o[14]||(o[14]=a("div",{class:"text-caption text-disabled"}," Coba kata kunci yang berbeda ",-1))])]),_:1},8,["modelValue","items","rules","loading","disabled","no-data-text"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Ve,{modelValue:k.value.quantity,"onUpdate:modelValue":o[1]||(o[1]=D=>k.value.quantity=D),modelModifiers:{number:!0},label:"Jumlah",variant:"outlined",density:"compact",type:"number",min:"0.01",step:"0.01",rules:[D=>!!D||"Jumlah wajib diisi",D=>D>0||"Jumlah harus lebih dari 0"],hint:B.value,"persistent-hint":"",color:X.value?"warning":"primary"},null,8,["modelValue","rules","hint","color"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>{var D;return[e(Ve,{"model-value":((D=$.value)==null?void 0:D.unit)||"pcs",label:"Satuan",variant:"outlined",density:"compact",readonly:"",disabled:!$.value,placeholder:"Pilih item terlebih dahulu"},{"prepend-inner":t(()=>[e(S,{icon:"mdi-weight",size:"16"})]),_:1},8,["model-value","disabled"])]}),_:1}),e(E,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[e(rt,{modelValue:k.value.is_critical,"onUpdate:modelValue":o[2]||(o[2]=D=>k.value.is_critical=D),label:"Item Kritis",color:"warning",density:"compact","true-value":!0,"false-value":!1},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2",class:"d-flex flex-column gap-2"},{default:t(()=>[e(K,{color:s.value?"primary":X.value?"warning":"#D4A574",onClick:n,loading:p.value,disabled:!k.value.item_id||!k.value.quantity,block:""},{default:t(()=>[e(S,{icon:s.value?"mdi-content-save":X.value?"mdi-plus-box-multiple":"mdi-plus",class:"me-1"},null,8,["icon"]),f(" "+c(s.value?"Update":X.value?"Akumulasi":"Tambah"),1)]),_:1},8,["color","loading","disabled"]),s.value?(b(),L(K,{key:0,color:"grey",variant:"outlined",onClick:A,size:"small",block:""},{default:t(()=>[e(S,{icon:"mdi-close",class:"me-1"}),o[15]||(o[15]=f(" Batal "))]),_:1,__:[15]})):ae("",!0)]),_:1})]),_:1})]),_:1},512)]),a("div",pn,[a("div",gn,[a("h4",_n,"Daftar Item Komposisi ("+c(r.value.length)+")",1)]),r.value.length>0?(b(),se("div",kn,[(b(!0),se(Te,null,Ge(r.value,(D,ee)=>(b(),L(de,{key:ee,variant:"outlined",class:"mb-3"},{default:t(()=>[e(fe,{class:"pa-3"},{default:t(()=>{var W,w,ie,ce,De,Ae,Me;return[a("div",yn,[a("div",bn,[e(S,{icon:"mdi-check-circle",color:"success"}),a("div",null,[a("div",hn,c(D.name),1),a("div",xn,[a("span",wn,"Dibutuhkan: "+c(D.quantity)+" "+c(D.unit),1),o[16]||(o[16]=f(" â€¢ ")),a("span",{class:Xe({"text-success":(((W=D.inventory)==null?void 0:W.current_stock)??0)>(((w=D.inventory)==null?void 0:w.reorder_level)??0),"text-warning":(((ie=D.inventory)==null?void 0:ie.current_stock)??0)<=(((ce=D.inventory)==null?void 0:ce.reorder_level)??0)&&(((De=D.inventory)==null?void 0:De.current_stock)??0)>0,"text-error":(((Ae=D.inventory)==null?void 0:Ae.current_stock)??0)<=0})}," Stok: "+c(((Me=D.inventory)==null?void 0:Me.current_stock)||D.stock||0)+" "+c(D.unit),3),f(" â€¢ "+c(ue(D.price)),1)])])]),a("div",Vn,[e(K,{icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:Fe=>i(D,ee)},null,8,["onClick"]),e(K,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:Fe=>M(D,ee)},null,8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128))])):(b(),L(de,{key:1,variant:"outlined",class:"text-center pa-6"},{default:t(()=>[e(S,{icon:"mdi-package-variant-closed",size:"48",color:"grey",class:"mb-3"}),o[17]||(o[17]=a("div",{class:"text-body-2 text-medium-emphasis"}," Belum ada item komposisi ditambahkan ",-1))]),_:1,__:[17]}))])]),_:1}),e(Ke,{class:"px-6 pb-6"},{default:t(()=>[e(K,{variant:"outlined",color:"secondary","prepend-icon":"mdi-wrench",onClick:be},{default:t(()=>o[18]||(o[18]=[f(" Setting HPP ")])),_:1,__:[18]}),e(Le),e(K,{variant:"outlined",onClick:we,disabled:p.value},{default:t(()=>o[19]||(o[19]=[f(" Batal ")])),_:1,__:[19]},8,["disabled"]),e(K,{color:"#D4A574",onClick:te,loading:p.value,disabled:r.value.length===0},{default:t(()=>o[20]||(o[20]=[f(" Simpan Komposisi ")])),_:1,__:[20]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Qt,{modelValue:R.value,"onUpdate:modelValue":o[4]||(o[4]=D=>R.value=D),"variant-id":((U=O.variant)==null?void 0:U.id)||((j=O.variant)==null?void 0:j.id_variant),"variant-name":(J=O.variant)==null?void 0:J.name,onHppUpdated:o[5]||(o[5]=D=>d("save"))},null,8,["modelValue","variant-id","variant-name"]),e(Oe,{modelValue:_.value,"onUpdate:modelValue":o[6]||(o[6]=D=>_.value=D),"max-width":"400px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ce,{class:"d-flex align-center justify-center text-h6 text-error"},{default:t(()=>[e(S,{icon:"mdi-alert-circle",color:"error",class:"me-2"}),o[21]||(o[21]=f(" Konfirmasi Hapus "))]),_:1,__:[21]}),e(ze),e(fe,{class:"pa-6"},{default:t(()=>[a("div",Pn,[e(S,{icon:"mdi-delete-alert",size:"64",color:"error",class:"mb-4"}),o[24]||(o[24]=a("p",{class:"text-body-1 mb-2"}," Apakah Anda yakin ingin menghapus item ini? ",-1)),N.value?(b(),se("div",Cn,[a("strong",null,c(N.value.item.name),1),o[22]||(o[22]=a("br",null,null,-1)),f(" Dibutuhkan: "+c(N.value.item.quantity)+" "+c(N.value.item.unit),1)])):ae("",!0),e(He,{type:"warning",variant:"tonal",class:"mt-4 text-start"},{default:t(()=>o[23]||(o[23]=[a("strong",null,"Perhatian:",-1),f(" Item yang sudah dihapus tidak dapat dikembalikan! ")])),_:1,__:[23]})])]),_:1}),e(Ke,{class:"px-6 pb-6"},{default:t(()=>[e(K,{variant:"outlined",onClick:x,disabled:oe.value,class:"flex-grow-1"},{default:t(()=>o[25]||(o[25]=[f(" Batal ")])),_:1,__:[25]},8,["disabled"]),e(K,{color:"error",onClick:C,loading:oe.value,class:"flex-grow-1"},{default:t(()=>o[26]||(o[26]=[f(" Hapus ")])),_:1,__:[26]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Oe,{modelValue:T.value,"onUpdate:modelValue":o[8]||(o[8]=D=>T.value=D),"max-width":"450px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ce,{class:Xe(["d-flex align-center justify-center text-h6",Ie()])},{default:t(()=>[e(S,{icon:ne(),color:xe(),class:"me-2",size:"24"},null,8,["icon","color"]),f(" "+c(re.value),1)]),_:1},8,["class"]),e(ze),e(fe,{class:"pa-6"},{default:t(()=>[a("div",In,[e(S,{icon:ne(),color:xe(),size:"64",class:"mb-4"},null,8,["icon","color"]),a("div",Sn,c(I.value),1),e(He,{type:ge.value,variant:"tonal",class:"mt-4 text-start"},{default:t(()=>[ge.value==="success"?(b(),se(Te,{key:0},[o[27]||(o[27]=a("strong",null,"Berhasil!",-1)),o[28]||(o[28]=f(" Perubahan telah disimpan. "))],64)):ge.value==="info"?(b(),se(Te,{key:1},[o[29]||(o[29]=a("strong",null,"Informasi:",-1)),o[30]||(o[30]=f(" Item telah diperbarui sesuai permintaan. "))],64)):(b(),se(Te,{key:2},[o[31]||(o[31]=a("strong",null,"Perhatian:",-1)),o[32]||(o[32]=f(" Silakan periksa kembali informasi. "))],64))]),_:1},8,["type"])])]),_:1}),e(Ke,{class:"px-6 pb-6"},{default:t(()=>[e(Le),e(K,{color:_e(),onClick:o[7]||(o[7]=D=>T.value=!1),class:"px-6"},{default:t(()=>[e(S,{icon:"mdi-check",class:"me-1"}),o[33]||(o[33]=f(" OK "))]),_:1,__:[33]},8,["color"]),e(Le)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Dn=Ne($n,[["__scopeId","data-v-df449ced"]]),Tn={class:"d-flex align-center gap-2"},Un={class:"mt-2"},zn={key:0,class:"mt-1 font-weight-medium"},An={key:1,class:"mt-1 text-warning"},Mn=Re({__name:"CreateVariantDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","save"],setup(l,{emit:F}){const y=l,d=F,z=H(),p=H(!1),P=H(!1),m=H([]),r=H({name:"",selectedProduct:null,selectedProductId:null,active:!0}),s=[g=>!!g||"Nama variant wajib diisi",g=>g.length>=3||"Nama variant minimal 3 karakter"],G=[g=>!!g||"Produk wajib dipilih"],_=(g,k="success")=>{const $=document.createElement("div");$.style.cssText=`
    position: fixed;
    top: 20px;
    right: 20px;
    background: ${k==="success"?"#4CAF50":"#f44336"};
    color: white;
    padding: 16px 24px;
    border-radius: 8px;
    z-index: 9999;
    font-family: 'Roboto', sans-serif;
    font-size: 14px;
    font-weight: 500;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    display: flex;
    align-items: center;
    gap: 8px;
    animation: slideIn 0.3s ease-out;
    min-width: 300px;
  `;const X=document.createElement("span");if(X.innerHTML=k==="success"?"âœ“":"âœ•",X.style.cssText=`
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: rgba(255,255,255,0.2);
    font-weight: bold;
  `,$.appendChild(X),$.appendChild(document.createTextNode(g)),!document.querySelector("#snackbar-styles")){const B=document.createElement("style");B.id="snackbar-styles",B.textContent=`
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `,document.head.appendChild(B)}document.body.appendChild($),setTimeout(()=>{$.style.animation="slideOut 0.3s ease-in",setTimeout(()=>{$.parentNode&&$.parentNode.removeChild($)},300)},3e3),console.log(`${k}: ${g}`)},N=async()=>{P.value=!0;try{const g=await qe.get("/api/products");m.value=g.data.data||g.data||[],console.log("Fetched products:",m.value),console.log("First product structure:",m.value[0])}catch(g){console.error("Gagal mengambil data produk:",g),m.value=[]}finally{P.value=!1}},oe=g=>{!g&&m.value.length===0&&N()},T=g=>{console.log("Product object changed:",g),r.value.selectedProduct=g,g?r.value.selectedProductId=g.id:r.value.selectedProductId=null},I=me(()=>{if(console.log("Computing selected product info..."),console.log("form.selectedProduct:",r.value.selectedProduct),console.log("form.selectedProductId:",r.value.selectedProductId),r.value.selectedProduct)return console.log("Using selectedProduct object:",r.value.selectedProduct),r.value.selectedProduct;if(r.value.selectedProductId&&m.value.length>0){console.log("Searching for product with ID:",r.value.selectedProductId),console.log("Product IDs available:",m.value.map(k=>({id:k.id,name:k.name})));const g=m.value.find(k=>k.id===r.value.selectedProductId);return console.log("Found selected product by ID:",g),g}return console.log("No product selected or no products available"),null}),re=()=>{console.log("Generating SKU...");const g=I.value;if(console.log("Product info for SKU:",g),console.log("Form name:",r.value.name),console.log("Form selectedProductId:",r.value.selectedProductId),!g||!r.value.name)return console.log("Missing productInfo or name, returning empty SKU"),"";const k=g.sku||"PROD",$=r.value.name.replace(/\s+/g,"").toUpperCase().substring(0,3),X=Date.now().toString().slice(-4),B=`${k}-${$}-${X}`;return console.log("Generated SKU:",B),B},ge=async()=>{var $,X;if(p.value)return;const{valid:g}=await z.value.validate();if(!g)return;const k=I.value;if(console.log("Product info in saveVariant:",k),!k){_("Produk tidak ditemukan","error");return}if(!k.id&&!k.id_product){_("ID Produk tidak valid","error"),console.error("Product missing ID:",k);return}p.value=!0;try{const B={id_product:k.id||k.id_product,name:r.value.name,sku:re(),price:0,cost_price:null,barcode:null,variant_values:[],active:r.value.active};console.log("Payload being sent:",B),console.log("Payload JSON:",JSON.stringify(B));const h=await qe.post("/api/variants",B);if(console.log("API Response:",h.data),console.log("Response Status:",h.status),h.data.success!==!1&&(h.status===200||h.status===201))_("Variant berhasil dibuat!","success"),console.log("Created variant data:",h.data.data),d("save"),Z();else throw new Error(h.data.message||"Gagal membuat variant")}catch(B){const h=((X=($=B.response)==null?void 0:$.data)==null?void 0:X.message)||B.message||"Gagal membuat variant";_(h,"error"),console.error("Save variant error:",B)}finally{p.value=!1}},R=()=>{var g;r.value={name:"",selectedProduct:null,selectedProductId:null,active:!0},(g=z.value)==null||g.resetValidation()},Z=()=>{d("update:modelValue",!1),R()};return Pe(()=>y.modelValue,g=>{g&&(R(),N())}),(g,k)=>(b(),L(Oe,{"model-value":g.modelValue,"onUpdate:modelValue":k[3]||(k[3]=$=>g.$emit("update:modelValue",$)),"max-width":"600px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ce,{class:"bg-primary text-white"},{default:t(()=>[e(S,{icon:"mdi-plus-circle",class:"me-2"}),k[4]||(k[4]=f(" Tambah Variant Baru ")),e(Le),e(K,{icon:"mdi-close",variant:"text",color:"white",onClick:Z})]),_:1,__:[4]}),e(Ct,{ref_key:"formRef",ref:z,onSubmit:Vt(ge,["prevent"])},{default:t(()=>[e(fe,{class:"pa-6"},{default:t(()=>[e($e,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(Pt,{modelValue:r.value.selectedProduct,"onUpdate:modelValue":[k[0]||(k[0]=$=>r.value.selectedProduct=$),T],items:m.value,loading:P.value,"item-title":"name","return-object":"",label:"Pilih Produk *",placeholder:"Cari produk...",variant:"outlined",rules:G,required:"","no-data-text":"Tidak ada produk ditemukan","onUpdate:search":oe},{item:t(({props:$,item:X})=>[e(Je,Ia(Sa($)),{prepend:t(()=>[e(Se,{image:X.raw.image_url,size:"40"},{default:t(()=>[X.raw.image_url?ae("",!0):(b(),L(S,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"])]),default:t(()=>[e(nt,null,{default:t(()=>[f(c(X.raw.name),1)]),_:2},1024),e(it,null,{default:t(()=>[f("SKU: "+c(X.raw.sku||"-"),1)]),_:2},1024)]),_:2},1040)]),selection:t(({item:$})=>[a("div",Tn,[e(Se,{image:$.raw.image_url,size:"24"},{default:t(()=>[$.raw.image_url?ae("",!0):(b(),L(S,{key:0,icon:"mdi-coffee",size:"16"}))]),_:2},1032,["image"]),a("span",null,c($.raw.name),1)])]),_:1},8,["modelValue","items","loading"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Ve,{modelValue:r.value.name,"onUpdate:modelValue":k[1]||(k[1]=$=>r.value.name=$),label:"Nama Variant *",placeholder:"Contoh: Large Hot, Medium Cold, dll",variant:"outlined",rules:s,required:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(He,{color:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[e(_t,null,{default:t(()=>[e(S,{icon:"mdi-information",class:"me-2"}),k[5]||(k[5]=f(" SKU Otomatis "))]),_:1,__:[5]}),a("div",Un,[k[6]||(k[6]=f(" SKU variant akan dibuat otomatis berdasarkan nama produk dan variant ")),r.value.name&&(r.value.selectedProduct||r.value.selectedProductId)?(b(),se("div",zn," Preview SKU: "+c(re()),1)):r.value.name&&!r.value.selectedProduct&&!r.value.selectedProductId?(b(),se("div",An," Pilih produk terlebih dahulu untuk melihat preview SKU ")):ae("",!0)])]),_:1})]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(rt,{modelValue:r.value.active,"onUpdate:modelValue":k[2]||(k[2]=$=>r.value.active=$),label:"Variant Aktif",color:"primary",inset:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(ze),e(Ke,{class:"pa-6"},{default:t(()=>[e(Le),e(K,{variant:"outlined",onClick:Z,disabled:p.value},{default:t(()=>k[7]||(k[7]=[f(" Batal ")])),_:1,__:[7]},8,["disabled"]),e(K,{type:"submit",color:"primary",loading:p.value},{default:t(()=>k[8]||(k[8]=[f(" Simpan Variant ")])),_:1,__:[8]},8,["loading"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["model-value"]))}}),En=Ne(Mn,[["__scopeId","data-v-6f78bbf1"]]),Hn={class:"product-variant-tab"},Bn={class:"d-flex gap-2"},Fn={key:0,class:"mt-4 d-flex align-center gap-2"},Kn={key:1,class:"text-center pa-12"},Rn={key:2,class:"text-center pa-12"},qn={class:"d-flex align-center gap-3"},On={class:"flex-grow-1 min-width-0"},Ln={class:"text-h6 font-weight-bold text-truncate"},Nn={class:"text-body-2 text-medium-emphasis mb-0"},jn={class:"d-flex flex-column gap-1"},Wn={class:"text-xs"},Gn={class:"d-flex align-center gap-2"},Xn={class:"text-primary font-weight-medium"},Jn={class:"d-flex gap-1"},Yn={class:"d-flex align-center justify-space-between w-100"},Qn={class:"d-flex gap-1"},Zn=Re({__name:"ProductVariantTab",props:{loading:{type:Boolean}},emits:["refresh"],setup(l,{emit:F}){const y=F,d=H(!1),z=H([]),p=H(!1),P=H(!1),m=H(null),r=H(!1),s=H(!1),G=H(!1),_=H({search:"",stockStatus:"",activeStatus:null,sortBy:"name_asc"}),N=[{title:"Semua Status",value:""},{title:"Stok Aman",value:"safe"},{title:"Stok Kritis",value:"critical"},{title:"Stok Habis",value:"out"}],oe=[{title:"Nama Produk A-Z",value:"name_asc"},{title:"Nama Produk Z-A",value:"name_desc"},{title:"Variant Terbanyak",value:"variants_desc"},{title:"Variant Tersedikit",value:"variants_asc"}],T=me(()=>!!(_.value.search||_.value.stockStatus||_.value.activeStatus!==null||_.value.sortBy!=="name_asc")),I=me(()=>{const v={};return z.value.forEach(u=>{const n=u.id_product;v[n]||(v[n]={product:u.product||{id:u.id_product,id_product:u.id_product,name:`Product ${u.id_product}`,sku:""},variants:[]}),v[n].variants.push(u)}),Object.values(v)}),re=me(()=>{let v=[...I.value];if(_.value.search){const u=_.value.search.toLowerCase();v=v.filter(n=>{var i;return n.product.name.toLowerCase().includes(u)||((i=n.product.sku)==null?void 0:i.toLowerCase().includes(u))||n.variants.some(A=>A.name.toLowerCase().includes(u)||A.sku.toLowerCase().includes(u))})}switch(_.value.stockStatus&&(v=v.filter(u=>u.variants.some(n=>{var A;return(((A=n.composition_summary)==null?void 0:A.stock_status)||"safe")===_.value.stockStatus}))),_.value.activeStatus!==null&&(v=v.filter(u=>u.variants.some(n=>n.is_active===_.value.activeStatus))),_.value.sortBy){case"name_asc":v.sort((u,n)=>u.product.name.localeCompare(n.product.name));break;case"name_desc":v.sort((u,n)=>n.product.name.localeCompare(u.product.name));break;case"variants_desc":v.sort((u,n)=>n.variants.length-u.variants.length);break;case"variants_asc":v.sort((u,n)=>u.variants.length-n.variants.length);break}return v}),ge=(v,u="success")=>{},R=async()=>{var v,u,n;d.value=!0;try{const i=await qe.get("/api/variants",{params:{per_page:1e3,with_product:!0,with_composition:!0}});if(i.data.success===!1)throw new Error(i.data.message||"Failed to load variants");const A=((v=i.data.data)==null?void 0:v.data)||i.data.data||[];z.value=A.map(M=>({...M,is_active:M.active!==void 0?M.active:M.is_active,id:M.id_variant||M.id,id_product:M.id_product||M.product_id}))}catch(i){(n=(u=i.response)==null?void 0:u.data)!=null&&n.message||i.message,z.value=[]}finally{d.value=!1}},Z=v=>{m.value=v,r.value=!0},g=v=>{v&&(m.value=v,s.value=!0)},k=v=>{m.value=v,p.value=!0},$=()=>{G.value=!0},X=async()=>{var v,u;if(m.value)try{P.value=!0,await qe.delete(`/api/variants/${m.value.id_variant}`),ge("Variant berhasil dihapus","success"),await R(),p.value=!1}catch(n){(u=(v=n.response)==null?void 0:v.data)!=null&&u.message}finally{P.value=!1}},B=v=>{switch(v){case"critical":return"error";case"out":return"error";case"safe":return"success";default:return"primary"}},h=v=>{switch(v){case"critical":return"Kritis";case"out":return"Habis";case"safe":return"Aman";default:return"Normal"}},V=v=>{const u=v.filter(n=>n.is_active).length;return u===0?"error":u===v.length?"success":"warning"},q=v=>v.some(u=>{var i;const n=(i=u.composition_summary)==null?void 0:i.stock_status;return n==="critical"||n==="out"}),ue=v=>{const u=v.filter(i=>i.is_active).length,n=v.filter(i=>{var M;const A=(M=i.composition_summary)==null?void 0:M.stock_status;return A==="critical"||A==="out"}).length;return n>0?{text:`${n} Stok Kritis`,color:"error",icon:"mdi-alert-circle"}:u===v.length?{text:"Semua Aktif",color:"success",icon:"mdi-check-circle"}:u===0?{text:"Semua Nonaktif",color:"error",icon:"mdi-close-circle"}:{text:`${u}/${v.length} Aktif`,color:"warning",icon:"mdi-minus-circle"}},ye=()=>{_.value={search:"",stockStatus:"",activeStatus:null,sortBy:"name_asc"}},ve=()=>{R(),y("refresh")},Q=()=>{console.log("Variant created, refreshing data..."),R(),y("refresh")};return ut(()=>{R()}),(v,u)=>{var n,i,A;return b(),se("div",Hn,[e(de,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(Ce,{class:"d-flex align-center justify-space-between"},{default:t(()=>[u[14]||(u[14]=a("div",null,[a("h2",{class:"text-h5 font-weight-bold"},"Variant Produk"),a("p",{class:"text-body-2 text-medium-emphasis"}," Kelola variant dan komposisi untuk produk Anda ")],-1)),a("div",Bn,[e(K,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:R,loading:d.value},{default:t(()=>u[12]||(u[12]=[f(" Refresh ")])),_:1,__:[12]},8,["loading"]),e(K,{color:"primary","prepend-icon":"mdi-plus",onClick:$},{default:t(()=>u[13]||(u[13]=[f(" Tambah Variant ")])),_:1,__:[13]})])]),_:1,__:[14]})]),_:1}),e(de,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(fe,null,{default:t(()=>[e($e,null,{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Ve,{modelValue:_.value.search,"onUpdate:modelValue":u[0]||(u[0]=M=>_.value.search=M),label:"Cari Variant",placeholder:"Nama variant, SKU, atau produk...",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Be,{modelValue:_.value.stockStatus,"onUpdate:modelValue":u[1]||(u[1]=M=>_.value.stockStatus=M),items:N,label:"Status Stok",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Be,{modelValue:_.value.activeStatus,"onUpdate:modelValue":u[2]||(u[2]=M=>_.value.activeStatus=M),items:[{title:"Semua Status",value:null},{title:"Aktif",value:!0},{title:"Nonaktif",value:!1}],label:"Status Aktif",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Be,{modelValue:_.value.sortBy,"onUpdate:modelValue":u[3]||(u[3]=M=>_.value.sortBy=M),items:oe,label:"Urutkan",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),T.value?(b(),se("div",Fn,[u[16]||(u[16]=a("span",{class:"text-body-2"},"Filter aktif:",-1)),_.value.search?(b(),L(pe,{key:0,size:"small",closable:"","onClick:close":u[4]||(u[4]=M=>_.value.search="")},{default:t(()=>[f(" Pencarian: "+c(_.value.search),1)]),_:1})):ae("",!0),_.value.stockStatus?(b(),L(pe,{key:1,size:"small",closable:"","onClick:close":u[5]||(u[5]=M=>_.value.stockStatus="")},{default:t(()=>{var M;return[f(" Stok: "+c((M=N.find(C=>C.value===_.value.stockStatus))==null?void 0:M.title),1)]}),_:1})):ae("",!0),_.value.activeStatus!==null?(b(),L(pe,{key:2,size:"small",closable:"","onClick:close":u[6]||(u[6]=M=>_.value.activeStatus=null)},{default:t(()=>[f(" Status: "+c(_.value.activeStatus?"Aktif":"Nonaktif"),1)]),_:1})):ae("",!0),e(K,{variant:"text",size:"small",color:"error",onClick:ye},{default:t(()=>u[15]||(u[15]=[f(" Hapus Semua Filter ")])),_:1,__:[15]})])):ae("",!0)]),_:1})]),_:1}),!d.value&&re.value.length===0&&T.value?(b(),L(He,{key:0,type:"info",variant:"outlined",class:"mb-6",title:"Tidak ada hasil",text:"Tidak ada variant yang sesuai dengan filter yang dipilih. Coba ubah filter pencarian."})):ae("",!0),d.value?(b(),se("div",Kn,[e(qt,{color:"primary",indeterminate:"",size:"64"}),u[17]||(u[17]=a("div",{class:"mt-4 text-h6"},"Memuat variant...",-1))])):I.value.length===0?(b(),se("div",Rn,[e(S,{icon:"mdi-tune-variant",size:"96",class:"text-disabled mb-6"}),u[19]||(u[19]=a("h3",{class:"text-h5 font-weight-bold mb-4"},"Belum Ada Variant Produk",-1)),u[20]||(u[20]=a("p",{class:"text-body-1 text-medium-emphasis mb-6"}," Buat variant untuk produk Anda agar dapat menawarkan pilihan yang beragam ",-1)),e(K,{color:"primary",size:"large","prepend-icon":"mdi-plus",onClick:$},{default:t(()=>u[18]||(u[18]=[f(" Buat Variant Pertama ")])),_:1,__:[18]})])):(b(),L($e,{key:3},{default:t(()=>[(b(!0),se(Te,null,Ge(re.value,M=>(b(),L(E,{key:M.product.id_product,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(de,{class:Xe(["variant-group-card h-100",{"border-error":q(M.variants)}]),elevation:"2"},{default:t(()=>[e(Ce,{class:"pa-4 pb-2"},{default:t(()=>[a("div",qn,[e(Se,{image:M.product.image_url,size:"48",class:"flex-shrink-0"},{default:t(()=>[M.product.image_url?ae("",!0):(b(),L(S,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"]),a("div",On,[a("h3",Ln,c(M.product.name),1),a("p",Nn," SKU: "+c(M.product.sku||"-"),1)]),e(pe,{color:V(M.variants),size:"small",variant:"tonal"},{default:t(()=>[f(c(M.variants.length)+" Variant ",1)]),_:2},1032,["color"])])]),_:2},1024),e(ze),e(fe,{class:"pa-4"},{default:t(()=>[e(kt,{class:"pa-0"},{default:t(()=>[(b(!0),se(Te,null,Ge(M.variants,(C,x)=>(b(),L(Je,{key:C.id_variant,class:Xe(["pa-2 rounded-lg variant-item",{"mb-2":x<M.variants.length-1}])},{prepend:t(()=>[e(Se,{size:"32",color:C.is_active?"success":"error",variant:"tonal"},{default:t(()=>[e(S,{icon:C.is_active?"mdi-check":"mdi-close",size:"16"},null,8,["icon"])]),_:2},1032,["color"])]),append:t(()=>[a("div",Jn,[e(Ee,{text:"Kelola Komposisi"},{activator:t(({props:ne})=>[e(K,he({ref_for:!0},ne,{icon:"mdi-chef-hat",size:"small",variant:"text",color:"primary",onClick:xe=>Z(C)}),null,16,["onClick"])]),_:2},1024),e(Ee,{text:"Hapus Variant"},{activator:t(({props:ne})=>[e(K,he({ref_for:!0},ne,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:xe=>k(C)}),null,16,["onClick"])]),_:2},1024)])]),default:t(()=>[e(nt,{class:"text-sm font-weight-medium"},{default:t(()=>[f(c(C.name),1)]),_:2},1024),e(it,null,{default:t(()=>[a("div",jn,[a("span",Wn,"SKU: "+c(C.sku),1),a("div",Gn,[a("span",Xn,c(Y(tt)(C.price||0)),1),C.composition_summary?(b(),L(pe,{key:0,color:B(C.composition_summary.stock_status),size:"x-small",variant:"tonal"},{default:t(()=>[f(c(h(C.composition_summary.stock_status)),1)]),_:2},1032,["color"])):ae("",!0)])])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:2},1024)]),_:2},1024),e(ze),e(Ke,{class:"pa-4"},{default:t(()=>[a("div",Yn,[a("div",null,[e(pe,{color:ue(M.variants).color,size:"small",variant:"tonal"},{default:t(()=>[e(S,{icon:ue(M.variants).icon,size:"14",class:"me-1"},null,8,["icon"]),f(" "+c(ue(M.variants).text),1)]),_:2},1032,["color"])]),a("div",Qn,[e(Ee,{text:"Setting HPP Produk"},{activator:t(({props:C})=>[e(K,he({ref_for:!0},C,{icon:"mdi-calculator-variant",size:"small",variant:"text",color:"warning",onClick:x=>g(M.variants[0])}),null,16,["onClick"])]),_:2},1024),e(Ee,{text:"Tambah Variant"},{activator:t(({props:C})=>[e(K,he({ref_for:!0},C,{icon:"mdi-plus",size:"small",variant:"text",color:"primary",onClick:$}),null,16)]),_:1}),e(Ee,{text:"Pengaturan Produk (Coming Soon)"},{activator:t(({props:C})=>[e(K,he({ref_for:!0},C,{icon:"mdi-cog",size:"small",variant:"text",color:"secondary",disabled:""}),null,16)]),_:1})])])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})),e(Dn,{modelValue:r.value,"onUpdate:modelValue":u[7]||(u[7]=M=>r.value=M),variant:m.value,onSave:ve},null,8,["modelValue","variant"]),e(Qt,{modelValue:s.value,"onUpdate:modelValue":u[8]||(u[8]=M=>s.value=M),"variant-id":(n=m.value)==null?void 0:n.id_variant,"variant-name":(i=m.value)==null?void 0:i.name,onHppUpdated:R,onPriceUpdated:R},null,8,["modelValue","variant-id","variant-name"]),e(En,{modelValue:G.value,"onUpdate:modelValue":u[9]||(u[9]=M=>G.value=M),onSave:Q},null,8,["modelValue"]),e(At,{modelValue:p.value,"onUpdate:modelValue":u[10]||(u[10]=M=>p.value=M),title:"Konfirmasi Hapus Variant","item-name":(A=m.value)==null?void 0:A.name,loading:P.value,"confirm-text":"Hapus Variant",onConfirm:X,onCancel:u[11]||(u[11]=M=>p.value=!1)},null,8,["modelValue","item-name","loading"])])}}}),zt=Ne(Zn,[["__scopeId","data-v-38a8b956"]]),ei={class:"product-management"},ti={class:"d-flex justify-space-between align-center mb-6"},ai={class:"d-flex gap-3 align-center"},li={key:0,class:"d-flex gap-2"},oi={class:"d-flex align-center"},si=Re({__name:"products-management",setup(l){Ot();const{productsList:F,categories:y,loading:d,saveLoading:z,deleteLoading:p,toggleLoading:P,stats:m,dialog:r,deleteDialog:s,editMode:G,selectedProduct:_,selectedProducts:N,currentPage:oe,totalItems:T,itemsPerPage:I,filters:re,errorMessage:ge,successMessage:R,modalErrorMessage:Z,formData:g,selectedImage:k,imagePreview:$,canCreateEdit:X,hasSelectedProducts:B,fetchProductsList:h,fetchCategories:V,fetchStats:q,saveProduct:ue,deleteProduct:ye,bulkDeleteProducts:ve,toggleActiveStatus:Q,toggleFeaturedStatus:v,openCreateDialog:u,openEditDialog:n,openDeleteDialog:i,closeDialog:A,handleImageUpload:M,clearModalError:C,onPageChange:x}=Lt(),{dialog:ne,editMode:xe,formData:Ie,availableItems:_e,saveLoading:te,modalErrorMessage:be,openCreateDialog:we,closeDialog:O,saveRecipe:o,clearModalError:U,fetchAvailableItems:j}=Fa(),{productItemsList:J,loading:D,fetchProductItemsForComposition:ee}=ta(),W=H("products"),w=H(!1),ie=H(null),ce=H(!1),De=H(null),Ae=async()=>{await ye()},Me=async()=>{await ve()},Fe=Ue=>{const le=Ue.id_product||Ue.id;we(le)},Ye=async Ue=>{ie.value=Ue;try{await ee({page:1,per_page:50,critical_only:!1})}catch{}w.value=!0},dt=Ue=>{De.value=Ue,ce.value=!0},ct=Ue=>{if(!Ue)return[];const le=Ue.id_product||Ue.id;return J.value.filter(lt=>{var ke;return((ke=lt.product)==null?void 0:ke.id_product)===le||lt.product_id===le})||[]},mt=Ue=>{Object.assign(re,Ue),h()},Zt=Ue=>{re.search=Ue,h()},ea=()=>{k.value=null,$.value&&($.value="")};return Pe(W,async Ue=>{Ue==="compositions"&&await ee({page:1,per_page:15,critical_only:!1})},{immediate:!1}),ut(()=>{h(),V(),q(),j()}),(Ue,le)=>{var lt;return b(),se("div",ei,[a("div",ti,[le[19]||(le[19]=a("div",null,[a("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Produk & Komposisi"),a("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola produk dan komposisi untuk coffee shop Anda")],-1)),a("div",ai,[Y(B)&&W.value==="products"?(b(),se("div",li,[e(pe,{color:"primary",size:"small"},{default:t(()=>[f(c(Y(N).length)+" dipilih ",1)]),_:1}),e(K,{color:"error",variant:"outlined",size:"small","prepend-icon":"mdi-delete",onClick:Me},{default:t(()=>le[17]||(le[17]=[f(" Hapus Terpilih ")])),_:1,__:[17]})])):ae("",!0),Y(X)&&W.value==="products"?(b(),L(K,{key:1,color:"primary","prepend-icon":"mdi-plus",class:"coffee-btn",onClick:Y(u)},{default:t(()=>le[18]||(le[18]=[f(" Tambah Produk ")])),_:1,__:[18]},8,["onClick"])):ae("",!0)])]),e(hl,{modelValue:W.value,"onUpdate:modelValue":le[0]||(le[0]=ke=>W.value=ke),class:"mb-6"},{default:t(()=>[e(ft,{value:"products"},{default:t(()=>[e(S,{icon:"mdi-coffee",class:"me-2"}),le[20]||(le[20]=f(" Produk "))]),_:1,__:[20]}),e(ft,{value:"compositions"},{default:t(()=>[e(S,{icon:"mdi-chef-hat",class:"me-2"}),le[21]||(le[21]=f(" Komposisi Produk "))]),_:1,__:[21]}),e(ft,{value:"variants"},{default:t(()=>[e(S,{icon:"mdi-tune-variant",class:"me-2"}),le[22]||(le[22]=f(" Variant Produk "))]),_:1,__:[22]})]),_:1},8,["modelValue"]),Y(ge)?(b(),L(He,{key:0,type:"error",variant:"outlined",class:"mb-4",text:Y(ge),closable:"","onClick:close":le[1]||(le[1]=ke=>ge.value="")},null,8,["text"])):ae("",!0),Y(R)?(b(),L(He,{key:1,type:"success",variant:"outlined",class:"mb-4",text:Y(R),closable:"","onClick:close":le[2]||(le[2]=ke=>R.value="")},null,8,["text"])):ae("",!0),e(xt,{modelValue:W.value,"onUpdate:modelValue":le[4]||(le[4]=ke=>W.value=ke)},{default:t(()=>[e(st,{value:"products"},{default:t(()=>[e(ks,{stats:Y(m)},null,8,["stats"]),e(es,{filters:Y(re),"onUpdate:filters":mt,onSearch:Zt},null,8,["filters"]),e(Es,{products:Y(F),loading:Y(d),"current-page":Y(oe),"total-items":Y(T),"items-per-page":Y(I),"selected-products":Y(N),"toggle-loading":Y(P),"onUpdate:page":Y(x),onAddProduct:Y(u),onEditProduct:Y(n),onOpenRecipeDialog:Fe,onOpenCompositionDialog:Ye,onOpenVariantDialog:dt,onDeleteProduct:Y(i),onToggleActive:Y(Q),onToggleFeatured:Y(v),"onUpdate:selectedProducts":le[3]||(le[3]=ke=>N.value=ke)},null,8,["products","loading","current-page","total-items","items-per-page","selected-products","toggle-loading","onUpdate:page","onAddProduct","onEditProduct","onDeleteProduct","onToggleActive","onToggleFeatured"])]),_:1}),e(st,{value:"compositions"},{default:t(()=>[e(ho,{"product-items":Y(J),loading:Y(D),onRefresh:Y(ee)},null,8,["product-items","loading","onRefresh"])]),_:1}),e(st,{value:"variants"},{default:t(()=>[e(zt,{loading:Y(d),onRefresh:Y(h)},null,8,["loading","onRefresh"])]),_:1})]),_:1},8,["modelValue"]),e(Xo,{modelValue:Y(r),"onUpdate:modelValue":[le[5]||(le[5]=ke=>yt(r)?r.value=ke:null),le[6]||(le[6]=ke=>r.value=ke)],"edit-mode":Y(G),"form-data":Y(g),categories:Y(y),loading:Y(z),"error-message":Y(Z),"selected-image":Y(k)?[Y(k)]:[],"image-preview":Y($),onClose:Y(A),onSubmit:Y(ue),onImageChange:Y(M),onRemoveImage:ea,onClearError:Y(C),onUpdateForm:le[7]||(le[7]=(ke,St)=>Y(g)[ke]=St)},null,8,["modelValue","edit-mode","form-data","categories","loading","error-message","selected-image","image-preview","onClose","onSubmit","onImageChange","onClearError"]),e(Ka,{modelValue:Y(ne),"onUpdate:modelValue":[le[8]||(le[8]=ke=>yt(ne)?ne.value=ke:null),le[9]||(le[9]=ke=>ne.value=ke)],"edit-mode":Y(xe),"form-data":Y(Ie),"available-items":Y(_e),loading:Y(te),"error-message":Y(be),onClose:Y(O),onSave:Y(o),onClearError:Y(U)},null,8,["modelValue","edit-mode","form-data","available-items","loading","error-message","onClose","onSave","onClearError"]),e(At,{modelValue:Y(s),"onUpdate:modelValue":le[10]||(le[10]=ke=>yt(s)?s.value=ke:null),title:"Konfirmasi Hapus Produk","item-name":(lt=Y(_))==null?void 0:lt.name,loading:Y(p),"confirm-text":"Hapus Produk",onConfirm:Ae,onCancel:le[11]||(le[11]=ke=>s.value=!1)},null,8,["modelValue","item-name","loading"]),e(Yt,{modelValue:w.value,"onUpdate:modelValue":le[12]||(le[12]=ke=>w.value=ke),product:ie.value,items:ct(ie.value),onSave:le[13]||(le[13]=()=>{Y(h)(),w.value=!1}),onRefresh:Y(h)},null,8,["modelValue","product","items","onRefresh"]),e(Oe,{modelValue:ce.value,"onUpdate:modelValue":le[16]||(le[16]=ke=>ce.value=ke),"max-width":"1400px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ce,{class:"d-flex justify-between align-center"},{default:t(()=>{var ke;return[a("div",oi,[e(S,{icon:"tabler-versions",class:"me-2"}),f(" Kelola Variant - "+c((ke=De.value)==null?void 0:ke.name),1)]),e(K,{icon:"tabler-x",variant:"text",onClick:le[14]||(le[14]=St=>ce.value=!1)})]}),_:1}),e(ze),e(fe,{class:"pa-0"},{default:t(()=>[De.value?(b(),L(zt,{key:0,product:De.value},null,8,["product"])):ae("",!0)]),_:1}),e(ze),e(Ke,null,{default:t(()=>[e(Le),e(K,{color:"grey-darken-1",variant:"outlined",onClick:le[15]||(le[15]=ke=>ce.value=!1)},{default:t(()=>[e(S,{icon:"mdi-close",class:"me-1"}),le[23]||(le[23]=f(" Tutup "))]),_:1,__:[23]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Yi=Ne(si,[["__scopeId","data-v-8c8b1097"]]);export{Yi as default};
