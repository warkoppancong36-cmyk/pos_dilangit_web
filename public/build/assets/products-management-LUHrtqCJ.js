import{D as Et}from"./DeleteConfirmationDialog-BgNuC5VH.js";import{f as st}from"./formatters-BD6tdLx_.js";import{P as pt,u as ta}from"./useProductItems-CjZ44uQk.js";import{I as aa}from"./ItemsApi-Cgru8AC3.js";import{H as la,u as oa}from"./HPPBreakdownDialog-BPK0F-Gx.js";import{V as Ge}from"./VDialog-CI-OtAdR.js";import{V as de,b as Ie,c as Ne}from"./VCard-B46mwe6I.js";import{cq as Ht,a8 as lt,a9 as ot,as as na,aF as sa,af as Bt,bT as ia,r as H,V as ce,aG as Ze,w as Ce,W as Qe,b as e,a0 as K,aa as nt,ak as ra,ab as Ft,ac as Kt,H as Rt,ba as ua,L as da,N as qt,bZ as ca,b_ as ma,b9 as _t,aJ as xt,I as va,ag as Ot,aM as kt,bj as fa,bt as Tt,p as we,be as Pt,cr as pa,c8 as Ut,bh as ga,F as Ae,X as S,cp as _a,c9 as ka,aI as ya,s as v,cs as ba,a$ as ha,ad as xa,aH as wa,b3 as Va,b5 as Pa,d as Le,D as ft,c as se,f as t,e as a,t as c,g as N,l as te,m as X,i as et,v as tt,o as b,aw as Nt,ax as wt,$ as Ct,j as Lt,ct as Ca,aA as We,ap as Sa,aq as Ia,a5 as ht}from"./main-BJG8mpGz.js";import{V as fe}from"./VCardText-CklbQ-AC.js";import{V as Te}from"./VAvatar-DqLZBU2d.js";import{V as pe,m as $a,b as zt}from"./VChip-CmJcIuPZ.js";import{V as Ue,a as E}from"./VRow-CCJ1T0oW.js";import{V as St}from"./VAutocomplete-aC7FsIQD.js";import{u as Da,e as Ta,t as ut,V as bt,a as at,b as ct,d as mt}from"./VList-rRdMaQCK.js";import{u as Ua,V as Pe,m as za}from"./VTextField-D_VHOyBk.js";import{V as vt}from"./VSwitch-CvhNeDiV.js";import{a as yt,V as Re}from"./VAlert-DiIYiPpR.js";import{V as Xe}from"./VSpacer-VMjlQp_B.js";import{V as it}from"./VSnackbar-CulZeZSJ.js";import{_ as Je}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Aa,m as Ma,a as Ea,V as Oe}from"./VSelect-BSaLI6Ow.js";import{V as Ha}from"./VCheckbox-Cuy_H63A.js";import{V as Ee}from"./VDivider-C67JGP98.js";import{V as Ba}from"./VContainer-DVai80zs.js";import{a as jt,u as Fa,P as Ka}from"./useProducts-B5zwZCyC.js";import{V as It}from"./VForm-BwTKfqme.js";import{V as At}from"./VTextarea-ZIGDOpX-.js";import{V as Ke}from"./VTooltip-W5gvZDfm.js";import{M as Ra,m as qa,V as Oa}from"./VImg-Be5kvLAw.js";import{V as Na,u as La}from"./useCategories-BE-l9HV0.js";import{u as ja,m as Wa,h as Ga}from"./filter-Ctj4SWlI.js";import{f as Wt,a as Xa,s as Ja}from"./forwardRefs-B931MWyl.js";import{V as Ya}from"./VMenu-Bux0U967.js";import{V as Qa}from"./VCheckboxBtn-B5-5Z5Eh.js";import{V as Za}from"./VDataTableServer-CbhtQjfY.js";import{V as el}from"./VSkeletonLoader-DWMOYw9h.js";import{V as tl}from"./VDataTable-BUt1YD7T.js";import{c as al,d as ll,u as ol}from"./VOverlay-Bh9tgczb.js";import"./ProductsApi-Do8tFHk1.js";import"./api-DawjRq9f.js";import"./index-D-EbNoF1.js";/* empty css              */import"./helpers-B-vn2Qqf.js";import"./CategoriesApi-B_5Hq9Gj.js";import"./VTable-D8AqnKO6.js";const nl=l=>{const{touchstartX:F,touchendX:h,touchstartY:d,touchendY:U}=l,p=.5,V=16;l.offsetX=h-F,l.offsetY=U-d,Math.abs(l.offsetY)<p*Math.abs(l.offsetX)&&(l.left&&h<F-V&&l.left(l),l.right&&h>F+V&&l.right(l)),Math.abs(l.offsetX)<p*Math.abs(l.offsetY)&&(l.up&&U<d-V&&l.up(l),l.down&&U>d+V&&l.down(l))};function sl(l,F){var d;const h=l.changedTouches[0];F.touchstartX=h.clientX,F.touchstartY=h.clientY,(d=F.start)==null||d.call(F,{originalEvent:l,...F})}function il(l,F){var d;const h=l.changedTouches[0];F.touchendX=h.clientX,F.touchendY=h.clientY,(d=F.end)==null||d.call(F,{originalEvent:l,...F}),nl(F)}function rl(l,F){var d;const h=l.changedTouches[0];F.touchmoveX=h.clientX,F.touchmoveY=h.clientY,(d=F.move)==null||d.call(F,{originalEvent:l,...F})}function ul(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const F={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:l.left,right:l.right,up:l.up,down:l.down,start:l.start,move:l.move,end:l.end};return{touchstart:h=>sl(h,F),touchend:h=>il(h,F),touchmove:h=>rl(h,F)}}function dl(l,F){var m;const h=F.value,d=h!=null&&h.parent?l.parentElement:l,U=(h==null?void 0:h.options)??{passive:!0},p=(m=F.instance)==null?void 0:m.$.uid;if(!d||!p)return;const V=ul(F.value);d._touchHandlers=d._touchHandlers??Object.create(null),d._touchHandlers[p]=V,Ht(V).forEach(r=>{d.addEventListener(r,V[r],U)})}function cl(l,F){var p,V;const h=(p=F.value)!=null&&p.parent?l.parentElement:l,d=(V=F.instance)==null?void 0:V.$.uid;if(!(h!=null&&h._touchHandlers)||!d)return;const U=h._touchHandlers[d];Ht(U).forEach(m=>{h.removeEventListener(m,U[m])}),delete h._touchHandlers[d]}const Gt={mounted:dl,unmounted:cl},Xt=Symbol.for("vuetify:v-window"),Jt=Symbol.for("vuetify:v-window-group"),Yt=ot({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:l=>typeof l=="boolean"||l==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Kt(),...Ft(),...ra()},"VWindow"),Vt=lt()({name:"VWindow",directives:{Touch:Gt},props:Yt(),emits:{"update:modelValue":l=>!0},setup(l,F){let{slots:h}=F;const{themeClasses:d}=na(l),{isRtl:U}=sa(),{t:p}=Bt(),V=ia(l,Jt),m=H(),r=ce(()=>U.value?!l.reverse:l.reverse),n=Ze(!1),W=ce(()=>{const g=l.direction==="vertical"?"y":"x",I=(r.value?!n.value:n.value)?"-reverse":"";return`v-window-${g}${I}-transition`}),_=Ze(0),L=H(void 0),le=ce(()=>V.items.value.findIndex(g=>V.selected.value.includes(g.id)));Ce(le,(g,k)=>{const I=V.items.value.length,G=I-1;I<=2?n.value=g<k:g===G&&k===0?n.value=!0:g===0&&k===G?n.value=!1:n.value=g<k}),da(Xt,{transition:W,isReversed:n,transitionCount:_,transitionHeight:L,rootRef:m});const D=Qe(()=>l.continuous||le.value!==0),C=Qe(()=>l.continuous||le.value!==V.items.value.length-1);function ie(){D.value&&V.prev()}function ge(){C.value&&V.next()}const q=ce(()=>{const g=[],k={icon:U.value?l.nextIcon:l.prevIcon,class:`v-window__${r.value?"right":"left"}`,onClick:V.prev,"aria-label":p("$vuetify.carousel.prev")};g.push(D.value?h.prev?h.prev({props:k}):e(K,k,null):e("div",null,null));const I={icon:U.value?l.prevIcon:l.nextIcon,class:`v-window__${r.value?"left":"right"}`,onClick:V.next,"aria-label":p("$vuetify.carousel.next")};return g.push(C.value?h.next?h.next({props:I}):e(K,I,null):e("div",null,null)),g}),Q=ce(()=>l.touch===!1?l.touch:{...{left:()=>{r.value?ie():ge()},right:()=>{r.value?ge():ie()},start:k=>{let{originalEvent:I}=k;I.stopPropagation()}},...l.touch===!0?{}:l.touch});return nt(()=>Rt(e(l.tag,{ref:m,class:["v-window",{"v-window--show-arrows-on-hover":l.showArrows==="hover"},d.value,l.class],style:l.style},{default:()=>{var g,k;return[e("div",{class:"v-window__container",style:{height:L.value}},[(g=h.default)==null?void 0:g.call(h,{group:V}),l.showArrows!==!1&&e("div",{class:"v-window__controls"},[q.value])]),(k=h.additional)==null?void 0:k.call(h,{group:V})]}}),[[ua("touch"),Q.value]])),{group:V}}}),Qt=ot({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Kt(),...ma(),...ll()},"VWindowItem"),dt=lt()({name:"VWindowItem",directives:{Touch:Gt},props:Qt(),emits:{"group:selected":l=>!0},setup(l,F){let{slots:h}=F;const d=qt(Xt),U=ca(l,Jt),{isBooted:p}=Da();if(!d||!U)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const V=Ze(!1),m=ce(()=>p.value&&(d.isReversed.value?l.reverseTransition!==!1:l.transition!==!1));function r(){!V.value||!d||(V.value=!1,d.transitionCount.value>0&&(d.transitionCount.value-=1,d.transitionCount.value===0&&(d.transitionHeight.value=void 0)))}function n(){var D;V.value||!d||(V.value=!0,d.transitionCount.value===0&&(d.transitionHeight.value=xt((D=d.rootRef.value)==null?void 0:D.clientHeight)),d.transitionCount.value+=1)}function W(){r()}function _(D){V.value&&_t(()=>{!m.value||!V.value||!d||(d.transitionHeight.value=xt(D.clientHeight))})}const L=ce(()=>{const D=d.isReversed.value?l.reverseTransition:l.transition;return m.value?{name:typeof D!="string"?d.transition.value:D,onBeforeEnter:n,onAfterEnter:r,onEnterCancelled:W,onBeforeLeave:n,onAfterLeave:r,onLeaveCancelled:W,onEnter:_}:!1}),{hasContent:le}=al(l,U.isSelected);return nt(()=>e(Ra,{transition:L.value,disabled:!p.value},{default:()=>{var D;return[Rt(e("div",{class:["v-window-item",U.selectedClass.value,l.class],style:l.style},[le.value&&((D=h.default)==null?void 0:D.call(h))]),[[va,U.isSelected.value]])]}})),{groupItem:U}}}),ml=ot({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:{type:Boolean,default:!0},delimiters:Array,...Wa({filterKeys:["title"]}),...Ma({hideNoData:!0,returnObject:!0}),...Pt(za({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...qa({transition:!1})},"VCombobox"),vl=lt()({name:"VCombobox",props:ml(),emits:{"update:focused":l=>!0,"update:modelValue":l=>!0,"update:search":l=>!0,"update:menu":l=>!0},setup(l,F){var M;let{emit:h,slots:d}=F;const{t:U}=Bt(),p=H(),V=Ze(!1),m=Ze(!0),r=Ze(!1),n=H(),W=H(),_=Ze(-1);let L=!1;const{items:le,transformIn:D,transformOut:C}=Ta(l),{textColorClasses:ie,textColorStyles:ge}=Ot(()=>{var o;return(o=p.value)==null?void 0:o.color}),q=kt(l,"modelValue",[],o=>D(fa(o)),o=>{const T=C(o);return l.multiple?T:T[0]??null}),Q=Ua(l),g=ce(()=>!!(l.chips||d.chip)),k=ce(()=>g.value||!!d.selection),I=Ze(!l.multiple&&!k.value?((M=q.value[0])==null?void 0:M.title)??"":""),G=ce({get:()=>I.value,set:o=>{var T;if(I.value=o??"",!l.multiple&&!k.value&&(q.value=[ut(l,o)]),o&&l.multiple&&((T=l.delimiters)!=null&&T.length)){const R=o.split(new RegExp(`(?:${l.delimiters.join("|")})+`));R.length>1&&(R.forEach(J=>{J=J.trim(),J&&xe(ut(l,J))}),I.value="")}o||(_.value=-1),m.value=!o}}),j=ce(()=>typeof l.counterValue=="function"?l.counterValue(q.value):typeof l.counterValue=="number"?l.counterValue:l.multiple?q.value.length:G.value.length),{filteredItems:y,getMatches:w}=ja(l,le,()=>m.value?"":G.value),O=ce(()=>l.hideSelected?y.value.filter(o=>!q.value.some(T=>T.value===o.value)):y.value),re=ce(()=>l.hideNoData&&!O.value.length||Q.isReadonly.value||Q.isDisabled.value),he=kt(l,"menu"),me=ce({get:()=>he.value,set:o=>{var T;he.value&&!o&&((T=n.value)!=null&&T.Î¨openChildren.size)||o&&re.value||(he.value=o)}}),Y=Qe(()=>me.value?l.closeText:l.openText);Ce(I,o=>{L?_t(()=>L=!1):V.value&&!me.value&&(me.value=!0),h("update:search",o)}),Ce(q,o=>{var T;!l.multiple&&!k.value&&(I.value=((T=o[0])==null?void 0:T.title)??"")});const f=ce(()=>q.value.map(o=>o.value)),u=ce(()=>{var T;return(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&G.value===((T=O.value[0])==null?void 0:T.title))&&O.value.length>0&&!m.value&&!r.value}),s=H(),i=Aa(s,p);function z(o){L=!0,l.openOnClear&&(me.value=!0)}function A(){re.value||(me.value=!0)}function ke(o){re.value||(V.value&&(o.preventDefault(),o.stopPropagation()),me.value=!me.value)}function B(o){var T;o.key!==" "&&Ut(o)&&((T=p.value)==null||T.focus())}function x(o){var J,$,Z,ne;if(pa(o)||Q.isReadonly.value)return;const T=(J=p.value)==null?void 0:J.selectionStart,R=q.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(o.key)&&o.preventDefault(),["Enter","ArrowDown"].includes(o.key)&&(me.value=!0),["Escape"].includes(o.key)&&(me.value=!1),["Enter","Escape","Tab"].includes(o.key)&&(u.value&&["Enter","Tab"].includes(o.key)&&!q.value.some(P=>{let{value:ve}=P;return ve===O.value[0].value})&&xe(y.value[0]),m.value=!0),o.key==="ArrowDown"&&u.value&&(($=s.value)==null||$.focus("next")),o.key==="Enter"&&G.value&&(xe(ut(l,G.value)),k.value&&(I.value="")),["Backspace","Delete"].includes(o.key)){if(!l.multiple&&k.value&&q.value.length>0&&!G.value)return xe(q.value[0],!1);if(~_.value){o.preventDefault();const P=_.value;xe(q.value[_.value],!1),_.value=P>=R-1?R-2:P}else o.key==="Backspace"&&!G.value&&(_.value=R-1);return}if(l.multiple)if(o.key==="ArrowLeft"){if(_.value<0&&T&&T>0)return;const P=_.value>-1?_.value-1:R-1;q.value[P]?_.value=P:(_.value=-1,(Z=p.value)==null||Z.setSelectionRange(G.value.length,G.value.length))}else if(o.key==="ArrowRight"){if(_.value<0)return;const P=_.value+1;q.value[P]?_.value=P:(_.value=-1,(ne=p.value)==null||ne.setSelectionRange(0,0))}else~_.value&&Ut(o)&&(_.value=-1)}function ue(){var o;l.eager&&((o=W.value)==null||o.calculateVisibleItems())}function $e(){var o;V.value&&(m.value=!0,(o=p.value)==null||o.focus())}function xe(o){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!o||o.props.disabled))if(l.multiple){const R=q.value.findIndex($=>(l.valueComparator||Tt)($.value,o.value)),J=T??!~R;if(~R){const $=J?[...q.value,o]:[...q.value];$.splice(R,1),q.value=$}else J&&(q.value=[...q.value,o]);l.clearOnSelect&&(G.value="")}else{const R=T!==!1;q.value=R?[o]:[],I.value=R&&!k.value?o.title:"",_t(()=>{me.value=!1,m.value=!0})}}function Ve(o){V.value=!0,setTimeout(()=>{r.value=!0})}function ee(o){r.value=!1}function ye(o){(o==null||o===""&&!l.multiple&&!k.value)&&(q.value=[])}return Ce(V,(o,T)=>{if(!(o||o===T)&&(_.value=-1,me.value=!1,G.value)){if(l.multiple){xe(ut(l,G.value));return}if(!k.value)return;q.value.some(R=>{let{title:J}=R;return J===G.value})?I.value="":xe(ut(l,G.value))}}),Ce(me,()=>{if(!l.hideSelected&&me.value&&q.value.length){const o=O.value.findIndex(T=>q.value.some(R=>(l.valueComparator||Tt)(R.value,T.value)));ga&&window.requestAnimationFrame(()=>{var T;o>=0&&((T=W.value)==null||T.scrollToIndex(o))})}}),Ce(()=>l.items,(o,T)=>{me.value||V.value&&!T.length&&o.length&&(me.value=!0)}),nt(()=>{const o=!!(!l.hideNoData||O.value.length||d["prepend-item"]||d["append-item"]||d["no-data"]),T=q.value.length>0,R=Pe.filterProps(l);return e(Pe,we({ref:p},R,{modelValue:G.value,"onUpdate:modelValue":[J=>G.value=J,ye],focused:V.value,"onUpdate:focused":J=>V.value=J,validationValue:q.externalValue,counterValue:j.value,dirty:T,class:["v-combobox",{"v-combobox--active-menu":me.value,"v-combobox--chips":!!l.chips,"v-combobox--selection-slot":!!k.value,"v-combobox--selecting-index":_.value>-1,[`v-combobox--${l.multiple?"multiple":"single"}`]:!0},l.class],style:l.style,readonly:Q.isReadonly.value,placeholder:T?void 0:l.placeholder,"onClick:clear":z,"onMousedown:control":A,onKeydown:x}),{...d,default:()=>e(Ae,null,[e(Ya,we({ref:n,modelValue:me.value,"onUpdate:modelValue":J=>me.value=J,activator:"parent",contentClass:"v-combobox__content",disabled:re.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterEnter:ue,onAfterLeave:$e},l.menuProps),{default:()=>[o&&e(bt,we({ref:s,selected:f.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:J=>J.preventDefault(),onKeydown:B,onFocusin:Ve,onFocusout:ee,tabindex:"-1","aria-live":"polite",color:l.itemColor??l.color},i,l.listProps),{default:()=>{var J,$,Z;return[(J=d["prepend-item"])==null?void 0:J.call(d),!O.value.length&&!l.hideNoData&&((($=d["no-data"])==null?void 0:$.call(d))??e(at,{key:"no-data",title:U(l.noDataText)},null)),e(Ea,{ref:W,renderless:!0,items:O.value,itemKey:"value"},{default:ne=>{var He;let{item:P,index:ve,itemRef:_e}=ne;const ze=we(P.props,{ref:_e,key:P.value,active:u.value&&ve===0?!0:void 0,onClick:()=>xe(P,null)});return((He=d.item)==null?void 0:He.call(d,{item:P,index:ve,props:ze}))??e(at,we(ze,{role:"option"}),{prepend:Me=>{let{isSelected:Be}=Me;return e(Ae,null,[l.multiple&&!l.hideSelected?e(Qa,{key:P.value,modelValue:Be,ripple:!1,tabindex:"-1"},null):void 0,P.props.prependAvatar&&e(Te,{image:P.props.prependAvatar},null),P.props.prependIcon&&e(S,{icon:P.props.prependIcon},null)])},title:()=>{var Me;return m.value?P.title:Ga("v-combobox",P.title,(Me=w(P))==null?void 0:Me.title)}})}}),(Z=d["append-item"])==null?void 0:Z.call(d)]}})]}),q.value.map((J,$)=>{function Z(_e){_e.stopPropagation(),_e.preventDefault(),xe(J,!1)}const ne={"onClick:close":Z,onKeydown(_e){_e.key!=="Enter"&&_e.key!==" "||(_e.preventDefault(),_e.stopPropagation(),Z(_e))},onMousedown(_e){_e.preventDefault(),_e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},P=g.value?!!d.chip:!!d.selection,ve=P?ka(g.value?d.chip({item:J,index:$,props:ne}):d.selection({item:J,index:$})):void 0;if(!(P&&!ve))return e("div",{key:J.value,class:["v-combobox__selection",$===_.value&&["v-combobox__selection--selected",ie.value]],style:$===_.value?ge.value:{}},[g.value?d.chip?e(ya,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:J.title}}},{default:()=>[ve]}):e(pe,we({key:"chip",closable:l.closableChips,size:"small",text:J.title,disabled:J.props.disabled},ne),null):ve??e("span",{class:"v-combobox__selection-text"},[J.title,l.multiple&&$<q.value.length-1&&e("span",{class:"v-combobox__selection-comma"},[v(",")])])])})]),"append-inner":function(){var ne,P;for(var J=arguments.length,$=new Array(J),Z=0;Z<J;Z++)$[Z]=arguments[Z];return e(Ae,null,[(ne=d["append-inner"])==null?void 0:ne.call(d,...$),(!l.hideNoData||l.items.length)&&l.menuIcon?e(S,{class:"v-combobox__menu-icon",color:(P=p.value)==null?void 0:P.fieldIconColor,icon:l.menuIcon,onMousedown:ke,onClick:_a,"aria-label":U(Y.value),title:U(Y.value),tabindex:"-1"},null):void 0])}})}),Wt({isFocused:V,isPristine:m,menu:me,search:G,selectionIndex:_,filteredItems:y,select:xe},p)}}),$t=Symbol.for("vuetify:v-tabs"),fl=ot({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Pt(ba({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),gt=lt()({name:"VTab",props:fl(),setup(l,F){let{slots:h,attrs:d}=F;const{textColorClasses:U,textColorStyles:p}=Ot(()=>l.sliderColor),V=H(),m=H(),r=ce(()=>l.direction==="horizontal"),n=ce(()=>{var _,L;return((L=(_=V.value)==null?void 0:_.group)==null?void 0:L.isSelected.value)??!1});function W(_){var le,D;let{value:L}=_;if(L){const C=(D=(le=V.value)==null?void 0:le.$el.parentElement)==null?void 0:D.querySelector(".v-tab--selected .v-tab__slider"),ie=m.value;if(!C||!ie)return;const ge=getComputedStyle(C).color,q=C.getBoundingClientRect(),Q=ie.getBoundingClientRect(),g=r.value?"x":"y",k=r.value?"X":"Y",I=r.value?"right":"bottom",G=r.value?"width":"height",j=q[g],y=Q[g],w=j>y?q[I]-Q[I]:q[g]-Q[g],O=Math.sign(w)>0?r.value?"right":"bottom":Math.sign(w)<0?r.value?"left":"top":"center",he=(Math.abs(w)+(Math.sign(w)<0?q[G]:Q[G]))/Math.max(q[G],Q[G])||0,me=q[G]/Q[G]||0,Y=1.5;Xa(ie,{backgroundColor:[ge,"currentcolor"],transform:[`translate${k}(${w}px) scale${k}(${me})`,`translate${k}(${w/Y}px) scale${k}(${(he-1)/Y+1})`,"none"],transformOrigin:Array(3).fill(O)},{duration:225,easing:Ja})}}return nt(()=>{const _=K.filterProps(l);return e(K,we({symbol:$t,ref:V,class:["v-tab",l.class],style:l.style,tabindex:n.value?0:-1,role:"tab","aria-selected":String(n.value),active:!1},_,d,{block:l.fixed,maxWidth:l.fixed?300:void 0,"onGroup:selected":W}),{...h,default:()=>{var L;return e(Ae,null,[((L=h.default)==null?void 0:L.call(h))??l.text,!l.hideSlider&&e("div",{ref:m,class:["v-tab__slider",U.value],style:p.value},null)])}})}),Wt({},V)}}),pl=ot({...Pt(Yt(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),gl=lt()({name:"VTabsWindow",props:pl(),emits:{"update:modelValue":l=>!0},setup(l,F){let{slots:h}=F;const d=qt($t,null),U=kt(l,"modelValue"),p=ce({get(){var V;return U.value!=null||!d?U.value:(V=d.items.value.find(m=>d.selected.value.includes(m.id)))==null?void 0:V.value},set(V){U.value=V}});return nt(()=>{const V=Vt.filterProps(l);return e(Vt,we({_as:"VTabsWindow"},V,{modelValue:p.value,"onUpdate:modelValue":m=>p.value=m,class:["v-tabs-window",l.class],style:l.style,mandatory:!1,touch:!1}),h)}),{}}}),_l=ot({...Qt()},"VTabsWindowItem"),kl=lt()({name:"VTabsWindowItem",props:_l(),setup(l,F){let{slots:h}=F;return nt(()=>{const d=dt.filterProps(l);return e(dt,we({_as:"VTabsWindowItem"},d,{class:["v-tabs-window-item",l.class],style:l.style}),h)}),{}}});function yl(l){return l?l.map(F=>Pa(F)?F:{text:F,value:F}):[]}const bl=ot({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...$a({mandatory:"force",selectedClass:"v-tab-item--selected"}),...Va(),...Ft()},"VTabs"),hl=lt()({name:"VTabs",props:bl(),emits:{"update:modelValue":l=>!0},setup(l,F){let{attrs:h,slots:d}=F;const U=kt(l,"modelValue"),p=ce(()=>yl(l.items)),{densityClasses:V}=ha(l),{backgroundColorClasses:m,backgroundColorStyles:r}=xa(()=>l.bgColor),{scopeId:n}=ol();return wa({VTab:{color:Qe(()=>l.color),direction:Qe(()=>l.direction),stacked:Qe(()=>l.stacked),fixed:Qe(()=>l.fixedTabs),sliderColor:Qe(()=>l.sliderColor),hideSlider:Qe(()=>l.hideSlider)}}),nt(()=>{const W=zt.filterProps(l),_=!!(d.window||l.items.length>0);return e(Ae,null,[e(zt,we(W,{modelValue:U.value,"onUpdate:modelValue":L=>U.value=L,class:["v-tabs",`v-tabs--${l.direction}`,`v-tabs--align-tabs-${l.alignTabs}`,{"v-tabs--fixed-tabs":l.fixedTabs,"v-tabs--grow":l.grow,"v-tabs--stacked":l.stacked},V.value,m.value,l.class],style:[{"--v-tabs-height":xt(l.height)},r.value,l.style],role:"tablist",symbol:$t},n,h),{default:()=>{var L;return[((L=d.default)==null?void 0:L.call(d))??p.value.map(le=>{var D;return((D=d.tab)==null?void 0:D.call(d,{item:le}))??e(gt,we(le,{key:le.text,value:le.value}),{default:d[`tab.${le.value}`]?()=>{var C;return(C=d[`tab.${le.value}`])==null?void 0:C.call(d,{item:le})}:void 0})})]}}),_&&e(gl,we({modelValue:U.value,"onUpdate:modelValue":L=>U.value=L,key:"tabs-window"},n),{default:()=>{var L;return[p.value.map(le=>{var D;return((D=d.item)==null?void 0:D.call(d,{item:le}))??e(kl,{value:le.value},{default:()=>{var C;return(C=d[`item.${le.value}`])==null?void 0:C.call(d,{item:le})}})}),(L=d.window)==null?void 0:L.call(d)]}})])}),{}}}),xl={class:"d-flex align-center gap-3"},wl={class:"text-body-2 ma-0 opacity-90"},Vl={class:"d-flex align-center gap-4"},Pl={class:"flex-grow-1"},Cl={class:"text-h6 font-weight-bold mb-1"},Sl={class:"text-body-2 text-medium-emphasis mb-1"},Il={class:"text-body-2 text-medium-emphasis mb-0"},$l={class:"d-flex align-center justify-space-between w-100"},Dl={class:"d-flex align-center"},Tl={key:0,class:"text-warning"},Ul={key:1},zl={key:0,class:"text-center pa-8"},Al={class:"d-flex align-center gap-4 mt-1"},Ml={key:1,class:"text-primary"},El={class:"d-flex gap-2"},Hl=Le({__name:"ProductCompositionDialog",props:{modelValue:{type:Boolean},product:{},items:{}},emits:["update:modelValue","save","refresh"],setup(l,{emit:F}){const h=l,d=F,U=ce({get:()=>h.modelValue,set:B=>d("update:modelValue",B)}),p=H(!1),V=H([]),m=H(!1),r=H(!1),n=H(""),W=H(""),_=H(!1),L=H(-1),le=H(!1),D=H({itemId:null,quantity:1,unit:"pcs",isCritical:!1}),C=H([]),ie=H(!1),ge=H([]),q=async()=>{var B;if(h.product)try{const x=h.product.id_product||h.product.id;console.log("ðŸ”„ Fetching composition for product ID:",x);const ue=await pt.getAll({product_id:x,page:1,per_page:1e5});ue.success&&((B=ue.data)!=null&&B.data)&&(V.value=ue.data.data,ge.value=JSON.parse(JSON.stringify(ue.data.data)),console.log("âœ… Initial composition loaded:",ge.value.length,"items"))}catch(x){console.error("Error fetching product composition:",x)}},Q=async()=>{var B;ie.value=!0;try{const x=await aa.getAll({page:1,per_page:1e5,active:!0});x.success&&((B=x.data)!=null&&B.data)&&(C.value=x.data.data.map(ue=>{var $e,xe,Ve;return{id:(($e=ue.id_item)==null?void 0:$e.toString())||((xe=ue.id)==null?void 0:xe.toString()),name:ue.name,current_stock:((Ve=ue.inventory)==null?void 0:Ve.current_stock)||0,unit:ue.unit||"pcs"}}))}catch(x){console.error("Error fetching available items:",x),C.value=[]}finally{ie.value=!1}},g=ce(()=>D.value.itemId&&D.value.quantity>0&&D.value.unit.trim().length>0),k=ce(()=>{if(!D.value.itemId)return null;const B=C.value.find(x=>x.id===D.value.itemId);return(B==null?void 0:B.unit)||null}),I=ce(()=>{if(!D.value.itemId)return null;const B=C.value.find(x=>x.id===D.value.itemId);return B?y(B):null}),G=ce(()=>I.value!==null&&I.value<=0),j=ce(()=>Array.isArray(C.value)?C.value:[]),y=B=>B.current_stock||B.stock||0,w=()=>ie.value?"Memuat items...":!C.value||C.value.length===0?"Tidak ada item tersedia":"Tidak ada item yang ditemukan",O=B=>{const x=y(B);return x>50?"success":x>20?"warning":x>0?"error":"grey"},re=B=>{const x=y(B);return x>50?"Aman":x>20?"Rendah":x>0?"Kritis":"Habis"};Ce(()=>D.value.itemId,B=>{if(B){const x=C.value.find(ue=>ue.id===B);x!=null&&x.unit&&(D.value.unit=x.unit)}}),Ce(()=>h.items,B=>{B&&B.length>0,V.value=[...B]},{immediate:!0}),Ce(()=>h.modelValue,B=>{B&&h.product&&q()}),ft(()=>{Q()});const he=()=>{le.value=!0},me=()=>V.value.some(x=>{var ue;return((ue=x.item)==null?void 0:ue.inventory)&&x.item.inventory.current_stock<x.quantity_needed})?"error":"success",Y=()=>V.value.some(x=>{var ue;return((ue=x.item)==null?void 0:ue.inventory)&&x.item.inventory.current_stock<x.quantity_needed})?"Stok Kritis":"Stok Aman",f=()=>{if(!g.value)return;const B=C.value.find($e=>$e.id===D.value.itemId);if(!B)return;if(V.value.find($e=>{var xe;return((xe=$e.item)==null?void 0:xe.id)===B.id})){n.value=`Item "${B.name}" sudah ada dalam komposisi produk ini`,m.value=!0;return}const ue={id_product_item:`temp_${Date.now()}`,item:{id:String(B.id),name:B.name,inventory:{current_stock:B.current_stock||0}},quantity_needed:D.value.quantity,unit:D.value.unit,is_critical:D.value.isCritical};V.value.push(ue),i()},u=(B,x)=>{var xe;if(console.log("ðŸ” EditItem called with:",B),console.log("ðŸ” Item structure:",JSON.stringify(B,null,2)),C.value.length===0){console.warn("âš ï¸ Available items not loaded yet, fetching..."),Q().then(()=>{console.log("âœ… Available items loaded, retrying edit"),u(B,x)});return}_.value=!0,L.value=x;let ue=((xe=B.item)==null?void 0:xe.id)||null;ue!==null&&(ue=ue.toString()),console.log("ðŸŽ¯ Found itemId (converted to string):",ue),console.log("ðŸ” Available items for reference:",C.value.map(Ve=>({id:Ve.id,name:Ve.name}))),D.value={itemId:ue,quantity:parseFloat(B.quantity_needed.toString())||0,unit:B.unit,isCritical:B.is_critical},console.log("ðŸ“ Form data set for edit:",{original_quantity:B.quantity_needed,parsed_quantity:parseFloat(B.quantity_needed.toString()),form_data:D.value});const $e=C.value.find(Ve=>Ve.id===ue);if($e)console.log("âœ… Item found in available items:",$e.name);else{console.warn("âš ï¸ Item ID not found in available items, trying alternative matching...");const Ve=C.value.find(ee=>{var ye;return ee.name===((ye=B.item)==null?void 0:ye.name)});Ve?(console.log("âœ… Found item by name matching, using ID:",Ve.id),D.value.itemId=Ve.id):console.error("âŒ Could not find item in available items by ID or name")}},s=()=>{if(!g.value||L.value===-1)return;const B=C.value.find(x=>x.id===D.value.itemId);B&&(V.value[L.value]={...V.value[L.value],item:{id:String(B.id),name:B.name,inventory:{current_stock:B.current_stock||0}},quantity_needed:D.value.quantity,unit:D.value.unit,is_critical:D.value.isCritical},i())},i=()=>{_.value=!1,L.value=-1,D.value={itemId:null,quantity:1,unit:"pcs",isCritical:!1}},z=B=>{V.value.splice(B,1)},A=async()=>{var B,x,ue,$e,xe,Ve,ee,ye,M,o,T,R,J,$,Z,ne,P,ve,_e,ze,He,Me;if(h.product){p.value=!0;try{console.log("ðŸ’¾ Saving composition for product:",h.product.name),console.log("ðŸ“¦ Items to save:",V.value);const Be=parseInt(String(((B=h.product)==null?void 0:B.id_product)||((x=h.product)==null?void 0:x.id)||"0")),qe=ge.value||[],je=V.value;console.log("ðŸ”„ Comparing items for save:",{existing_count:qe.length,current_count:je.length,existing_items:qe.map(oe=>{var Se,Fe;return{id:oe.id_product_item,item_id:(Se=oe.item)==null?void 0:Se.id,item_name:(Fe=oe.item)==null?void 0:Fe.name}}),current_items:je.map(oe=>{var Se,Fe;return{id:oe.id_product_item,item_id:(Se=oe.item)==null?void 0:Se.id,item_name:(Fe=oe.item)==null?void 0:Fe.name,quantity:oe.quantity_needed,unit:oe.unit}})}),console.log("ðŸ”„ Starting to process",je.length,"items for save...");for(const oe of je){const Se=qe.find(Ye=>{var De,ae;return!!(Ye.id_product_item===oe.id_product_item||oe.id_product_item&&!oe.id_product_item.toString().startsWith("temp_")&&((De=Ye.item)==null?void 0:De.id)===((ae=oe.item)==null?void 0:ae.id))});if(console.log("ðŸ” Processing item:",{item_name:(ue=oe.item)==null?void 0:ue.name,item_id_product_item:oe.id_product_item,existing_found:!!Se,existing_id:Se==null?void 0:Se.id_product_item,is_temp:($e=oe.id_product_item)==null?void 0:$e.toString().startsWith("temp_"),matching_strategy:Se?Se.id_product_item===oe.id_product_item?"exact_id":"item_product_match":"no_match"}),!((xe=oe.item)!=null&&xe.id)||parseInt(oe.item.id)===0){console.warn("âš ï¸ Skipping item with invalid item_id:",{item_name:(Ve=oe.item)==null?void 0:Ve.name,item_id:(ee=oe.item)==null?void 0:ee.id,full_item:oe});continue}const Fe={product_id:Be,item_id:parseInt(((ye=oe.item)==null?void 0:ye.id)||"0"),quantity_needed:parseFloat(oe.quantity_needed.toString()),unit:oe.unit,is_critical:oe.is_critical,notes:oe.notes||""};console.log("ðŸ“¤ API Data for item:",(M=oe.item)==null?void 0:M.name,{raw_item_id:(o=oe.item)==null?void 0:o.id,parsed_item_id:parseInt(((T=oe.item)==null?void 0:T.id)||"0"),api_data:Fe,full_item_data:{id_product_item:oe.id_product_item,item_name:(R=oe.item)==null?void 0:R.name,quantity:oe.quantity_needed,unit:oe.unit}});try{Se&&!((J=oe.id_product_item)!=null&&J.toString().startsWith("temp_"))?(console.log("âœï¸ Updating existing item:",{id:Se.id_product_item,item_name:($=oe.item)==null?void 0:$.name,current_stock:(ne=(Z=oe.item)==null?void 0:Z.inventory)==null?void 0:ne.current_stock}),await pt.update(parseInt(Se.id_product_item||"0"),Fe)):(console.log("âž• Creating new item:",{item_name:(P=oe.item)==null?void 0:P.name,current_stock:(_e=(ve=oe.item)==null?void 0:ve.inventory)==null?void 0:_e.current_stock,id_product_item:oe.id_product_item,is_temp:(ze=oe.id_product_item)==null?void 0:ze.toString().startsWith("temp_"),existing_item_found:!!Se}),await pt.create(Fe))}catch(Ye){throw console.error("âŒ Error processing item:",Ye),(He=Ye.message)!=null&&He.includes("already assigned")?n.value=`Item "${(Me=oe.item)==null?void 0:Me.name}" sudah ditambahkan ke produk ini`:n.value=Ye.message||"Terjadi kesalahan saat menyimpan item",m.value=!0,Ye}}for(const oe of qe)if(!je.find(Fe=>Fe.id_product_item===oe.id_product_item)&&oe.id_product_item)try{console.log("ðŸ—‘ï¸ Deleting item:",oe.id_product_item),await pt.delete(parseInt(oe.id_product_item))}catch(Fe){console.error("âŒ Error deleting item:",Fe),n.value=`Gagal menghapus item: ${Fe.message}`,m.value=!0}console.log("âœ… Composition saved successfully!"),W.value="Komposisi produk berhasil disimpan!",r.value=!0,d("save",{product:h.product,items:V.value}),d("refresh"),ke()}catch(Be){console.error("âŒ Error saving composition:",Be),m.value||(n.value=Be.message||"Terjadi kesalahan saat menyimpan komposisi",m.value=!0)}finally{p.value=!1}}},ke=()=>{U.value=!1,setTimeout(()=>{V.value=[...h.items],i()},300)};return(B,x)=>{var ue,$e,xe,Ve;return b(),se(Ae,null,[e(Ge,{modelValue:U.value,"onUpdate:modelValue":x[9]||(x[9]=ee=>U.value=ee),"max-width":"900",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ie,{class:"d-flex align-center justify-between bg-primary text-white"},{default:t(()=>{var ee;return[a("div",xl,[e(S,{icon:"mdi-chef-hat",size:"24"}),a("div",null,[x[13]||(x[13]=a("h3",{class:"text-h6 font-weight-bold"},"Kelola Komposisi Item",-1)),a("p",wl,c(((ee=B.product)==null?void 0:ee.name)||"Produk"),1)])]),e(K,{icon:"mdi-close",variant:"text",size:"small",onClick:ke})]}),_:1}),e(fe,{class:"pa-6"},{default:t(()=>[e(de,{variant:"tonal",class:"mb-6"},{default:t(()=>[e(fe,{class:"pa-4"},{default:t(()=>{var ee,ye,M,o,T;return[a("div",Vl,[e(Te,{image:(ee=B.product)==null?void 0:ee.image_url,size:"64"},{default:t(()=>{var R;return[(R=B.product)!=null&&R.image_url?te("",!0):(b(),N(S,{key:0,icon:"mdi-coffee"}))]}),_:1},8,["image"]),a("div",Pl,[a("h4",Cl,c((ye=B.product)==null?void 0:ye.name),1),a("p",Sl," SKU: "+c(((M=B.product)==null?void 0:M.sku)||"SKU-"+((o=B.product)==null?void 0:o.id_product)),1),a("p",Il," Harga: "+c(X(st)(((T=B.product)==null?void 0:T.price)||0)),1)]),e(pe,{color:me(),variant:"tonal"},{default:t(()=>[v(c(Y()),1)]),_:1},8,["color"])])]}),_:1})]),_:1}),e(de,{class:"mb-6",elevation:"2"},{default:t(()=>[e(Ie,{class:"bg-grey-lighten-4 py-3"},{default:t(()=>[a("div",$l,[a("div",Dl,[e(S,{icon:_.value?"mdi-pencil-circle":"mdi-plus-circle",class:"me-2"},null,8,["icon"]),v(" "+c(_.value?"Edit Item Komposisi":"Tambah Item Komposisi"),1)])])]),_:1}),e(fe,{class:"pa-4"},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(St,{modelValue:D.value.itemId,"onUpdate:modelValue":x[0]||(x[0]=ee=>D.value.itemId=ee),items:j.value,loading:ie.value,"item-title":"name","item-value":"id",label:"Pilih Item",placeholder:"Cari item (termasuk yang stok kosong)...","prepend-inner-icon":"mdi-magnify",variant:"outlined",clearable:"","no-data-text":w()},{item:t(({props:ee,item:ye})=>[e(at,we(ee,{class:{"text-medium-emphasis":y(ye.raw)<=0}}),{prepend:t(()=>[e(Te,{size:"32",class:"me-3",color:y(ye.raw)<=0?"warning":"primary",variant:"tonal"},{default:t(()=>[e(S,{icon:"mdi-package-variant",color:y(ye.raw)<=0?"warning":"primary"},null,8,["color"])]),_:2},1032,["color"])]),append:t(()=>[y(ye.raw)>0?(b(),N(pe,{key:0,size:"x-small",color:O(ye.raw),variant:"tonal"},{default:t(()=>[v(c(re(ye.raw)),1)]),_:2},1032,["color"])):(b(),N(pe,{key:1,size:"x-small",color:"warning",variant:"tonal","prepend-icon":"mdi-alert"},{default:t(()=>x[15]||(x[15]=[v(" Kosong ")])),_:1,__:[15]}))]),default:t(()=>[e(ct,null,{default:t(()=>[v(c(ye.raw.name),1)]),_:2},1024),e(mt,{class:"text-medium-emphasis"},{default:t(()=>[y(ye.raw)<=0?(b(),se("span",Tl,[e(S,{icon:"mdi-alert-circle",size:"12",class:"me-1"}),x[14]||(x[14]=v(" Stok Kosong - Masih bisa digunakan "))])):(b(),se("span",Ul," Stok: "+c(y(ye.raw))+" "+c(ye.raw.unit),1))]),_:2},1024)]),_:2},1040,["class"])]),_:1},8,["modelValue","items","loading","no-data-text"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Pe,{modelValue:D.value.quantity,"onUpdate:modelValue":x[1]||(x[1]=ee=>D.value.quantity=ee),modelModifiers:{number:!0},type:"number",label:"Jumlah",variant:"outlined",min:"0",step:"0.01"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Pe,{modelValue:D.value.unit,"onUpdate:modelValue":x[2]||(x[2]=ee=>D.value.unit=ee),label:"Satuan",variant:"outlined",placeholder:"kg, pcs, ml",readonly:!!k.value,hint:k.value?`Satuan dari item: ${k.value}`:"","persistent-hint":""},null,8,["modelValue","readonly","hint"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(vt,{modelValue:D.value.isCritical,"onUpdate:modelValue":x[3]||(x[3]=ee=>D.value.isCritical=ee),label:"Item Kritis",color:"error","hide-details":""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(K,{color:_.value?"success":"primary",block:"","prepend-icon":_.value?"mdi-check":"mdi-plus",onClick:x[4]||(x[4]=ee=>_.value?s():f()),disabled:!g.value},{default:t(()=>[v(c(_.value?"Update":"Tambah"),1)]),_:1},8,["color","prepend-icon","disabled"]),_.value?(b(),N(K,{key:0,color:"error",variant:"outlined",block:"","prepend-icon":"mdi-close",class:"mt-2",onClick:i},{default:t(()=>x[16]||(x[16]=[v(" Batal ")])),_:1,__:[16]})):te("",!0)]),_:1})]),_:1}),G.value?(b(),N(Re,{key:0,color:"warning",variant:"tonal",class:"mt-4","prepend-icon":"mdi-alert"},{default:t(()=>[e(yt,null,{default:t(()=>x[17]||(x[17]=[v("Item Stok Kosong")])),_:1,__:[17]}),x[18]||(x[18]=a("div",null,"Item yang dipilih sedang kosong stok, namun masih bisa ditambahkan ke komposisi. Pastikan untuk memperbarui stok sebelum produksi.",-1))]),_:1,__:[18]})):te("",!0)]),_:1})]),_:1}),e(de,{elevation:"2"},{default:t(()=>[e(Ie,{class:"bg-grey-lighten-4 py-3"},{default:t(()=>[e(S,{icon:"mdi-format-list-bulleted",class:"me-2"}),v(" Daftar Item Komposisi ("+c(V.value.length)+") ",1)]),_:1}),e(fe,{class:"pa-0"},{default:t(()=>[V.value.length===0?(b(),se("div",zl,[e(S,{icon:"mdi-package-variant-closed",size:"64",class:"text-disabled mb-4"}),x[19]||(x[19]=a("h4",{class:"text-h6 mb-2"},"Belum ada item komposisi",-1)),x[20]||(x[20]=a("p",{class:"text-body-2 text-medium-emphasis"}," Tambahkan item yang dibutuhkan untuk membuat produk ini ",-1))])):(b(),N(bt,{key:1},{default:t(()=>[(b(!0),se(Ae,null,et(V.value,(ee,ye)=>(b(),N(at,{key:ee.id||ye,class:"border-b"},{prepend:t(()=>[e(Te,{size:"40",class:"me-3"},{default:t(()=>{var M,o;return[e(S,{icon:(M=ee.item)!=null&&M.inventory&&ee.item.inventory.current_stock>=ee.quantity_needed?"mdi-check-circle":"mdi-alert-circle",color:(o=ee.item)!=null&&o.inventory&&ee.item.inventory.current_stock>=ee.quantity_needed?"success":"error"},null,8,["icon","color"])]}),_:2},1024)]),append:t(()=>[a("div",El,[e(K,{icon:"mdi-pencil",variant:"text",size:"small",color:"primary",onClick:M=>u(ee,ye)},null,8,["onClick"]),e(K,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:M=>z(ye)},null,8,["onClick"])])]),default:t(()=>[e(ct,{class:"font-weight-medium"},{default:t(()=>{var M;return[v(c(((M=ee.item)==null?void 0:M.name)||"Item tidak ditemukan")+" ",1),ee.is_critical?(b(),N(pe,{key:0,color:"error",size:"x-small",variant:"tonal",class:"ms-2"},{default:t(()=>x[21]||(x[21]=[v(" Kritis ")])),_:1,__:[21]})):te("",!0)]}),_:2},1024),e(mt,null,{default:t(()=>{var M;return[a("div",Al,[a("span",null,"Dibutuhkan: "+c(ee.quantity_needed)+" "+c(ee.unit),1),(M=ee.item)!=null&&M.inventory?(b(),se("span",{key:0,class:tt(ee.item.inventory.current_stock>=ee.quantity_needed?"text-success":"text-error")}," Stok: "+c(ee.item.inventory.current_stock)+" "+c(ee.unit),3)):te("",!0),ee.formatted_total_cost?(b(),se("span",Ml,c(ee.formatted_total_cost),1)):te("",!0)])]}),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1}),e(Ne,{class:"pa-6 pt-0"},{default:t(()=>[e(K,{color:"warning",variant:"outlined","prepend-icon":"mdi-calculator",onClick:he},{default:t(()=>x[22]||(x[22]=[v(" Setting HPP ")])),_:1,__:[22]}),e(Xe),e(K,{variant:"outlined",onClick:ke},{default:t(()=>x[23]||(x[23]=[v(" Batal ")])),_:1,__:[23]}),e(K,{color:"primary",onClick:A,loading:p.value},{default:t(()=>x[24]||(x[24]=[v(" Simpan Komposisi ")])),_:1,__:[24]},8,["loading"])]),_:1})]),_:1}),e(it,{modelValue:m.value,"onUpdate:modelValue":x[6]||(x[6]=ee=>m.value=ee),color:"error",location:"top",timeout:5e3},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:x[5]||(x[5]=ee=>m.value=!1)},{default:t(()=>x[25]||(x[25]=[v(" Tutup ")])),_:1,__:[25]})]),default:t(()=>[v(c(n.value)+" ",1)]),_:1},8,["modelValue"]),e(it,{modelValue:r.value,"onUpdate:modelValue":x[8]||(x[8]=ee=>r.value=ee),color:"success",location:"top",timeout:3e3},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:x[7]||(x[7]=ee=>r.value=!1)},{default:t(()=>x[26]||(x[26]=[v(" Tutup ")])),_:1,__:[26]})]),default:t(()=>[v(c(W.value)+" ",1)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),e(la,{modelValue:le.value,"onUpdate:modelValue":x[10]||(x[10]=ee=>le.value=ee),"product-id":parseInt(String(((ue=B.product)==null?void 0:ue.id_product)||(($e=B.product)==null?void 0:$e.id)||"0")),"product-name":((xe=B.product)==null?void 0:xe.product_name)||((Ve=B.product)==null?void 0:Ve.name),onHppUpdated:x[11]||(x[11]=ee=>d("refresh")),onPriceUpdated:x[12]||(x[12]=ee=>d("refresh"))},null,8,["modelValue","product-id","product-name"])],64)}}}),Zt=Je(Hl,[["__scopeId","data-v-33220da6"]]),Bl={class:"composition-cards"},Fl={key:1,class:"text-center pa-12"},Kl={key:2,class:"text-center pa-12"},Rl={class:"d-flex align-center gap-3"},ql={class:"flex-grow-1 min-width-0"},Ol={class:"text-h6 font-weight-bold text-truncate"},Nl={class:"text-caption text-medium-emphasis mb-0"},Ll={class:"d-flex align-center gap-2 mb-3"},jl={class:"text-body-2 font-weight-medium"},Wl={class:"composition-items"},Gl={class:"d-flex align-center gap-2 flex-grow-1 min-width-0"},Xl={class:"text-body-2 text-truncate"},Jl={class:"text-end flex-shrink-0"},Yl={class:"text-body-2 font-weight-medium"},Ql={key:0,class:"text-caption text-success"},Zl={key:1,class:"text-caption text-primary"},eo={class:"d-flex justify-between align-center mb-3"},to={class:"text-h6 font-weight-bold text-primary"},ao={class:"d-flex gap-2"},lo={class:"d-flex align-center"},oo={class:"d-flex align-center gap-4"},no={class:"flex-grow-1"},so={class:"text-h5 font-weight-bold mb-2"},io={class:"d-flex align-center gap-4 mb-2"},ro={class:"text-body-2"},uo={class:"text-h6 text-primary font-weight-bold"},co={class:"d-flex align-center mt-1 gap-4"},mo={class:"d-flex align-center"},vo={class:"d-flex align-center"},fo={key:0,class:"d-flex align-center"},po={class:"text-primary font-weight-medium"},go={key:1,class:"text-center py-8"},_o={class:"text-h6 font-weight-bold"},ko={class:"text-h6 font-weight-bold"},yo={class:"text-h6 font-weight-bold"},bo=Le({__name:"ProductCompositionCards",props:{productItems:{},loading:{type:Boolean}},emits:["refresh","edit-composition","view-details"],setup(l,{emit:F}){const h=l,d=F,U=H(!1),p=H(!1),V=H(null),m=H([]),r=H(null),n=H({search:"",stockStatus:"",itemType:"",criticalOnly:!1,sortBy:"name_asc"}),W=[{title:"Semua Status",value:""},{title:"Stok Aman",value:"safe"},{title:"Stok Kritis",value:"critical"},{title:"Stok Habis",value:"out"}],_=[{title:"Nama A-Z",value:"name_asc"},{title:"Nama Z-A",value:"name_desc"},{title:"Harga Tertinggi",value:"price_desc"},{title:"Harga Terendah",value:"price_asc"},{title:"Item Terbanyak",value:"items_desc"},{title:"Item Tersedikit",value:"items_asc"}],L=j=>{V.value=j,m.value=j.items||[],U.value=!0},le=j=>{r.value=j,p.value=!0},D=j=>{console.log("Composition saved:",j),d("refresh")},C=()=>{n.value={search:"",stockStatus:"",itemType:"",criticalOnly:!1,sortBy:"name_asc"}},ie=ce(()=>!!(n.value.search||n.value.stockStatus||n.value.itemType||n.value.criticalOnly||n.value.sortBy!=="name_asc")),ge=ce(()=>{let j=0;return n.value.search&&j++,n.value.stockStatus&&j++,n.value.itemType&&j++,n.value.criticalOnly&&j++,n.value.sortBy!=="name_asc"&&j++,j}),q=ce(()=>{const j=new Map;h.productItems.forEach(w=>{if(!w.product)return;const O=w.product.id_product||w.product.id;j.has(O)||j.set(O,{...w.product,items:[],totalItems:0}),j.get(O).items.push(w),j.get(O).totalItems++});let y=Array.from(j.values());if(n.value.search){const w=n.value.search.toLowerCase();y=y.filter(O=>O.name.toLowerCase().includes(w)||O.sku&&O.sku.toLowerCase().includes(w)||O.items.some(re=>{var he;return(he=re.item)==null?void 0:he.name.toLowerCase().includes(w)}))}return n.value.stockStatus&&(y=y.filter(w=>{const O=Q(w);switch(n.value.stockStatus){case"safe":return O.color==="success";case"critical":return O.color==="warning";case"out":return O.color==="error";default:return!0}})),n.value.criticalOnly&&(y=y.filter(w=>w.items.some(O=>O.is_critical))),y.sort((w,O)=>{switch(n.value.sortBy){case"name_asc":return w.name.localeCompare(O.name);case"name_desc":return O.name.localeCompare(w.name);case"price_asc":return(w.price||0)-(O.price||0);case"price_desc":return(O.price||0)-(w.price||0);case"items_asc":return w.totalItems-O.totalItems;case"items_desc":return O.totalItems-w.totalItems;default:return w.name.localeCompare(O.name)}}),y}),Q=j=>{let y=!1,w=!1;return j.items.forEach(O=>{var re;if((re=O.item)!=null&&re.inventory){const he=O.item.inventory.current_stock||0,me=O.quantity_needed||0;he<=0?y=!0:(he<me||O.is_critical)&&(w=!0)}}),y?{text:"Stok Habis",color:"error"}:w?{text:"Stok Kritis",color:"warning"}:{text:"Stok Aman",color:"success"}},g=j=>{if(!(j!=null&&j.inventory))return"grey";const y=j.inventory.current_stock||0;return y<=0?"error":y<=10?"warning":"success"},k=j=>{if(!(j!=null&&j.inventory))return"Tidak ada data";const y=j.inventory.current_stock||0;return y<=0?"Habis":y<=10?"Rendah":"Aman"},I=j=>{const y=g(j);return{"text-error":y==="error","text-warning":y==="warning","text-success":y==="success","text-grey":y==="grey"}},G=j=>`Item Komposisi (${j})`;return(j,y)=>(b(),se("div",Bl,[e(de,{class:"mb-6"},{default:t(()=>[e(Ie,{class:"d-flex align-center justify-between"},{default:t(()=>[y[12]||(y[12]=a("div",null,[a("h2",{class:"text-h5 font-weight-bold"},"Komposisi Produk"),a("p",{class:"text-body-2 text-medium-emphasis"}," Kelola komposisi bahan untuk setiap produk ")],-1)),e(K,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:y[0]||(y[0]=w=>d("refresh")),loading:j.loading},{default:t(()=>y[11]||(y[11]=[v(" Refresh ")])),_:1,__:[11]},8,["loading"])]),_:1,__:[12]})]),_:1}),e(de,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Pe,{modelValue:n.value.search,"onUpdate:modelValue":y[1]||(y[1]=w=>n.value.search=w),label:"Cari Produk",placeholder:"Nama produk, SKU, atau item...",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:n.value.stockStatus,"onUpdate:modelValue":y[2]||(y[2]=w=>n.value.stockStatus=w),items:W,label:"Status Stok",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-chart-line","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:n.value.sortBy,"onUpdate:modelValue":y[3]||(y[3]=w=>n.value.sortBy=w),items:_,label:"Urutkan",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-sort","hide-details":""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3",class:"d-flex align-center"},{default:t(()=>[e(Ha,{modelValue:n.value.criticalOnly,"onUpdate:modelValue":y[4]||(y[4]=w=>n.value.criticalOnly=w),label:"Hanya Item Kritis",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),e(Ue,{class:"mt-3"},{default:t(()=>[e(E,{cols:"12",md:"6",class:"d-flex align-center gap-2"},{default:t(()=>[e(K,{variant:"outlined",color:"grey",size:"small","prepend-icon":"mdi-filter-off",onClick:C,disabled:!ie.value},{default:t(()=>y[13]||(y[13]=[v(" Reset Filter ")])),_:1,__:[13]},8,["disabled"]),ie.value?(b(),N(pe,{key:0,color:"primary",variant:"tonal",size:"small"},{default:t(()=>[v(c(ge.value)+" filter aktif ",1)]),_:1})):te("",!0)]),_:1}),e(E,{cols:"12",md:"6",class:"d-flex align-center justify-end"},{default:t(()=>[e(pe,{color:q.value.length>0?"success":"default",variant:"tonal","prepend-icon":"mdi-package-variant"},{default:t(()=>[v(c(q.value.length)+" Produk dengan Komposisi ",1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1})]),_:1}),!j.loading&&q.value.length===0&&ie.value?(b(),N(Re,{key:0,type:"info",variant:"outlined",class:"mb-6",title:"Tidak ada hasil",text:"Tidak ada produk yang sesuai dengan filter yang dipilih. Coba ubah filter pencarian."})):te("",!0),j.loading?(b(),se("div",Fl,[e(Nt,{color:"primary",indeterminate:"",size:"64"}),y[14]||(y[14]=a("div",{class:"mt-4 text-h6"},"Memuat komposisi...",-1))])):q.value.length===0?(b(),se("div",Kl,[e(S,{icon:"mdi-chef-hat-off",size:"96",class:"text-disabled mb-6"}),y[16]||(y[16]=a("h3",{class:"text-h5 font-weight-bold mb-4"},"Belum Ada Komposisi Produk",-1)),y[17]||(y[17]=a("p",{class:"text-body-1 text-medium-emphasis mb-6"}," Buat komposisi untuk produk Anda agar dapat melihat detail bahan yang dibutuhkan ",-1)),e(K,{color:"primary",size:"large","prepend-icon":"mdi-plus"},{default:t(()=>y[15]||(y[15]=[v(" Buat Komposisi Pertama ")])),_:1,__:[15]})])):(b(),N(Ue,{key:3},{default:t(()=>[(b(!0),se(Ae,null,et(q.value,w=>(b(),N(E,{key:w.id_product,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(de,{class:tt(["composition-card h-100",{"border-error":Q(w).color==="error"}]),elevation:"2"},{default:t(()=>[e(Ie,{class:"pa-4 pb-2"},{default:t(()=>[a("div",Rl,[e(Te,{image:w.image_url,size:"48",class:"flex-shrink-0"},{default:t(()=>[w.image_url?te("",!0):(b(),N(S,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"]),a("div",ql,[a("h3",Ol,c(w.name),1),a("p",Nl,c(w.sku||"SKU-"+w.id_product),1)])])]),_:2},1024),e(fe,{class:"py-2"},{default:t(()=>[e(pe,{color:Q(w).color,size:"small",variant:"tonal",class:"mb-3"},{default:t(()=>[v(c(Q(w).text),1)]),_:2},1032,["color"]),a("div",Ll,[e(S,{icon:"mdi-format-list-bulleted",size:"16"}),a("span",jl,c(G(w.totalItems)),1)]),a("div",Wl,[(b(!0),se(Ae,null,et(w.items,O=>{var re,he,me,Y;return b(),se("div",{key:O.id_product_item,class:"composition-item d-flex align-center justify-between mb-2"},[a("div",Gl,[e(S,{icon:(re=O.item)!=null&&re.inventory&&O.item.inventory.current_stock>=O.quantity_needed?"mdi-check-circle":"mdi-alert-circle",color:(he=O.item)!=null&&he.inventory&&O.item.inventory.current_stock>=O.quantity_needed?"success":"error",size:"16"},null,8,["icon","color"]),a("span",Xl,c(((me=O.item)==null?void 0:me.name)||"Item tidak ditemukan"),1),O.is_critical?(b(),N(pe,{key:0,color:"error",size:"x-small",variant:"tonal"},{default:t(()=>y[18]||(y[18]=[v(" Kritis ")])),_:1,__:[18]})):te("",!0)]),a("div",Jl,[a("div",Yl,c(O.quantity_needed)+" "+c(O.unit),1),(Y=O.item)!=null&&Y.inventory?(b(),se("div",Ql," Stok: "+c(O.item.inventory.current_stock)+" "+c(O.unit),1)):te("",!0),O.formatted_total_cost?(b(),se("div",Zl,c(O.formatted_total_cost),1)):te("",!0)])])}),128))])]),_:2},1024),e(fe,{class:"pt-0"},{default:t(()=>[e(Ee,{class:"mb-3"}),a("div",eo,[y[19]||(y[19]=a("span",{class:"text-body-2"},"Harga:",-1)),a("span",to,c(X(st)(w.price||0)),1)]),a("div",ao,[e(K,{color:"primary",size:"small","prepend-icon":"mdi-eye",onClick:O=>le(w)},{default:t(()=>y[20]||(y[20]=[v(" Detail ")])),_:2,__:[20]},1032,["onClick"]),e(K,{color:"secondary",variant:"outlined",size:"small","prepend-icon":"mdi-cog",onClick:O=>L(w)},{default:t(()=>y[21]||(y[21]=[v(" Kelola ")])),_:2,__:[21]},1032,["onClick"])])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})),e(Zt,{modelValue:U.value,"onUpdate:modelValue":y[5]||(y[5]=w=>U.value=w),product:V.value,items:m.value,onSave:D,onRefresh:y[6]||(y[6]=w=>d("refresh"))},null,8,["modelValue","product","items"]),e(Ge,{modelValue:p.value,"onUpdate:modelValue":y[10]||(y[10]=w=>p.value=w),"max-width":"900",scrollable:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ie,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",lo,[e(S,{icon:"mdi-eye",class:"mr-2",color:"primary"}),y[22]||(y[22]=a("span",null,"Detail Komposisi Produk",-1))]),e(K,{icon:"",variant:"text",onClick:y[7]||(y[7]=w=>p.value=!1)},{default:t(()=>[e(S,{icon:"mdi-close"})]),_:1})]),_:1}),e(Ee),r.value?(b(),N(fe,{key:0},{default:t(()=>[e(Ba,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(de,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(fe,null,{default:t(()=>[a("div",oo,[e(Te,{image:r.value.image_url,size:"80"},{default:t(()=>[r.value.image_url?te("",!0):(b(),N(S,{key:0,icon:"mdi-coffee",size:"40"}))]),_:1},8,["image"]),a("div",no,[a("h2",so,c(r.value.name),1),a("div",io,[e(pe,{color:Q(r.value).color,variant:"tonal",size:"small"},{default:t(()=>[v(c(Q(r.value).text),1)]),_:1},8,["color"]),a("span",ro,"SKU: "+c(r.value.sku||"-"),1)]),a("div",uo,c(X(st)(r.value.price||0)),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(de,{variant:"outlined"},{default:t(()=>[e(Ie,{class:"text-h6"},{default:t(()=>[e(S,{icon:"mdi-format-list-bulleted",class:"mr-2"}),v(" Komposisi Item ("+c(r.value.totalItems||0)+") ",1)]),_:1}),e(fe,null,{default:t(()=>[r.value.items&&r.value.items.length>0?(b(),N(bt,{key:0},{default:t(()=>[(b(!0),se(Ae,null,et(r.value.items,(w,O)=>(b(),N(at,{key:w.id_product_item,class:"px-0"},{prepend:t(()=>[e(Te,{size:"40",color:g(w.item),variant:"tonal"},{default:t(()=>{var re;return[e(S,{icon:(re=w.item)!=null&&re.inventory&&w.item.inventory.current_stock>=w.quantity_needed?"mdi-check":"mdi-alert"},null,8,["icon"])]}),_:2},1032,["color"])]),append:t(()=>[e(pe,{color:g(w.item),variant:"tonal",size:"small"},{default:t(()=>[v(c(k(w.item)),1)]),_:2},1032,["color"])]),default:t(()=>[e(ct,{class:"font-weight-medium"},{default:t(()=>{var re;return[v(c(((re=w.item)==null?void 0:re.name)||"Unknown Item")+" ",1),w.is_critical?(b(),N(pe,{key:0,color:"error",variant:"tonal",size:"x-small",class:"ml-2"},{default:t(()=>y[23]||(y[23]=[v(" Kritis ")])),_:1,__:[23]})):te("",!0)]}),_:2},1024),e(mt,null,{default:t(()=>{var re,he;return[a("div",co,[a("div",mo,[e(S,{icon:"mdi-scale",size:"14",class:"mr-1"}),a("span",null," Kebutuhan: "+c(Number(w.quantity_needed||0).toLocaleString("id-ID"))+" "+c(w.unit),1)]),a("div",vo,[e(S,{icon:"mdi-warehouse",size:"14",class:"mr-1"}),a("span",{class:tt(I(w.item))}," Stok: "+c(Number(((he=(re=w.item)==null?void 0:re.inventory)==null?void 0:he.current_stock)||0).toLocaleString("id-ID"))+" "+c(w.unit),3)]),w.formatted_total_cost?(b(),se("div",fo,[e(S,{icon:"mdi-currency-usd",size:"14",class:"mr-1"}),a("span",po,c(w.formatted_total_cost),1)])):te("",!0)])]}),_:2},1024),O<r.value.items.length-1?(b(),N(Ee,{key:0,class:"mt-3"})):te("",!0)]),_:2},1024))),128))]),_:1})):(b(),se("div",go,[e(S,{icon:"mdi-package-variant-closed",size:"48",color:"grey-lighten-1",class:"mb-2"}),y[24]||(y[24]=a("p",{class:"text-body-1 text-grey"}," Belum ada komposisi item untuk produk ini ",-1))]))]),_:1})]),_:1})]),_:1})]),_:1}),e(Ue,{class:"mt-4"},{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"outlined",color:"primary"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[e(S,{icon:"mdi-format-list-bulleted",size:"32",class:"mb-2"}),a("div",_o,c(r.value.totalItems||0),1),y[25]||(y[25]=a("div",{class:"text-body-2"},"Total Item",-1))]),_:1,__:[25]})]),_:1})]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"outlined",color:"warning"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>{var w;return[e(S,{icon:"mdi-alert",size:"32",class:"mb-2"}),a("div",ko,c(((w=r.value.items)==null?void 0:w.filter(O=>O.is_critical).length)||0),1),y[26]||(y[26]=a("div",{class:"text-body-2"},"Item Kritis",-1))]}),_:1,__:[26]})]),_:1})]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"outlined",color:"success"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[e(S,{icon:"mdi-currency-usd",size:"32",class:"mb-2"}),a("div",yo,c(X(st)(r.value.price||0)),1),y[27]||(y[27]=a("div",{class:"text-body-2"},"Harga Jual",-1))]),_:1,__:[27]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):te("",!0),e(Ee),e(Ne,{class:"pa-4"},{default:t(()=>[e(Xe),e(K,{variant:"outlined",onClick:y[8]||(y[8]=w=>p.value=!1)},{default:t(()=>y[28]||(y[28]=[v(" Tutup ")])),_:1,__:[28]}),e(K,{color:"secondary",variant:"outlined","prepend-icon":"mdi-cog",onClick:y[9]||(y[9]=()=>{p.value=!1,L(r.value)})},{default:t(()=>y[29]||(y[29]=[v(" Kelola Komposisi ")])),_:1,__:[29]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),ho=Je(bo,[["__scopeId","data-v-8f4d44b6"]]),xo={class:"d-flex align-center gap-2"},wo={class:"text-white"},Vo={class:"text-h6 mb-4 d-flex align-center gap-2"},Po={class:"text-h6 mb-4 d-flex align-center gap-2"},Co={class:"d-flex flex-column gap-2"},So={key:0,class:"d-flex align-center gap-2"},Io={class:"d-flex align-center gap-2 mb-2"},$o={class:"d-flex gap-2"},Do={class:"d-flex gap-2"},To={class:"d-flex align-center justify-space-between"},Uo={class:"d-flex align-center gap-2"},zo={class:"text-end"},Ao={class:"text-h6 font-weight-bold"},Mo={class:"text-caption"},Eo={class:"text-h6 mb-4 d-flex align-center gap-2"},Ho={class:"text-h6 mb-4 d-flex align-center gap-2"},Bo={class:"image-upload-container"},Fo={key:0,class:"mb-4"},Ko={class:"text-center mt-2"},Ro={class:"text-h6 mb-4 d-flex align-center gap-2"},qo={class:"text-h6 mb-4 d-flex align-center gap-2"},Oo={class:"d-flex align-center"},No={class:"text-subtitle-1"},Lo={class:"text-body-1"},jo={class:"d-flex align-center"},Wo={class:"text-subtitle-1"},Go=Le({__name:"ProductDialog",props:{modelValue:{type:Boolean},editMode:{type:Boolean},formData:{},categories:{},loading:{type:Boolean},errorMessage:{},successMessage:{},selectedImage:{},imagePreview:{},useDialogError:{type:Boolean}},emits:["update:modelValue","close","submit","image-change","remove-image","clear-error","clear-success","update-form"],setup(l,{emit:F}){var Y,f,u;const h=Lt(),{nameRules:d,categoryRules:U}=jt(),{getProductHPPBreakdown:p}=oa(),V=H(!1),m=H(!1),r=async()=>{if(!(!_.editMode||!C.id))try{const s=await fetch(`/api/products/${C.id}/items`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(s.ok){const i=await s.json();m.value=i.success&&i.data&&i.data.length>0}}catch(s){console.error("Error checking HPP status:",s)}},n=async()=>{if(C.id)try{V.value=!0;const s=await p(C.id,"latest");s&&(C.cost=s.total_hpp,le("update-form","cost",s.total_hpp))}catch(s){console.error("Error refreshing HPP:",s)}finally{V.value=!1}},W=()=>{console.log("Open items setup for product:",C.id)},_=l,L=ce(()=>_.errorMessage),le=F,D=H(),C=wt({..._.formData});Ce(()=>_.formData,s=>{Object.assign(C,s)},{deep:!0}),Ce(C,s=>{Object.keys(s).forEach(i=>{le("update-form",i,s[i])})},{deep:!0}),Ce(()=>_.modelValue,s=>{s&&_.editMode&&r()});const ie=wt({length:((Y=_.formData.dimensions)==null?void 0:Y.length)||null,width:((f=_.formData.dimensions)==null?void 0:f.width)||null,height:((u=_.formData.dimensions)==null?void 0:u.height)||null});Ce(ie,s=>{const i=s.length!==null||s.width!==null||s.height!==null;C.dimensions=i?{length:s.length!==null?s.length:void 0,width:s.width!==null?s.width:void 0,height:s.height!==null?s.height:void 0}:{}},{deep:!0});const ge=[{title:"Draft",value:"draft"},{title:"Published",value:"published"},{title:"Archived",value:"archived"}],q=ce(()=>{if(!C.price||!C.cost||C.cost<=0)return 0;const s=(C.price-C.cost)/C.cost*100;return Math.ceil(s)}),Q=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),g=s=>s<10?"error":s<25?"warning":s<50?"success":"info",k=s=>s<10?"tabler-trending-down":s<25?"tabler-trending-up":s<50?"tabler-trending-up-2":"tabler-trending-up-3",I=s=>!s||s===0?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),G=s=>{if(!s||s.trim()===""||s==="Rp 0")return 0;const z=s.replace(/[^\d,.-]/g,"").replace(/\./g,"").replace(",",".");return parseFloat(z)||0},j=H(!1),y=s=>{const i=G(s);C.price=i},w=()=>{j.value=!0},O=()=>{j.value=!1},re=async()=>{var i;const{valid:s}=await((i=D.value)==null?void 0:i.validate());s&&le("submit",C)},he=s=>{le("image-change",s)},me=()=>{le("remove-image")};return(s,i)=>(b(),N(Ge,{"model-value":s.modelValue,"max-width":"900px",persistent:"",scrollable:"","onUpdate:modelValue":i[25]||(i[25]=z=>s.$emit("update:modelValue",z))},{default:t(()=>[e(de,{class:"product-dialog coffee-dialog"},{default:t(()=>[e(Ie,{class:"d-flex align-center justify-space-between coffee-header"},{default:t(()=>[a("div",xo,[e(S,{icon:s.editMode?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),a("span",wo,c(s.editMode?"Edit Produk":"Tambah Produk Baru"),1)]),e(K,{icon:"tabler-x",variant:"text",color:"white",onClick:i[0]||(i[0]=z=>s.$emit("close"))})]),_:1}),e(Ee),e(fe,{class:"pa-6"},{default:t(()=>[e(It,{ref_key:"formRef",ref:D,onSubmit:Ct(re,["prevent"])},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[a("h6",Vo,[e(S,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),i[26]||(i[26]=v(" Informasi Dasar "))])]),_:1}),e(E,{cols:"12",md:"8"},{default:t(()=>[e(Pe,{modelValue:C.name,"onUpdate:modelValue":i[1]||(i[1]=z=>C.name=z),label:"Nama Produk",placeholder:"Masukkan nama produk",rules:X(d),required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Pe,{modelValue:C.sku,"onUpdate:modelValue":i[2]||(i[2]=z=>C.sku=z),label:"SKU",placeholder:"Auto generate jika kosong",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(At,{modelValue:C.description,"onUpdate:modelValue":i[3]||(i[3]=z=>C.description=z),label:"Deskripsi Produk",placeholder:"Masukkan deskripsi produk",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Oe,{"model-value":C.category_id,"onUpdate:modelValue":i[4]||(i[4]=z=>C.category_id=z),items:s.categories,"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Pilih kategori",rules:X(U),required:"",variant:"outlined"},null,8,["model-value","items","rules"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Pe,{modelValue:C.brand,"onUpdate:modelValue":i[5]||(i[5]=z=>C.brand=z),label:"Brand/Merek",placeholder:"Masukkan brand produk",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Po,[e(S,{icon:"tabler-currency-dollar",size:"20",class:"coffee-icon"}),i[27]||(i[27]=v(" Harga & Biaya "))])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(Pe,{"model-value":I(C.price),"onUpdate:modelValue":i[6]||(i[6]=z=>y(z)),label:"Harga Jual",placeholder:"Rp 0",required:"",variant:"outlined",onFocus:w,onBlur:O},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[a("div",Co,[e(Pe,{"model-value":I(C.cost),label:"Harga Pokok Penjualan (HPP)",placeholder:"Auto-calculated dari bahan baku",variant:"outlined",readonly:"","append-inner-icon":"mdi-calculator",hint:"HPP dihitung otomatis berdasarkan harga bahan baku","persistent-hint":""},null,8,["model-value"]),s.editMode?(b(),se("div",So,[e(pe,{color:m.value?"success":"warning",size:"small",variant:"tonal"},{default:t(()=>[e(S,{icon:m.value?"tabler-calculator":"tabler-alert-circle",size:"14",class:"me-1"},null,8,["icon"]),v(" "+c(m.value?"Auto HPP Active":"Setup Required"),1)]),_:1},8,["color"]),m.value?(b(),N(K,{key:0,size:"small",variant:"outlined",color:"primary",onClick:n,loading:V.value},{default:t(()=>[e(S,{icon:"tabler-refresh",size:"14",class:"me-1"}),i[28]||(i[28]=v(" Update HPP "))]),_:1,__:[28]},8,["loading"])):(b(),N(Ke,{key:1},{activator:t(({props:z})=>[e(pe,we(z,{color:"warning",size:"small",variant:"tonal"}),{default:t(()=>[e(S,{icon:"tabler-alert-circle",size:"14",class:"me-1"}),i[29]||(i[29]=v(" Belum Ada Resep "))]),_:2,__:[29]},1040)]),default:t(()=>[i[30]||(i[30]=a("span",null,"Setup resep produk untuk menghitung HPP otomatis",-1))]),_:1,__:[30]}))])):te("",!0)])]),_:1}),s.editMode?(b(),N(E,{key:0,cols:"12"},{default:t(()=>[m.value?(b(),N(Re,{key:0,color:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[e(yt,null,{default:t(()=>[e(S,{icon:"tabler-info-circle",class:"me-2"}),i[31]||(i[31]=v(" HPP Otomatis Aktif "))]),_:1,__:[31]}),i[32]||(i[32]=a("div",{class:"mt-2"}," HPP produk ini dihitung otomatis berdasarkan item/bahan yang digunakan. Untuk mengubah HPP, silakan update harga item di menu Item Management. ",-1))]),_:1,__:[32]})):(b(),N(Re,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[e(yt,null,{default:t(()=>[e(S,{icon:"tabler-alert-triangle",class:"me-2"}),i[33]||(i[33]=v(" HPP Manual "))]),_:1,__:[33]}),i[34]||(i[34]=a("div",{class:"mt-2"}," Produk ini menggunakan HPP manual. Untuk perhitungan otomatis, tambahkan item/bahan yang digunakan untuk produk ini. ",-1))]),_:1,__:[34]}))]),_:1})):te("",!0),e(E,{cols:"12"},{default:t(()=>[m.value&&s.editMode?(b(),N(Re,{key:0,color:"success",variant:"tonal",class:"mb-4"},{default:t(()=>[a("div",Io,[e(S,{icon:"tabler-check-circle"}),i[35]||(i[35]=a("span",{class:"font-weight-medium"},"HPP Otomatis Aktif",-1))]),i[38]||(i[38]=a("div",{class:"text-body-2 mb-3"}," Produk ini sudah memiliki resep dan HPP dihitung otomatis berdasarkan harga bahan baku terkini. HPP akan update secara otomatis saat harga bahan baku berubah. ",-1)),a("div",$o,[e(K,{size:"small",color:"primary",variant:"outlined",onClick:W},{default:t(()=>[e(S,{icon:"tabler-edit",size:"14",class:"me-1"}),i[36]||(i[36]=v(" Edit Resep "))]),_:1,__:[36]}),e(K,{size:"small",variant:"outlined",color:"info",onClick:n,loading:V.value},{default:t(()=>[e(S,{icon:"tabler-refresh",size:"14",class:"me-1"}),i[37]||(i[37]=v(" Refresh HPP "))]),_:1,__:[37]},8,["loading"])])]),_:1,__:[38]})):!m.value&&s.editMode?(b(),N(Re,{key:1,color:"warning",variant:"tonal",class:"mb-0"},{default:t(()=>[a("div",Do,[e(K,{size:"small",variant:"outlined",color:"info",onClick:i[7]||(i[7]=z=>X(h).push("/hpp-management"))},{default:t(()=>[e(S,{icon:"tabler-calculator",size:"14",class:"me-1"}),i[39]||(i[39]=v(" Lihat HPP Management "))]),_:1,__:[39]})])]),_:1})):te("",!0)]),_:1}),e(E,{cols:"12"},{default:t(()=>[C.price&&C.cost&&C.cost>0?(b(),N(Re,{key:0,color:g(q.value),variant:"tonal",class:"mb-0"},{default:t(()=>[a("div",To,[a("div",Uo,[e(S,{icon:k(q.value)},null,8,["icon"]),i[40]||(i[40]=a("span",{class:"font-weight-medium"},"Profit Margin",-1))]),a("div",zo,[a("div",Ao,c(Math.round(q.value))+"%",1),a("div",Mo," Keuntungan: "+c(Q(C.price-C.cost)),1)])])]),_:1},8,["color"])):te("",!0)]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Eo,[e(S,{icon:"tabler-ruler",size:"20",class:"coffee-icon"}),i[41]||(i[41]=v(" Dimensi (cm) "))])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Pe,{modelValue:ie.length,"onUpdate:modelValue":i[8]||(i[8]=z=>ie.length=z),modelModifiers:{number:!0},label:"Panjang",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Pe,{modelValue:ie.width,"onUpdate:modelValue":i[9]||(i[9]=z=>ie.width=z),modelModifiers:{number:!0},label:"Lebar",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Pe,{modelValue:ie.height,"onUpdate:modelValue":i[10]||(i[10]=z=>ie.height=z),modelModifiers:{number:!0},label:"Tinggi",placeholder:"0",type:"number",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Ho,[e(S,{icon:"tabler-photo",size:"20",class:"coffee-icon"}),i[42]||(i[42]=v(" Gambar Produk "))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("div",Bo,[s.imagePreview?(b(),se("div",Fo,[e(Oa,{src:s.imagePreview,"max-width":"200","max-height":"200",class:"mx-auto rounded"},null,8,["src"]),a("div",Ko,[e(K,{size:"small",color:"error",variant:"outlined",onClick:me},{default:t(()=>i[43]||(i[43]=[v(" Hapus Gambar ")])),_:1,__:[43]})])])):te("",!0),e(Na,{"model-value":s.selectedImage,"onUpdate:modelValue":i[11]||(i[11]=z=>he(Array.isArray(z)?z:[z])),label:"Upload Gambar","prepend-icon":"tabler-camera",accept:"image/*",variant:"outlined"},null,8,["model-value"]),i[44]||(i[44]=a("div",{class:"text-caption text-medium-emphasis mt-1"}," Format: JPG, JPEG, PNG, GIF. Maksimal 2MB. ",-1))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",Ro,[e(S,{icon:"tabler-settings",size:"20",class:"coffee-icon"}),i[45]||(i[45]=v(" Pengaturan "))])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(Oe,{"model-value":C.status,"onUpdate:modelValue":i[12]||(i[12]=z=>C.status=z),items:ge,label:"Status Publikasi",variant:"outlined"},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(vt,{"model-value":C.active,"onUpdate:modelValue":i[13]||(i[13]=z=>C.active=z??!1),label:"Produk Aktif",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(E,{cols:"12",md:"4"},{default:t(()=>[e(vt,{"model-value":C.featured,"onUpdate:modelValue":i[14]||(i[14]=z=>C.featured=z??!1),label:"Produk Unggulan",color:"coffee",inset:""},null,8,["model-value"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[a("h6",qo,[e(S,{icon:"tabler-seo",size:"20",class:"coffee-icon"}),i[46]||(i[46]=v(" SEO (Opsional) "))])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Pe,{modelValue:C.meta_title,"onUpdate:modelValue":i[15]||(i[15]=z=>C.meta_title=z),label:"Meta Title",placeholder:"Judul untuk SEO",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(At,{modelValue:C.meta_description,"onUpdate:modelValue":i[16]||(i[16]=z=>C.meta_description=z),label:"Meta Description",placeholder:"Deskripsi untuk SEO",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(vl,{"model-value":C.tags,"onUpdate:modelValue":i[17]||(i[17]=z=>C.tags=z),label:"Tags",placeholder:"Tambah tag dan tekan Enter",multiple:"",chips:"",variant:"outlined"},null,8,["model-value"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(Ee),e(Ne,{class:"pa-6"},{default:t(()=>[e(Xe),e(K,{variant:"outlined",class:"coffee-secondary",onClick:i[18]||(i[18]=z=>s.$emit("close"))},{default:t(()=>i[47]||(i[47]=[v(" Batal ")])),_:1,__:[47]}),e(K,{color:"primary",class:"coffee-primary",loading:s.loading,onClick:re},{default:t(()=>[v(c(s.editMode?"Perbarui":"Simpan")+" Produk ",1)]),_:1},8,["loading"])]),_:1})]),_:1}),s.useDialogError?te("",!0):(b(),N(it,{key:0,"model-value":!!L.value,"onUpdate:modelValue":i[20]||(i[20]=z=>!z&&s.$emit("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500"},{actions:t(()=>[e(K,{icon:"tabler-x",size:"small",variant:"text",onClick:i[19]||(i[19]=z=>s.$emit("clear-error"))})]),default:t(()=>[a("div",Oo,[e(S,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),a("div",null,[i[48]||(i[48]=a("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),a("div",No,c(L.value),1)])])]),_:1},8,["model-value"])),s.useDialogError?(b(),N(Ge,{key:1,"model-value":!!L.value,"onUpdate:modelValue":i[22]||(i[22]=z=>!z&&s.$emit("clear-error")),"max-width":"400",persistent:"",class:"error-dialog"},{default:t(()=>[e(de,null,{default:t(()=>[e(Ie,{class:"d-flex align-center text-error"},{default:t(()=>[e(S,{icon:"tabler-alert-circle",class:"me-2"}),i[49]||(i[49]=v(" Error Occurred "))]),_:1,__:[49]}),e(Ee),e(fe,{class:"py-4"},{default:t(()=>[a("div",Lo,c(L.value),1)]),_:1}),e(Ee),e(Ne,{class:"justify-end pa-4"},{default:t(()=>[e(K,{color:"error",variant:"outlined",onClick:i[21]||(i[21]=z=>s.$emit("clear-error"))},{default:t(()=>i[50]||(i[50]=[v(" Close ")])),_:1,__:[50]})]),_:1})]),_:1})]),_:1},8,["model-value"])):te("",!0),e(it,{"model-value":!!s.successMessage,"onUpdate:modelValue":i[24]||(i[24]=z=>!z&&s.$emit("clear-success")),color:"success",location:"top right",timeout:4e3,vertical:"","min-width":"320","max-width":"500"},{actions:t(()=>[e(K,{icon:"tabler-x",size:"small",variant:"text",onClick:i[23]||(i[23]=z=>s.$emit("clear-success"))})]),default:t(()=>[a("div",jo,[e(S,{icon:"tabler-check-circle",class:"me-3",size:"28"}),a("div",null,[i[51]||(i[51]=a("div",{class:"text-h6 font-weight-bold"},"Berhasil!",-1)),a("div",Wo,c(s.successMessage),1)])])]),_:1},8,["model-value"])]),_:1},8,["model-value"]))}}),Xo=Je(Go,[["__scopeId","data-v-66fc4b3b"]]),Jo={key:0,class:"mt-4"},Yo={class:"d-flex align-center gap-2 mb-2"},Qo={class:"d-flex flex-wrap gap-2"},Zo=Le({__name:"ProductSearchFilters",props:{filters:{}},emits:["update:filters","search"],setup(l,{emit:F}){const h=l,d=F,{categories:U,loading:p,fetchCategories:V}=La(),m=H(!1),r=H("");ft(()=>{V(),r.value=n.search||""});const n=wt({...h.filters});Ce(()=>h.filters,Q=>{Object.assign(n,Q),r.value=Q.search||""},{deep:!0}),Ca(r,Q=>{console.log("ðŸ” Search query changed:",Q),n.search=Q,Q.length>=3||Q.length===0?(console.log("âœ… Triggering search with query:",Q),m.value=!0,d("search",Q),D(),setTimeout(()=>{m.value=!1},500)):console.log("â³ Query too short, waiting for more characters:",Q.length)},{debounce:500,maxWait:1e3});const W=[{title:"Aktif",value:"active"},{title:"Tidak Aktif",value:"inactive"}],_=[{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],L=[{title:"Terbaru",value:"desc"},{title:"Terlama",value:"asc"}],le=ce(()=>!!(r.value||n.category_id||n.active||n.stock_status||n.featured!==null||n.min_price||n.max_price)),D=()=>{d("update:filters",{...n})},C=()=>{r.value="",Object.assign(n,{search:"",category_id:null,active:null,stock_status:null,featured:null,min_price:null,max_price:null,sort_by:"created_at",sort_order:"desc"}),D()},ie=Q=>{const g=U.value.find(k=>k.id_category===Q);return(g==null?void 0:g.name)||"Unknown"},ge=Q=>{if(!Q)return"Semua";const g=W.find(k=>k.value===Q);return(g==null?void 0:g.title)||String(Q)},q=Q=>{const g=_.find(k=>k.value===Q);return(g==null?void 0:g.title)||Q};return(Q,g)=>(b(),N(de,{class:"mb-6"},{default:t(()=>[e(Ie,{class:"d-flex align-center gap-2"},{default:t(()=>[e(S,{icon:"tabler-filter",class:"coffee-icon"}),g[11]||(g[11]=v(" Filter & Pencarian Produk "))]),_:1,__:[11]}),e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(Pe,{modelValue:r.value,"onUpdate:modelValue":g[0]||(g[0]=k=>r.value=k),label:"Cari produk...",placeholder:"Nama, SKU, atau deskripsi (min. 3 karakter)","prepend-inner-icon":"tabler-search",loading:m.value,clearable:"",variant:"outlined",hint:r.value.length>0&&r.value.length<3?`Ketik ${3-r.value.length} karakter lagi untuk mencari`:"","persistent-hint":""},null,8,["modelValue","loading","hint"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:n.category_id,"onUpdate:modelValue":[g[1]||(g[1]=k=>n.category_id=k),D],items:X(U),"item-title":"name","item-value":"id_category",label:"Kategori",placeholder:"Semua kategori","prepend-inner-icon":"tabler-category",loading:X(p),clearable:"",variant:"outlined"},null,8,["modelValue","items","loading"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Oe,{modelValue:n.active,"onUpdate:modelValue":[g[2]||(g[2]=k=>n.active=k),D],items:W,label:"Status",placeholder:"Semua status","prepend-inner-icon":"tabler-toggle-left",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Oe,{modelValue:n.stock_status,"onUpdate:modelValue":[g[3]||(g[3]=k=>n.stock_status=k),D],items:_,label:"Stok",placeholder:"Semua stok","prepend-inner-icon":"tabler-package",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"1",class:"d-flex align-center"},{default:t(()=>[e(K,{icon:"tabler-refresh",variant:"outlined",color:"coffee",onClick:C})]),_:1})]),_:1}),e(Ue,{class:"mt-3"},{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Pe,{modelValue:n.min_price,"onUpdate:modelValue":g[4]||(g[4]=k=>n.min_price=k),label:"Harga Minimum",placeholder:"0","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:D},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Pe,{modelValue:n.max_price,"onUpdate:modelValue":g[5]||(g[5]=k=>n.max_price=k),label:"Harga Maksimum",placeholder:"Tidak terbatas","prepend-inner-icon":"tabler-currency-dollar",type:"number",variant:"outlined",onInput:D},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Oe,{modelValue:n.sort_order,"onUpdate:modelValue":[g[6]||(g[6]=k=>n.sort_order=k),D],items:L,label:"Urutan",placeholder:"Terbaru","prepend-inner-icon":"tabler-arrow-up",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),le.value?(b(),se("div",Jo,[a("div",Yo,[e(S,{icon:"tabler-filter-check",size:"small",class:"coffee-icon"}),g[12]||(g[12]=a("span",{class:"text-sm font-weight-medium"},"Filter Aktif:",-1))]),a("div",Qo,[r.value?(b(),N(pe,{key:0,closable:"",size:"small",color:"coffee","onClick:close":g[7]||(g[7]=k=>{r.value="",n.search="",D()})},{default:t(()=>[v(" Pencarian: "+c(r.value),1)]),_:1})):te("",!0),n.category_id?(b(),N(pe,{key:1,closable:"",size:"small",color:"coffee","onClick:close":g[8]||(g[8]=k=>{n.category_id=null,D()})},{default:t(()=>[v(" Kategori: "+c(ie(n.category_id)),1)]),_:1})):te("",!0),n.active?(b(),N(pe,{key:2,closable:"",size:"small",color:"coffee","onClick:close":g[9]||(g[9]=k=>{n.active=null,D()})},{default:t(()=>[v(" Status: "+c(ge(n.active)),1)]),_:1})):te("",!0),n.stock_status?(b(),N(pe,{key:3,closable:"",size:"small",color:"coffee","onClick:close":g[10]||(g[10]=k=>{n.stock_status=null,D()})},{default:t(()=>[v(" Stok: "+c(q(n.stock_status)),1)]),_:1})):te("",!0)])])):te("",!0)]),_:1})]),_:1}))}}),en=Je(Zo,[["__scopeId","data-v-1afc3ae3"]]),tn={class:"d-flex align-center gap-2"},an={class:"text-h6"},ln={class:"d-flex align-center gap-2"},on={class:"text-h6"},nn={class:"d-flex align-center gap-2"},sn={class:"text-h6"},rn={class:"d-flex align-center gap-2"},un={class:"text-h6"},dn={class:"d-flex align-center gap-2"},cn={class:"text-h6"},mn={class:"d-flex align-center gap-2"},vn={class:"text-h6"},fn={class:"d-flex align-center gap-2"},pn={class:"text-h6"},gn={class:"d-flex align-center gap-2"},_n={class:"text-h6"},kn=Le({__name:"ProductStatsCards",props:{stats:{}},setup(l){const F=d=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(d),h=d=>`${d.toFixed(1)}%`;return(d,U)=>(b(),N(Ue,{class:"mb-6"},{default:t(()=>[e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"primary",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-package"})]),_:1}),a("div",null,[U[0]||(U[0]=a("span",{class:"text-sm text-medium-emphasis"},"Total Produk",-1)),a("div",tn,[a("h6",an,c(((p=d.stats)==null?void 0:p.total_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"success",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-check"})]),_:1}),a("div",null,[U[1]||(U[1]=a("span",{class:"text-sm text-medium-emphasis"},"Produk Aktif",-1)),a("div",ln,[a("h6",on,c(((p=d.stats)==null?void 0:p.active_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"warning",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-star"})]),_:1}),a("div",null,[U[2]||(U[2]=a("span",{class:"text-sm text-medium-emphasis"},"Produk Unggulan",-1)),a("div",nn,[a("h6",sn,c(((p=d.stats)==null?void 0:p.featured_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"error",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-alert-triangle"})]),_:1}),a("div",null,[U[3]||(U[3]=a("span",{class:"text-sm text-medium-emphasis"},"Stok Rendah",-1)),a("div",rn,[a("h6",un,c(((p=d.stats)==null?void 0:p.low_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"info",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-currency-dollar"})]),_:1}),a("div",null,[U[4]||(U[4]=a("span",{class:"text-sm text-medium-emphasis"},"Nilai Stok",-1)),a("div",dn,[a("h6",cn,c(F(((p=d.stats)==null?void 0:p.total_stock_value)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"secondary",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-chart-line"})]),_:1}),a("div",null,[U[5]||(U[5]=a("span",{class:"text-sm text-medium-emphasis"},"Harga Rata-rata",-1)),a("div",mn,[a("h6",vn,c(F(((p=d.stats)==null?void 0:p.average_price)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"coffee",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-trending-up"})]),_:1}),a("div",null,[U[6]||(U[6]=a("span",{class:"text-sm text-medium-emphasis"},"Margin Rata-rata",-1)),a("div",fn,[a("h6",pn,c(h(((p=d.stats)==null?void 0:p.average_margin)||0)),1)])])]}),_:1})]),_:1})]),_:1}),e(E,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(de,{class:"stats-card"},{default:t(()=>[e(fe,{class:"d-flex align-center"},{default:t(()=>{var p;return[e(Te,{size:"44",rounded:"",color:"surface",variant:"tonal",class:"me-3"},{default:t(()=>[e(S,{icon:"tabler-x-circle"})]),_:1}),a("div",null,[U[7]||(U[7]=a("span",{class:"text-sm text-medium-emphasis"},"Stok Habis",-1)),a("div",gn,[a("h6",_n,c(((p=d.stats)==null?void 0:p.out_of_stock_products)||0),1)])])]}),_:1})]),_:1})]),_:1})]),_:1}))}}),yn=Je(kn,[["__scopeId","data-v-124783ae"]]),bn={class:"d-flex align-center gap-2"},hn={class:"d-flex align-center gap-2"},xn={class:"text-center py-8"},wn={class:"d-flex align-center gap-3 py-2"},Vn={class:"font-weight-medium"},Pn={class:"text-caption text-medium-emphasis"},Cn={class:"text-end"},Sn={class:"font-weight-medium"},In={key:0,class:"text-caption text-medium-emphasis"},$n={class:"text-center profit-margin-container"},Dn={class:"text-center"},Tn={key:0,class:"text-caption text-medium-emphasis mt-1"},Un={class:"d-flex align-center gap-2"},zn={class:"text-body-2"},An={class:"text-caption text-medium-emphasis"},Mn={class:"d-flex align-center gap-1"},En=Le({__name:"ProductTable",props:{products:{},totalItems:{},loading:{type:Boolean},currentPage:{},itemsPerPage:{},selectedProducts:{},toggleLoading:{}},emits:["add-product","view-product","edit-product","manage-recipes","open-recipe-dialog","open-composition-dialog","open-variant-dialog","delete-product","toggle-active","toggle-featured","bulk-delete","update:page","update:items-per-page","update:sort-by","update:selected-products"],setup(l){const F=[{title:"Produk",key:"name",sortable:!0,width:"250px"},{title:"Kategori",key:"category",sortable:!1,width:"120px"},{title:"Harga",key:"price",sortable:!0,align:"end",width:"130px"},{title:"Margin",key:"profit_margin",sortable:!0,align:"center",width:"100px"},{title:"Stok",key:"stock",sortable:!0,align:"center",width:"100px"},{title:"Status",key:"active",sortable:!0,width:"140px"},{title:"Dibuat",key:"created_at",sortable:!0,width:"120px"},{title:"Aksi",key:"actions",sortable:!1,align:"center",width:"200px"}],h=m=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(m),d=m=>new Date(m).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}),U=m=>new Date(m).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),p=(m,r)=>m<=0?"error":r&&m<=r?"warning":"success",V=m=>m<10?"error":m<25?"warning":m<50?"success":"info";return(m,r)=>(b(),N(de,null,{default:t(()=>[e(Ie,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",bn,[e(S,{icon:"tabler-list",class:"coffee-icon"}),r[7]||(r[7]=v(" Data Produk ")),m.totalItems?(b(),N(pe,{key:0,size:"small",color:"coffee",variant:"tonal"},{default:t(()=>[v(c(m.totalItems)+" item ",1)]),_:1})):te("",!0)]),a("div",hn,[m.selectedProducts.length>0?(b(),N(K,{key:0,"prepend-icon":"tabler-trash",color:"error",variant:"outlined",onClick:r[0]||(r[0]=n=>m.$emit("bulk-delete"))},{default:t(()=>[v(" Hapus Terpilih ("+c(m.selectedProducts.length)+") ",1)]),_:1})):te("",!0),e(K,{"prepend-icon":"tabler-plus",color:"coffee",onClick:r[1]||(r[1]=n=>m.$emit("add-product"))},{default:t(()=>r[8]||(r[8]=[v(" Tambah Produk ")])),_:1,__:[8]})])]),_:1}),e(Ee),e(Za,{"model-value":m.selectedProducts,"onUpdate:modelValue":r[3]||(r[3]=n=>m.$emit("update:selected-products",n)),headers:F,items:m.products,"items-length":m.totalItems,loading:m.loading,"items-per-page":m.itemsPerPage,page:m.currentPage,"show-select":"","item-value":"id",class:"products-table","onUpdate:page":r[4]||(r[4]=n=>m.$emit("update:page",n)),"onUpdate:itemsPerPage":r[5]||(r[5]=n=>m.$emit("update:items-per-page",n)),"onUpdate:sortBy":r[6]||(r[6]=n=>m.$emit("update:sort-by",n))},{loading:t(()=>[e(el,{type:"table-row@10"})]),"no-data":t(()=>[a("div",xn,[e(S,{icon:"tabler-package-off",size:"64",class:"mb-4 text-disabled"}),r[10]||(r[10]=a("h6",{class:"text-h6 mb-2"}," Tidak ada produk ",-1)),r[11]||(r[11]=a("p",{class:"text-body-2 text-medium-emphasis mb-4"}," Belum ada produk yang ditambahkan atau sesuai dengan filter yang dipilih. ",-1)),e(K,{"prepend-icon":"tabler-plus",color:"coffee",onClick:r[2]||(r[2]=n=>m.$emit("add-product"))},{default:t(()=>r[9]||(r[9]=[v(" Tambah Produk Pertama ")])),_:1,__:[9]})])]),"item.name":t(({item:n})=>[a("div",wn,[e(Te,{image:n.image_url,size:"40",rounded:"",class:"product-avatar"},{default:t(()=>[n.image_url?te("",!0):(b(),N(S,{key:0,icon:"tabler-package"}))]),_:2},1032,["image"]),a("div",null,[a("div",Vn,c(n.name),1),a("div",Pn," SKU: "+c(n.sku||"-"),1)])])]),"item.category":t(({item:n})=>[e(pe,{color:"coffee",size:"small",variant:"tonal"},{default:t(()=>{var W;return[v(c(((W=n.category)==null?void 0:W.name)||"-"),1)]}),_:2},1024)]),"item.price":t(({item:n})=>[a("div",Cn,[a("div",Sn,c(h(n.price)),1),n.cost?(b(),se("div",In," HPP: "+c(h(n.cost)),1)):te("",!0)])]),"item.profit_margin":t(({item:n})=>[a("div",$n,[n.cost&&n.cost>0&&n.profit_margin!==void 0?(b(),N(pe,{key:0,color:V(n.profit_margin),size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>[v(c(Math.round(n.profit_margin))+"% ",1)]),_:2},1032,["color"])):(b(),N(pe,{key:1,color:"grey",size:"small",variant:"tonal",class:"profit-margin-chip"},{default:t(()=>r[12]||(r[12]=[v(" - ")])),_:1,__:[12]}))])]),"item.stock":t(({item:n})=>[a("div",Dn,[e(pe,{color:p(n.stock,n.min_stock),size:"small",variant:"tonal"},{default:t(()=>[v(c(n.stock)+" "+c(n.unit||"pcs"),1)]),_:2},1032,["color"]),n.min_stock?(b(),se("div",Tn," Min: "+c(n.min_stock),1)):te("",!0)])]),"item.active":t(({item:n})=>[a("div",Un,[e(pe,{color:n.active?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[v(c(n.active?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["color"]),n.featured?(b(),N(Ke,{key:0,text:"Produk Unggulan"},{activator:t(({props:W})=>[e(S,we(W,{icon:"tabler-star-filled",color:"warning",size:"small"}),null,16)]),_:1})):te("",!0)])]),"item.created_at":t(({item:n})=>[a("div",zn,c(d(n.created_at??"")),1),a("div",An,c(U((n==null?void 0:n.created_at)??"")),1)]),"item.actions":t(({item:n})=>[a("div",Mn,[e(Ke,{text:"Kelola Komposisi"},{activator:t(({props:W})=>[e(K,we(W,{icon:"tabler-chef-hat",size:"small",variant:"text",color:"primary",onClick:_=>m.$emit("open-composition-dialog",n)}),null,16,["onClick"])]),_:2},1024),e(Ke,{text:"Kelola Variant"},{activator:t(({props:W})=>[e(K,we(W,{icon:"tabler-versions",size:"small",variant:"text",color:"secondary",onClick:_=>m.$emit("open-variant-dialog",n)}),null,16,["onClick"])]),_:2},1024),e(Ke,{text:"Edit Produk"},{activator:t(({props:W})=>[e(K,we(W,{icon:"tabler-edit",size:"small",variant:"text",color:"coffee",onClick:_=>m.$emit("edit-product",n)}),null,16,["onClick"])]),_:2},1024),e(Ke,{text:n.active?"Nonaktifkan":"Aktifkan"},{activator:t(({props:W})=>{var _;return[e(K,we(W,{icon:n.active?"tabler-toggle-right":"tabler-toggle-left",size:"small",variant:"text",color:n.active?"success":"error",loading:((_=m.toggleLoading)==null?void 0:_[n.id_product])||!1,onClick:L=>m.$emit("toggle-active",n)}),null,16,["icon","color","loading","onClick"])]}),_:2},1032,["text"]),e(Ke,{text:n.featured?"Hapus dari Unggulan":"Jadikan Unggulan"},{activator:t(({props:W})=>[e(K,we(W,{icon:n.featured?"tabler-star-filled":"tabler-star",size:"small",variant:"text",color:n.featured?"warning":"default",onClick:_=>m.$emit("toggle-featured",n)}),null,16,["icon","color","onClick"])]),_:2},1032,["text"]),e(Ke,{text:"Hapus Produk"},{activator:t(({props:W})=>[e(K,we(W,{icon:"tabler-trash",size:"small",variant:"text",color:"error",onClick:_=>m.$emit("delete-product",n)}),null,16,["onClick"])]),_:2},1024)])]),_:1},8,["model-value","items","items-length","loading","items-per-page","page"])]),_:1}))}}),Hn=Je(En,[["__scopeId","data-v-bbf8f372"]]),Bn={class:"d-flex align-center gap-3"},Fn={class:"text-h5 font-weight-bold"},Kn={class:"text-h6"},Rn={class:"text-body-1"},qn={class:"d-flex flex-column"},On={class:"font-weight-medium"},Nn={class:"text-caption text-grey-darken-1"},Ln={class:"font-weight-medium"},jn={key:0,class:"text-caption"},Wn={key:1,class:"text-grey-lighten-1 text-caption"},Gn={class:"v-data-table__footer"},Xn={class:"pa-4 d-flex justify-space-between align-center"},Jn={class:"text-subtitle-1 font-weight-bold"},Yn={class:"text-subtitle-2 text-uppercase"},Qn={class:"text-h6 font-weight-bold my-2"},Zn={class:"text-caption"},ea=Le({__name:"HPPVariantBreakdownDialog",props:{modelValue:{type:Boolean},variantId:{},variantName:{default:""}},emits:["update:modelValue","hpp-updated","price-updated"],setup(l,{emit:F}){const h=l,d=F,U=H(!1),p=H(null),V=H(null),m=H(!1),r=H(!1),n=H("latest"),W=H(0),_=H(0),L=H(""),le=H(0),D=H(!1),C=H(!1),ie=H(""),ge=H(""),q=[{title:"Current Cost",value:"current"},{title:"Latest Purchase",value:"latest"},{title:"Average Purchase",value:"average"}],Q=[{title:"Item",value:"item_name",sortable:!0},{title:"Quantity",value:"quantity_needed",align:"end"},{title:"Cost/Unit",value:"cost_per_unit",align:"end"},{title:"Total Cost",value:"total_cost",align:"end"},{title:"Priority",value:"is_critical",align:"center"},{title:"Notes",value:"notes"}],g=Y=>!Y||Y===0?"":new Intl.NumberFormat("id-ID").format(Y),k=Y=>{if(!Y)return 0;const f=Y.replace(/[^\d]/g,"");return parseInt(f)||0},I=Y=>{var u;const f=k(Y);if(_.value=f,L.value=g(f),(u=p.value)!=null&&u.total_hpp&&f>0){const s=p.value.total_hpp;W.value=s>0?Math.round((f-s)/s*100):0}else W.value=0},G=Y=>st(Y),j=async(Y,f)=>{U.value=!0;try{await new Promise(u=>setTimeout(u,500)),p.value={total_hpp:15e4,method:f,calculated_at:new Date().toISOString(),items:[{item_name:"Tepung Terigu",item_code:"TPNG001",quantity_needed:.5,unit:"kg",cost_per_unit:15e3,total_cost:7500,is_critical:!1,notes:null},{item_name:"Gula Pasir",item_code:"GUL001",quantity_needed:.25,unit:"kg",cost_per_unit:12e3,total_cost:3e3,is_critical:!1,notes:null},{item_name:"Telur Ayam",item_code:"TLR001",quantity_needed:3,unit:"pcs",cost_per_unit:3e3,total_cost:9e3,is_critical:!0,notes:"Price volatile"}]},m.value=!0}catch(u){console.error("Error loading HPP breakdown:",u),m.value=!1}finally{U.value=!1}},y=async(Y,f)=>{U.value=!0;try{if(await new Promise(u=>setTimeout(u,1e3)),p.value){switch(f){case"latest":p.value.total_hpp=Math.round(p.value.total_hpp*1.1);break;case"average":p.value.total_hpp=Math.round(p.value.total_hpp*1.05);break;default:p.value.total_hpp=Math.round(p.value.total_hpp*1.03)}p.value.calculated_at=new Date().toISOString()}}catch(u){throw u}finally{U.value=!1}},w=async(Y,f,u,s,i)=>{U.value=!0;try{return await new Promise(z=>setTimeout(z,1e3)),{data:{new_price:u,markup_percentage:p.value?Math.round((u-p.value.total_hpp)/p.value.total_hpp*100):0}}}catch(z){throw z}finally{U.value=!1}},O=async()=>{var Y,f,u;if(h.variantId)try{const s=localStorage.getItem("token"),i=await We.get(`/api/variants/${h.variantId}`,{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}});if(i.data.success&&i.data.data){const z=i.data.data;if(z.price&&z.price>0)_.value=Number(z.price),L.value=g(Number(z.price));else if((Y=p.value)!=null&&Y.total_hpp){const A=Math.round(p.value.total_hpp*1.2);_.value=A,L.value=g(A)}if((f=p.value)!=null&&f.total_hpp&&_.value>0){const A=p.value.total_hpp;W.value=A>0?Math.round((_.value-A)/A*100):0}le.value+=1}}catch(s){console.warn("Could not load target price, using default:",s),(u=p.value)!=null&&u.total_hpp&&(_.value=Math.round(p.value.total_hpp*1.2))}},re=async()=>{h.variantId&&(await j(h.variantId,n.value),await O())},he=async()=>{var Y,f;if(h.variantId)try{await y(h.variantId,n.value),ie.value=`HPP successfully updated using ${n.value} method!`,D.value=!0,d("hpp-updated"),await re()}catch(u){console.error("Error updating HPP:",u),ge.value=((f=(Y=u==null?void 0:u.response)==null?void 0:Y.data)==null?void 0:f.message)||"Failed to update HPP",C.value=!0}},me=async()=>{var Y,f,u,s,i,z;if(h.variantId&&((Y=p.value)!=null&&Y.total_hpp)&&_.value)try{const A=await w(h.variantId,n.value,_.value,!0,!0);if((f=A==null?void 0:A.data)!=null&&f.new_price){if(_.value=A.data.new_price,L.value=g(A.data.new_price),((u=A==null?void 0:A.data)==null?void 0:u.markup_percentage)!==void 0)W.value=A.data.markup_percentage;else{const ke=p.value.total_hpp;W.value=ke>0?Math.round((A.data.new_price-ke)/ke*100):0}le.value+=1,await _t()}await re(),ie.value=`Price successfully updated to ${G(((s=A==null?void 0:A.data)==null?void 0:s.new_price)||_.value)}!`,D.value=!0,d("price-updated")}catch(A){console.error("Error applying price suggestion:",A),ge.value=((z=(i=A==null?void 0:A.response)==null?void 0:i.data)==null?void 0:z.message)||"Failed to update variant price",C.value=!0}};return Ce(()=>h.modelValue,Y=>{Y&&h.variantId&&re()}),Ce(()=>h.variantId,Y=>{Y&&h.modelValue&&re()}),Ce(n,async()=>{h.variantId&&await re()}),Ce([()=>{var Y;return(Y=p.value)==null?void 0:Y.total_hpp},_],()=>{var Y;if((Y=p.value)!=null&&Y.total_hpp&&_.value>0){const f=p.value.total_hpp;W.value=f>0?Math.round((_.value-f)/f*100):0}else W.value=0}),Ce(_,Y=>{Y!==k(L.value)&&(L.value=g(Y))}),(Y,f)=>(b(),se(Ae,null,[e(Ge,{"model-value":Y.modelValue,"max-width":"1200",scrollable:"","onUpdate:modelValue":f[6]||(f[6]=u=>Y.$emit("update:modelValue",u))},{default:t(()=>[e(de,null,{default:t(()=>[e(Ie,{class:"d-flex align-center justify-space-between"},{default:t(()=>[a("div",Bn,[e(S,{icon:"mdi-calculator-variant",size:"24"}),a("span",null,"HPP Breakdown - "+c(Y.variantName||"Variant"),1)]),e(K,{icon:"mdi-close",size:"small",variant:"text",onClick:f[0]||(f[0]=u=>Y.$emit("update:modelValue",!1))})]),_:1}),e(fe,null,{default:t(()=>[e(Ue,{class:"mb-4"},{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>[e(Oe,{modelValue:n.value,"onUpdate:modelValue":[f[1]||(f[1]=u=>n.value=u),re],items:q,label:"HPP Calculation Method",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>[e(K,{color:"primary",variant:"elevated",loading:U.value,"prepend-icon":"mdi-update",block:"",onClick:he},{default:t(()=>[v(" Update HPP with "+c(n.value),1)]),_:1},8,["loading"])]),_:1})]),_:1}),m.value?(b(),N(de,{key:0,variant:"tonal",color:"primary",class:"mb-4"},{default:t(()=>[e(fe,null,{default:t(()=>[e(Ue,{align:"center"},{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>{var u;return[f[11]||(f[11]=a("div",{class:"text-subtitle-2"}," Total HPP ",-1)),a("div",Fn,c(G(((u=p.value)==null?void 0:u.total_hpp)||0)),1)]}),_:1,__:[11]}),e(E,{cols:"12",md:"4"},{default:t(()=>{var u;return[f[12]||(f[12]=a("div",{class:"text-subtitle-2"}," Calculation Method ",-1)),a("div",Kn,c((u=q.find(s=>{var i;return s.value===((i=p.value)==null?void 0:i.method)}))==null?void 0:u.title),1)]}),_:1,__:[12]}),e(E,{cols:"12",md:"4"},{default:t(()=>{var u;return[f[13]||(f[13]=a("div",{class:"text-subtitle-2"}," Last Calculated ",-1)),a("div",Rn,c((u=p.value)!=null&&u.calculated_at?new Date(p.value.calculated_at).toLocaleString():"-"),1)]}),_:1,__:[13]})]),_:1})]),_:1})]),_:1})):te("",!0),m.value?(b(),N(de,{key:1},{default:t(()=>{var u;return[e(Ie,null,{default:t(()=>{var s,i;return[e(S,{icon:"mdi-format-list-bulleted",class:"me-2"}),v(" Item Breakdown ("+c(((i=(s=p.value)==null?void 0:s.items)==null?void 0:i.length)||0)+" items) ",1)]}),_:1}),e(tl,{headers:Q,items:((u=p.value)==null?void 0:u.items)||[],"items-per-page":10,class:"elevation-0"},{"item.item_name":t(({item:s})=>[a("div",qn,[a("span",On,c(s.item_name),1),a("span",Nn,c(s.item_code),1)])]),"item.quantity_needed":t(({item:s})=>[a("span",Ln,c(s.quantity_needed)+" "+c(s.unit),1)]),"item.cost_per_unit":t(({item:s})=>[a("span",null,c(G(s.cost_per_unit)),1)]),"item.total_cost":t(({item:s})=>[e(pe,{color:s.is_critical?"error":"primary",variant:"elevated",size:"small"},{default:t(()=>[v(c(G(s.total_cost)),1)]),_:2},1032,["color"])]),"item.is_critical":t(({item:s})=>[e(pe,{color:s.is_critical?"error":"success","prepend-icon":s.is_critical?"mdi-alert":"mdi-check",variant:"tonal",size:"small"},{default:t(()=>[v(c(s.is_critical?"Critical":"Normal"),1)]),_:2},1032,["color","prepend-icon"])]),"item.notes":t(({item:s})=>[s.notes?(b(),se("span",jn,c(s.notes),1)):(b(),se("span",Wn,"â€”"))]),bottom:t(()=>{var s;return[a("div",Gn,[e(Ee),a("div",Xn,[a("div",Jn," Total HPP: "+c(G(((s=p.value)==null?void 0:s.total_hpp)||0)),1),e(pe,{color:"info",variant:"elevated"},{default:t(()=>{var i,z;return[v(c(((z=(i=p.value)==null?void 0:i.items)==null?void 0:z.length)||0)+" items ",1)]}),_:1})])])]}),_:1},8,["items"])]}),_:1})):te("",!0),m.value?(b(),N(de,{key:2,class:"mt-4"},{default:t(()=>[e(Ie,null,{default:t(()=>[e(S,{icon:"mdi-cash-multiple",class:"me-2"}),f[14]||(f[14]=v(" Price Suggestion "))]),_:1,__:[14]}),e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"6"},{default:t(()=>{var u;return[(b(),N(Pe,{key:le.value,modelValue:L.value,"onUpdate:modelValue":[f[2]||(f[2]=s=>L.value=s),I],label:"Target Selling Price",variant:"outlined",prefix:"Rp",hint:`Current HPP: ${G(((u=p.value)==null?void 0:u.total_hpp)||0)}`,"persistent-hint":""},null,8,["modelValue","hint"]))]}),_:1}),e(E,{cols:"12",md:"6"},{default:t(()=>{var u;return[(b(),N(Pe,{key:le.value,modelValue:W.value,"onUpdate:modelValue":f[3]||(f[3]=s=>W.value=s),label:"Markup Percentage",variant:"outlined",type:"number",min:"0",step:"5",suffix:"%",readonly:"",hint:`Profit: ${G(_.value-(((u=p.value)==null?void 0:u.total_hpp)||0))}`,"persistent-hint":""},null,8,["modelValue","hint"]))]}),_:1})]),_:1}),e(Ue,{class:"mt-2"},{default:t(()=>[e(E,{cols:"12",md:"12"},{default:t(()=>[e(K,{color:"success",variant:"elevated","prepend-icon":"mdi-check-circle",loading:U.value,disabled:!_.value||_.value<=0,block:"",onClick:me},{default:t(()=>f[15]||(f[15]=[v(" Apply Price ")])),_:1,__:[15]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})):te("",!0),r.value?(b(),N(de,{key:3,variant:"tonal",color:"success",class:"mt-4"},{default:t(()=>[e(Ie,null,{default:t(()=>[e(S,{icon:"mdi-lightbulb",class:"me-2"}),f[16]||(f[16]=v(" Price Suggestions "))]),_:1,__:[16]}),e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[(b(!0),se(Ae,null,et(V.value.suggestions,(u,s)=>(b(),N(E,{key:s,cols:"12",md:"4"},{default:t(()=>[e(de,{variant:"elevated"},{default:t(()=>[e(fe,{class:"text-center"},{default:t(()=>[a("div",Yn,c(s)+" Method ",1),a("div",Qn,c(G(u.suggested_price)),1),a("div",Zn,[v(" HPP: "+c(G(u.hpp)),1),f[17]||(f[17]=a("br",null,null,-1)),v(" Markup: "+c(u.markup_percentage.toFixed(1))+"%",1),f[18]||(f[18]=a("br",null,null,-1)),v(" Margin: "+c(u.profit_margin.toFixed(1))+"% ",1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):te("",!0),!m.value&&!U.value?(b(),N(de,{key:4,variant:"outlined"},{default:t(()=>[e(fe,{class:"text-center py-8"},{default:t(()=>[e(S,{icon:"mdi-calculator-variant-outline",size:"64",color:"grey",class:"mb-4"}),f[20]||(f[20]=a("div",{class:"text-h6 mb-2"}," No HPP Data Available ",-1)),f[21]||(f[21]=a("div",{class:"text-body-2 text-medium-emphasis mb-4"}," Add composition items first, then calculate HPP using the method above. ",-1)),e(K,{color:"primary","prepend-icon":"mdi-plus",onClick:f[4]||(f[4]=u=>Y.$emit("update:modelValue",!1))},{default:t(()=>f[19]||(f[19]=[v(" Add Composition Items ")])),_:1,__:[19]})]),_:1,__:[20,21]})]),_:1})):te("",!0)]),_:1}),e(Ne,{class:"pa-4"},{default:t(()=>[e(Xe),e(K,{variant:"outlined",color:"grey","prepend-icon":"mdi-close",onClick:f[5]||(f[5]=u=>Y.$emit("update:modelValue",!1))},{default:t(()=>f[22]||(f[22]=[v(" Batal ")])),_:1,__:[22]})]),_:1})]),_:1})]),_:1},8,["model-value"]),e(it,{modelValue:D.value,"onUpdate:modelValue":f[8]||(f[8]=u=>D.value=u),color:"success",location:"top"},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:f[7]||(f[7]=u=>D.value=!1)},{default:t(()=>f[23]||(f[23]=[v(" Close ")])),_:1,__:[23]})]),default:t(()=>[v(c(ie.value)+" ",1)]),_:1},8,["modelValue"]),e(it,{modelValue:C.value,"onUpdate:modelValue":f[10]||(f[10]=u=>C.value=u),color:"error",location:"top"},{actions:t(()=>[e(K,{color:"white",variant:"text",onClick:f[9]||(f[9]=u=>C.value=!1)},{default:t(()=>f[24]||(f[24]=[v(" Close ")])),_:1,__:[24]})]),default:t(()=>[v(c(ge.value)+" ",1)]),_:1},8,["modelValue"])],64))}}),es={class:"d-flex align-center gap-2"},ts={class:"pa-4",style:{"background-color":"#2A2A2A"}},as={key:0,class:"d-flex align-center gap-3"},ls={class:"text-h6 text-white font-weight-bold"},os={class:"d-flex align-center gap-4 mt-1"},ns={class:"text-caption text-grey-lighten-1"},ss={class:"text-caption text-grey-lighten-1"},is={class:"pa-4 add-item-form"},rs={class:"d-flex align-center justify-space-between mb-4"},us={class:"d-flex align-center gap-2"},ds={class:"text-h6"},cs={key:0,class:"text-error"},ms={key:1},vs={class:"d-flex align-center"},fs={class:"pa-4 text-center"},ps={class:"pa-4 pt-0"},gs={class:"d-flex align-center justify-between mb-4"},_s={class:"text-h6"},ks={key:0,class:"composition-list"},ys={class:"d-flex align-center justify-between"},bs={class:"d-flex align-center gap-3"},hs={class:"font-weight-medium"},xs={class:"text-caption text-medium-emphasis"},ws={class:"font-weight-medium text-primary"},Vs={class:"d-flex align-center gap-2"},Ps={class:"text-center"},Cs={key:0,class:"text-body-2 text-medium-emphasis"},Ss={class:"text-center"},Is={class:"text-body-1 mb-2",style:{"white-space":"pre-line"}},$s=Le({__name:"AddItemCompositionDialog",props:{modelValue:{type:Boolean},variant:{}},emits:["update:modelValue","save"],setup(l,{emit:F}){const h=l,d=F,U=H(),p=H(!1),V=H(!1),m=H([]),r=H([]),n=H(!1),W=H(null),_=H(!1),L=H(null),le=H(!1),D=H(!1),C=H(""),ie=H(""),ge=H("success"),q=H(!1),Q=ce({get:()=>(console.log("ðŸ”µ [DEBUG] Dialog getter called, props.modelValue:",h.modelValue),h.modelValue),set:M=>{console.log("ðŸ”µ [DEBUG] Dialog setter called with value:",M),d("update:modelValue",M)}}),g=()=>({item_id:null,quantity:1,is_critical:!1}),k=H(g()),I=ce(()=>!k.value.item_id||!Array.isArray(m.value)?null:m.value.find(M=>M.id_item===k.value.item_id)),G=ce(()=>!I.value||n.value&&W.value!==null?null:r.value.find(M=>{var o,T;return M.name===((o=I.value)==null?void 0:o.name)||M.id&&((T=I.value)==null?void 0:T.id_item)&&M.id===I.value.id_item})),j=ce(()=>{if(!I.value)return"";if(n.value&&W.value!==null)return"Mode Edit: Mengubah quantity item yang dipilih";if(G.value){const M=G.value;return`Item sudah ada dengan quantity ${M.quantity} ${M.unit}. Quantity akan ditambahkan.`}return`Stok tersedia: ${w(I.value)} ${I.value.unit}`}),y=ce(()=>Array.isArray(m.value)?m.value.filter(M=>w(M)>0):[]),w=M=>{var o,T;return((o=M.inventory)==null?void 0:o.current_stock)||((T=M.inventory)==null?void 0:T.available_stock)||M.current_stock||0},O=()=>V.value?"Memuat items...":!m.value||m.value.length===0?"Tidak ada item tersedia":y.value.length===0?"Semua item sedang stok habis":"Tidak ada item yang ditemukan",re=M=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(M),he=M=>{switch(M){case"overstock":return"success";case"in_stock":return"primary";case"low_stock":return"warning";case"out_of_stock":return"error";default:return"grey"}},me=M=>{switch(M){case"overstock":return"Berlebih";case"in_stock":return"Tersedia";case"low_stock":return"Menipis";case"out_of_stock":return"Habis";default:return"Unknown"}},Y=(M,o,T)=>{var P,ve,_e,ze,He,Me,Be,qe;if(!o)return!0;const R=o.toLowerCase().trim(),J=((ve=(P=T==null?void 0:T.raw)==null?void 0:P.name)==null?void 0:ve.toLowerCase())||"",$=((ze=(_e=T==null?void 0:T.raw)==null?void 0:_e.item_code)==null?void 0:ze.toLowerCase())||"",Z=((Me=(He=T==null?void 0:T.raw)==null?void 0:He.unit)==null?void 0:Me.toLowerCase())||"",ne=((qe=(Be=T==null?void 0:T.raw)==null?void 0:Be.description)==null?void 0:qe.toLowerCase())||"";return J.includes(R)||$.includes(R)||Z.includes(R)||ne.includes(R)},f=async()=>{var M,o,T;V.value=!0,console.log("Loading available items...");try{const R=await We.get("/api/items?per_page=all&include=inventory");console.log("Items API response:",R.data);const J=((o=(M=R.data)==null?void 0:M.data)==null?void 0:o.data)||((T=R.data)==null?void 0:T.data)||R.data||[];m.value=Array.isArray(J)?J:[],console.log("Available items loaded:",m.value.length,"items"),console.log("Sample items with inventory:",m.value.slice(0,3))}catch(R){console.error("Error loading items:",R),R!=null&&R.response&&(console.error("API Error Status:",R.response.status),console.error("API Error Data:",R.response.data)),m.value=[]}finally{V.value=!1}},u=async()=>{var M,o,T,R,J;if(!(!((M=h.variant)!=null&&M.id)&&!((o=h.variant)!=null&&o.id_variant)))try{const $=h.variant.id||h.variant.id_variant;console.log("Loading composition items for variant:",$);const Z=await We.get(`/api/variant-items/variant/${$}`);console.log("Composition API response:",Z.data);const ne=((R=(T=Z.data)==null?void 0:T.data)==null?void 0:R.composition)||((J=Z.data)==null?void 0:J.composition)||[];if(!Array.isArray(ne)){console.warn("API response composition is not an array:",ne),r.value=[];return}r.value=ne.map(P=>{var ve,_e,ze,He,Me,Be,qe,je,oe,Se;return{id:P.id_variant_item||P.id,name:((ve=P.item)==null?void 0:ve.name)||P.name,quantity:parseFloat(P.quantity_needed||P.quantity||P.qty||"1"),unit:P.unit||((_e=P.item)==null?void 0:_e.unit)||"pcs",stock:((He=(ze=P.item)==null?void 0:ze.inventory)==null?void 0:He.current_stock)||((Be=(Me=P.item)==null?void 0:Me.inventory)==null?void 0:Be.available_stock)||((qe=P.item)==null?void 0:qe.current_stock)||P.stock||0,price:parseFloat(((je=P.item)==null?void 0:je.cost_per_unit)||((oe=P.item)==null?void 0:oe.price)||P.price||"0"),is_critical:P.is_critical||!1,inventory:(Se=P.item)!=null&&Se.inventory?{current_stock:P.item.inventory.current_stock||0,available_stock:P.item.inventory.available_stock||0,stock_status:P.item.inventory.stock_status||"unknown",reorder_level:P.item.inventory.reorder_level||0}:null}}),console.log("Composition items loaded:",r.value)}catch($){console.error("Error loading composition items:",$),$!=null&&$.response&&(console.error("API Error Status:",$.response.status),console.error("API Error Data:",$.response.data)),r.value=[]}},s=async()=>{var J,$;const{valid:M}=await U.value.validate();if(!M||!I.value)return;const o=I.value.name,T=I.value.id_item,R=k.value.quantity;if(console.log("ðŸ” Handle save - Mode:",n.value?"EDIT":"ADD"),console.log("ðŸ” Item:",o,"ID:",T),console.log("ðŸ” Quantity:",R),n.value&&W.value!==null){console.log("âœï¸ Edit mode: Updating existing item at index",W.value);const ne=r.value[W.value].quantity;console.log(`ðŸ“ Updating item "${o}":`),console.log(`   - Old quantity: ${ne}`),console.log(`   - New quantity: ${R}`),r.value[W.value].quantity=R,r.value[W.value].is_critical=k.value.is_critical,console.log("âœ… Item updated successfully in edit mode"),n.value=!1,W.value=null}else{console.log("âž• Add mode: Checking for existing item");const Z=r.value.findIndex(ne=>ne.name===o||ne.id&&T&&ne.id===T);if(Z!==-1){const P=r.value[Z].quantity,ve=P+R;console.log("ðŸ“¦ Item already exists! Accumulating quantity:"),console.log(`   - Item: ${o}`),console.log(`   - Old quantity: ${P}`),console.log(`   - Adding: ${R}`),console.log(`   - New quantity: ${ve}`),r.value[Z].quantity=ve}else{console.log("âž• Adding new item to composition:",o);const ne={name:o,quantity:R,unit:I.value.unit,stock:((J=I.value.inventory)==null?void 0:J.current_stock)||(($=I.value.inventory)==null?void 0:$.available_stock)||I.value.current_stock||0,price:I.value.cost_per_unit||0,is_critical:k.value.is_critical,inventory:I.value.inventory?{current_stock:I.value.inventory.current_stock||0,available_stock:I.value.inventory.available_stock||0,stock_status:I.value.inventory.stock_status||"unknown",reorder_level:I.value.inventory.reorder_level||0}:null};r.value.push(ne),console.log("âœ… New item added successfully")}}k.value=g(),console.log("ðŸ”„ Form reset")},i=(M,o)=>{console.log("ðŸ” Edit item called:",M,o);const T=m.value.find(R=>R.name===M.name||R.id_item===M.id);T?(console.log("âœ… Found item in available items:",T),n.value=!0,W.value=o,k.value={item_id:T.id_item,quantity:M.quantity,is_critical:M.is_critical||!1},console.log("ðŸ“ Edit mode activated!"),console.log("ðŸ“ Form data set:",k.value),console.log("ðŸ“ Editing item at index:",o),setTimeout(()=>{const R=document.querySelector(".add-item-form");R&&R.scrollIntoView({behavior:"smooth",block:"start"})},100)):(console.error("âŒ Could not find item in available items"),console.log("Available items:",m.value.map(R=>({id:R.id_item,name:R.name}))),console.log("Looking for item:",{id:M.id,name:M.name}))},z=()=>{console.log("âŒ Edit mode cancelled"),n.value=!1,W.value=null,k.value=g()},A=(M,o)=>{L.value={item:M,index:o},_.value=!0},ke=async()=>{var J,$,Z;if(!L.value)return;const{item:M,index:o}=L.value,T=M.name,R=M.id;le.value=!0,console.log("ðŸš€ Starting delete process for:",T,"ID:",R,"Index:",o);try{R?(console.log("ðŸ—‘ï¸ Deleting item from database:",T,"with ID:",R),await We.delete(`/api/variant-items/${R}`),console.log("âœ… Item deleted from database successfully")):console.log("ðŸ“ Item has no ID, removing from local list only"),_.value=!1,L.value=null,console.log("âœ… Delete dialog closed"),console.log("ðŸ”„ Force refreshing composition list..."),await u(),console.log("âœ… Composition list refreshed from server. New count:",r.value.length),console.log("ðŸ“¡ Emitting save event to parent component..."),d("save"),console.log("âœ… Save event emitted to parent component"),console.log("ðŸŽ‰ Item successfully deleted:",T)}catch(ne){console.error("âŒ Error deleting item:",ne),console.error("âŒ Error details:",(J=ne.response)==null?void 0:J.data),alert("Gagal menghapus item: "+(((Z=($=ne.response)==null?void 0:$.data)==null?void 0:Z.message)||ne.message))}finally{le.value=!1,console.log("ðŸ Delete process completed")}},B=()=>{_.value=!1,L.value=null},x=()=>{switch(ge.value){case"success":return"mdi-check-circle";case"info":return"mdi-information";case"warning":return"mdi-alert";default:return"mdi-check-circle"}},ue=()=>{switch(ge.value){case"success":return"success";case"info":return"info";case"warning":return"warning";default:return"success"}},$e=()=>{switch(ge.value){case"success":return"text-success";case"info":return"text-info";case"warning":return"text-warning";default:return"text-success"}},xe=()=>{switch(ge.value){case"success":return"success";case"info":return"info";case"warning":return"warning";default:return"success"}},Ve=async()=>{var M,o,T,R;if(!((M=h.variant)!=null&&M.id)&&!((o=h.variant)!=null&&o.id_variant)){console.error("No variant ID found");return}p.value=!0;try{const J=h.variant.id||h.variant.id_variant;console.log("ðŸ” [DEBUG] Composition items count:",r.value.length),console.log("ðŸ” [DEBUG] Raw composition items:",JSON.stringify(r.value,null,2));const $=r.value.some(Z=>Z.id);if(console.log("ðŸ” [DEBUG] Has existing items:",$),$){console.log("ï¿½ [EDIT MODE] Updating existing composition");const Z={items:r.value.map(P=>{const ve=m.value.find(_e=>_e.name===P.name);return console.log(`Mapping item "${P.name}":`),console.log("  - Found item:",ve==null?void 0:ve.id_item),console.log("  - Original ID (id_variant_item):",P.id),console.log("  - Quantity:",P.quantity),console.log("  - Unit:",P.unit),console.log("  - Is critical:",P.is_critical),{id_variant_item:P.id,quantity_needed:Number(P.quantity),unit:P.unit,is_critical:P.is_critical||!1}}).filter(P=>P.id_variant_item&&P.quantity_needed>0)};console.log("Edit payload:",JSON.stringify(Z,null,2));const ne=await We.post("/api/variant-items/bulk-update",Z);console.log("Composition updated successfully:",ne.data)}else{console.log("âœ¨ [CREATE MODE] Creating new composition");const Z={id_variant:J,items:r.value.map(P=>{const ve=m.value.find(_e=>_e.name===P.name);return console.log(`Mapping item "${P.name}":`),console.log("  - Found item:",ve==null?void 0:ve.id_item),console.log("  - Quantity:",P.quantity),console.log("  - Unit:",P.unit),console.log("  - Is critical:",P.is_critical),{id_item:ve==null?void 0:ve.id_item,quantity_needed:Number(P.quantity),unit:P.unit,is_critical:P.is_critical||!1}}).filter(P=>P.id_item&&P.quantity_needed>0)};console.log("Create payload:",JSON.stringify(Z,null,2));const ne=await We.post("/api/variant-items/bulk-store",Z);console.log("Composition created successfully:",ne.data)}d("save"),ye()}catch(J){console.error("Error saving composition:",J),alert("Gagal menyimpan komposisi: "+(((R=(T=J.response)==null?void 0:T.data)==null?void 0:R.message)||J.message))}finally{p.value=!1}},ee=()=>{q.value=!0},ye=()=>{Q.value=!1,k.value=g(),r.value=[],n.value=!1,W.value=null};return Ce(()=>h.modelValue,M=>{M?(k.value=g(),f(),u()):(n.value=!1,W.value=null)}),Ce(()=>k.value.item_id,M=>{M&&I.value&&console.log("Item selected:",I.value.name,"Unit:",I.value.unit)}),ft(()=>{f()}),(M,o)=>{var T,R,J;return b(),se(Ae,null,[e(Ge,{modelValue:Q.value,"onUpdate:modelValue":o[3]||(o[3]=$=>Q.value=$),"max-width":"1000px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ie,{class:"d-flex align-center justify-space-between",style:{"background-color":"#D4A574",color:"white"}},{default:t(()=>[a("div",es,[e(S,{icon:"mdi-delete",color:"white"}),o[9]||(o[9]=a("span",null,"Kelola Komposisi Item",-1))]),e(K,{icon:"mdi-close",variant:"text",color:"white",onClick:ye,disabled:p.value},null,8,["disabled"])]),_:1}),e(fe,{class:"pa-0"},{default:t(()=>[a("div",ts,[M.variant?(b(),se("div",as,[e(S,{icon:"mdi-coffee",size:"32",color:"white"}),a("div",null,[a("h3",ls,c(M.variant.name),1),a("div",os,[a("span",ns,"SKU: "+c(M.variant.sku),1),a("span",ss,"Harga: "+c(re(M.variant.price||0)),1),e(pe,{color:"success",size:"small",variant:"tonal"},{default:t(()=>o[10]||(o[10]=[v(" Stok Aman ")])),_:1,__:[10]})])])])):te("",!0)]),a("div",is,[a("div",rs,[a("div",us,[e(S,{icon:"mdi-plus-circle",color:"success"}),a("h4",ds,c(n.value?"Edit Item Komposisi":"Tambah Item Komposisi"),1)])]),e(It,{ref_key:"form",ref:U,onSubmit:Ct(s,["prevent"])},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"4"},{default:t(()=>[e(St,{modelValue:k.value.item_id,"onUpdate:modelValue":o[0]||(o[0]=$=>k.value.item_id=$),items:y.value,"item-title":"name","item-value":"id_item",label:"Pilih Item",variant:"outlined",density:"compact",rules:[$=>!!$||"Item wajib dipilih"],loading:V.value,disabled:V.value||m.value&&m.value.length===0,"no-data-text":O(),placeholder:"Ketik untuk mencari item dengan stok...",clearable:"","menu-props":{maxHeight:"300px"},"hide-details":"auto","custom-filter":Y},{"prepend-inner":t(()=>[e(S,{icon:"mdi-package",size:"16"})]),item:t(({props:$,item:Z})=>[e(at,we($,{title:Z.raw.name,disabled:w(Z.raw)<=0,class:["pa-3",{"text-disabled":w(Z.raw)<=0}]}),{prepend:t(()=>[e(S,{icon:"mdi-package-variant",color:w(Z.raw)<=0?"grey-darken-2":"grey-lighten-1",class:"me-3"},null,8,["color"])]),subtitle:t(()=>[a("div",{class:tt(["text-caption",w(Z.raw)<=0?"text-disabled":"text-medium-emphasis"])},[w(Z.raw)<=0?(b(),se("span",cs,[e(S,{icon:"mdi-alert-circle",size:"12",class:"me-1"}),o[11]||(o[11]=v(" Stok Habis "))])):(b(),se("span",ms," Stok: "+c(w(Z.raw))+" "+c(Z.raw.unit),1))],2)]),append:t(()=>{var ne;return[w(Z.raw)>0?(b(),N(pe,{key:0,size:"x-small",color:he(((ne=Z.raw.inventory)==null?void 0:ne.stock_status)||Z.raw.stock_status||"unknown"),variant:"tonal"},{default:t(()=>{var P;return[v(c(me(((P=Z.raw.inventory)==null?void 0:P.stock_status)||Z.raw.stock_status||"unknown")),1)]}),_:2},1032,["color"])):(b(),N(pe,{key:1,size:"x-small",color:"error",variant:"outlined","prepend-icon":"mdi-close-circle"},{default:t(()=>o[12]||(o[12]=[v(" Habis ")])),_:1,__:[12]}))]}),_:2},1040,["title","disabled","class"])]),selection:t(({item:$})=>[a("div",vs,[e(S,{icon:"mdi-package-variant",size:"16",class:"me-2"}),a("span",null,c($.raw.name),1)])]),"no-data":t(()=>[a("div",fs,[e(S,{icon:"mdi-magnify",size:"48",color:"grey",class:"mb-2"}),o[13]||(o[13]=a("div",{class:"text-body-2 text-medium-emphasis"}," Tidak ada item yang ditemukan ",-1)),o[14]||(o[14]=a("div",{class:"text-caption text-disabled"}," Coba kata kunci yang berbeda ",-1))])]),_:1},8,["modelValue","items","rules","loading","disabled","no-data-text"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>[e(Pe,{modelValue:k.value.quantity,"onUpdate:modelValue":o[1]||(o[1]=$=>k.value.quantity=$),modelModifiers:{number:!0},label:"Jumlah",variant:"outlined",density:"compact",type:"number",min:"0.01",step:"0.01",rules:[$=>!!$||"Jumlah wajib diisi",$=>$>0||"Jumlah harus lebih dari 0"],hint:j.value,"persistent-hint":"",color:G.value?"warning":"primary"},null,8,["modelValue","rules","hint","color"])]),_:1}),e(E,{cols:"12",md:"2"},{default:t(()=>{var $;return[e(Pe,{"model-value":(($=I.value)==null?void 0:$.unit)||"pcs",label:"Satuan",variant:"outlined",density:"compact",readonly:"",disabled:!I.value,placeholder:"Pilih item terlebih dahulu"},{"prepend-inner":t(()=>[e(S,{icon:"mdi-weight",size:"16"})]),_:1},8,["model-value","disabled"])]}),_:1}),e(E,{cols:"12",md:"2",class:"d-flex align-center"},{default:t(()=>[e(vt,{modelValue:k.value.is_critical,"onUpdate:modelValue":o[2]||(o[2]=$=>k.value.is_critical=$),label:"Item Kritis",color:"warning",density:"compact","true-value":!0,"false-value":!1},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"2",class:"d-flex flex-column gap-2"},{default:t(()=>[e(K,{color:n.value?"primary":G.value?"warning":"#D4A574",onClick:s,loading:p.value,disabled:!k.value.item_id||!k.value.quantity,block:""},{default:t(()=>[e(S,{icon:n.value?"mdi-content-save":G.value?"mdi-plus-box-multiple":"mdi-plus",class:"me-1"},null,8,["icon"]),v(" "+c(n.value?"Update":G.value?"Akumulasi":"Tambah"),1)]),_:1},8,["color","loading","disabled"]),n.value?(b(),N(K,{key:0,color:"grey",variant:"outlined",onClick:z,size:"small",block:""},{default:t(()=>[e(S,{icon:"mdi-close",class:"me-1"}),o[15]||(o[15]=v(" Batal "))]),_:1,__:[15]})):te("",!0)]),_:1})]),_:1})]),_:1},512)]),a("div",ps,[a("div",gs,[a("h4",_s,"Daftar Item Komposisi ("+c(r.value.length)+")",1)]),r.value.length>0?(b(),se("div",ks,[(b(!0),se(Ae,null,et(r.value,($,Z)=>(b(),N(de,{key:Z,variant:"outlined",class:"mb-3"},{default:t(()=>[e(fe,{class:"pa-3"},{default:t(()=>{var ne,P,ve,_e,ze,He,Me;return[a("div",ys,[a("div",bs,[e(S,{icon:"mdi-check-circle",color:"success"}),a("div",null,[a("div",hs,c($.name),1),a("div",xs,[a("span",ws,"Dibutuhkan: "+c($.quantity)+" "+c($.unit),1),o[16]||(o[16]=v(" â€¢ ")),a("span",{class:tt({"text-success":(((ne=$.inventory)==null?void 0:ne.current_stock)??0)>(((P=$.inventory)==null?void 0:P.reorder_level)??0),"text-warning":(((ve=$.inventory)==null?void 0:ve.current_stock)??0)<=(((_e=$.inventory)==null?void 0:_e.reorder_level)??0)&&(((ze=$.inventory)==null?void 0:ze.current_stock)??0)>0,"text-error":(((He=$.inventory)==null?void 0:He.current_stock)??0)<=0})}," Stok: "+c(((Me=$.inventory)==null?void 0:Me.current_stock)||$.stock||0)+" "+c($.unit),3),v(" â€¢ "+c(re($.price)),1)])])]),a("div",Vs,[e(K,{icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:Be=>i($,Z)},null,8,["onClick"]),e(K,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:Be=>A($,Z)},null,8,["onClick"])])])]}),_:2},1024)]),_:2},1024))),128))])):(b(),N(de,{key:1,variant:"outlined",class:"text-center pa-6"},{default:t(()=>[e(S,{icon:"mdi-package-variant-closed",size:"48",color:"grey",class:"mb-3"}),o[17]||(o[17]=a("div",{class:"text-body-2 text-medium-emphasis"}," Belum ada item komposisi ditambahkan ",-1))]),_:1,__:[17]}))])]),_:1}),e(Ne,{class:"px-6 pb-6"},{default:t(()=>[e(K,{variant:"outlined",color:"secondary","prepend-icon":"mdi-wrench",onClick:ee},{default:t(()=>o[18]||(o[18]=[v(" Setting HPP ")])),_:1,__:[18]}),e(Xe),e(K,{variant:"outlined",onClick:ye,disabled:p.value},{default:t(()=>o[19]||(o[19]=[v(" Batal ")])),_:1,__:[19]},8,["disabled"]),e(K,{color:"#D4A574",onClick:Ve,loading:p.value,disabled:r.value.length===0},{default:t(()=>o[20]||(o[20]=[v(" Simpan Komposisi ")])),_:1,__:[20]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(ea,{modelValue:q.value,"onUpdate:modelValue":o[4]||(o[4]=$=>q.value=$),"variant-id":((T=M.variant)==null?void 0:T.id)||((R=M.variant)==null?void 0:R.id_variant),"variant-name":(J=M.variant)==null?void 0:J.name,onHppUpdated:o[5]||(o[5]=$=>d("save"))},null,8,["modelValue","variant-id","variant-name"]),e(Ge,{modelValue:_.value,"onUpdate:modelValue":o[6]||(o[6]=$=>_.value=$),"max-width":"400px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ie,{class:"d-flex align-center justify-center text-h6 text-error"},{default:t(()=>[e(S,{icon:"mdi-alert-circle",color:"error",class:"me-2"}),o[21]||(o[21]=v(" Konfirmasi Hapus "))]),_:1,__:[21]}),e(Ee),e(fe,{class:"pa-6"},{default:t(()=>[a("div",Ps,[e(S,{icon:"mdi-delete-alert",size:"64",color:"error",class:"mb-4"}),o[24]||(o[24]=a("p",{class:"text-body-1 mb-2"}," Apakah Anda yakin ingin menghapus item ini? ",-1)),L.value?(b(),se("div",Cs,[a("strong",null,c(L.value.item.name),1),o[22]||(o[22]=a("br",null,null,-1)),v(" Dibutuhkan: "+c(L.value.item.quantity)+" "+c(L.value.item.unit),1)])):te("",!0),e(Re,{type:"warning",variant:"tonal",class:"mt-4 text-start"},{default:t(()=>o[23]||(o[23]=[a("strong",null,"Perhatian:",-1),v(" Item yang sudah dihapus tidak dapat dikembalikan! ")])),_:1,__:[23]})])]),_:1}),e(Ne,{class:"px-6 pb-6"},{default:t(()=>[e(K,{variant:"outlined",onClick:B,disabled:le.value,class:"flex-grow-1"},{default:t(()=>o[25]||(o[25]=[v(" Batal ")])),_:1,__:[25]},8,["disabled"]),e(K,{color:"error",onClick:ke,loading:le.value,class:"flex-grow-1"},{default:t(()=>o[26]||(o[26]=[v(" Hapus ")])),_:1,__:[26]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Ge,{modelValue:D.value,"onUpdate:modelValue":o[8]||(o[8]=$=>D.value=$),"max-width":"450px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ie,{class:tt(["d-flex align-center justify-center text-h6",$e()])},{default:t(()=>[e(S,{icon:x(),color:ue(),class:"me-2",size:"24"},null,8,["icon","color"]),v(" "+c(ie.value),1)]),_:1},8,["class"]),e(Ee),e(fe,{class:"pa-6"},{default:t(()=>[a("div",Ss,[e(S,{icon:x(),color:ue(),size:"64",class:"mb-4"},null,8,["icon","color"]),a("div",Is,c(C.value),1),e(Re,{type:ge.value,variant:"tonal",class:"mt-4 text-start"},{default:t(()=>[ge.value==="success"?(b(),se(Ae,{key:0},[o[27]||(o[27]=a("strong",null,"Berhasil!",-1)),o[28]||(o[28]=v(" Perubahan telah disimpan. "))],64)):ge.value==="info"?(b(),se(Ae,{key:1},[o[29]||(o[29]=a("strong",null,"Informasi:",-1)),o[30]||(o[30]=v(" Item telah diperbarui sesuai permintaan. "))],64)):(b(),se(Ae,{key:2},[o[31]||(o[31]=a("strong",null,"Perhatian:",-1)),o[32]||(o[32]=v(" Silakan periksa kembali informasi. "))],64))]),_:1},8,["type"])])]),_:1}),e(Ne,{class:"px-6 pb-6"},{default:t(()=>[e(Xe),e(K,{color:xe(),onClick:o[7]||(o[7]=$=>D.value=!1),class:"px-6"},{default:t(()=>[e(S,{icon:"mdi-check",class:"me-1"}),o[33]||(o[33]=v(" OK "))]),_:1,__:[33]},8,["color"]),e(Xe)]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}}),Ds=Je($s,[["__scopeId","data-v-df449ced"]]),Ts={class:"d-flex align-center gap-2"},Us={class:"mt-2"},zs={key:0,class:"mt-1 font-weight-medium"},As={key:1,class:"mt-1 text-warning"},Ms=Le({__name:"CreateVariantDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue","save"],setup(l,{emit:F}){const h=l,d=F,U=H(),p=H(!1),V=H(!1),m=H([]),r=H({name:"",selectedProduct:null,selectedProductId:null,active:!0}),n=[g=>!!g||"Nama variant wajib diisi",g=>g.length>=3||"Nama variant minimal 3 karakter"],W=[g=>!!g||"Produk wajib dipilih"],_=(g,k="success")=>{const I=document.createElement("div");I.style.cssText=`
    position: fixed;
    top: 20px;
    right: 20px;
    background: ${k==="success"?"#4CAF50":"#f44336"};
    color: white;
    padding: 16px 24px;
    border-radius: 8px;
    z-index: 9999;
    font-family: 'Roboto', sans-serif;
    font-size: 14px;
    font-weight: 500;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    display: flex;
    align-items: center;
    gap: 8px;
    animation: slideIn 0.3s ease-out;
    min-width: 300px;
  `;const G=document.createElement("span");if(G.innerHTML=k==="success"?"âœ“":"âœ•",G.style.cssText=`
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: rgba(255,255,255,0.2);
    font-weight: bold;
  `,I.appendChild(G),I.appendChild(document.createTextNode(g)),!document.querySelector("#snackbar-styles")){const j=document.createElement("style");j.id="snackbar-styles",j.textContent=`
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `,document.head.appendChild(j)}document.body.appendChild(I),setTimeout(()=>{I.style.animation="slideOut 0.3s ease-in",setTimeout(()=>{I.parentNode&&I.parentNode.removeChild(I)},300)},3e3),console.log(`${k}: ${g}`)},L=async()=>{V.value=!0;try{const g=await We.get("/api/products");m.value=g.data.data||g.data||[],console.log("Fetched products:",m.value),console.log("First product structure:",m.value[0])}catch(g){console.error("Gagal mengambil data produk:",g),m.value=[]}finally{V.value=!1}},le=g=>{!g&&m.value.length===0&&L()},D=g=>{console.log("Product object changed:",g),r.value.selectedProduct=g,g?r.value.selectedProductId=g.id:r.value.selectedProductId=null},C=ce(()=>{if(console.log("Computing selected product info..."),console.log("form.selectedProduct:",r.value.selectedProduct),console.log("form.selectedProductId:",r.value.selectedProductId),r.value.selectedProduct)return console.log("Using selectedProduct object:",r.value.selectedProduct),r.value.selectedProduct;if(r.value.selectedProductId&&m.value.length>0){console.log("Searching for product with ID:",r.value.selectedProductId),console.log("Product IDs available:",m.value.map(k=>({id:k.id,name:k.name})));const g=m.value.find(k=>k.id===r.value.selectedProductId);return console.log("Found selected product by ID:",g),g}return console.log("No product selected or no products available"),null}),ie=()=>{console.log("Generating SKU...");const g=C.value;if(console.log("Product info for SKU:",g),console.log("Form name:",r.value.name),console.log("Form selectedProductId:",r.value.selectedProductId),!g||!r.value.name)return console.log("Missing productInfo or name, returning empty SKU"),"";const k=g.sku||"PROD",I=r.value.name.replace(/\s+/g,"").toUpperCase().substring(0,3),G=Date.now().toString().slice(-4),j=`${k}-${I}-${G}`;return console.log("Generated SKU:",j),j},ge=async()=>{var I,G;if(p.value)return;const{valid:g}=await U.value.validate();if(!g)return;const k=C.value;if(console.log("Product info in saveVariant:",k),!k){_("Produk tidak ditemukan","error");return}if(!k.id&&!k.id_product){_("ID Produk tidak valid","error"),console.error("Product missing ID:",k);return}p.value=!0;try{const j={id_product:k.id||k.id_product,name:r.value.name,sku:ie(),price:0,cost_price:null,barcode:null,variant_values:[],active:r.value.active};console.log("Payload being sent:",j),console.log("Payload JSON:",JSON.stringify(j));const y=await We.post("/api/variants",j);if(console.log("API Response:",y.data),console.log("Response Status:",y.status),y.data.success!==!1&&(y.status===200||y.status===201))_("Variant berhasil dibuat!","success"),console.log("Created variant data:",y.data.data),d("save"),Q();else throw new Error(y.data.message||"Gagal membuat variant")}catch(j){const y=((G=(I=j.response)==null?void 0:I.data)==null?void 0:G.message)||j.message||"Gagal membuat variant";_(y,"error"),console.error("Save variant error:",j)}finally{p.value=!1}},q=()=>{var g;r.value={name:"",selectedProduct:null,selectedProductId:null,active:!0},(g=U.value)==null||g.resetValidation()},Q=()=>{d("update:modelValue",!1),q()};return Ce(()=>h.modelValue,g=>{g&&(q(),L())}),(g,k)=>(b(),N(Ge,{"model-value":g.modelValue,"onUpdate:modelValue":k[3]||(k[3]=I=>g.$emit("update:modelValue",I)),"max-width":"600px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ie,{class:"bg-primary text-white"},{default:t(()=>[e(S,{icon:"mdi-plus-circle",class:"me-2"}),k[4]||(k[4]=v(" Tambah Variant Baru ")),e(Xe),e(K,{icon:"mdi-close",variant:"text",color:"white",onClick:Q})]),_:1,__:[4]}),e(It,{ref_key:"formRef",ref:U,onSubmit:Ct(ge,["prevent"])},{default:t(()=>[e(fe,{class:"pa-6"},{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12"},{default:t(()=>[e(St,{modelValue:r.value.selectedProduct,"onUpdate:modelValue":[k[0]||(k[0]=I=>r.value.selectedProduct=I),D],items:m.value,loading:V.value,"item-title":"name","return-object":"",label:"Pilih Produk *",placeholder:"Cari produk...",variant:"outlined",rules:W,required:"","no-data-text":"Tidak ada produk ditemukan","onUpdate:search":le},{item:t(({props:I,item:G})=>[e(at,Sa(Ia(I)),{prepend:t(()=>[e(Te,{image:G.raw.image_url,size:"40"},{default:t(()=>[G.raw.image_url?te("",!0):(b(),N(S,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"])]),default:t(()=>[e(ct,null,{default:t(()=>[v(c(G.raw.name),1)]),_:2},1024),e(mt,null,{default:t(()=>[v("SKU: "+c(G.raw.sku||"-"),1)]),_:2},1024)]),_:2},1040)]),selection:t(({item:I})=>[a("div",Ts,[e(Te,{image:I.raw.image_url,size:"24"},{default:t(()=>[I.raw.image_url?te("",!0):(b(),N(S,{key:0,icon:"mdi-coffee",size:"16"}))]),_:2},1032,["image"]),a("span",null,c(I.raw.name),1)])]),_:1},8,["modelValue","items","loading"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Pe,{modelValue:r.value.name,"onUpdate:modelValue":k[1]||(k[1]=I=>r.value.name=I),label:"Nama Variant *",placeholder:"Contoh: Large Hot, Medium Cold, dll",variant:"outlined",rules:n,required:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(Re,{color:"info",variant:"tonal",class:"mb-0"},{default:t(()=>[e(yt,null,{default:t(()=>[e(S,{icon:"mdi-information",class:"me-2"}),k[5]||(k[5]=v(" SKU Otomatis "))]),_:1,__:[5]}),a("div",Us,[k[6]||(k[6]=v(" SKU variant akan dibuat otomatis berdasarkan nama produk dan variant ")),r.value.name&&(r.value.selectedProduct||r.value.selectedProductId)?(b(),se("div",zs," Preview SKU: "+c(ie()),1)):r.value.name&&!r.value.selectedProduct&&!r.value.selectedProductId?(b(),se("div",As," Pilih produk terlebih dahulu untuk melihat preview SKU ")):te("",!0)])]),_:1})]),_:1}),e(E,{cols:"12"},{default:t(()=>[e(vt,{modelValue:r.value.active,"onUpdate:modelValue":k[2]||(k[2]=I=>r.value.active=I),label:"Variant Aktif",color:"primary",inset:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Ee),e(Ne,{class:"pa-6"},{default:t(()=>[e(Xe),e(K,{variant:"outlined",onClick:Q,disabled:p.value},{default:t(()=>k[7]||(k[7]=[v(" Batal ")])),_:1,__:[7]},8,["disabled"]),e(K,{type:"submit",color:"primary",loading:p.value},{default:t(()=>k[8]||(k[8]=[v(" Simpan Variant ")])),_:1,__:[8]},8,["loading"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["model-value"]))}}),Es=Je(Ms,[["__scopeId","data-v-6f78bbf1"]]),Hs={class:"product-variant-tab"},Bs={class:"d-flex gap-2"},Fs={key:0,class:"mt-4 d-flex align-center gap-2"},Ks={key:1,class:"text-center pa-12"},Rs={key:2,class:"text-center pa-12"},qs={class:"d-flex align-center gap-3"},Os={class:"flex-grow-1 min-width-0"},Ns={class:"text-h6 font-weight-bold text-truncate"},Ls={class:"text-body-2 text-medium-emphasis mb-0"},js={class:"d-flex flex-column gap-1"},Ws={class:"text-xs"},Gs={class:"d-flex align-center gap-2"},Xs={class:"text-primary font-weight-medium"},Js={class:"d-flex gap-1"},Ys={class:"d-flex align-center justify-space-between w-100"},Qs={class:"d-flex gap-1"},Zs=Le({__name:"ProductVariantTab",props:{loading:{type:Boolean}},emits:["refresh"],setup(l,{emit:F}){const h=F,d=H(!1),U=H([]),p=H(!1),V=H(!1),m=H(null),r=H(!1),n=H(!1),W=H(!1),_=H({search:"",stockStatus:"",activeStatus:null,sortBy:"name_asc"}),L=[{title:"Semua Status",value:""},{title:"Stok Aman",value:"safe"},{title:"Stok Kritis",value:"critical"},{title:"Stok Habis",value:"out"}],le=[{title:"Nama Produk A-Z",value:"name_asc"},{title:"Nama Produk Z-A",value:"name_desc"},{title:"Variant Terbanyak",value:"variants_desc"},{title:"Variant Tersedikit",value:"variants_asc"}],D=ce(()=>!!(_.value.search||_.value.stockStatus||_.value.activeStatus!==null||_.value.sortBy!=="name_asc")),C=ce(()=>{const f={};return U.value.forEach(u=>{const s=u.id_product;f[s]||(f[s]={product:u.product||{id:u.id_product,id_product:u.id_product,name:`Product ${u.id_product}`,sku:""},variants:[]}),f[s].variants.push(u)}),Object.values(f)}),ie=ce(()=>{let f=[...C.value];if(_.value.search){const u=_.value.search.toLowerCase();f=f.filter(s=>{var i;return s.product.name.toLowerCase().includes(u)||((i=s.product.sku)==null?void 0:i.toLowerCase().includes(u))||s.variants.some(z=>z.name.toLowerCase().includes(u)||z.sku.toLowerCase().includes(u))})}switch(_.value.stockStatus&&(f=f.filter(u=>u.variants.some(s=>{var z;return(((z=s.composition_summary)==null?void 0:z.stock_status)||"safe")===_.value.stockStatus}))),_.value.activeStatus!==null&&(f=f.filter(u=>u.variants.some(s=>s.is_active===_.value.activeStatus))),_.value.sortBy){case"name_asc":f.sort((u,s)=>u.product.name.localeCompare(s.product.name));break;case"name_desc":f.sort((u,s)=>s.product.name.localeCompare(u.product.name));break;case"variants_desc":f.sort((u,s)=>s.variants.length-u.variants.length);break;case"variants_asc":f.sort((u,s)=>u.variants.length-s.variants.length);break}return f}),ge=(f,u="success")=>{},q=async()=>{var f,u,s;d.value=!0;try{const i=await We.get("/api/variants",{params:{per_page:1e3,with_product:!0,with_composition:!0}});if(i.data.success===!1)throw new Error(i.data.message||"Failed to load variants");const z=((f=i.data.data)==null?void 0:f.data)||i.data.data||[];U.value=z.map(A=>({...A,is_active:A.active!==void 0?A.active:A.is_active,id:A.id_variant||A.id,id_product:A.id_product||A.product_id}))}catch(i){(s=(u=i.response)==null?void 0:u.data)!=null&&s.message||i.message,U.value=[]}finally{d.value=!1}},Q=f=>{m.value=f,r.value=!0},g=f=>{f&&(m.value=f,n.value=!0)},k=f=>{m.value=f,p.value=!0},I=()=>{W.value=!0},G=async()=>{var f,u;if(m.value)try{V.value=!0,await We.delete(`/api/variants/${m.value.id_variant}`),ge("Variant berhasil dihapus","success"),await q(),p.value=!1}catch(s){(u=(f=s.response)==null?void 0:f.data)!=null&&u.message}finally{V.value=!1}},j=f=>{switch(f){case"critical":return"error";case"out":return"error";case"safe":return"success";default:return"primary"}},y=f=>{switch(f){case"critical":return"Kritis";case"out":return"Habis";case"safe":return"Aman";default:return"Normal"}},w=f=>{const u=f.filter(s=>s.is_active).length;return u===0?"error":u===f.length?"success":"warning"},O=f=>f.some(u=>{var i;const s=(i=u.composition_summary)==null?void 0:i.stock_status;return s==="critical"||s==="out"}),re=f=>{const u=f.filter(i=>i.is_active).length,s=f.filter(i=>{var A;const z=(A=i.composition_summary)==null?void 0:A.stock_status;return z==="critical"||z==="out"}).length;return s>0?{text:`${s} Stok Kritis`,color:"error",icon:"mdi-alert-circle"}:u===f.length?{text:"Semua Aktif",color:"success",icon:"mdi-check-circle"}:u===0?{text:"Semua Nonaktif",color:"error",icon:"mdi-close-circle"}:{text:`${u}/${f.length} Aktif`,color:"warning",icon:"mdi-minus-circle"}},he=()=>{_.value={search:"",stockStatus:"",activeStatus:null,sortBy:"name_asc"}},me=()=>{q(),h("refresh")},Y=()=>{console.log("Variant created, refreshing data..."),q(),h("refresh")};return ft(()=>{q()}),(f,u)=>{var s,i,z;return b(),se("div",Hs,[e(de,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(Ie,{class:"d-flex align-center justify-space-between"},{default:t(()=>[u[14]||(u[14]=a("div",null,[a("h2",{class:"text-h5 font-weight-bold"},"Variant Produk"),a("p",{class:"text-body-2 text-medium-emphasis"}," Kelola variant dan komposisi untuk produk Anda ")],-1)),a("div",Bs,[e(K,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:q,loading:d.value},{default:t(()=>u[12]||(u[12]=[v(" Refresh ")])),_:1,__:[12]},8,["loading"]),e(K,{color:"primary","prepend-icon":"mdi-plus",onClick:I},{default:t(()=>u[13]||(u[13]=[v(" Tambah Variant ")])),_:1,__:[13]})])]),_:1,__:[14]})]),_:1}),e(de,{class:"mb-6",elevation:"0",variant:"outlined"},{default:t(()=>[e(fe,null,{default:t(()=>[e(Ue,null,{default:t(()=>[e(E,{cols:"12",md:"3"},{default:t(()=>[e(Pe,{modelValue:_.value.search,"onUpdate:modelValue":u[0]||(u[0]=A=>_.value.search=A),label:"Cari Variant",placeholder:"Nama variant, SKU, atau produk...",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-magnify","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:_.value.stockStatus,"onUpdate:modelValue":u[1]||(u[1]=A=>_.value.stockStatus=A),items:L,label:"Status Stok",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:_.value.activeStatus,"onUpdate:modelValue":u[2]||(u[2]=A=>_.value.activeStatus=A),items:[{title:"Semua Status",value:null},{title:"Aktif",value:!0},{title:"Nonaktif",value:!1}],label:"Status Aktif",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue"])]),_:1}),e(E,{cols:"12",md:"3"},{default:t(()=>[e(Oe,{modelValue:_.value.sortBy,"onUpdate:modelValue":u[3]||(u[3]=A=>_.value.sortBy=A),items:le,label:"Urutkan",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),D.value?(b(),se("div",Fs,[u[16]||(u[16]=a("span",{class:"text-body-2"},"Filter aktif:",-1)),_.value.search?(b(),N(pe,{key:0,size:"small",closable:"","onClick:close":u[4]||(u[4]=A=>_.value.search="")},{default:t(()=>[v(" Pencarian: "+c(_.value.search),1)]),_:1})):te("",!0),_.value.stockStatus?(b(),N(pe,{key:1,size:"small",closable:"","onClick:close":u[5]||(u[5]=A=>_.value.stockStatus="")},{default:t(()=>{var A;return[v(" Stok: "+c((A=L.find(ke=>ke.value===_.value.stockStatus))==null?void 0:A.title),1)]}),_:1})):te("",!0),_.value.activeStatus!==null?(b(),N(pe,{key:2,size:"small",closable:"","onClick:close":u[6]||(u[6]=A=>_.value.activeStatus=null)},{default:t(()=>[v(" Status: "+c(_.value.activeStatus?"Aktif":"Nonaktif"),1)]),_:1})):te("",!0),e(K,{variant:"text",size:"small",color:"error",onClick:he},{default:t(()=>u[15]||(u[15]=[v(" Hapus Semua Filter ")])),_:1,__:[15]})])):te("",!0)]),_:1})]),_:1}),!d.value&&ie.value.length===0&&D.value?(b(),N(Re,{key:0,type:"info",variant:"outlined",class:"mb-6",title:"Tidak ada hasil",text:"Tidak ada variant yang sesuai dengan filter yang dipilih. Coba ubah filter pencarian."})):te("",!0),d.value?(b(),se("div",Ks,[e(Nt,{color:"primary",indeterminate:"",size:"64"}),u[17]||(u[17]=a("div",{class:"mt-4 text-h6"},"Memuat variant...",-1))])):C.value.length===0?(b(),se("div",Rs,[e(S,{icon:"mdi-tune-variant",size:"96",class:"text-disabled mb-6"}),u[19]||(u[19]=a("h3",{class:"text-h5 font-weight-bold mb-4"},"Belum Ada Variant Produk",-1)),u[20]||(u[20]=a("p",{class:"text-body-1 text-medium-emphasis mb-6"}," Buat variant untuk produk Anda agar dapat menawarkan pilihan yang beragam ",-1)),e(K,{color:"primary",size:"large","prepend-icon":"mdi-plus",onClick:I},{default:t(()=>u[18]||(u[18]=[v(" Buat Variant Pertama ")])),_:1,__:[18]})])):(b(),N(Ue,{key:3},{default:t(()=>[(b(!0),se(Ae,null,et(ie.value,A=>(b(),N(E,{key:A.product.id_product,cols:"12",md:"6",lg:"4"},{default:t(()=>[e(de,{class:tt(["variant-group-card h-100",{"border-error":O(A.variants)}]),elevation:"2"},{default:t(()=>[e(Ie,{class:"pa-4 pb-2"},{default:t(()=>[a("div",qs,[e(Te,{image:A.product.image_url,size:"48",class:"flex-shrink-0"},{default:t(()=>[A.product.image_url?te("",!0):(b(),N(S,{key:0,icon:"mdi-coffee"}))]),_:2},1032,["image"]),a("div",Os,[a("h3",Ns,c(A.product.name),1),a("p",Ls," SKU: "+c(A.product.sku||"-"),1)]),e(pe,{color:w(A.variants),size:"small",variant:"tonal"},{default:t(()=>[v(c(A.variants.length)+" Variant ",1)]),_:2},1032,["color"])])]),_:2},1024),e(Ee),e(fe,{class:"pa-4"},{default:t(()=>[e(bt,{class:"pa-0"},{default:t(()=>[(b(!0),se(Ae,null,et(A.variants,(ke,B)=>(b(),N(at,{key:ke.id_variant,class:tt(["pa-2 rounded-lg variant-item",{"mb-2":B<A.variants.length-1}])},{prepend:t(()=>[e(Te,{size:"32",color:ke.is_active?"success":"error",variant:"tonal"},{default:t(()=>[e(S,{icon:ke.is_active?"mdi-check":"mdi-close",size:"16"},null,8,["icon"])]),_:2},1032,["color"])]),append:t(()=>[a("div",Js,[e(Ke,{text:"Kelola Komposisi"},{activator:t(({props:x})=>[e(K,we({ref_for:!0},x,{icon:"mdi-chef-hat",size:"small",variant:"text",color:"primary",onClick:ue=>Q(ke)}),null,16,["onClick"])]),_:2},1024),e(Ke,{text:"Hapus Variant"},{activator:t(({props:x})=>[e(K,we({ref_for:!0},x,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:ue=>k(ke)}),null,16,["onClick"])]),_:2},1024)])]),default:t(()=>[e(ct,{class:"text-sm font-weight-medium"},{default:t(()=>[v(c(ke.name),1)]),_:2},1024),e(mt,null,{default:t(()=>[a("div",js,[a("span",Ws,"SKU: "+c(ke.sku),1),a("div",Gs,[a("span",Xs,c(X(st)(ke.price||0)),1),ke.composition_summary?(b(),N(pe,{key:0,color:j(ke.composition_summary.stock_status),size:"x-small",variant:"tonal"},{default:t(()=>[v(c(y(ke.composition_summary.stock_status)),1)]),_:2},1032,["color"])):te("",!0)])])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:2},1024)]),_:2},1024),e(Ee),e(Ne,{class:"pa-4"},{default:t(()=>[a("div",Ys,[a("div",null,[e(pe,{color:re(A.variants).color,size:"small",variant:"tonal"},{default:t(()=>[e(S,{icon:re(A.variants).icon,size:"14",class:"me-1"},null,8,["icon"]),v(" "+c(re(A.variants).text),1)]),_:2},1032,["color"])]),a("div",Qs,[e(Ke,{text:"Setting HPP Produk"},{activator:t(({props:ke})=>[e(K,we({ref_for:!0},ke,{icon:"mdi-calculator-variant",size:"small",variant:"text",color:"warning",onClick:B=>g(A.variants[0])}),null,16,["onClick"])]),_:2},1024),e(Ke,{text:"Tambah Variant"},{activator:t(({props:ke})=>[e(K,we({ref_for:!0},ke,{icon:"mdi-plus",size:"small",variant:"text",color:"primary",onClick:I}),null,16)]),_:1}),e(Ke,{text:"Pengaturan Produk (Coming Soon)"},{activator:t(({props:ke})=>[e(K,we({ref_for:!0},ke,{icon:"mdi-cog",size:"small",variant:"text",color:"secondary",disabled:""}),null,16)]),_:1})])])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})),e(Ds,{modelValue:r.value,"onUpdate:modelValue":u[7]||(u[7]=A=>r.value=A),variant:m.value,onSave:me},null,8,["modelValue","variant"]),e(ea,{modelValue:n.value,"onUpdate:modelValue":u[8]||(u[8]=A=>n.value=A),"variant-id":(s=m.value)==null?void 0:s.id_variant,"variant-name":(i=m.value)==null?void 0:i.name,onHppUpdated:q,onPriceUpdated:q},null,8,["modelValue","variant-id","variant-name"]),e(Es,{modelValue:W.value,"onUpdate:modelValue":u[9]||(u[9]=A=>W.value=A),onSave:Y},null,8,["modelValue"]),e(Et,{modelValue:p.value,"onUpdate:modelValue":u[10]||(u[10]=A=>p.value=A),title:"Konfirmasi Hapus Variant","item-name":(z=m.value)==null?void 0:z.name,loading:V.value,"confirm-text":"Hapus Variant",onConfirm:G,onCancel:u[11]||(u[11]=A=>p.value=!1)},null,8,["modelValue","item-name","loading"])])}}}),Mt=Je(Zs,[["__scopeId","data-v-38a8b956"]]),ei={class:"product-management"},ti={class:"d-flex justify-space-between align-center mb-6"},ai={class:"d-flex gap-3 align-center"},li={key:0,class:"d-flex gap-2"},oi={class:"d-flex align-center"},ni=Le({__name:"products-management",setup(l){Lt();const{productsList:F,categories:h,loading:d,saveLoading:U,deleteLoading:p,toggleLoading:V,stats:m,dialog:r,deleteDialog:n,editMode:W,selectedProduct:_,selectedProducts:L,currentPage:le,totalItems:D,itemsPerPage:C,filters:ie,errorMessage:ge,successMessage:q,modalErrorMessage:Q,formData:g,selectedImage:k,imagePreview:I,canCreateEdit:G,hasSelectedProducts:j,fetchProductsList:y,fetchCategories:w,fetchStats:O,saveProduct:re,deleteProduct:he,bulkDeleteProducts:me,toggleActiveStatus:Y,toggleFeaturedStatus:f,openCreateDialog:u,openEditDialog:s,openDeleteDialog:i,closeDialog:z,handleImageUpload:A,clearModalError:ke,onPageChange:B}=jt(),{dialog:x,editMode:ue,formData:$e,availableItems:xe,saveLoading:Ve,modalErrorMessage:ee,openCreateDialog:ye,closeDialog:M,saveRecipe:o,clearModalError:T,fetchAvailableItems:R}=Fa(),{productItemsList:J,loading:$,fetchProductItemsForComposition:Z}=ta(),ne=H("products"),P=H(!1),ve=H(null),_e=H(!1),ze=H(null),He=async()=>{await he()},Me=async()=>{await me()},Be=De=>{const ae=De.id_product||De.id;ye(ae)},qe=async De=>{ve.value=De;try{await Z({page:1,per_page:50,critical_only:!1})}catch{}P.value=!0},je=De=>{ze.value=De,_e.value=!0},oe=De=>{if(!De)return[];const ae=De.id_product||De.id;return J.value.filter(rt=>{var be;return((be=rt.product)==null?void 0:be.id_product)===ae||rt.product_id===ae})||[]},Se=De=>{Object.assign(ie,De),y()},Fe=De=>{ie.search=De,y()},Ye=()=>{k.value=null,I.value&&(I.value="")};return Ce(ne,async De=>{De==="compositions"&&await Z({page:1,per_page:15,critical_only:!1})},{immediate:!1}),ft(()=>{y(),w(),O(),R()}),(De,ae)=>{var rt;return b(),se("div",ei,[a("div",ti,[ae[19]||(ae[19]=a("div",null,[a("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Produk & Komposisi"),a("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola produk dan komposisi untuk coffee shop Anda")],-1)),a("div",ai,[X(j)&&ne.value==="products"?(b(),se("div",li,[e(pe,{color:"primary",size:"small"},{default:t(()=>[v(c(X(L).length)+" dipilih ",1)]),_:1}),e(K,{color:"error",variant:"outlined",size:"small","prepend-icon":"mdi-delete",onClick:Me},{default:t(()=>ae[17]||(ae[17]=[v(" Hapus Terpilih ")])),_:1,__:[17]})])):te("",!0),X(G)&&ne.value==="products"?(b(),N(K,{key:1,color:"primary","prepend-icon":"mdi-plus",class:"coffee-btn",onClick:X(u)},{default:t(()=>ae[18]||(ae[18]=[v(" Tambah Produk ")])),_:1,__:[18]},8,["onClick"])):te("",!0)])]),e(hl,{modelValue:ne.value,"onUpdate:modelValue":ae[0]||(ae[0]=be=>ne.value=be),class:"mb-6"},{default:t(()=>[e(gt,{value:"products"},{default:t(()=>[e(S,{icon:"mdi-coffee",class:"me-2"}),ae[20]||(ae[20]=v(" Produk "))]),_:1,__:[20]}),e(gt,{value:"compositions"},{default:t(()=>[e(S,{icon:"mdi-chef-hat",class:"me-2"}),ae[21]||(ae[21]=v(" Komposisi Produk "))]),_:1,__:[21]}),e(gt,{value:"variants"},{default:t(()=>[e(S,{icon:"mdi-tune-variant",class:"me-2"}),ae[22]||(ae[22]=v(" Variant Produk "))]),_:1,__:[22]})]),_:1},8,["modelValue"]),X(ge)?(b(),N(Re,{key:0,type:"error",variant:"outlined",class:"mb-4",text:X(ge),closable:"","onClick:close":ae[1]||(ae[1]=be=>ge.value="")},null,8,["text"])):te("",!0),X(q)?(b(),N(Re,{key:1,type:"success",variant:"outlined",class:"mb-4",text:X(q),closable:"","onClick:close":ae[2]||(ae[2]=be=>q.value="")},null,8,["text"])):te("",!0),e(Vt,{modelValue:ne.value,"onUpdate:modelValue":ae[4]||(ae[4]=be=>ne.value=be)},{default:t(()=>[e(dt,{value:"products"},{default:t(()=>[e(yn,{stats:X(m)},null,8,["stats"]),e(en,{filters:X(ie),"onUpdate:filters":Se,onSearch:Fe},null,8,["filters"]),e(Hn,{products:X(F),loading:X(d),"current-page":X(le),"total-items":X(D),"items-per-page":X(C),"selected-products":X(L),"toggle-loading":X(V),"onUpdate:page":X(B),onAddProduct:X(u),onEditProduct:X(s),onOpenRecipeDialog:Be,onOpenCompositionDialog:qe,onOpenVariantDialog:je,onDeleteProduct:X(i),onToggleActive:X(Y),onToggleFeatured:X(f),"onUpdate:selectedProducts":ae[3]||(ae[3]=be=>L.value=be)},null,8,["products","loading","current-page","total-items","items-per-page","selected-products","toggle-loading","onUpdate:page","onAddProduct","onEditProduct","onDeleteProduct","onToggleActive","onToggleFeatured"])]),_:1}),e(dt,{value:"compositions"},{default:t(()=>[e(ho,{"product-items":X(J),loading:X($),onRefresh:X(Z)},null,8,["product-items","loading","onRefresh"])]),_:1}),e(dt,{value:"variants"},{default:t(()=>[e(Mt,{loading:X(d),onRefresh:X(y)},null,8,["loading","onRefresh"])]),_:1})]),_:1},8,["modelValue"]),e(Xo,{modelValue:X(r),"onUpdate:modelValue":[ae[5]||(ae[5]=be=>ht(r)?r.value=be:null),ae[6]||(ae[6]=be=>r.value=be)],"edit-mode":X(W),"form-data":X(g),categories:X(h),loading:X(U),"error-message":X(Q),"selected-image":X(k)?[X(k)]:[],"image-preview":X(I),onClose:X(z),onSubmit:X(re),onImageChange:X(A),onRemoveImage:Ye,onClearError:X(ke),onUpdateForm:ae[7]||(ae[7]=(be,Dt)=>X(g)[be]=Dt)},null,8,["modelValue","edit-mode","form-data","categories","loading","error-message","selected-image","image-preview","onClose","onSubmit","onImageChange","onClearError"]),e(Ka,{modelValue:X(x),"onUpdate:modelValue":[ae[8]||(ae[8]=be=>ht(x)?x.value=be:null),ae[9]||(ae[9]=be=>x.value=be)],"edit-mode":X(ue),"form-data":X($e),"available-items":X(xe),loading:X(Ve),"error-message":X(ee),onClose:X(M),onSave:X(o),onClearError:X(T)},null,8,["modelValue","edit-mode","form-data","available-items","loading","error-message","onClose","onSave","onClearError"]),e(Et,{modelValue:X(n),"onUpdate:modelValue":ae[10]||(ae[10]=be=>ht(n)?n.value=be:null),title:"Konfirmasi Hapus Produk","item-name":(rt=X(_))==null?void 0:rt.name,loading:X(p),"confirm-text":"Hapus Produk",onConfirm:He,onCancel:ae[11]||(ae[11]=be=>n.value=!1)},null,8,["modelValue","item-name","loading"]),e(Zt,{modelValue:P.value,"onUpdate:modelValue":ae[12]||(ae[12]=be=>P.value=be),product:ve.value,items:oe(ve.value),onSave:ae[13]||(ae[13]=()=>{X(y)(),P.value=!1}),onRefresh:X(y)},null,8,["modelValue","product","items","onRefresh"]),e(Ge,{modelValue:_e.value,"onUpdate:modelValue":ae[16]||(ae[16]=be=>_e.value=be),"max-width":"1400px",persistent:""},{default:t(()=>[e(de,null,{default:t(()=>[e(Ie,{class:"d-flex justify-between align-center"},{default:t(()=>{var be;return[a("div",oi,[e(S,{icon:"tabler-versions",class:"me-2"}),v(" Kelola Variant - "+c((be=ze.value)==null?void 0:be.name),1)]),e(K,{icon:"tabler-x",variant:"text",onClick:ae[14]||(ae[14]=Dt=>_e.value=!1)})]}),_:1}),e(Ee),e(fe,{class:"pa-0"},{default:t(()=>[ze.value?(b(),N(Mt,{key:0,product:ze.value},null,8,["product"])):te("",!0)]),_:1}),e(Ee),e(Ne,null,{default:t(()=>[e(Xe),e(K,{color:"grey-darken-1",variant:"outlined",onClick:ae[15]||(ae[15]=be=>_e.value=!1)},{default:t(()=>[e(S,{icon:"mdi-close",class:"me-1"}),ae[23]||(ae[23]=v(" Tutup "))]),_:1,__:[23]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Yi=Je(ni,[["__scopeId","data-v-8c8b1097"]]);export{Yi as default};
