var He=Object.defineProperty;var Qe=(u,t,s)=>t in u?He(u,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[t]=s;var Pe=(u,t,s)=>Qe(u,typeof t!="symbol"?t+"":t,s);import{D as We}from"./DeleteConfirmationDialog-ssueIl77.js";import{a7 as be,V as P,cz as Ce,b6 as ke,W as ae,b0 as Te,r as x,cb as Xe,aH as Ye,ak as Ge,bF as Le,av as Me,L as Ze,a6 as Ve,bk as et,N as Fe,aE as tt,af as at,cc as lt,a8 as Se,b4 as de,b as e,H as qe,b3 as ot,cn as it,I as st,aa as Ue,ad as nt,ac as Re,b5 as ut,p as rt,F as ie,au as le,d as we,w as _e,g as Q,f as l,e as i,X as ye,t as f,a1 as Z,a0 as dt,l as M,at as mt,c as J,i as $e,s as N,o as S,D as ct,m as vt,aB as pt,_ as yt}from"./main-DoH7BNU0.js";import{V as Ie}from"./VDialog-BV2VGmZm.js";import{b as ze,c as Ne,V as me}from"./VCard-DXDUncB3.js";import{V as ft}from"./VForm-CAYzcBWs.js";import{V as ce}from"./VCardText-yZra56bd.js";import{V as re,a as p}from"./VRow-rYX4edDC.js";import{b as _t,c as Be,d as bt,j as gt,a as ht,V as W}from"./VTextField-9Sc5KvAe.js";import{V as fe}from"./VSelect-CFvVKkz4.js";import{V as kt}from"./VTextarea-BYX7KS0N.js";import{V as he}from"./VDivider-B11OzaCF.js";import{V as Vt}from"./VSwitch-Dkd19lHh.js";import{V as Ee}from"./VSpacer-B7k_m55h.js";import{V as oe}from"./VChip-r-xKq0AX.js";import{V as St}from"./VDataTableServer-Dop79CET.js";import"./VOverlay-7fEsiQXu.js";import"./forwardRefs-B931MWyl.js";import"./VImg-CJPkcWWl.js";import"./VAvatar-GpMkftR2.js";/* empty css              */import"./VList-DF0oT0kL.js";import"./VMenu-DpRAsqgU.js";import"./VCheckboxBtn-RlaGNlgl.js";import"./VDataTable-GpqQrsR0.js";import"./VTable-NMvqQ2hE.js";import"./filter-BqjlRo96.js";const xe=Symbol.for("vuetify:v-slider");function wt(u,t,s){const b=s==="vertical",h=t.getBoundingClientRect(),C="touches"in u?u.touches[0]:u;return b?C.clientY-(h.top+h.height/2):C.clientX-(h.left+h.width/2)}function xt(u,t){return"touches"in u&&u.touches.length?u.touches[0][t]:"changedTouches"in u&&u.changedTouches.length?u.changedTouches[0][t]:u[t]}const Dt=be({disabled:{type:Boolean,default:null},error:Boolean,readonly:{type:Boolean,default:null},max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:u=>typeof u=="boolean"||u==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:u=>typeof u=="boolean"||u==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:u=>["vertical","horizontal"].includes(u)},reverse:Boolean,...Ge(),...Ye({elevation:2}),ripple:{type:Boolean,default:!0}},"Slider"),Pt=u=>{const t=P(()=>parseFloat(u.min)),s=P(()=>parseFloat(u.max)),b=P(()=>Number(u.step)>0?parseFloat(u.step):0),h=P(()=>Math.max(Ce(b.value),Ce(t.value)));function C(F){if(F=parseFloat(F),b.value<=0)return F;const _=Le(F,t.value,s.value),q=t.value%b.value,n=Math.round((_-q)/b.value)*b.value+q;return parseFloat(Math.min(n,s.value).toFixed(h.value))}return{min:t,max:s,step:b,decimals:h,roundValue:C}},Ct=u=>{let{props:t,steps:s,onSliderStart:b,onSliderMove:h,onSliderEnd:C,getActiveThumb:F}=u;const{isRtl:_}=ke(),q=ae(()=>t.reverse),n=P(()=>t.direction==="vertical"),$=P(()=>n.value!==q.value),{min:w,max:I,step:U,decimals:E,roundValue:H}=s,X=P(()=>parseInt(t.thumbSize,10)),d=P(()=>parseInt(t.tickSize,10)),m=P(()=>parseInt(t.trackSize,10)),g=P(()=>(I.value-w.value)/U.value),D=ae(()=>t.disabled),T=P(()=>t.error||t.disabled?void 0:t.thumbColor??t.color),V=P(()=>t.error||t.disabled?void 0:t.trackColor??t.color),L=P(()=>t.error||t.disabled?void 0:t.trackFillColor??t.color),R=Te(!1),z=Te(0),j=x(),K=x();function B(r){var De;const k=(De=j.value)==null?void 0:De.$el;if(!k)return;const v=t.direction==="vertical",pe=v?"top":"left",Ae=v?"height":"width",je=v?"clientY":"clientX",{[pe]:Ke,[Ae]:Oe}=k.getBoundingClientRect(),Je=xt(r,je);let ge=Math.min(Math.max((Je-Ke-z.value)/Oe,0),1)||0;return(v?$.value:$.value!==_.value)&&(ge=1-ge),H(w.value+ge*(I.value-w.value))}const Y=r=>{const k=B(r);k!=null&&C({value:k}),R.value=!1,z.value=0},G=r=>{const k=B(r);K.value=F(r),K.value&&(R.value=!0,K.value.contains(r.target)?z.value=wt(r,K.value,t.direction):(z.value=0,k!=null&&h({value:k})),k!=null&&b({value:k}),Me(()=>{var v;return(v=K.value)==null?void 0:v.focus()}))},A={passive:!0,capture:!0};function ee(r){const k=B(r);k!=null&&h({value:k})}function se(r){r.stopPropagation(),r.preventDefault(),Y(r),window.removeEventListener("mousemove",ee,A),window.removeEventListener("mouseup",se)}function ne(r){var k;Y(r),window.removeEventListener("touchmove",ee,A),(k=r.target)==null||k.removeEventListener("touchend",ne)}function ue(r){var k;G(r),window.addEventListener("touchmove",ee,A),(k=r.target)==null||k.addEventListener("touchend",ne,{passive:!1})}function o(r){r.button===0&&(r.preventDefault(),G(r),window.addEventListener("mousemove",ee,A),window.addEventListener("mouseup",se,{passive:!1}))}const a=r=>{const k=(r-w.value)/(I.value-w.value)*100;return Le(isNaN(k)?0:k,0,100)},c=ae(()=>t.showTicks),te=P(()=>c.value?t.ticks?Array.isArray(t.ticks)?t.ticks.map(r=>({value:r,position:a(r),label:r.toString()})):Object.keys(t.ticks).map(r=>({value:parseFloat(r),position:a(parseFloat(r)),label:t.ticks[r]})):g.value!==1/0?Xe(g.value+1).map(r=>{const k=w.value+r*U.value;return{value:k,position:a(k)}}):[]:[]),ve=P(()=>te.value.some(r=>{let{label:k}=r;return!!k})),y={activeThumbRef:K,color:ae(()=>t.color),decimals:E,disabled:D,direction:ae(()=>t.direction),elevation:ae(()=>t.elevation),hasLabels:ve,isReversed:q,indexFromEnd:$,min:w,max:I,mousePressed:R,numTicks:g,onSliderMousedown:o,onSliderTouchstart:ue,parsedTicks:te,parseMouseMove:B,position:a,readonly:ae(()=>t.readonly),rounded:ae(()=>t.rounded),roundValue:H,showTicks:c,startOffset:z,step:U,thumbSize:X,thumbColor:T,thumbLabel:ae(()=>t.thumbLabel),ticks:ae(()=>t.ticks),tickSize:d,trackColor:V,trackContainerRef:j,trackFillColor:L,trackSize:m,vertical:n};return Ze(xe,y),y},Tt=be({focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0},ripple:{type:[Boolean,Object],default:!0},name:String,...Ue()},"VSliderThumb"),qt=Ve()({name:"VSliderThumb",directives:{Ripple:et},props:Tt(),emits:{"update:modelValue":u=>!0},setup(u,t){let{slots:s,emit:b}=t;const h=Fe(xe),{isRtl:C,rtlClasses:F}=ke();if(!h)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:_,step:q,disabled:n,thumbSize:$,thumbLabel:w,direction:I,isReversed:U,vertical:E,readonly:H,elevation:X,mousePressed:d,decimals:m,indexFromEnd:g}=h,D=P(()=>n.value?void 0:X.value),{elevationClasses:T}=tt(D),{textColorClasses:V,textColorStyles:L}=at(_),{pageup:R,pagedown:z,end:j,home:K,left:B,right:Y,down:G,up:A}=lt,ee=[R,z,j,K,B,Y,G,A],se=P(()=>q.value?[1,2,3]:[1,5,10]);function ne(o,a){if(!ee.includes(o.key))return;o.preventDefault();const c=q.value||.1,te=(u.max-u.min)/c;if([B,Y,G,A].includes(o.key)){const y=(E.value?[C.value?B:Y,U.value?G:A]:g.value!==C.value?[B,A]:[Y,A]).includes(o.key)?1:-1,r=o.shiftKey?2:o.ctrlKey?1:0;a=a+y*c*se.value[r]}else if(o.key===K)a=u.min;else if(o.key===j)a=u.max;else{const ve=o.key===z?1:-1;a=a-ve*c*(te>100?te/10:10)}return Math.max(u.min,Math.min(u.max,a))}function ue(o){const a=ne(o,u.modelValue);a!=null&&b("update:modelValue",a)}return Se(()=>{const o=de(g.value?100-u.position:u.position,"%");return e("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":u.focused,"v-slider-thumb--pressed":u.focused&&d.value},u.class,F.value],style:[{"--v-slider-thumb-position":o,"--v-slider-thumb-size":de($.value)},u.style],role:"slider",tabindex:n.value?-1:0,"aria-label":u.name,"aria-valuemin":u.min,"aria-valuemax":u.max,"aria-valuenow":u.modelValue,"aria-readonly":!!H.value,"aria-orientation":I.value,onKeydown:H.value?void 0:ue},[e("div",{class:["v-slider-thumb__surface",V.value,T.value],style:{...L.value}},null),qe(e("div",{class:["v-slider-thumb__ripple",V.value],style:L.value},null),[[ot("ripple"),u.ripple,null,{circle:!0,center:!0}]]),e(it,{origin:"bottom center"},{default:()=>{var a;return[qe(e("div",{class:"v-slider-thumb__label-container"},[e("div",{class:["v-slider-thumb__label"]},[e("div",null,[((a=s["thumb-label"])==null?void 0:a.call(s,{modelValue:u.modelValue}))??u.modelValue.toFixed(q.value?m.value:1)])])]),[[st,w.value&&u.focused||w.value==="always"]])]}})])}),{}}}),Rt=be({start:{type:Number,required:!0},stop:{type:Number,required:!0},...Ue()},"VSliderTrack"),Bt=Ve()({name:"VSliderTrack",props:Rt(),emits:{},setup(u,t){let{slots:s}=t;const b=Fe(xe);if(!b)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:h,parsedTicks:C,rounded:F,showTicks:_,tickSize:q,trackColor:n,trackFillColor:$,trackSize:w,vertical:I,min:U,max:E,indexFromEnd:H}=b,{roundedClasses:X}=nt(F),{backgroundColorClasses:d,backgroundColorStyles:m}=Re($),{backgroundColorClasses:g,backgroundColorStyles:D}=Re(n),T=P(()=>`inset-${I.value?"block":"inline"}-${H.value?"end":"start"}`),V=P(()=>I.value?"height":"width"),L=P(()=>({[T.value]:"0%",[V.value]:"100%"})),R=P(()=>u.stop-u.start),z=P(()=>({[T.value]:de(u.start,"%"),[V.value]:de(R.value,"%")})),j=P(()=>_.value?(I.value?C.value.slice().reverse():C.value).map((B,Y)=>{var A;const G=B.value!==U.value&&B.value!==E.value?de(B.position,"%"):void 0;return e("div",{key:B.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":B.position>=u.start&&B.position<=u.stop,"v-slider-track__tick--first":B.value===U.value,"v-slider-track__tick--last":B.value===E.value}],style:{[T.value]:G}},[(B.label||s["tick-label"])&&e("div",{class:"v-slider-track__tick-label"},[((A=s["tick-label"])==null?void 0:A.call(s,{tick:B,index:Y}))??B.label])])}):[]);return Se(()=>e("div",{class:["v-slider-track",X.value,u.class],style:[{"--v-slider-track-size":de(w.value),"--v-slider-tick-size":de(q.value)},u.style]},[e("div",{class:["v-slider-track__background",g.value,{"v-slider-track__background--opacity":!!h.value||!$.value}],style:{...L.value,...D.value}},null),e("div",{class:["v-slider-track__fill",d.value],style:{...z.value,...m.value}},null),_.value&&e("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":_.value==="always"}]},[j.value])])),{}}}),Lt=be({...gt(),...Dt(),...bt(),modelValue:{type:[Number,String],default:0}},"VSlider"),Mt=Ve()({name:"VSlider",props:Lt(),emits:{"update:focused":u=>!0,"update:modelValue":u=>!0,start:u=>!0,end:u=>!0},setup(u,t){let{slots:s,emit:b}=t;const h=x(),{rtlClasses:C}=ke(),F=Pt(u),_=ut(u,"modelValue",void 0,V=>F.roundValue(V??F.min.value)),{min:q,max:n,mousePressed:$,roundValue:w,onSliderMousedown:I,onSliderTouchstart:U,trackContainerRef:E,position:H,hasLabels:X,readonly:d}=Ct({props:u,steps:F,onSliderStart:()=>{b("start",_.value)},onSliderEnd:V=>{let{value:L}=V;const R=w(L);_.value=R,b("end",R)},onSliderMove:V=>{let{value:L}=V;return _.value=w(L)},getActiveThumb:()=>{var V;return(V=h.value)==null?void 0:V.$el}}),{isFocused:m,focus:g,blur:D}=_t(u),T=P(()=>H(_.value));return Se(()=>{const V=Be.filterProps(u),L=!!(u.label||s.label||s.prepend);return e(Be,rt({class:["v-slider",{"v-slider--has-labels":!!s["tick-label"]||X.value,"v-slider--focused":m.value,"v-slider--pressed":$.value,"v-slider--disabled":u.disabled},C.value,u.class],style:u.style},V,{focused:m.value}),{...s,prepend:L?R=>{var z,j;return e(ie,null,[((z=s.label)==null?void 0:z.call(s,R))??(u.label?e(ht,{id:R.id.value,class:"v-slider__label",text:u.label},null):void 0),(j=s.prepend)==null?void 0:j.call(s,R)])}:void 0,default:R=>{let{id:z,messagesId:j}=R;return e("div",{class:"v-slider__container",onMousedown:d.value?void 0:I,onTouchstartPassive:d.value?void 0:U},[e("input",{id:z.value,name:u.name||z.value,disabled:!!u.disabled,readonly:!!u.readonly,tabindex:"-1",value:_.value},null),e(Bt,{ref:E,start:0,stop:T.value},{"tick-label":s["tick-label"]}),e(qt,{ref:h,"aria-describedby":j.value,focused:m.value,min:q.value,max:n.value,modelValue:_.value,"onUpdate:modelValue":K=>_.value=K,position:T.value,elevation:u.elevation,onFocus:g,onBlur:D,ripple:u.ripple,name:u.name},{"thumb-label":s["thumb-label"]})])}})}),{}}});class O{static async getPromotions(t={}){return(await le.get(this.BASE_URL,{params:t})).data.data}static async getPromotion(t){return(await le.get(`${this.BASE_URL}/${t}`)).data.data}static async createPromotion(t){return(await le.post(this.BASE_URL,t)).data.data}static async updatePromotion(t,s){return(await le.put(`${this.BASE_URL}/${t}`,s)).data.data}static async deletePromotion(t){await le.delete(`${this.BASE_URL}/${t}`)}static async getActivePromotions(){return(await le.get(`${this.BASE_URL}/active`)).data.data}static async calculatePromotions(t){return(await le.post(`${this.BASE_URL}/calculate`,{cart_items:t})).data.data}static async getStats(){return(await le.get(`${this.BASE_URL}/stats`)).data.data}static async toggleStatus(t){return(await le.post(`${this.BASE_URL}/${t}/toggle-status`)).data.data}static async duplicate(t){return(await le.post(`${this.BASE_URL}/${t}/duplicate`)).data.data}static getPromotionTypeLabel(t){return{happy_hour:"Happy Hour",buy_one_get_one:"Buy 1 Get 1",combo_deal:"Combo Deal",member_discount:"Member Discount",seasonal:"Seasonal"}[t]||t}static getPromotionTypeIcon(t){return{happy_hour:"mdi-clock-outline",buy_one_get_one:"mdi-numeric-1-box-multiple",combo_deal:"mdi-food-variant",member_discount:"mdi-account-star",seasonal:"mdi-weather-sunny"}[t]||"mdi-tag"}static getPromotionTypeColor(t){return{happy_hour:"warning",buy_one_get_one:"success",combo_deal:"info",member_discount:"secondary",seasonal:"primary"}[t]||"primary"}static getStatusColor(t){return{active:"success",inactive:"secondary",expired:"error",scheduled:"warning",not_applicable:"info"}[t]||"primary"}static getStatusLabel(t){return{active:"Aktif",inactive:"Tidak Aktif",expired:"Kadaluarsa",scheduled:"Terjadwal",not_applicable:"Tidak Berlaku"}[t]||t}static formatCurrency(t){return new Intl.NumberFormat("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}static formatDiscountValue(t){if(!t.discount_value)return"Special Offer";switch(t.discount_type){case"percentage":return`${t.discount_value}% OFF`;case"fixed_amount":return`Rp ${this.formatCurrency(t.discount_value)} OFF`;default:return"Special Offer"}}static getDayLabel(t){return{monday:"Senin",tuesday:"Selasa",wednesday:"Rabu",thursday:"Kamis",friday:"Jumat",saturday:"Sabtu",sunday:"Minggu"}[t]||t}static formatValidDays(t){if(!t||t.length===0)return"Setiap hari";const s=t.map(b=>this.getDayLabel(b));return s.length===7?"Setiap hari":s.length===1?s[0]:s.length===2?s.join(" & "):s.slice(0,-1).join(", ")+" & "+s.slice(-1)[0]}static formatTimeRange(t,s){return!t||!s?"Sepanjang hari":`${t} - ${s}`}static formatPromotionDiscount(t){return t.discount_type==="percentage"?`${t.discount_value}%`:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t.discount_value)}static isPromotionValid(t){if(!t.active)return!1;const s=new Date;if(t.valid_from&&t.valid_until){const b=new Date(t.valid_from),h=new Date(t.valid_until);if(s<b||s>h)return!1}if(t.valid_days&&t.valid_days.length>0){const b=s.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();if(!t.valid_days.includes(b))return!1}if(t.type==="happy_hour"&&t.start_time&&t.end_time){const b=s.toTimeString().slice(0,5);if(b<t.start_time||b>t.end_time)return!1}return!0}static createPromotionRules(t,s){switch(t){case"happy_hour":return{discount_percentage:s.discount_percentage||0,applicable_hours:s.applicable_hours||[]};case"buy_one_get_one":return{buy_quantity:s.buy_quantity||1,get_quantity:s.get_quantity||1,max_free_items:s.max_free_items};case"combo_deal":return{required_items:s.required_items||[],combo_price:s.combo_price||0};case"member_discount":return{member_tiers:s.member_tiers||[],discount_percentage:s.discount_percentage||0};case"seasonal":return{season:s.season||"",discount_percentage:s.discount_percentage||0};default:return s}}static getPriorityLabel(t){return t>=90?"Sangat Tinggi":t>=70?"Tinggi":t>=50?"Sedang":t>=30?"Rendah":"Sangat Rendah"}static getPriorityColor(t){return t>=90?"error":t>=70?"warning":t>=50?"info":t>=30?"success":"secondary"}}Pe(O,"BASE_URL","/api/promotions");const Ft={class:"d-flex align-center"},Ut={class:"font-weight-medium"},$t={key:0,class:"mt-2"},It={class:"mb-0"},zt=we({__name:"PromotionDialog",props:{modelValue:{type:Boolean},promotion:{default:null},mode:{}},emits:["update:modelValue","saved"],setup(u,{emit:t}){const s=u,b=t,h=x(),C=x(!1),F=x(!1),_=x(""),q=x({}),n=x({name:"",description:"",type:"happy_hour",discount_type:"percentage",discount_value:0,max_discount_amount:null,minimum_amount:null,priority:5,start_time:null,end_time:null,valid_days:[],buy_quantity:null,get_quantity:null,combo_quantity:null,combo_price:null,min_quantity:null,valid_from:new Date().toISOString().slice(0,16),valid_until:(()=>{const o=new Date;return o.setMonth(o.getMonth()+1),o.toISOString().slice(0,16)})(),active:!0,promotion_rules:[]}),$=[{title:"Happy Hour",value:"happy_hour"},{title:"Beli 1 Dapat 1",value:"buy_one_get_one"},{title:"Paket Combo",value:"combo_deal"},{title:"Diskon Kategori",value:"category_discount"},{title:"Diskon Quantity",value:"quantity_discount"}],w=[{title:"Persentase (%)",value:"percentage"},{title:"Jumlah Tetap (Rp)",value:"fixed_amount"}],I=[{title:"Senin",value:"monday"},{title:"Selasa",value:"tuesday"},{title:"Rabu",value:"wednesday"},{title:"Kamis",value:"thursday"},{title:"Jumat",value:"friday"},{title:"Sabtu",value:"saturday"},{title:"Minggu",value:"sunday"}],U=P({get:()=>s.modelValue,set:o=>b("update:modelValue",o)}),E=P(()=>s.mode==="create"?"Tambah Promosi Baru":"Edit Promosi"),H=[o=>!!o||"Nama promosi wajib diisi",o=>o.length>=3||"Nama minimal 3 karakter"],X=P(()=>[o=>o>0||"Nilai diskon harus lebih dari 0",...n.value.discount_type==="percentage"?[o=>o<=100||"Persentase maksimal 100%"]:[]]),d=[o=>!!o||"Tanggal mulai berlaku wajib diisi"],m=[o=>!!o||"Tanggal berakhir wajib diisi",o=>!o||!n.value.valid_from?!0:new Date(o)>new Date(n.value.valid_from)||"Tanggal berakhir harus setelah tanggal mulai"],g=()=>{_.value="",q.value={}},D=o=>!o||o===0?"":new Intl.NumberFormat("id-ID").format(o),T=o=>{if(!o||o.trim()==="")return null;const a=o.replace(/[^\d]/g,"");if(a==="")return null;const c=parseInt(a);return isNaN(c)?null:c},V=x(""),L=x(""),R=x("");_e(()=>n.value.max_discount_amount,o=>{V.value=D(o)}),_e(()=>n.value.minimum_amount,o=>{L.value=D(o)}),_e(()=>n.value.combo_price,o=>{R.value=D(o)});const z=o=>{const a=T(o);n.value.max_discount_amount=a,V.value=D(a)},j=o=>{const a=T(o);n.value.minimum_amount=a,L.value=D(a)},K=o=>{const a=T(o);n.value.combo_price=a,R.value=D(a)},B=o=>({name:"Nama Promosi",description:"Deskripsi",type:"Tipe Promosi",discount_type:"Tipe Diskon",discount_value:"Nilai Diskon",valid_from:"Berlaku Dari",valid_until:"Berlaku Sampai",start_time:"Jam Mulai",end_time:"Jam Berakhir",valid_days:"Hari Berlaku",buy_quantity:"Jumlah Beli",get_quantity:"Jumlah Dapat",combo_quantity:"Jumlah Paket",combo_price:"Harga Paket",min_quantity:"Minimal Quantity",minimum_amount:"Minimal Pembelian",max_discount_amount:"Maksimal Diskon",priority:"Prioritas"})[o]||o,Y=()=>n.value.discount_type==="percentage"?"Persentase Diskon":"Jumlah Diskon",G=()=>{n.value.start_time=null,n.value.end_time=null,n.value.valid_days=[],n.value.buy_quantity=null,n.value.get_quantity=null,n.value.combo_quantity=null,n.value.combo_price=null,n.value.min_quantity=null},A=()=>{g();const o=new Date,a=new Date;a.setMonth(a.getMonth()+1),n.value={name:"",description:"",type:"happy_hour",discount_type:"percentage",discount_value:0,max_discount_amount:null,minimum_amount:null,priority:5,start_time:null,end_time:null,valid_days:[],buy_quantity:null,get_quantity:null,combo_quantity:null,combo_price:null,min_quantity:null,valid_from:o.toISOString().slice(0,16),valid_until:a.toISOString().slice(0,16),active:!0,promotion_rules:[]},V.value="",L.value="",R.value="",Me(()=>{var c;(c=h.value)==null||c.resetValidation()})},ee=()=>{if(s.promotion){const o=s.promotion;n.value={name:o.name,description:o.description||"",type:o.type,discount_type:o.discount_type,discount_value:o.discount_value,max_discount_amount:o.max_discount_amount,minimum_amount:o.minimum_amount,priority:o.priority,start_time:o.start_time,end_time:o.end_time,valid_days:o.valid_days||[],buy_quantity:o.buy_quantity,get_quantity:o.get_quantity,combo_quantity:o.combo_quantity,combo_price:o.combo_price,min_quantity:o.min_quantity,valid_from:o.valid_from?new Date(o.valid_from).toISOString().slice(0,16):null,valid_until:o.valid_until?new Date(o.valid_until).toISOString().slice(0,16):null,active:o.active,promotion_rules:o.promotion_rules||[]},V.value=D(o.max_discount_amount),L.value=D(o.minimum_amount),R.value=D(o.combo_price)}},se=async()=>{var o;if(C.value)try{F.value=!0,g(),n.value.promotion_rules=ne(),s.mode==="create"?await O.createPromotion(n.value):s.promotion&&await O.updatePromotion(s.promotion.id_promotion,n.value),b("saved")}catch(a){if(console.error("Save error:",a),(o=a==null?void 0:a.response)!=null&&o.data){const c=a.response.data;c.errors&&typeof c.errors=="object"?(q.value=c.errors,_.value=c.message||"Terjadi kesalahan validasi"):_.value=c.message||"Terjadi kesalahan saat menyimpan promosi"}else a!=null&&a.message?_.value=a.message:_.value="Terjadi kesalahan yang tidak diketahui"}finally{F.value=!1}},ne=()=>{const o=[];switch(n.value.type){case"happy_hour":o.push({type:"time_based",start_time:n.value.start_time,end_time:n.value.end_time,valid_days:n.value.valid_days||[]});break;case"buy_one_get_one":o.push({type:"quantity_based",buy_quantity:n.value.buy_quantity||1,get_quantity:n.value.get_quantity||1});break;case"combo_deal":o.push({type:"combo_based",combo_quantity:n.value.combo_quantity||2,combo_price:n.value.combo_price||0});break;case"category_discount":o.push({type:"category_based",applicable_categories:n.value.applicable_categories||[]});break;case"quantity_discount":o.push({type:"quantity_threshold",min_quantity:n.value.min_quantity||1});break}return o.push({type:"discount",discount_type:n.value.discount_type,discount_value:n.value.discount_value,max_discount_amount:n.value.max_discount_amount,minimum_amount:n.value.minimum_amount}),o},ue=()=>{g(),U.value=!1};return _e(()=>s.modelValue,o=>{o&&(s.mode==="edit"&&s.promotion?ee():A())}),(o,a)=>(S(),Q(Ie,{modelValue:U.value,"onUpdate:modelValue":a[23]||(a[23]=c=>U.value=c),"max-width":"900px",persistent:"",scrollable:""},{default:l(()=>[e(me,null,{default:l(()=>[e(ze,{class:"d-flex align-center justify-space-between bg-primary text-white"},{default:l(()=>[i("div",Ft,[e(ye,{icon:"mdi-bullhorn-outline",size:"24",class:"me-2"}),i("span",null,f(E.value),1)]),e(Z,{icon:"mdi-close",variant:"text",color:"white",onClick:ue})]),_:1}),e(ft,{ref_key:"formRef",ref:h,modelValue:C.value,"onUpdate:modelValue":a[22]||(a[22]=c=>C.value=c),onSubmit:dt(se,["prevent"])},{default:l(()=>[e(ce,{class:"pa-6"},{default:l(()=>[_.value?(S(),Q(mt,{key:0,type:"error",class:"mb-4",closable:"","onClick:close":g},{default:l(()=>[i("div",Ut,f(_.value),1),Object.keys(q.value).length>0?(S(),J("div",$t,[i("ul",It,[(S(!0),J(ie,null,$e(q.value,(c,te)=>(S(),J("li",{key:te},[i("strong",null,f(B(te))+":",1),N(" "+f(c.join(", ")),1)]))),128))])])):M("",!0)]),_:1})):M("",!0),e(re,null,{default:l(()=>[e(p,{cols:"12"},{default:l(()=>a[24]||(a[24]=[i("h6",{class:"text-h6 mb-4"},"Informasi Dasar",-1)])),_:1,__:[24]}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(W,{modelValue:n.value.name,"onUpdate:modelValue":a[0]||(a[0]=c=>n.value.name=c),label:"Nama Promosi",rules:H,variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(fe,{modelValue:n.value.type,"onUpdate:modelValue":[a[1]||(a[1]=c=>n.value.type=c),G],items:$,label:"Tipe Promosi",rules:[c=>!!c||"Tipe promosi wajib dipilih"],variant:"outlined",required:""},null,8,["modelValue","rules"])]),_:1}),e(p,{cols:"12"},{default:l(()=>[e(kt,{modelValue:n.value.description,"onUpdate:modelValue":a[2]||(a[2]=c=>n.value.description=c),label:"Deskripsi",variant:"outlined",rows:"3","auto-grow":""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:l(()=>[e(he,{class:"my-4"}),a[25]||(a[25]=i("h6",{class:"text-h6 mb-4"},"Konfigurasi Promosi",-1))]),_:1,__:[25]}),n.value.type==="happy_hour"?(S(),J(ie,{key:0},[e(p,{cols:"12",md:"4"},{default:l(()=>[e(W,{modelValue:n.value.start_time,"onUpdate:modelValue":a[3]||(a[3]=c=>n.value.start_time=c),label:"Jam Mulai",type:"time",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4"},{default:l(()=>[e(W,{modelValue:n.value.end_time,"onUpdate:modelValue":a[4]||(a[4]=c=>n.value.end_time=c),label:"Jam Berakhir",type:"time",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4"},{default:l(()=>[e(fe,{modelValue:n.value.valid_days,"onUpdate:modelValue":a[5]||(a[5]=c=>n.value.valid_days=c),items:I,label:"Hari Berlaku",multiple:"",chips:"",variant:"outlined"},null,8,["modelValue"])]),_:1})],64)):M("",!0),n.value.type==="buy_one_get_one"?(S(),J(ie,{key:1},[e(p,{cols:"12",md:"6"},{default:l(()=>[e(W,{modelValue:n.value.buy_quantity,"onUpdate:modelValue":a[6]||(a[6]=c=>n.value.buy_quantity=c),modelModifiers:{number:!0},label:"Beli Quantity",type:"number",min:"1",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(W,{modelValue:n.value.get_quantity,"onUpdate:modelValue":a[7]||(a[7]=c=>n.value.get_quantity=c),modelModifiers:{number:!0},label:"Dapat Quantity",type:"number",min:"1",variant:"outlined",required:""},null,8,["modelValue"])]),_:1})],64)):M("",!0),n.value.type==="combo_deal"?(S(),J(ie,{key:2},[e(p,{cols:"12",md:"6"},{default:l(()=>[e(W,{modelValue:n.value.combo_quantity,"onUpdate:modelValue":a[8]||(a[8]=c=>n.value.combo_quantity=c),modelModifiers:{number:!0},label:"Jumlah Item Combo",type:"number",min:"2",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(W,{modelValue:R.value,"onUpdate:modelValue":a[9]||(a[9]=c=>R.value=c),label:"Harga Combo",prefix:"Rp",variant:"outlined",required:"",onInput:a[10]||(a[10]=c=>K(c.target.value))},null,8,["modelValue"])]),_:1})],64)):M("",!0),n.value.type==="quantity_discount"?(S(),Q(p,{key:3,cols:"12",md:"6"},{default:l(()=>[e(W,{modelValue:n.value.min_quantity,"onUpdate:modelValue":a[11]||(a[11]=c=>n.value.min_quantity=c),modelModifiers:{number:!0},label:"Minimum Quantity",type:"number",min:"1",variant:"outlined",required:""},null,8,["modelValue"])]),_:1})):M("",!0),e(p,{cols:"12",md:"4"},{default:l(()=>[e(fe,{modelValue:n.value.discount_type,"onUpdate:modelValue":a[12]||(a[12]=c=>n.value.discount_type=c),items:w,label:"Tipe Diskon",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"4"},{default:l(()=>[e(W,{modelValue:n.value.discount_value,"onUpdate:modelValue":a[13]||(a[13]=c=>n.value.discount_value=c),modelModifiers:{number:!0},label:Y(),rules:X.value,variant:"outlined",type:"number",suffix:n.value.discount_type==="percentage"?"%":"Rp",required:""},null,8,["modelValue","label","rules","suffix"])]),_:1}),n.value.discount_type==="percentage"?(S(),Q(p,{key:4,cols:"12",md:"4"},{default:l(()=>[e(W,{modelValue:V.value,"onUpdate:modelValue":a[14]||(a[14]=c=>V.value=c),label:"Maksimum Diskon",variant:"outlined",prefix:"Rp",hint:"Opsional",onInput:a[15]||(a[15]=c=>z(c.target.value))},null,8,["modelValue"])]),_:1})):M("",!0),e(p,{cols:"12",md:"6"},{default:l(()=>[e(Mt,{modelValue:n.value.priority,"onUpdate:modelValue":a[16]||(a[16]=c=>n.value.priority=c),label:"Prioritas",min:1,max:10,step:1,"thumb-label":"always",variant:"outlined",color:"primary"},{"thumb-label":l(({modelValue:c})=>[N(f(c),1)]),_:1},8,["modelValue"]),a[26]||(a[26]=i("div",{class:"text-caption text-medium-emphasis mt-2"}," 1 = Prioritas Rendah, 10 = Prioritas Tinggi ",-1))]),_:1,__:[26]}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(W,{modelValue:L.value,"onUpdate:modelValue":a[17]||(a[17]=c=>L.value=c),label:"Minimum Pembelian",variant:"outlined",prefix:"Rp",hint:"Kosongkan jika tidak ada minimum",onInput:a[18]||(a[18]=c=>j(c.target.value))},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:l(()=>[e(he,{class:"my-4"}),a[27]||(a[27]=i("h6",{class:"text-h6 mb-4"},"Periode Berlaku",-1))]),_:1,__:[27]}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(W,{modelValue:n.value.valid_from,"onUpdate:modelValue":a[19]||(a[19]=c=>n.value.valid_from=c),label:"Berlaku Dari",variant:"outlined",type:"datetime-local",rules:d,required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[e(W,{modelValue:n.value.valid_until,"onUpdate:modelValue":a[20]||(a[20]=c=>n.value.valid_until=c),label:"Berlaku Sampai",variant:"outlined",type:"datetime-local",rules:m,required:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12"},{default:l(()=>[e(he,{class:"my-4"}),a[28]||(a[28]=i("h6",{class:"text-h6 mb-4"},"Status",-1))]),_:1,__:[28]}),e(p,{cols:"12"},{default:l(()=>[e(Vt,{modelValue:n.value.active,"onUpdate:modelValue":a[21]||(a[21]=c=>n.value.active=c),label:"Aktifkan promosi ini",color:"primary",inset:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Ne,{class:"pa-6 pt-0"},{default:l(()=>[e(Ee),e(Z,{variant:"outlined",onClick:ue},{default:l(()=>a[29]||(a[29]=[N(" Batal ")])),_:1,__:[29]}),e(Z,{type:"submit",color:"primary",loading:F.value,disabled:!C.value},{default:l(()=>[N(f(o.mode==="create"?"Simpan":"Update"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]))}}),Nt={class:"d-flex align-center"},Et={class:"mb-6"},At={class:"mb-3"},jt={class:"text-h6 font-weight-medium"},Kt={class:"mb-3"},Ot={class:"mb-3"},Jt={class:"mb-3"},Ht={class:"text-body-1"},Qt={class:"mb-6"},Wt={class:"mb-3"},Xt={class:"text-body-1 font-weight-medium"},Yt={class:"mb-3"},Gt={class:"d-flex flex-wrap gap-1"},Zt={class:"mb-3"},ea={class:"text-body-1 font-weight-medium"},ta={class:"mb-3"},aa={class:"text-body-1 font-weight-medium"},la={class:"mb-3"},oa={class:"text-body-1 font-weight-medium"},ia={class:"mb-3"},sa={class:"text-body-1 font-weight-medium"},na={class:"mb-3"},ua={class:"text-body-1 font-weight-medium"},ra={class:"mb-3"},da={class:"mb-3"},ma={class:"text-body-1 font-weight-medium"},ca={class:"mb-3"},va={class:"text-body-1 font-weight-medium"},pa={class:"mb-3"},ya={class:"text-body-1 font-weight-medium"},fa={key:0,class:"mb-6"},_a={class:"mb-3"},ba={class:"text-body-1 font-weight-medium"},ga={class:"mb-3"},ha={class:"text-body-1 font-weight-medium"},ka={class:"mb-3"},Va={class:"mb-6"},Sa={class:"mb-3"},wa={class:"mb-3"},xa={class:"mb-3"},Da={class:"text-body-2"},Pa={class:"mb-3"},Ca={class:"text-body-2"},Ta=we({__name:"PromotionViewDialog",props:{modelValue:{type:Boolean},promotion:{}},emits:["update:modelValue"],setup(u,{emit:t}){const s=u,b=t,h=P({get:()=>s.modelValue,set:d=>b("update:modelValue",d)}),C=()=>{h.value=!1},F=d=>O.formatPromotionDiscount(d),_=d=>O.getPromotionTypeLabel(d),q=d=>({happy_hour:"orange",buy_one_get_one:"purple",combo_deal:"teal",category_discount:"indigo",quantity_discount:"pink"})[d]||"secondary",n=d=>d>=8?"error":d>=5?"warning":"success",$=d=>O.getStatusColor(d),w=d=>O.getStatusLabel(d),I=d=>({monday:"Sen",tuesday:"Sel",wednesday:"Rab",thursday:"Kam",friday:"Jum",saturday:"Sab",sunday:"Min"})[d]||d,U=d=>d?new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(d):"-",E=d=>new Date(d).toLocaleString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),H=()=>{var L;if(!((L=s.promotion)!=null&&L.valid_until))return"Tidak terbatas";const d=new Date,g=new Date(s.promotion.valid_until).getTime()-d.getTime();if(g<=0)return"Kadaluarsa";const D=Math.floor(g/(1e3*60*60*24)),T=Math.floor(g%(1e3*60*60*24)/(1e3*60*60)),V=Math.floor(g%(1e3*60*60)/(1e3*60));return D>0?`${D} hari ${T} jam`:T>0?`${T} jam ${V} menit`:V>0?`${V} menit`:"Kurang dari 1 menit"},X=()=>{var T;if(!((T=s.promotion)!=null&&T.valid_until))return"info";const d=new Date,g=new Date(s.promotion.valid_until).getTime()-d.getTime();if(g<=0)return"error";const D=Math.floor(g/(1e3*60*60*24));return D<=1?"error":D<=7?"warning":"success"};return(d,m)=>(S(),Q(Ie,{modelValue:h.value,"onUpdate:modelValue":m[0]||(m[0]=g=>h.value=g),"max-width":"700px",scrollable:""},{default:l(()=>[d.promotion?(S(),Q(me,{key:0},{default:l(()=>[e(ze,{class:"d-flex align-center justify-space-between bg-primary text-white"},{default:l(()=>[i("div",Nt,[e(ye,{icon:"mdi-eye",size:"24",class:"me-2"}),m[1]||(m[1]=i("span",null,"Detail Promosi",-1))]),e(Z,{icon:"mdi-close",variant:"text",color:"white",onClick:C})]),_:1}),e(ce,{class:"pa-6"},{default:l(()=>[i("div",Et,[m[6]||(m[6]=i("h6",{class:"text-h6 mb-4"},"Informasi Dasar",-1)),e(re,null,{default:l(()=>[e(p,{cols:"12"},{default:l(()=>[i("div",At,[m[2]||(m[2]=i("div",{class:"text-caption text-medium-emphasis"},"Nama Promosi",-1)),i("div",jt,f(d.promotion.name),1)])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Kt,[m[3]||(m[3]=i("div",{class:"text-caption text-medium-emphasis"},"Tipe Promosi",-1)),e(oe,{color:q(d.promotion.type),variant:"tonal",size:"small"},{default:l(()=>[N(f(_(d.promotion.type)),1)]),_:1},8,["color"])])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Ot,[m[4]||(m[4]=i("div",{class:"text-caption text-medium-emphasis"},"Prioritas",-1)),e(oe,{color:n(d.promotion.priority),variant:"tonal",size:"small"},{default:l(()=>[N(f(d.promotion.priority),1)]),_:1},8,["color"])])]),_:1}),d.promotion.description?(S(),Q(p,{key:0,cols:"12"},{default:l(()=>[i("div",Jt,[m[5]||(m[5]=i("div",{class:"text-caption text-medium-emphasis"},"Deskripsi",-1)),i("div",Ht,f(d.promotion.description),1)])]),_:1})):M("",!0)]),_:1})]),i("div",Qt,[m[18]||(m[18]=i("h6",{class:"text-h6 mb-4"},"Konfigurasi Promosi",-1)),e(re,null,{default:l(()=>{var g;return[d.promotion.type==="happy_hour"?(S(),J(ie,{key:0},[e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Wt,[m[7]||(m[7]=i("div",{class:"text-caption text-medium-emphasis"},"Jam Berlaku",-1)),i("div",Xt,f(d.promotion.start_time||"00:00")+" - "+f(d.promotion.end_time||"23:59"),1)])]),_:1}),(g=d.promotion.valid_days)!=null&&g.length?(S(),Q(p,{key:0,cols:"12",md:"6"},{default:l(()=>[i("div",Yt,[m[8]||(m[8]=i("div",{class:"text-caption text-medium-emphasis"},"Hari Berlaku",-1)),i("div",Gt,[(S(!0),J(ie,null,$e(d.promotion.valid_days,D=>(S(),Q(oe,{key:D,size:"x-small",variant:"tonal",color:"primary"},{default:l(()=>[N(f(I(D)),1)]),_:2},1024))),128))])])]),_:1})):M("",!0)],64)):M("",!0),d.promotion.type==="buy_one_get_one"?(S(),J(ie,{key:1},[e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Zt,[m[9]||(m[9]=i("div",{class:"text-caption text-medium-emphasis"},"Beli Quantity",-1)),i("div",ea,f(d.promotion.buy_quantity||1),1)])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",ta,[m[10]||(m[10]=i("div",{class:"text-caption text-medium-emphasis"},"Dapat Quantity",-1)),i("div",aa,f(d.promotion.get_quantity||1),1)])]),_:1})],64)):M("",!0),d.promotion.type==="combo_deal"?(S(),J(ie,{key:2},[e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",la,[m[11]||(m[11]=i("div",{class:"text-caption text-medium-emphasis"},"Jumlah Item Combo",-1)),i("div",oa,f(d.promotion.combo_quantity||2),1)])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",ia,[m[12]||(m[12]=i("div",{class:"text-caption text-medium-emphasis"},"Harga Combo",-1)),i("div",sa,f(U(d.promotion.combo_price)),1)])]),_:1})],64)):M("",!0),d.promotion.type==="quantity_discount"?(S(),Q(p,{key:3,cols:"12",md:"6"},{default:l(()=>[i("div",na,[m[13]||(m[13]=i("div",{class:"text-caption text-medium-emphasis"},"Minimum Quantity",-1)),i("div",ua,f(d.promotion.min_quantity||1),1)])]),_:1})):M("",!0),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",ra,[m[14]||(m[14]=i("div",{class:"text-caption text-medium-emphasis"},"Tipe Diskon",-1)),e(oe,{color:d.promotion.discount_type==="percentage"?"primary":"success",variant:"tonal",size:"small"},{default:l(()=>[N(f(d.promotion.discount_type==="percentage"?"Persentase":"Jumlah Tetap"),1)]),_:1},8,["color"])])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",da,[m[15]||(m[15]=i("div",{class:"text-caption text-medium-emphasis"},"Nilai Diskon",-1)),i("div",ma,f(F(d.promotion)),1)])]),_:1}),d.promotion.max_discount_amount?(S(),Q(p,{key:4,cols:"12",md:"6"},{default:l(()=>[i("div",ca,[m[16]||(m[16]=i("div",{class:"text-caption text-medium-emphasis"},"Maksimum Diskon",-1)),i("div",va,f(U(d.promotion.max_discount_amount)),1)])]),_:1})):M("",!0),d.promotion.minimum_amount?(S(),Q(p,{key:5,cols:"12",md:"6"},{default:l(()=>[i("div",pa,[m[17]||(m[17]=i("div",{class:"text-caption text-medium-emphasis"},"Minimum Pembelian",-1)),i("div",ya,f(U(d.promotion.minimum_amount)),1)])]),_:1})):M("",!0)]}),_:1})]),d.promotion.valid_from||d.promotion.valid_until?(S(),J("div",fa,[m[22]||(m[22]=i("h6",{class:"text-h6 mb-4"},"Periode Berlaku",-1)),e(re,null,{default:l(()=>[d.promotion.valid_from?(S(),Q(p,{key:0,cols:"12",md:"6"},{default:l(()=>[i("div",_a,[m[19]||(m[19]=i("div",{class:"text-caption text-medium-emphasis"},"Berlaku Dari",-1)),i("div",ba,f(E(d.promotion.valid_from)),1)])]),_:1})):M("",!0),d.promotion.valid_until?(S(),Q(p,{key:1,cols:"12",md:"6"},{default:l(()=>[i("div",ga,[m[20]||(m[20]=i("div",{class:"text-caption text-medium-emphasis"},"Berlaku Sampai",-1)),i("div",ha,f(E(d.promotion.valid_until)),1)])]),_:1})):M("",!0),d.promotion.valid_until?(S(),Q(p,{key:2,cols:"12"},{default:l(()=>[i("div",ka,[m[21]||(m[21]=i("div",{class:"text-caption text-medium-emphasis"},"Sisa Waktu",-1)),e(oe,{color:X(),variant:"tonal",size:"small"},{default:l(()=>[e(ye,{icon:"mdi-clock-outline",size:"16",class:"me-1"}),N(" "+f(H()),1)]),_:1},8,["color"])])]),_:1})):M("",!0)]),_:1})])):M("",!0),i("div",Va,[m[25]||(m[25]=i("h6",{class:"text-h6 mb-4"},"Status",-1)),e(re,null,{default:l(()=>[e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Sa,[m[23]||(m[23]=i("div",{class:"text-caption text-medium-emphasis"},"Status Aktif",-1)),e(oe,{color:d.promotion.active?"success":"error",variant:"tonal",size:"small"},{default:l(()=>[e(ye,{icon:d.promotion.active?"mdi-check":"mdi-close",size:"16",class:"me-1"},null,8,["icon"]),N(" "+f(d.promotion.active?"Aktif":"Tidak Aktif"),1)]),_:1},8,["color"])])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",wa,[m[24]||(m[24]=i("div",{class:"text-caption text-medium-emphasis"},"Status Berlaku",-1)),e(oe,{color:$(d.promotion.status||"unknown"),variant:"tonal",size:"small"},{default:l(()=>[N(f(w(d.promotion.status||"unknown")),1)]),_:1},8,["color"])])]),_:1})]),_:1})]),i("div",null,[m[28]||(m[28]=i("h6",{class:"text-h6 mb-4"},"Informasi Sistem",-1)),e(re,null,{default:l(()=>[e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",xa,[m[26]||(m[26]=i("div",{class:"text-caption text-medium-emphasis"},"Dibuat Pada",-1)),i("div",Da,f(E(d.promotion.created_at)),1)])]),_:1}),e(p,{cols:"12",md:"6"},{default:l(()=>[i("div",Pa,[m[27]||(m[27]=i("div",{class:"text-caption text-medium-emphasis"},"Terakhir Diupdate",-1)),i("div",Ca,f(E(d.promotion.updated_at)),1)])]),_:1})]),_:1})])]),_:1}),e(Ne,{class:"pa-6 pt-0"},{default:l(()=>[e(Ee),e(Z,{variant:"outlined",onClick:C},{default:l(()=>m[29]||(m[29]=[N(" Tutup ")])),_:1,__:[29]})]),_:1})]),_:1})):M("",!0)]),_:1},8,["modelValue"]))}}),qa={class:"promotion-management"},Ra={class:"d-flex justify-space-between align-center mb-6"},Ba={class:"d-flex gap-3 align-center"},La={class:"text-h3 font-weight-bold"},Ma={class:"text-h3 font-weight-bold"},Fa={class:"text-h3 font-weight-bold"},Ua={class:"text-h3 font-weight-bold"},$a={class:"font-weight-medium"},Ia={key:0,class:"text-caption text-medium-emphasis"},za={class:"font-weight-medium"},Na={class:"text-sm"},Ea={key:0},Aa={key:1},ja={key:2},Ka={class:"d-flex align-center gap-2"},Oa=we({__name:"promotions-management",setup(u){const t=x([]),s=x(!1),b=x(null),h=x(1),C=x(15),F=x(0),_=x({search:"",type:"all",status:"all",sort_by:"created_at",sort_order:"desc"});x(""),x("all"),x("all"),x("all");const q=x(!1),n=x(!1),$=x(!1),w=x(null),I=x("create"),U=x(!1),E=[{title:"Semua Tipe",value:"all"},{title:"Happy Hour",value:"happy_hour"},{title:"Beli 1 Dapat 1",value:"buy_one_get_one"},{title:"Paket Combo",value:"combo_deal"},{title:"Diskon Kategori",value:"category_discount"},{title:"Diskon Quantity",value:"quantity_discount"}],H=[{title:"Semua Status",value:"all"},{title:"Aktif",value:"active"},{title:"Tidak Aktif",value:"inactive"},{title:"Kadaluarsa",value:"expired"},{title:"Terjadwal",value:"scheduled"}],X=[{title:"Tanggal Dibuat",value:"created_at"},{title:"Nama",value:"name"},{title:"Prioritas",value:"priority"},{title:"Tanggal Berlaku",value:"valid_from"}],d=[{title:"Nama",key:"name",sortable:!0},{title:"Tipe",key:"type",sortable:!0},{title:"Diskon",key:"discount",sortable:!0},{title:"Periode",key:"valid_period",sortable:!1},{title:"Jam",key:"time_range",sortable:!1},{title:"Prioritas",key:"priority",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Aksi",key:"actions",sortable:!1,align:"center"}],m=pt(()=>{h.value=1,g()},500),g=async()=>{try{s.value=!0;const y={search:_.value.search||void 0,type:_.value.type==="all"?void 0:_.value.type,status:_.value.status==="all"?void 0:_.value.status,sort_by:_.value.sort_by||"priority",sort_order:"desc",page:h.value,per_page:C.value},r=await O.getPromotions(y);t.value=r.data,F.value=r.total}catch(y){console.error("Failed to fetch promotions:",y)}finally{s.value=!1}},D=async()=>{try{b.value=await O.getStats()}catch(y){console.error("Failed to fetch promotion stats:",y)}},T=async()=>{await Promise.all([g(),D()])},V=y=>{h.value=y.page,C.value=y.itemsPerPage,g()},L=()=>{w.value=null,I.value="create",q.value=!0},R=y=>{w.value=y,n.value=!0},z=y=>{w.value=y,I.value="edit",q.value=!0},j=async y=>{try{await O.duplicate(y.id_promotion),await T()}catch(r){console.error("Failed to duplicate promotion:",r)}},K=async y=>{try{await O.toggleStatus(y.id_promotion),await g()}catch(r){console.error("Failed to toggle promotion status:",r)}},B=y=>{w.value=y,$.value=!0},Y=async()=>{if(w.value)try{U.value=!0,await O.deletePromotion(w.value.id_promotion),await T(),$.value=!1}catch(y){console.error("Failed to delete promotion:",y)}finally{U.value=!1}},G=()=>{w.value=null,$.value=!1},A=()=>{q.value=!1,T()},ee=y=>O.formatPromotionDiscount(y),se=y=>O.getPromotionTypeLabel(y),ne=y=>({happy_hour:"orange",buy_one_get_one:"purple",combo_deal:"teal",category_discount:"indigo",quantity_discount:"pink"})[y]||"secondary",ue=y=>y>=8?"error":y>=5?"warning":"success",o=y=>O.getStatusColor(y||"inactive"),a=y=>O.getStatusLabel(y||"inactive"),c=y=>y?new Date(y).toLocaleDateString("id-ID"):"-",te=y=>{const r={monday:"Sen",tuesday:"Sel",wednesday:"Rab",thursday:"Kam",friday:"Jum",saturday:"Sab",sunday:"Min"};return y.map(k=>r[k]||k).join(", ")},ve=(y,r)=>y.length>r?y.substring(0,r)+"...":y;return ct(()=>{T()}),(y,r)=>{var k;return S(),J("div",qa,[i("div",Ra,[r[11]||(r[11]=i("div",null,[i("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Promosi"),i("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola promosi dan penawaran khusus untuk coffee shop Anda")],-1)),i("div",Ba,[e(Z,{color:"primary","prepend-icon":"mdi-plus",onClick:L},{default:l(()=>r[10]||(r[10]=[N(" Tambah Promosi ")])),_:1,__:[10]})])]),e(re,{class:"mb-6"},{default:l(()=>[e(p,{cols:"12",md:"3"},{default:l(()=>[e(me,{color:"primary",variant:"tonal"},{default:l(()=>[e(ce,{class:"text-center"},{default:l(()=>{var v;return[i("div",La,f(((v=b.value)==null?void 0:v.total_promotions)||0),1),r[12]||(r[12]=i("div",{class:"text-body-2 text-medium-emphasis"},"Total Promosi",-1))]}),_:1,__:[12]})]),_:1})]),_:1}),e(p,{cols:"12",md:"3"},{default:l(()=>[e(me,{color:"success",variant:"tonal"},{default:l(()=>[e(ce,{class:"text-center"},{default:l(()=>{var v;return[i("div",Ma,f(((v=b.value)==null?void 0:v.active_promotions)||0),1),r[13]||(r[13]=i("div",{class:"text-body-2 text-medium-emphasis"},"Aktif",-1))]}),_:1,__:[13]})]),_:1})]),_:1}),e(p,{cols:"12",md:"3"},{default:l(()=>[e(me,{color:"warning",variant:"tonal"},{default:l(()=>[e(ce,{class:"text-center"},{default:l(()=>{var v;return[i("div",Fa,f(((v=b.value)==null?void 0:v.scheduled_promotions)||0),1),r[14]||(r[14]=i("div",{class:"text-body-2 text-medium-emphasis"},"Terjadwal",-1))]}),_:1,__:[14]})]),_:1})]),_:1}),e(p,{cols:"12",md:"3"},{default:l(()=>[e(me,{color:"error",variant:"tonal"},{default:l(()=>[e(ce,{class:"text-center"},{default:l(()=>{var v;return[i("div",Ua,f(((v=b.value)==null?void 0:v.expired_promotions)||0),1),r[15]||(r[15]=i("div",{class:"text-body-2 text-medium-emphasis"},"Kedaluwarsa",-1))]}),_:1,__:[15]})]),_:1})]),_:1})]),_:1}),e(me,null,{default:l(()=>[e(ce,null,{default:l(()=>[e(re,{class:"mb-4"},{default:l(()=>[e(p,{cols:"12",md:"4"},{default:l(()=>[e(W,{modelValue:_.value.search,"onUpdate:modelValue":r[0]||(r[0]=v=>_.value.search=v),label:"Cari promosi...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:vt(m),"onClick:clear":r[1]||(r[1]=v=>{_.value.search="",g()})},null,8,["modelValue","onInput"])]),_:1}),e(p,{cols:"12",md:"2"},{default:l(()=>[e(fe,{modelValue:_.value.type,"onUpdate:modelValue":[r[2]||(r[2]=v=>_.value.type=v),g],items:E,label:"Tipe",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"2"},{default:l(()=>[e(fe,{modelValue:_.value.status,"onUpdate:modelValue":[r[3]||(r[3]=v=>_.value.status=v),g],items:H,label:"Status",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"2"},{default:l(()=>[e(fe,{modelValue:_.value.sort_by,"onUpdate:modelValue":[r[4]||(r[4]=v=>_.value.sort_by=v),g],items:X,label:"Urutkan",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{cols:"12",md:"2",class:"d-flex align-center"},{default:l(()=>[e(Z,{variant:"outlined","prepend-icon":"mdi-refresh",onClick:T},{default:l(()=>r[16]||(r[16]=[N(" Refresh ")])),_:1,__:[16]})]),_:1})]),_:1}),e(St,{"items-per-page":C.value,"onUpdate:itemsPerPage":r[5]||(r[5]=v=>C.value=v),page:h.value,"onUpdate:page":r[6]||(r[6]=v=>h.value=v),headers:d,items:t.value,"items-length":F.value,loading:s.value,class:"promotion-table","onUpdate:options":V},{"item.name":l(({item:v})=>[i("div",null,[i("div",$a,f(v.name),1),v.description?(S(),J("div",Ia,f(ve(v.description,50)),1)):M("",!0)])]),"item.type":l(({item:v})=>[e(oe,{size:"small",color:ne(v.type),variant:"tonal"},{default:l(()=>[N(f(se(v.type)),1)]),_:2},1032,["color"])]),"item.discount":l(({item:v})=>[i("span",za,f(ee(v)),1)]),"item.schedule":l(({item:v})=>[i("div",Na,[v.type==="happy_hour"?(S(),J("div",Ea,[e(ye,{icon:"mdi-clock-outline",size:"14",class:"me-1"}),N(" "+f(v.start_time)+" - "+f(v.end_time),1)])):M("",!0),v.valid_days&&v.valid_days.length>0?(S(),J("div",Aa,[e(ye,{icon:"mdi-calendar",size:"14",class:"me-1"}),N(" "+f(te(v.valid_days)),1)])):M("",!0),v.valid_from?(S(),J("div",ja,f(c(v.valid_from))+" - "+f(c(v.valid_until)),1)):M("",!0)])]),"item.priority":l(({item:v})=>[e(oe,{size:"small",color:ue(v.priority),variant:"tonal"},{default:l(()=>[N(f(v.priority),1)]),_:2},1032,["color"])]),"item.status":l(({item:v})=>[e(oe,{size:"small",color:o(v.status),variant:"tonal"},{default:l(()=>[N(f(a(v.status)),1)]),_:2},1032,["color"])]),"item.actions":l(({item:v})=>[i("div",Ka,[e(Z,{icon:"mdi-eye",size:"small",variant:"text",onClick:pe=>R(v)},null,8,["onClick"]),e(Z,{icon:"mdi-pencil",size:"small",variant:"text",onClick:pe=>z(v)},null,8,["onClick"]),e(Z,{icon:v.active?"mdi-pause":"mdi-play",size:"small",variant:"text",onClick:pe=>K(v)},null,8,["icon","onClick"]),e(Z,{icon:"mdi-content-copy",size:"small",variant:"text",onClick:pe=>j(v)},null,8,["onClick"]),e(Z,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:pe=>B(v)},null,8,["onClick"])])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1})]),_:1}),e(zt,{modelValue:q.value,"onUpdate:modelValue":r[7]||(r[7]=v=>q.value=v),promotion:w.value,mode:I.value,onSaved:A},null,8,["modelValue","promotion","mode"]),e(Ta,{modelValue:n.value,"onUpdate:modelValue":r[8]||(r[8]=v=>n.value=v),promotion:w.value},null,8,["modelValue","promotion"]),e(We,{modelValue:$.value,"onUpdate:modelValue":r[9]||(r[9]=v=>$.value=v),loading:U.value,"item-name":((k=w.value)==null?void 0:k.name)||"",title:"Konfirmasi Hapus Promosi",onConfirm:Y,onCancel:G},null,8,["modelValue","loading","item-name"])])}}}),gl=yt(Oa,[["__scopeId","data-v-7b5915af"]]);export{gl as default};
