import{av as be,d as Ct,r as k,V as oe,w as Dt,g as w,f as o,b as t,s as i,X as A,t as u,l as y,c as X,e as n,at as ut,a0 as V,o as _,au as Vt,aU as jt,D as Rt,m as a,a2 as ze,F as Lt,i as zt,p as Ge,$ as Ye,a4 as Ft,aw as nt,ar as Nt}from"./main-DcOxu_iY.js";import{V as Se}from"./VDialog-CtHBFQfr.js";import{b as fe,c as Ce,V as q}from"./VCard-CarlQF4f.js";import{V as G}from"./VDivider-5s4PHN83.js";import{V as H}from"./VCardText-ZbrtLebs.js";import{V as se}from"./VAlert-CCf-MFc-.js";import{V as Et,a as Bt}from"./VDataTable-Dj0xYjd9.js";import{V as D}from"./VChip-lx0Dd1Uw.js";import{V as Ve}from"./VSpacer-cna5IU0U.js";import{_ as Ut}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as qt}from"./ItemsApi-CPoB3JGk.js";import{u as Kt}from"./useApi-S1BoHU9j.js";import{V as _e,a as $}from"./VRow-B8LfeWfS.js";import{V as ve}from"./VTextField-BH8ElYDD.js";import{V as rt}from"./VSelect-Db2YqPW8.js";import{V as Tt}from"./VCheckbox-CQL7xQlJ.js";import{V as Ot}from"./VDataTableServer-CvcGYbUP.js";import{V as Xe}from"./VTooltip-DdizrO-n.js";import{V as Je}from"./VForm-BNe-nQJw.js";import{V as it}from"./VTextarea-C83dqbKk.js";import{V as Mt}from"./VAvatar-CbTt8RiM.js";import"./VOverlay-yRNL_Cmy.js";import"./forwardRefs-B931MWyl.js";import"./VImg-B8cqB_Zg.js";import"./VCheckboxBtn-PzFViS6h.js";import"./VTable-DcuHuBFr.js";import"./filter-CynBo2Pf.js";/* empty css              */import"./VList-D3qaeDoM.js";import"./VMenu-it0dmSHg.js";const ke="/api/inventory";class le{static async getAll(d){var p;try{return(await be.get(ke,{params:d})).data}catch(v){throw((p=v.response)==null?void 0:p.data)||this.handleError(v)}}static async getById(d){var p;try{return(await be.get(`${ke}/${d}`)).data}catch(v){throw((p=v.response)==null?void 0:p.data)||this.handleError(v)}}static async getStats(){var d;try{return(await be.get(`${ke}/stats`)).data}catch(p){throw((d=p.response)==null?void 0:d.data)||this.handleError(p)}}static async getLowStockAlerts(){var d;try{return(await be.get(`${ke}/low-stock-alerts`)).data}catch(p){throw((d=p.response)==null?void 0:d.data)||this.handleError(p)}}static async updateStock(d,p){var v;try{return(await be.post(`${ke}/${d}/update-stock`,p)).data}catch(M){throw((v=M.response)==null?void 0:v.data)||this.handleError(M)}}static async bulkUpdateStock(d){var p;try{return(await be.post(`${ke}/bulk-update-stock`,d)).data}catch(v){throw((p=v.response)==null?void 0:p.data)||this.handleError(v)}}static async setReorderLevel(d,p){var v;try{return(await be.post(`${ke}/${d}/reorder-level`,p)).data}catch(M){throw((v=M.response)==null?void 0:v.data)||this.handleError(M)}}static async getMovements(d){var p;try{const v=d!=null&&d.id_inventory?`${ke}/${d.id_inventory}/movements`:`${ke}/movements`;return(await be.get(v,{params:d})).data}catch(v){throw((p=v.response)==null?void 0:p.data)||this.handleError(v)}}static async recordMovement(d){var p;try{return(await be.post(`${ke}/movement`,d)).data}catch(v){throw((p=v.response)==null?void 0:p.data)||this.handleError(v)}}static handleError(d){var p,v;return d.response?{message:((p=d.response.data)==null?void 0:p.message)||"Terjadi kesalahan pada server",success:!1,errors:(v=d.response.data)==null?void 0:v.errors}:d.request?{message:"Tidak dapat terhubung ke server",success:!1}:{message:d.message||"Terjadi kesalahan yang tidak diketahui",success:!1}}static formatError(d){return d.errors?Object.values(d.errors).flat().join(", "):d.message||"Terjadi kesalahan yang tidak diketahui"}static isValidationError(d){return d.errors&&typeof d.errors=="object"}static getFieldError(d,p){return d.errors&&d.errors[p]?Array.isArray(d.errors[p])?d.errors[p][0]:d.errors[p]:null}static getMovementTypes(){return[{value:"stock_in",label:"Stock Masuk",color:"success"},{value:"stock_out",label:"Stock Keluar",color:"warning"},{value:"adjustment",label:"Penyesuaian",color:"info"},{value:"transfer",label:"Transfer",color:"primary"},{value:"return",label:"Retur",color:"success"},{value:"damaged",label:"Rusak",color:"error"},{value:"expired",label:"Kadaluarsa",color:"error"}]}static getStockStatusOptions(){return[{value:"all",label:"Semua Status"},{value:"in_stock",label:"Tersedia"},{value:"low_stock",label:"Stok Menipis"},{value:"out_of_stock",label:"Habis"},{value:"overstock",label:"Stok Berlebih"}]}}const Ht={key:1,class:"text-center py-8"},Gt={class:"font-weight-medium"},Yt={class:"text-medium-emphasis"},Xt={class:"text-center"},Jt={class:"text-center font-weight-medium"},Wt={class:"text-center font-weight-bold text-primary"},Qt={class:"text-end"},Zt={class:"text-end font-weight-medium text-success"},ea={class:"max-width-200"},ta={class:"font-weight-medium"},aa={key:0,class:"text-medium-emphasis"},oa={key:1,class:"d-block text-caption"},sa={key:2,class:"text-info d-block"},la={class:"text-center py-8"},na=Ct({__name:"InventoryMovementsDialog",props:{modelValue:{type:Boolean},inventoryId:{},inventoryName:{}},emits:["update:modelValue"],setup(ue,{emit:d}){const p=ue,v=d,M=k([]),W=k(!1),Y=k(""),F=oe({get:()=>p.modelValue,set:b=>v("update:modelValue",b)}),te=async()=>{var b,x,l,C;if(p.inventoryId)try{W.value=!0,Y.value="";const T=await le.getMovements({id_inventory:parseInt(p.inventoryId),page:1,per_page:50});T.data&&Array.isArray(T.data)?M.value=T.data:T.data&&((b=T==null?void 0:T.data)!=null&&b.data)&&Array.isArray((x=T==null?void 0:T.data)==null?void 0:x.data)?M.value=T.data.data:M.value=[]}catch(T){console.error("Error fetching movements:",T),Y.value=((C=(l=T.response)==null?void 0:l.data)==null?void 0:C.message)||"Gagal memuat riwayat pergerakan"}finally{W.value=!1}},ne=b=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(b),Q=b=>({in:"success",out:"error",stock_in:"success",stock_out:"error",adjustment:"warning",transfer:"info",return:"secondary"})[b]||"primary",Z=b=>({in:"Stock Masuk",out:"Stock Keluar",stock_in:"Stock Masuk",stock_out:"Stock Keluar",adjustment:"Penyesuaian",transfer:"Transfer",return:"Retur"})[b]||b,j=b=>({in:"tabler-plus",out:"tabler-minus",stock_in:"tabler-plus",stock_out:"tabler-minus",adjustment:"tabler-edit",transfer:"tabler-arrows-exchange",return:"tabler-arrow-back"})[b]||"tabler-package";return Dt(F,b=>{b&&p.inventoryId?te():(M.value=[],Y.value="")}),(b,x)=>(_(),w(Se,{modelValue:F.value,"onUpdate:modelValue":x[1]||(x[1]=l=>F.value=l),"max-width":"900px",scrollable:""},{default:o(()=>[t(q,null,{default:o(()=>[t(fe,{class:"d-flex align-center"},{default:o(()=>[t(A,{icon:"tabler-history",class:"me-2"}),i(" Riwayat Pergerakan - "+u(b.inventoryName),1)]),_:1}),t(G),t(H,{class:"pa-0"},{default:o(()=>[Y.value?(_(),w(se,{key:0,type:"error",variant:"tonal",class:"ma-4"},{default:o(()=>[i(u(Y.value),1)]),_:1})):y("",!0),W.value?(_(),X("div",Ht,[t(ut,{indeterminate:"",color:"primary",size:"40"}),x[2]||(x[2]=n("div",{class:"mt-4 text-medium-emphasis"}," Memuat riwayat pergerakan... ",-1))])):(_(),w(Et,{key:2,headers:[{title:"Tanggal",key:"created_at",sortable:!1},{title:"Jenis",key:"movement_type",sortable:!1},{title:"Kuantitas",key:"quantity",sortable:!1},{title:"Stok Sebelum",key:"stock_before",sortable:!1},{title:"Stok Sesudah",key:"stock_after",sortable:!1},{title:"Harga/Unit",key:"unit_cost",sortable:!1},{title:"Total Nilai",key:"total_cost",sortable:!1},{title:"Catatan",key:"notes",sortable:!1}],items:M.value,loading:W.value,class:"text-no-wrap","items-per-page":"15",height:"500","fixed-header":""},{"item.created_at":o(({item:l})=>[n("div",null,[n("div",Gt,u(new Date(l.created_at).toLocaleDateString("id-ID")),1),n("small",Yt,u(new Date(l.created_at).toLocaleTimeString("id-ID")),1)])]),"item.movement_type":o(({item:l})=>[t(D,{color:Q(l.movement_type),variant:"tonal",size:"small","prepend-icon":j(l.movement_type)},{default:o(()=>[i(u(Z(l.movement_type)),1)]),_:2},1032,["color","prepend-icon"])]),"item.quantity":o(({item:l})=>[n("div",Xt,[t(D,{color:l.movement_type==="in"||l.movement_type==="stock_in"?"success":"error",variant:"outlined",size:"small"},{default:o(()=>[i(u(l.movement_type==="in"||l.movement_type==="stock_in"?"+":"-")+u(Math.abs(l.quantity)),1)]),_:2},1032,["color"])])]),"item.stock_before":o(({item:l})=>[n("div",Jt,u(l.stock_before),1)]),"item.stock_after":o(({item:l})=>[n("div",Wt,u(l.stock_after),1)]),"item.unit_cost":o(({item:l})=>[n("div",Qt,u(l.unit_cost?ne(l.unit_cost):"-"),1)]),"item.total_cost":o(({item:l})=>[n("div",Zt,u(l.total_cost?ne(l.total_cost):"-"),1)]),"item.notes":o(({item:l})=>[n("div",ea,[n("div",ta,u(l.notes||"-"),1),l.reference_type&&l.reference_id?(_(),X("small",aa," Ref: "+u(l.reference_type)+"-"+u(l.reference_id),1)):y("",!0),l.batch_number?(_(),X("small",oa," Batch: "+u(l.batch_number),1)):y("",!0),l.user?(_(),X("small",sa," oleh: "+u(l.user.name),1)):y("",!0)])]),"no-data":o(()=>[n("div",la,[t(A,{icon:"tabler-history-off",size:"48",class:"text-medium-emphasis mb-4"}),x[3]||(x[3]=n("div",{class:"text-h6 text-medium-emphasis mb-2"}," Belum ada riwayat pergerakan ",-1)),x[4]||(x[4]=n("div",{class:"text-body-2 text-medium-emphasis"}," Riwayat akan muncul setelah ada pergerakan stok ",-1))])]),_:1},8,["items","loading"]))]),_:1}),t(G),t(Ce,{class:"pa-4"},{default:o(()=>[t(Ve),t(V,{variant:"outlined",onClick:x[0]||(x[0]=l=>F.value=!1)},{default:o(()=>x[5]||(x[5]=[i(" Tutup ")])),_:1,__:[5]}),t(V,{color:"primary","prepend-icon":"tabler-refresh",onClick:te},{default:o(()=>x[6]||(x[6]=[i(" Refresh ")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ra=Ut(na,[["__scopeId","data-v-ca0277a4"]]),ia=()=>{const ue=k([]),d=k(!1),p=k(!1),v=k({total_items:0,low_stock_items:0,out_of_stock_items:0,overstock_items:0,total_stock_value:0,total_stock_quantity:0,total_reserved_stock:0,items_need_restock:0}),M=k([]),W=k(!1),Y=k([]),F=k(!1),te=k(!1),ne=k(!1),Q=k(!1),Z=k(!1),j=k(null),b=k([]),x=k(1),l=k(0),C=k(15),T=k({search:"",stock_status:"all",category_id:void 0,supplier_id:void 0,available_in_kitchen:!1,available_in_bar:!1,station_mode:"inclusive",sort_by:"current_stock",sort_order:"asc"}),ce=k(""),N=k(""),K=k(""),he=k({movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:void 0,notes:""}),xe=k({reorder_level:0,max_stock_level:0}),de=oe(()=>b.value.length>0),De=oe(()=>v.value.total_stock_value),me=oe(()=>v.value.low_stock_items),ge=oe(()=>v.value.out_of_stock_items),re=oe(()=>Math.ceil(l.value/C.value)),Ee=oe(()=>x.value<re.value),Ue=oe(()=>x.value>1),Ae=oe(()=>({currentPage:x.value,totalPages:re.value,totalItems:l.value,itemsPerPage:C.value,hasNext:Ee.value,hasPrev:Ue.value})),Fe=[r=>r>0||"Kuantitas harus lebih dari 0",r=>Number.isInteger(r)||"Kuantitas harus berupa bilangan bulat"],Ne=[r=>!!r||"Alasan wajib diisi",r=>r&&r.length>=3||"Alasan minimal 3 karakter"],Be=[r=>!r||r>=0||"Harga harus lebih dari atau sama dengan 0"],g=[{title:"Stock Masuk",value:"stock_in",color:"success"},{title:"Stock Keluar",value:"stock_out",color:"warning"},{title:"Penyesuaian",value:"adjustment",color:"info"},{title:"Transfer",value:"transfer",color:"primary"},{title:"Retur",value:"return",color:"success"}],O=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Menipis",value:"low_stock"},{title:"Habis",value:"out_of_stock"},{title:"Stok Berlebih",value:"overstock"}],E=async()=>{d.value=!0,ce.value="";try{const r={...T.value,page:x.value,per_page:C.value};Object.keys(r).forEach(ee=>{const Me=r[ee];if(ee==="available_in_kitchen"||ee==="available_in_bar"){Me!==!0&&delete r[ee];return}if(ee==="station_mode"){!r.available_in_kitchen&&!r.available_in_bar&&delete r[ee];return}(Me===""||Me===void 0||Me===null||Me==="all")&&delete r[ee]});const z=await le.getAll(r);if(z.success)ue.value=z.data.data||[],l.value=z.data.total||0,z.data.current_page&&(x.value=z.data.current_page);else throw new Error(z.message||"Gagal mengambil data inventory")}catch(r){console.error("Error fetching inventory:",r),ce.value=le.formatError(r)||"Gagal mengambil data inventory",ue.value=[],l.value=0}finally{d.value=!1}},qe=async()=>{try{const r=await le.getStats();r.success&&(v.value=r.data)}catch(r){console.error("Error fetching inventory stats:",r)}},ie=async()=>{F.value=!0;try{const r=await le.getLowStockAlerts();r.success&&(Y.value=r.data.data||[])}catch(r){console.error("Error fetching low stock alerts:",r),Y.value=[]}finally{F.value=!1}},Te=async r=>{W.value=!0;try{const z=await le.getMovements({id_inventory:r,page:1,per_page:20});z.success&&(M.value=z.data)}catch(z){console.error("Error fetching movements:",z)}finally{W.value=!1}},We=async()=>{if(j.value){p.value=!0,K.value="";try{const r=await le.updateStock(j.value.id_inventory,he.value);if(r.success)N.value="Stock berhasil diperbarui",Ie(),await E(),await qe(),await ie();else throw new Error(r.message||"Gagal memperbarui stock")}catch(r){console.error("Error updating stock:",r),K.value=le.formatError(r)||"Gagal memperbarui stock"}finally{p.value=!1}}},Pe=async()=>{if(j.value){p.value=!0,K.value="";try{const r=await le.setReorderLevel(j.value.id_inventory,xe.value);if(r.success)N.value="Reorder level berhasil diperbarui",ae(),await E();else throw new Error(r.message||"Gagal memperbarui reorder level")}catch(r){console.error("Error setting reorder level:",r),K.value=le.formatError(r)||"Gagal memperbarui reorder level"}finally{p.value=!1}}},$e=r=>{j.value=r,he.value={movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:r.average_cost||void 0,notes:""},K.value="",te.value=!0},Qe=r=>{j.value=r,xe.value={reorder_level:r.reorder_level||0,max_stock_level:r.max_stock_level||0},K.value="",Z.value=!0},je=r=>{j.value=r,Te(r.id_inventory),Q.value=!0},Ie=()=>{te.value=!1,setTimeout(()=>{j.value=null,K.value=""},300)},ae=()=>{Z.value=!1,setTimeout(()=>{j.value=null,K.value=""},300)};return{inventoryList:ue,loading:d,saveLoading:p,stats:v,movementsList:M,movementsLoading:W,lowStockItems:Y,alertsLoading:F,stockUpdateDialog:te,bulkUpdateDialog:ne,movementsDialog:Q,reorderDialog:Z,selectedInventory:j,selectedItems:b,currentPage:x,totalItems:l,itemsPerPage:C,filters:T,errorMessage:ce,successMessage:N,modalErrorMessage:K,stockUpdateForm:he,reorderForm:xe,hasSelectedItems:de,totalStockValue:De,lowStockCount:me,outOfStockCount:ge,quantityRules:Fe,reasonRules:Ne,costRules:Be,movementTypeOptions:g,stockStatusOptions:O,fetchInventoryList:E,fetchStats:qe,fetchLowStockAlerts:ie,fetchMovements:Te,updateStock:We,setReorderLevel:Pe,openStockUpdateDialog:$e,openReorderDialog:Qe,openMovementsDialog:je,closeStockUpdateDialog:Ie,closeReorderDialog:ae,closeMovementsDialog:()=>{Q.value=!1,setTimeout(()=>{j.value=null,M.value=[]},300)},clearModalError:()=>{K.value=""},onPageChange:r=>{r!==x.value&&(x.value=r,E())},onItemsPerPageChange:r=>{r!==C.value&&(C.value=r,x.value=1,E())},handleFiltersUpdate:r=>{T.value={...T.value,...r},x.value=1,E()},formatCurrency:r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),getStockStatusColor:r=>r.current_stock===0?"error":r.is_low_stock?"warning":"success",getStockStatusText:r=>r.current_stock===0?"Habis":r.reorder_level>0&&r.current_stock<=r.reorder_level?"Menipis":r.max_stock_level&&r.current_stock>r.max_stock_level?"Berlebih":"Tersedia",getMovementTypeColor:r=>({stock_in:"success",stock_out:"warning",adjustment:"info",transfer:"primary",return:"success",damaged:"error",expired:"error"})[r]||"grey",totalPages:re,hasNextPage:Ee,hasPrevPage:Ue,paginationInfo:Ae}};function ua(ue){const d=k([]),p=k([]),v=k(!1),M=k(!1),W=k({total_items:0,total_value:0,low_stock_items:0,out_of_stock_items:0,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}),Y=k(1),F=k(0),te=k(10),ne=Vt({search:"",stock_status:"all",movement_type:"",date_from:"",date_to:"",item_id:void 0}),Q=k(!1),Z=k(!1),j=k(null),b=Vt({item_id:0,type:"in",quantity:0,notes:"",cost_per_unit:0}),x=k(""),l=k(""),C=k(""),T=oe(()=>!0),ce=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],N=[{title:"Masuk",value:"in",color:"success",icon:"tabler-plus"},{title:"Keluar",value:"out",color:"error",icon:"tabler-minus"},{title:"Penyesuaian",value:"adjustment",color:"warning",icon:"tabler-adjustments"}],K=[{title:"Pembelian",value:"purchase"},{title:"Penjualan",value:"sale"},{title:"Produksi",value:"production"},{title:"Penyesuaian",value:"adjustment"},{title:"Kerusakan",value:"waste"}],he=g=>g.current_stock<=0?{status:"out_of_stock",color:"error",text:"Habis",icon:"tabler-x"}:g.current_stock<=g.minimum_stock?{status:"low_stock",color:"warning",text:"Rendah",icon:"tabler-alert-triangle"}:{status:"in_stock",color:"success",text:"Tersedia",icon:"tabler-check"},xe=g=>!g.maximum_stock||g.maximum_stock<=0?100:Math.round(g.current_stock/g.maximum_stock*100),de=async()=>{v.value=!0;try{await new Promise(g=>setTimeout(g,1e3)),d.value=await qt.getAll(),F.value=d.value.length,l.value=""}catch{x.value="Gagal memuat data items"}finally{v.value=!1}},De=async g=>{v.value=!0;try{const O=await le.getMovements({id_inventory:g,page:Y.value,per_page:te.value});p.value=O.data.map(E=>({id:E.id_movement,item_id:E.id_inventory,type:E.movement_type,quantity:E.quantity,unit:"pcs",reference_id:E.reference_number?parseInt(E.reference_number):void 0,reference_type:E.reason,notes:E.notes,cost_per_unit:E.cost_per_unit,total_cost:E.total_cost,created_by:E.created_by,created_at:E.created_at,creator:E.user})),F.value=O.total}catch(O){console.error("Failed to fetch stock movements:",O),p.value=[]}finally{v.value=!1}},me=async()=>{try{await de();const g=d.value;W.value={total_items:g.length,total_value:g.reduce((O,E)=>O+E.current_stock*E.cost_per_unit,0),low_stock_items:g.filter(O=>O.current_stock<=O.minimum_stock&&O.current_stock>0).length,out_of_stock_items:g.filter(O=>O.current_stock<=0).length,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}}catch(g){console.error("Failed to fetch stats:",g)}},ge=async()=>{M.value=!0,C.value="";try{const g=await le.recordMovement({item_id:b.item_id,movement_type:b.type,quantity:b.quantity,notes:b.notes,cost_per_unit:b.cost_per_unit});if(g.success)l.value=`Stock ${b.type==="in"?"masuk":b.type==="out"?"keluar":"disesuaikan"} berhasil dicatat`,Ae(),await de(),await me(),ue&&ue();else throw new Error(g.message||"Gagal mencatat pergerakan stok")}catch(g){C.value=g.message||"Gagal mencatat pergerakan stok"}finally{M.value=!1}},re=g=>{j.value=g,Object.assign(b,{item_id:g.id_item,type:"in",quantity:0,notes:"",cost_per_unit:g.cost_per_unit}),Q.value=!0},Ee=g=>{j.value=g,Object.assign(b,{item_id:g.id_item,type:"out",quantity:0,notes:"",cost_per_unit:g.cost_per_unit}),Q.value=!0},Ue=g=>{j.value=g,Object.assign(b,{item_id:g.id_item,type:"adjustment",quantity:g.current_stock,notes:"",cost_per_unit:g.cost_per_unit}),Z.value=!0},Ae=()=>{Q.value=!1,Z.value=!1,C.value="",j.value=null};return{itemsList:d,stockMovements:p,loading:v,saveLoading:M,stats:W,currentPage:Y,totalItems:F,itemsPerPage:te,filters:ne,movementDialog:Q,adjustmentDialog:Z,selectedItem:j,movementFormData:b,errorMessage:x,successMessage:l,modalErrorMessage:C,canManageStock:T,stockStatusOptions:ce,movementTypeOptions:N,referenceTypeOptions:K,getStockStatus:he,getStockPercentage:xe,fetchItems:de,fetchStockMovements:De,fetchStats:me,recordStockMovement:ge,openStockInDialog:re,openStockOutDialog:Ee,openAdjustmentDialog:Ue,closeMovementDialog:Ae,clearModalError:()=>{C.value=""},onPageChange:g=>{Y.value=g,de()},handleFiltersUpdate:g=>{Object.assign(ne,g),Y.value=1,de()}}}const ca={class:"inventory-management"},da={class:"d-flex justify-space-between align-center mb-6"},ma={class:"d-flex gap-3 align-center"},pa={class:"d-flex align-center justify-space-between"},_a={class:"text-h4 font-weight-bold text-primary"},va={class:"d-flex align-center justify-space-between"},ka={class:"text-h4 font-weight-bold text-warning"},fa={class:"d-flex align-center justify-space-between"},ga={class:"text-h4 font-weight-bold text-error"},ya={class:"d-flex align-center justify-space-between"},ba={class:"text-h4 font-weight-bold text-success"},ha={class:"d-flex align-center justify-space-between"},xa={class:"d-flex align-center gap-3"},wa={class:"d-flex gap-2"},Sa={class:"d-flex flex-wrap gap-2"},Va={class:"d-flex align-center gap-2"},Ta={class:"text-caption"},Ma={class:"text-subtitle-2 text-medium-emphasis mb-3 d-flex align-center gap-2"},Ca={class:"table-container"},Da={class:"d-flex align-center"},Ea={class:"font-weight-medium"},Ua={class:"d-flex flex-column"},Aa={class:"text-primary font-weight-medium"},Ia={class:"text-medium-emphasis"},Pa={class:"text-center"},$a={class:"text-h6 font-weight-bold"},ja={key:0,class:"text-warning"},Ra={class:"text-center"},La={class:"d-flex flex-column gap-1"},za={key:2,class:"text-caption text-medium-emphasis"},Fa={class:"text-center"},Na={class:"text-end"},Ba={class:"text-end font-weight-medium text-success"},qa={class:"d-flex align-center gap-1"},Ka={class:"text-center py-12"},Oa={class:"text-h5 text-medium-emphasis mb-2"},Ha={class:"text-body-1 text-medium-emphasis mb-4"},Ga={key:0},Ya={key:0},Xa={key:1},Ja={key:2},Wa={key:1},Qa={class:"d-flex justify-center gap-3"},Za={class:"text-center py-8"},eo={class:"d-flex align-center gap-2"},to={class:"d-flex align-center gap-3"},ao={class:"font-weight-bold"},oo={class:"text-caption"},so={class:"text-caption"},lo={class:"d-flex gap-3 justify-end"},no={class:"d-flex align-center gap-2"},ro={class:"text-white"},io={class:"d-flex align-center gap-3"},uo={class:"font-weight-bold"},co={class:"text-caption"},mo={class:"d-flex align-center gap-2"},po={key:0,class:"text-center py-8"},_o={key:1},vo={class:"text-body-2"},ko={class:"d-flex align-center gap-2"},fo={class:"text-body-2 font-weight-medium"},go={class:"text-caption text-medium-emphasis"},yo={class:"text-end font-weight-medium text-success"},bo={class:"text-center py-8"},ho={key:0,class:"d-flex justify-center mt-4"},xo={class:"mb-4"},wo={class:"d-flex flex-column gap-2"},So={class:"mb-4"},Vo={class:"d-flex flex-column gap-2"},To=Ct({__name:"inventory-management",setup(ue){const{xs:d}=jt(),p=()=>{me(),ge(),re()},{inventoryList:v,loading:M,saveLoading:W,stats:Y,lowStockItems:F,stockUpdateDialog:te,reorderDialog:ne,movementsDialog:Q,selectedInventory:Z,currentPage:j,totalItems:b,itemsPerPage:x,filters:l,errorMessage:C,successMessage:T,modalErrorMessage:ce,stockUpdateForm:N,reorderForm:K,totalStockValue:he,lowStockCount:xe,outOfStockCount:de,stockStatusOptions:De,fetchInventoryList:me,fetchStats:ge,fetchLowStockAlerts:re,updateStock:Ee,setReorderLevel:Ue,openStockUpdateDialog:Ae,openReorderDialog:Fe,openMovementsDialog:Ne,closeStockUpdateDialog:Be,closeReorderDialog:g,clearModalError:O,onPageChange:E,onItemsPerPageChange:qe,handleFiltersUpdate:ie,formatCurrency:Te,getStockStatusColor:We,getStockStatusText:Pe}=ia(),{recordStockMovement:$e,openAdjustmentDialog:Qe,movementDialog:je,adjustmentDialog:Ie,selectedItem:ae,movementFormData:B,saveLoading:Ze,closeMovementDialog:Re,successMessage:Ke,modalErrorMessage:et,clearModalError:ct}=ua(p),dt=c=>c.item?{id_item:c.item.id_item,item_code:c.item.item_code,name:c.item.name,description:c.item.description||"",unit:c.item.unit,cost_per_unit:parseFloat(c.item.cost_per_unit),current_stock:c.current_stock,minimum_stock:c.reorder_level||0,active:!0,storage_location:c.item.storage_location||"",expiry_date:c.item.expiry_date||null,properties:c.item.properties||null,created_by:c.item.created_by||null,updated_by:c.item.updated_by||null,created_at:c.item.created_at,updated_at:c.item.updated_at,deleted_at:c.item.deleted_at||null}:null,mt=c=>{const e=dt(c);e&&Qe(e)},pt=oe(()=>Y.value);oe(()=>v.value),oe(()=>M.value);const r=()=>{const c=l.value.available_in_kitchen,e=l.value.available_in_bar,h=l.value.station_mode;return c&&e?h==="exclusive"?"Menampilkan item yang tersedia di Kitchen DAN Bar":"Menampilkan item yang tersedia di Kitchen ATAU Bar":c?h==="exclusive"?"Menampilkan item yang HANYA tersedia di Kitchen (tidak di Bar)":"Menampilkan semua item yang tersedia di Kitchen (termasuk yang juga di Bar)":e?h==="exclusive"?"Menampilkan item yang HANYA tersedia di Bar (tidak di Kitchen)":"Menampilkan semua item yang tersedia di Bar (termasuk yang juga di Kitchen)":""};Rt(()=>{me(),ge(),re()});const z=k(!1),ee=k(!1),Me=()=>{ee.value=!0},Oe=()=>{ee.value=!1},_t=()=>{var U;console.log("🔍 === AUTH STATUS CHECK ===");const c=nt("accessToken").value,e=localStorage.getItem("token"),h=localStorage.getItem("auth_token"),I=localStorage.getItem("accessToken");console.log("🍪 Cookie accessToken:",c?`Found (${c.substring(0,20)}...)`:"Not found"),console.log("💾 localStorage token:",e?`Found (${e.substring(0,20)}...)`:"Not found"),console.log("💾 localStorage auth_token:",h?`Found (${h.substring(0,20)}...)`:"Not found"),console.log("💾 localStorage accessToken:",I?`Found (${I.substring(0,20)}...)`:"Not found");try{const P=Nt();console.log("🏪 Auth Store isLoggedIn:",P.isLoggedIn),console.log("🏪 Auth Store user:",((U=P.user)==null?void 0:U.name)||"No user"),console.log("🏪 Auth Store token:",P.token?`Found (${P.token.substring(0,20)}...)`:"Not found")}catch(P){console.log("🏪 Auth Store not available:",P)}return console.log("========================="),{cookieToken:c,localToken:e,authToken:h,accessToken:I}},tt=()=>{try{const c=_t(),e=nt("accessToken").value;if(console.log("🔍 Checking cookie token:",e?"Token found in cookie":"No token in cookie"),e)return console.log("✅ Using cookie token (first 20 chars):",e.substring(0,20)+"..."),e;console.log("🔍 Checking localStorage methods...");const h=localStorage.getItem("token")||localStorage.getItem("auth_token")||localStorage.getItem("accessToken");return h?console.log("✅ Using localStorage token (first 20 chars):",h.substring(0,20)+"..."):console.log("❌ No token found in any storage"),h||null}catch(c){console.warn("❌ Error getting auth token:",c);const e=localStorage.getItem("token")||localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||null;return console.log("🔄 Fallback token result:",e?"Found fallback token":"No fallback token"),e}},At=async()=>{var c,e,h,I;try{console.log("🚀 Starting fetchAllInventoryForExport...");const U=new URLSearchParams({per_page:"999999",page:"1",search:l.value.search||"",stock_status:l.value.stock_status||"all"});l.value.available_in_kitchen&&U.append("available_in_kitchen","true"),l.value.available_in_bar&&U.append("available_in_bar","true"),(l.value.available_in_kitchen||l.value.available_in_bar)&&U.append("station_mode",l.value.station_mode||"inclusive"),console.log("📝 Request params:",U.toString());try{console.log("🔄 Attempting to fetch with useApi composable...");const{data:P}=await Kt(`/inventory?${U}`).get().json();if(P.value&&P.value.success){console.log("✅ Successfully fetched with useApi:",((c=P.value.data.data)==null?void 0:c.length)||0,"items");const f=(P.value.data.data||[]).filter((m,L,R)=>L===R.findIndex(J=>J.id_inventory===m.id_inventory));return console.log("🔍 After deduplication:",f.length,"unique items"),f}else throw console.log("❌ useApi response not successful:",P.value),new Error(((e=P.value)==null?void 0:e.message)||"useApi failed")}catch(P){console.warn("❌ useApi failed, trying manual fetch:",P);const s=tt();console.log("🔐 Token for manual fetch:",s?`Token available (${s.substring(0,20)}...)`:"No token");const f={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...s&&{Authorization:`Bearer ${s}`}};console.log("📋 Request headers:",{...f,Authorization:f.Authorization?f.Authorization.substring(0,30)+"...":"Not set"});const m=await fetch(`/api/inventory?${U}`,{method:"GET",headers:f});if(console.log("📊 Response status:",m.status,m.statusText),console.log("📋 Response headers:",Object.fromEntries(m.headers.entries())),!m.ok){const R=await m.text();console.error("❌ Manual fetch API Error Response:",R),console.error("📊 Error details - Status:",m.status,"StatusText:",m.statusText);try{const J=JSON.parse(R);console.error("📋 Parsed error JSON:",J)}catch{console.error("📋 Error response is not JSON:",R)}throw new Error(`HTTP ${m.status}: ${m.statusText}`)}const L=await m.json();if(console.log("✅ Manual fetch successful response:",{success:L.success,dataLength:((I=(h=L.data)==null?void 0:h.data)==null?void 0:I.length)||0,message:L.message}),L.success){const R=L.data.data||[],J=R.filter((we,pe,S)=>pe===S.findIndex(ye=>ye.id_inventory===we.id_inventory));return console.log("✅ Successfully fetched with manual fetch:",R.length,"items"),console.log("🔍 After deduplication:",J.length,"unique items"),J}else throw console.error("❌ Manual fetch response not successful:",L),new Error(L.message||"Failed to fetch inventory data")}}catch(U){throw console.error("💥 Fetch all inventory error:",U),new Error("Gagal mengambil data inventory lengkap: "+(U instanceof Error?U.message:"Unknown error"))}},at=k(!1),ot=k([]),st=k(!1),Le=k(1),He=k(10),lt=k(0),vt=async()=>{try{z.value=!0;const c=await At();console.log("📊 Exporting",c.length,"inventory items to Excel");const e=await Ft(()=>import("./xlsx-CfQreh1U.js"),[]),h=c.length,I=c.filter(S=>S.current_stock<=S.reorder_level).length,U=c.filter(S=>S.current_stock===0).length,P=c.reduce((S,ye)=>S+(ye.current_stock||0)*(ye.average_cost||0),0),s=c.map((S,ye)=>{var gt,yt,bt,ht,xt,wt,St;return{No:ye+1,"Produk/Variant":((gt=S.item)==null?void 0:gt.name)||((yt=S.product)==null?void 0:yt.name)||"Unknown Item",SKU:((bt=S.item)==null?void 0:bt.item_code)||((ht=S.product)==null?void 0:ht.sku)||"-",Unit:((xt=S.item)==null?void 0:xt.unit)||"pcs","Stok Saat Ini":S.current_stock||0,"Stok Tersedia":S.available_stock||0,"Stok Minimum":S.reorder_level||0,Status:Pe(S),Kitchen:(wt=S.item)!=null&&wt.available_in_kitchen?"Ya":"Tidak",Bar:(St=S.item)!=null&&St.available_in_bar?"Ya":"Tidak","Harga Rata-rata":S.average_cost||0,"Nilai Stok":(S.current_stock||0)*(S.average_cost||0),Dibuat:S.created_at?new Date(S.created_at).toLocaleDateString("id-ID"):"-",Diperbarui:S.updated_at?new Date(S.updated_at).toLocaleDateString("id-ID"):"-"}}),f=e.utils.book_new(),m=[];l.value.search&&m.push(`Pencarian: "${l.value.search}"`),l.value.stock_status&&l.value.stock_status!=="all"&&m.push(`Status: ${l.value.stock_status}`),l.value.available_in_kitchen&&m.push("Kitchen: Ya"),l.value.available_in_bar&&m.push("Bar: Ya");const L=[["LAPORAN INVENTORY MANAGEMENT"],["Tanggal Export:",new Date().toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})],["Total Items:",h],["Total Nilai Stok:",`Rp ${P.toLocaleString("id-ID")}`],["Items Low Stock:",I],["Items Out of Stock:",U],["Filter Diterapkan:",m.length>0?m.join(", "):"Semua Data"],[]],R=e.utils.aoa_to_sheet(L);e.utils.sheet_add_json(R,s,{origin:"A9"});const J=[{wch:5},{wch:35},{wch:15},{wch:8},{wch:12},{wch:12},{wch:12},{wch:15},{wch:8},{wch:8},{wch:15},{wch:15},{wch:12},{wch:12}];R["!cols"]=J,e.utils.book_append_sheet(f,R,"Inventory Report");const pe=`inventory-report-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;e.writeFile(f,pe),console.log("✅ Excel file generated successfully:",pe);try{await It(c,{total_items:h,total_stock_value:P,low_stock_count:I,out_of_stock_count:U}),T.value=`Laporan berhasil di-export ke Excel dengan ${h} item lengkap dan data berhasil diupload ke server!`}catch(S){console.error("Upload error:",S),T.value=`Laporan berhasil di-export ke Excel dengan ${h} item lengkap, tetapi gagal upload data ke server: `+(S instanceof Error?S.message:"Unknown error")}}catch(c){console.error("Export error:",c),C.value="Gagal mengexport laporan: "+(c instanceof Error?c.message:"Unknown error")}finally{z.value=!1}},It=async(c,e)=>{try{const h=c||v.value,I=e||{total_items:b.value,total_stock_value:he.value||0,low_stock_count:xe.value,out_of_stock_count:de.value},U={inventory_data:h.map(m=>{var L,R,J,we,pe,S,ye;return{id_inventory:m.id_inventory,id_product:m.id_product,id_item:m.id_item,current_stock:m.current_stock||0,available_stock:m.available_stock||0,reserved_stock:m.reserved_stock||0,reorder_level:m.reorder_level||0,max_stock_level:m.max_stock_level||null,average_cost:m.average_cost||0,product_name:((L=m.product)==null?void 0:L.name)||((R=m.item)==null?void 0:R.name)||"Unknown",product_sku:((J=m.product)==null?void 0:J.sku)||((we=m.item)==null?void 0:we.item_code)||null,unit:((pe=m.item)==null?void 0:pe.unit)||"pcs",category:((ye=(S=m.product)==null?void 0:S.category)==null?void 0:ye.name)||null,status:Pe(m),stock_value:(m.current_stock||0)*(m.average_cost||0),created_at:m.created_at,updated_at:m.updated_at}}),summary:{total_items:I.total_items,total_stock_value:I.total_stock_value,low_stock_count:I.low_stock_count,out_of_stock_count:I.out_of_stock_count,export_timestamp:new Date().toISOString(),filters_applied:{search:l.value.search||null,stock_status:l.value.stock_status!=="all"?l.value.stock_status:null}}},P=tt(),s=await fetch("/api/inventory/upload-data",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...P&&{Authorization:`Bearer ${P}`}},body:JSON.stringify(U)});if(!s.ok){const m=await s.json();throw new Error(m.message||`HTTP ${s.status}: ${s.statusText}`)}const f=await s.json();return console.log("Upload result:",f),f}catch(h){throw console.error("Upload inventory data error:",h),h}},kt=async()=>{var c;try{st.value=!0;const e=tt(),h=await fetch(`/api/inventory/upload-history?page=${Le.value}&per_page=${He.value}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...e&&{Authorization:`Bearer ${e}`}}});if(!h.ok)throw new Error(`HTTP ${h.status}: ${h.statusText}`);const I=await h.json();if(I.success)ot.value=I.data||[],lt.value=((c=I.pagination)==null?void 0:c.total)||0;else throw new Error(I.message||"Failed to fetch upload history")}catch(e){console.error("Fetch upload history error:",e),C.value="Gagal mengambil riwayat upload: "+(e instanceof Error?e.message:"Unknown error")}finally{st.value=!1}},Pt=c=>{Le.value=c,kt()},ft=()=>{at.value=!1,ot.value=[],Le.value=1},$t=async()=>{try{console.log("🚀 Testing login to get fresh token...");const c=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({login:"admin",password:"password123"})});console.log("📊 Login Response Status:",c.status,c.statusText);const e=await c.json();if(console.log("📋 Login Response Data:",e),e.success&&e.data.token){const h=e.data.token;console.log("✅ Login successful! Token:",h.substring(0,30)+"..."),localStorage.setItem("token",h),console.log("💾 Token saved to localStorage");const I=nt("accessToken",{default:()=>"",secure:!0,sameSite:"strict",maxAge:3600*24*7});I.value=h,console.log("🍪 Token saved to cookie"),T.value="Login berhasil! Token telah diperbarui. Silakan coba export lagi.",console.log("🌐 Testing API call with new token...");const U=await fetch("/api/inventory?per_page=1",{headers:{Authorization:"Bearer "+h,Accept:"application/json"}});console.log("📊 Test API Response Status:",U.status,U.statusText),U.ok?console.log("✅ New token works! You can now try the export function."):(console.log("❌ New token still doesn't work"),C.value="Token baru tidak bekerja. Mungkin ada masalah dengan server.")}else console.log("❌ Login failed:",e.message),C.value="Login gagal: "+(e.message||"Unknown error")}catch(c){console.log("💥 Login error:",c),C.value="Error saat login: "+(c instanceof Error?c.message:"Unknown error")}};return Dt(b,(c,e)=>{},{immediate:!0}),(c,e)=>{var h,I,U,P;return _(),X("div",ca,[n("div",da,[e[46]||(e[46]=n("div",null,[n("h1",{class:"text-h4 font-weight-bold inventory-title"}," Kelola Inventory "),n("p",{class:"text-body-1 text-medium-emphasis inventory-subtitle"}," Kelola stok barang dan pergerakan inventory ")],-1)),n("div",ma,[t(V,{color:"info","prepend-icon":"tabler-bug",variant:"outlined",size:"small",onClick:_t},{default:o(()=>e[43]||(e[43]=[i(" Check Auth ")])),_:1,__:[43]}),t(V,{color:"warning","prepend-icon":"tabler-login",variant:"outlined",size:"small",onClick:$t},{default:o(()=>e[44]||(e[44]=[i(" Test Login ")])),_:1,__:[44]}),t(V,{color:"primary","prepend-icon":"tabler-refresh",variant:"outlined",onClick:p},{default:o(()=>e[45]||(e[45]=[i(" Refresh Data ")])),_:1,__:[45]})])]),a(C)?(_(),w(se,{key:0,type:"error",variant:"outlined",class:"mb-4",text:a(C),closable:"","onClick:close":e[0]||(e[0]=s=>C.value="")},null,8,["text"])):y("",!0),a(T)?(_(),w(se,{key:1,type:"success",variant:"outlined",class:"mb-4",text:a(T),closable:"","onClick:close":e[1]||(e[1]=s=>T.value="")},null,8,["text"])):y("",!0),a(Ke)?(_(),w(se,{key:2,type:"success",variant:"outlined",class:"mb-4",text:a(Ke),closable:"","onClick:close":e[2]||(e[2]=s=>Ke.value="")},null,8,["text"])):y("",!0),t(_e,{class:"mb-6"},{default:o(()=>[t($,{cols:"12",md:"3"},{default:o(()=>[t(q,{class:"stats-card"},{default:o(()=>[t(H,null,{default:o(()=>[n("div",pa,[n("div",null,[n("div",_a,u(pt.value.total_items||0),1),e[47]||(e[47]=n("div",{class:"text-caption text-medium-emphasis"}," Total Produk ",-1))]),t(A,{icon:"tabler-package",size:"48",class:"text-primary opacity-50"})])]),_:1})]),_:1})]),_:1}),t($,{cols:"12",md:"3"},{default:o(()=>[t(q,{class:"stats-card"},{default:o(()=>[t(H,null,{default:o(()=>[n("div",va,[n("div",null,[n("div",ka,u(a(xe)||0),1),e[48]||(e[48]=n("div",{class:"text-caption text-medium-emphasis"}," Stok Menipis ",-1))]),t(A,{icon:"tabler-alert-triangle",size:"48",class:"text-warning opacity-50"})])]),_:1})]),_:1})]),_:1}),t($,{cols:"12",md:"3"},{default:o(()=>[t(q,{class:"stats-card"},{default:o(()=>[t(H,null,{default:o(()=>[n("div",fa,[n("div",null,[n("div",ga,u(a(de)||0),1),e[49]||(e[49]=n("div",{class:"text-caption text-medium-emphasis"}," Stok Habis ",-1))]),t(A,{icon:"tabler-x-circle",size:"48",class:"text-error opacity-50"})])]),_:1})]),_:1})]),_:1}),t($,{cols:"12",md:"3"},{default:o(()=>[t(q,{class:"stats-card"},{default:o(()=>[t(H,null,{default:o(()=>[n("div",ya,[n("div",null,[n("div",ba,u(a(Te)(a(he)||0)),1),e[50]||(e[50]=n("div",{class:"text-caption text-medium-emphasis"}," Nilai Stok ",-1))]),t(A,{icon:"tabler-currency-dollar",size:"48",class:"text-success opacity-50"})])]),_:1})]),_:1})]),_:1})]),_:1}),t(q,{class:"mb-6 info-card",color:"info",variant:"tonal"},{default:o(()=>[t(H,null,{default:o(()=>[n("div",ha,[n("div",xa,[t(A,{icon:"tabler-info-circle",size:"32",class:"text-info"}),e[51]||(e[51]=n("div",null,[n("div",{class:"text-subtitle-1 font-weight-medium text-info"}," Sistem Stock Movement Otomatis "),n("div",{class:"text-body-2 text-medium-emphasis"},[i(" Stok akan bertambah otomatis saat purchasing dan berkurang saat penjualan POS. Gunakan tombol "),n("strong",null,"Penyesuaian"),i(" untuk koreksi manual jika diperlukan. ")])],-1))]),n("div",wa,[t(D,{color:"success",variant:"tonal",size:"small"},{default:o(()=>[t(A,{icon:"tabler-shopping-cart",class:"me-1"}),e[52]||(e[52]=i(" Purchase → Stok + "))]),_:1,__:[52]}),t(D,{color:"error",variant:"tonal",size:"small"},{default:o(()=>[t(A,{icon:"tabler-cash",class:"me-1"}),e[53]||(e[53]=i(" POS Sale → Stok - "))]),_:1,__:[53]})])])]),_:1})]),_:1}),a(F).length>0?(_(),w(q,{key:3,class:"mb-6 low-stock-alert"},{default:o(()=>[t(fe,{class:"d-flex align-center"},{default:o(()=>[t(A,{icon:"tabler-alert-triangle",class:"text-warning me-2"}),i(" Peringatan Stok Menipis ("+u(a(F).length)+" produk) ",1)]),_:1}),t(H,null,{default:o(()=>[n("div",Sa,[(_(!0),X(Lt,null,zt(a(F).slice(0,10),s=>(_(),w(D,{key:s.id_inventory,color:"warning",variant:"outlined",size:"small"},{default:o(()=>{var f;return[i(u((f=s.product)==null?void 0:f.name)+" ("+u(s.current_stock)+"/"+u(s.reorder_level)+") ",1)]}),_:2},1024))),128)),a(F).length>10?(_(),w(D,{key:0,color:"warning",variant:"tonal",size:"small"},{default:o(()=>[i(" +"+u(a(F).length-10)+" lainnya ",1)]),_:1})):y("",!0)])]),_:1})]),_:1})):y("",!0),!a(M)&&a(v).length===0&&!a(C)&&!a(l).search&&a(l).stock_status==="all"?(_(),w(q,{key:4,class:"mb-6"},{default:o(()=>[t(H,{class:"text-center py-6"},{default:o(()=>[t(A,{icon:"tabler-info-circle",size:"48",class:"text-info mb-3"}),e[54]||(e[54]=n("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),e[55]||(e[55]=n("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[54,55]})]),_:1})):y("",!0),t(q,{class:"mb-6"},{default:o(()=>[t(H,null,{default:o(()=>[a(l).available_in_kitchen||a(l).available_in_bar?(_(),w(se,{key:0,type:"info",variant:"tonal",class:"mb-4",density:"compact"},{text:o(()=>[n("div",Va,[t(A,{icon:"tabler-info-circle",size:"16"}),n("span",Ta,[n("strong",null,u(a(l).station_mode==="exclusive"?"Mode Eksklusif":"Mode Inclusive")+":",1),i(" "+u(r()),1)])])]),_:1})):y("",!0),t(_e,null,{default:o(()=>[t($,{cols:"12",md:"3"},{default:o(()=>[t(ve,{modelValue:a(l).search,"onUpdate:modelValue":[e[3]||(e[3]=s=>a(l).search=s),e[4]||(e[4]=s=>a(ie)({search:s}))],label:"Cari inventory produk...",placeholder:"Nama produk, SKU, atau variant","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),t($,{cols:"12",md:"3"},{default:o(()=>[t(rt,{modelValue:a(l).stock_status,"onUpdate:modelValue":[e[5]||(e[5]=s=>a(l).stock_status=s),e[6]||(e[6]=s=>a(ie)({stock_status:s||"all"}))],items:a(De),label:"Status Stok",variant:"outlined",clearable:""},null,8,["modelValue","items"])]),_:1}),t($,{cols:"12"},{default:o(()=>[t(G,{class:"my-2"}),n("div",Ma,[t(A,{icon:"tabler-home",size:"16"}),e[56]||(e[56]=i(" Filter Station Ketersediaan "))]),t(_e,null,{default:o(()=>[t($,{cols:"12",md:"2",class:"d-flex align-center"},{default:o(()=>[t(Tt,{modelValue:a(l).available_in_kitchen,"onUpdate:modelValue":[e[7]||(e[7]=s=>a(l).available_in_kitchen=s),e[8]||(e[8]=s=>a(ie)({available_in_kitchen:s}))],label:"Kitchen",color:"warning","hide-details":""},null,8,["modelValue"])]),_:1}),t($,{cols:"12",md:"2",class:"d-flex align-center"},{default:o(()=>[t(Tt,{modelValue:a(l).available_in_bar,"onUpdate:modelValue":[e[9]||(e[9]=s=>a(l).available_in_bar=s),e[10]||(e[10]=s=>a(ie)({available_in_bar:s}))],label:"Bar",color:"info","hide-details":""},null,8,["modelValue"])]),_:1}),a(l).available_in_kitchen||a(l).available_in_bar?(_(),w($,{key:0,cols:"12",md:"3"},{default:o(()=>[t(rt,{modelValue:a(l).station_mode,"onUpdate:modelValue":[e[11]||(e[11]=s=>a(l).station_mode=s),e[12]||(e[12]=s=>a(ie)({station_mode:s}))],items:[{title:"Semua yang tersedia (Inclusive)",value:"inclusive"},{title:"Hanya eksklusif (Exclusive)",value:"exclusive"}],label:"Mode Filter",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})):y("",!0),a(l).available_in_kitchen||a(l).available_in_bar?(_(),w($,{key:1,cols:"12",md:"5",class:"d-flex align-center gap-2"},{default:o(()=>[t(V,{variant:"outlined","prepend-icon":"tabler-refresh",size:"small",onClick:e[13]||(e[13]=s=>{a(me)(),a(ge)(),a(re)()})},{default:o(()=>e[57]||(e[57]=[i(" Refresh ")])),_:1,__:[57]}),t(V,{variant:"outlined",color:"warning","prepend-icon":"tabler-filter-off",size:"small",onClick:e[14]||(e[14]=s=>a(ie)({search:"",stock_status:"all",available_in_kitchen:!1,available_in_bar:!1,station_mode:"inclusive"}))},{default:o(()=>e[58]||(e[58]=[i(" Clear ")])),_:1,__:[58]})]),_:1})):y("",!0)]),_:1})]),_:1}),!a(l).available_in_kitchen&&!a(l).available_in_bar?(_(),w($,{key:0,cols:"12",md:"6",class:"d-flex align-center gap-2"},{default:o(()=>[t(V,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:e[15]||(e[15]=s=>{a(me)(),a(ge)(),a(re)()})},{default:o(()=>e[59]||(e[59]=[i(" Refresh ")])),_:1,__:[59]}),a(l).search||a(l).stock_status!=="all"?(_(),w(V,{key:0,variant:"outlined",color:"warning","prepend-icon":"tabler-filter-off",onClick:e[16]||(e[16]=s=>a(ie)({search:"",stock_status:"all",available_in_kitchen:!1,available_in_bar:!1,station_mode:"inclusive"}))},{default:o(()=>e[60]||(e[60]=[i(" Clear ")])),_:1,__:[60]})):y("",!0)]),_:1})):y("",!0)]),_:1})]),_:1})]),_:1}),!a(M)&&a(v).length===0&&!a(C)&&!a(l).search&&a(l).stock_status==="all"?(_(),w(q,{key:5,class:"mb-6"},{default:o(()=>[t(H,{class:"text-center py-6"},{default:o(()=>[t(A,{icon:"tabler-package-off",size:"48",class:"text-disabled mb-3"}),e[61]||(e[61]=n("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),e[62]||(e[62]=n("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[61,62]})]),_:1})):y("",!0),t(q,{class:"products-inventory-table"},{default:o(()=>[t(fe,{class:"d-flex align-center gap-2 coffee-header"},{default:o(()=>[t(A,{icon:"tabler-package",class:"text-white"}),e[64]||(e[64]=n("span",{class:"text-white"},"Inventory Produk",-1)),t(Ve),t(V,{color:"success",variant:"elevated","prepend-icon":"tabler-file-spreadsheet",loading:z.value,onClick:Me},{default:o(()=>e[63]||(e[63]=[i(" Export Excel ")])),_:1,__:[63]},8,["loading"]),t(D,{color:"black",size:"small",variant:"tonal"},{default:o(()=>[i(u(a(b))+" Produk ",1)]),_:1})]),_:1,__:[64]}),t(G),n("div",Ca,[t(Ot,{headers:[{title:"Produk/Variant",key:"item_name",sortable:!1,width:"280px"},{title:"Stok Saat Ini",key:"current_stock",sortable:!1,width:"120px"},{title:"Stok Tersedia",key:"available_stock",sortable:!1,width:"120px"},{title:"Status",key:"status",sortable:!1,width:"120px"},{title:"Station",key:"station_availability",sortable:!1,width:"150px"},{title:"Reorder Level",key:"reorder_level",sortable:!1,width:"120px"},{title:"Harga Rata-rata",key:"average_cost",sortable:!1,width:"150px"},{title:"Nilai Stok",key:"stock_value",sortable:!1,width:"150px"},{title:"Aksi",key:"actions",sortable:!1,width:"200px",fixed:!0}],items:a(v),loading:a(M),"items-length":a(b),"items-per-page":a(x),page:a(j),"items-per-page-options":[10,15,25,50,100],"items-per-page-text":"Items per page:","page-text":"{0}-{1} of {2}","no-data-text":"Tidak ada data inventory",class:"text-no-wrap fixed-actions-table",id:"inventory-table","fixed-header":"",height:"500px","onUpdate:page":a(E),"onUpdate:itemsPerPage":a(qe)},{"item.item_name":o(({item:s})=>{var f,m,L,R,J,we,pe;return[n("div",Da,[n("div",null,[n("div",Ea,u(((f=s.item)==null?void 0:f.name)||((m=s.product)==null?void 0:m.name)||"Unknown Item"),1),n("div",Ua,[n("small",Aa," SKU: "+u(((L=s.item)==null?void 0:L.item_code)||((R=s.product)==null?void 0:R.sku)||"-"),1),n("small",Ia,u(((J=s.item)==null?void 0:J.description)||((pe=(we=s.product)==null?void 0:we.category)==null?void 0:pe.name)||"-"),1)])])])]}),"item.sku":o(({item:s})=>[t(D,{variant:"outlined",size:"small",color:"primary"},{default:o(()=>{var f,m;return[i(u(((f=s.item)==null?void 0:f.item_code)||((m=s.product)==null?void 0:m.sku)||"N/A"),1)]}),_:2},1024)]),"item.current_stock":o(({item:s})=>[n("div",Pa,[n("div",$a,u(s.current_stock),1),s.reserved_stock>0?(_(),X("small",ja," ("+u(s.reserved_stock)+" reserved) ",1)):y("",!0)])]),"item.available_stock":o(({item:s})=>[n("div",Ra,[t(D,{color:s.available_stock>0?"success":"error",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.available_stock),1)]),_:2},1032,["color"])])]),"item.status":o(({item:s})=>[t(D,{color:a(We)(s),variant:"tonal",size:"small"},{default:o(()=>[i(u(a(Pe)(s)),1)]),_:2},1032,["color"])]),"item.station_availability":o(({item:s})=>{var f,m,L,R;return[n("div",La,[(f=s.item)!=null&&f.available_in_kitchen?(_(),w(D,{key:0,color:"warning",variant:"tonal",size:"x-small","prepend-icon":"tabler-chef-hat"},{default:o(()=>e[65]||(e[65]=[i(" Kitchen ")])),_:1,__:[65]})):y("",!0),(m=s.item)!=null&&m.available_in_bar?(_(),w(D,{key:1,color:"info",variant:"tonal",size:"x-small","prepend-icon":"tabler-glass-cocktail"},{default:o(()=>e[66]||(e[66]=[i(" Bar ")])),_:1,__:[66]})):y("",!0),!((L=s.item)!=null&&L.available_in_kitchen)&&!((R=s.item)!=null&&R.available_in_bar)?(_(),X("span",za," Tidak tersedia ")):y("",!0)])]}),"item.reorder_level":o(({item:s})=>[n("div",Fa,u(s.reorder_level||"-"),1)]),"item.average_cost":o(({item:s})=>[n("div",Na,u(a(Te)(s.average_cost)),1)]),"item.stock_value":o(({item:s})=>[n("div",Ba,u(a(Te)(s.current_stock*s.average_cost)),1)]),"item.actions":o(({item:s})=>[n("div",qa,[t(Xe,{text:"Penyesuaian Stok"},{activator:o(({props:f})=>[t(V,Ge(f,{icon:"tabler-adjustments",color:"warning",variant:"text",size:"small",disabled:!s.item,onClick:m=>mt(s)}),null,16,["disabled","onClick"])]),_:2},1024),t(Xe,{text:"Update Stok"},{activator:o(({props:f})=>[t(V,Ge(f,{icon:"tabler-edit",color:"primary",variant:"text",size:"small",onClick:m=>a(Ae)(s)}),null,16,["onClick"])]),_:2},1024),t(Xe,{text:"Set Reorder Level"},{activator:o(({props:f})=>[t(V,Ge(f,{icon:"tabler-settings",color:"info",variant:"text",size:"small",onClick:m=>a(Fe)(s)}),null,16,["onClick"])]),_:2},1024),t(Xe,{text:"Lihat Riwayat"},{activator:o(({props:f})=>[t(V,Ge(f,{icon:"tabler-history",color:"secondary",variant:"text",size:"small",onClick:m=>a(Ne)(s)}),null,16,["onClick"])]),_:2},1024)])]),"no-data":o(()=>{var s;return[n("div",Ka,[t(A,{icon:a(l).search||a(l).stock_status!=="all"?"tabler-search-off":"tabler-package-off",size:"64",class:"text-medium-emphasis mb-4"},null,8,["icon"]),n("div",Oa,u(a(l).search||a(l).stock_status!=="all"?"Tidak Ada Hasil Pencarian":"Belum Ada Data Inventory"),1),n("div",Ha,[a(l).search||a(l).stock_status!=="all"?(_(),X("span",Ga,[a(l).search?(_(),X("span",Ya,[e[67]||(e[67]=i(' Tidak ditemukan inventory dengan kata kunci "')),n("strong",null,u(a(l).search),1),e[68]||(e[68]=i('" '))])):y("",!0),a(l).search&&a(l).stock_status!=="all"?(_(),X("span",Xa," dan ")):y("",!0),a(l).stock_status!=="all"?(_(),X("span",Ja,[e[69]||(e[69]=i(' status stok "')),n("strong",null,u(((s=a(De).find(f=>f.value===a(l).stock_status))==null?void 0:s.title)||a(l).stock_status),1),e[70]||(e[70]=i('" '))])):y("",!0),e[71]||(e[71]=n("br",null,null,-1)),e[72]||(e[72]=i("Coba kata kunci yang berbeda atau hapus filter. "))])):(_(),X("span",Wa,e[73]||(e[73]=[i(" Data inventory akan muncul setelah produk dan variant dibuat."),n("br",null,null,-1),i(" Silakan buat produk terlebih dahulu di menu "),n("strong",null,"Kelola Produk",-1),i(". ")])))]),n("div",Qa,[a(l).search||a(l).stock_status!=="all"?(_(),w(V,{key:0,color:"warning",variant:"outlined","prepend-icon":"tabler-filter-off",onClick:e[17]||(e[17]=f=>a(ie)({search:"",stock_status:"all"}))},{default:o(()=>e[74]||(e[74]=[i(" Hapus Filter ")])),_:1,__:[74]})):(_(),w(V,{key:1,color:"primary","prepend-icon":"tabler-plus",to:"/products-management"},{default:o(()=>e[75]||(e[75]=[i(" Buat Produk Baru ")])),_:1,__:[75]})),t(V,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:e[18]||(e[18]=f=>{a(me)(),a(ge)(),a(re)()})},{default:o(()=>e[76]||(e[76]=[i(" Refresh Data ")])),_:1,__:[76]})])])]}),loading:o(()=>[n("div",Za,[t(ut,{indeterminate:"",color:"primary",size:"40"}),e[77]||(e[77]=n("div",{class:"mt-4 text-medium-emphasis"}," Memuat data inventory... ",-1))])]),_:1},8,["items","loading","items-length","items-per-page","page","onUpdate:page","onUpdate:itemsPerPage"])])]),_:1}),t(Se,{modelValue:a(te),"onUpdate:modelValue":e[25]||(e[25]=s=>ze(te)?te.value=s:null),"max-width":"800px",fullscreen:a(d),persistent:"",class:"stock-dialog"},{default:o(()=>[t(q,null,{default:o(()=>[t(fe,null,{default:o(()=>{var s,f;return[i(" Update Stok - "+u((f=(s=a(Z))==null?void 0:s.product)==null?void 0:f.name),1)]}),_:1}),t(G),t(Je,{onSubmit:Ye(a(Ee),["prevent"])},{default:o(()=>[t(H,null,{default:o(()=>[a(ce)?(_(),w(se,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":a(O)},{default:o(()=>[i(u(a(ce)),1)]),_:1},8,["onClick:close"])):y("",!0),t(_e,null,{default:o(()=>[t($,{cols:"12",md:"6"},{default:o(()=>[t(rt,{modelValue:a(N).movement_type,"onUpdate:modelValue":e[19]||(e[19]=s=>a(N).movement_type=s),label:"Jenis Pergerakan *",items:[{title:"Stock Masuk",value:"stock_in"},{title:"Stock Keluar",value:"stock_out"},{title:"Penyesuaian",value:"adjustment"},{title:"Transfer",value:"transfer"},{title:"Retur",value:"return"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),t($,{cols:"12",md:"6"},{default:o(()=>[t(ve,{modelValue:a(N).quantity,"onUpdate:modelValue":e[20]||(e[20]=s=>a(N).quantity=s),modelModifiers:{number:!0},label:"Kuantitas *",type:"number",min:"1",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(_e,null,{default:o(()=>[t($,{cols:"12"},{default:o(()=>[t(ve,{modelValue:a(N).reason,"onUpdate:modelValue":e[21]||(e[21]=s=>a(N).reason=s),label:"Alasan *",placeholder:"Contoh: Pembelian dari supplier, Penjualan, dll",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(_e,null,{default:o(()=>[t($,{cols:"12",md:"6"},{default:o(()=>[t(ve,{modelValue:a(N).reference_number,"onUpdate:modelValue":e[22]||(e[22]=s=>a(N).reference_number=s),label:"Nomor Referensi",placeholder:"PO-001, SO-001, dll",variant:"outlined"},null,8,["modelValue"])]),_:1}),t($,{cols:"12",md:"6"},{default:o(()=>[t(ve,{modelValue:a(N).cost_per_unit,"onUpdate:modelValue":e[23]||(e[23]=s=>a(N).cost_per_unit=s),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",min:"0",step:"0.01",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(_e,null,{default:o(()=>[t($,{cols:"12"},{default:o(()=>[t(it,{modelValue:a(N).notes,"onUpdate:modelValue":e[24]||(e[24]=s=>a(N).notes=s),label:"Catatan",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(G),t(Ce,{class:"pa-4"},{default:o(()=>[t(Ve),t(V,{variant:"outlined",onClick:a(Be)},{default:o(()=>e[78]||(e[78]=[i(" Batal ")])),_:1,__:[78]},8,["onClick"]),t(V,{type:"submit",color:"primary",loading:a(W)},{default:o(()=>e[79]||(e[79]=[i(" Update Stok ")])),_:1,__:[79]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:a(ne),"onUpdate:modelValue":e[28]||(e[28]=s=>ze(ne)?ne.value=s:null),"max-width":"600px",fullscreen:a(d),persistent:"",class:"stock-dialog"},{default:o(()=>[t(q,null,{default:o(()=>[t(fe,null,{default:o(()=>{var s,f;return[i(" Set Reorder Level - "+u((f=(s=a(Z))==null?void 0:s.product)==null?void 0:f.name),1)]}),_:1}),t(G),t(Je,{onSubmit:Ye(a(Ue),["prevent"])},{default:o(()=>[t(H,null,{default:o(()=>[a(ce)?(_(),w(se,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":a(O)},{default:o(()=>[i(u(a(ce)),1)]),_:1},8,["onClick:close"])):y("",!0),t(_e,null,{default:o(()=>[t($,{cols:"12"},{default:o(()=>[t(ve,{modelValue:a(K).reorder_level,"onUpdate:modelValue":e[26]||(e[26]=s=>a(K).reorder_level=s),modelModifiers:{number:!0},label:"Reorder Level *",type:"number",min:"0",hint:"Stok minimum sebelum perlu restock","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(_e,null,{default:o(()=>[t($,{cols:"12"},{default:o(()=>[t(ve,{modelValue:a(K).max_stock_level,"onUpdate:modelValue":e[27]||(e[27]=s=>a(K).max_stock_level=s),modelModifiers:{number:!0},label:"Max Stock Level",type:"number",min:"0",hint:"Stok maksimum yang diizinkan","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(G),t(Ce,{class:"pa-4"},{default:o(()=>[t(Ve),t(V,{variant:"outlined",onClick:a(g)},{default:o(()=>e[80]||(e[80]=[i(" Batal ")])),_:1,__:[80]},8,["onClick"]),t(V,{type:"submit",color:"primary",loading:a(W)},{default:o(()=>e[81]||(e[81]=[i(" Simpan ")])),_:1,__:[81]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(ra,{modelValue:a(Q),"onUpdate:modelValue":e[29]||(e[29]=s=>ze(Q)?Q.value=s:null),"inventory-id":(I=(h=a(Z))==null?void 0:h.id_inventory)==null?void 0:I.toString(),"inventory-name":(P=(U=a(Z))==null?void 0:U.item)==null?void 0:P.name},null,8,["modelValue","inventory-id","inventory-name"]),t(Se,{modelValue:a(Ie),"onUpdate:modelValue":e[32]||(e[32]=s=>ze(Ie)?Ie.value=s:null),"max-width":"600px",fullscreen:a(d),persistent:"",class:"stock-dialog"},{default:o(()=>[t(q,{class:"stock-movement-dialog coffee-dialog"},{default:o(()=>[t(fe,{class:"d-flex align-center justify-space-between coffee-header"},{default:o(()=>[n("div",eo,[t(A,{icon:"tabler-adjustments",class:"text-white"}),e[82]||(e[82]=n("span",{class:"text-white"}," Penyesuaian Stok ",-1))]),t(V,{icon:"tabler-x",variant:"text",color:"white",onClick:a(Re)},null,8,["onClick"])]),_:1}),t(G),t(H,{class:"pa-6"},{default:o(()=>[t(Je,{onSubmit:Ye(a($e),["prevent"])},{default:o(()=>{var s;return[a(ae)?(_(),w(se,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:o(()=>[n("div",to,[t(A,{icon:"tabler-package"}),n("div",null,[n("div",ao,u(a(ae).name),1),n("div",oo,u(a(ae).item_code),1),n("div",so,"Stok Saat Ini: "+u(a(ae).current_stock)+" "+u(a(ae).unit),1)])])]),_:1})):y("",!0),a(et)?(_(),w(se,{key:1,type:"error",variant:"outlined",class:"mb-4",text:a(et),closable:"","onClick:close":a(ct)},null,8,["text","onClick:close"])):y("",!0),t(ve,{modelValue:a(B).quantity,"onUpdate:modelValue":e[30]||(e[30]=f=>a(B).quantity=f),modelModifiers:{number:!0},label:"Stok Baru",type:"number",min:"0",step:"0.001",variant:"outlined",suffix:(s=a(ae))==null?void 0:s.unit,class:"mb-4",required:""},null,8,["modelValue","suffix"]),t(it,{modelValue:a(B).notes,"onUpdate:modelValue":e[31]||(e[31]=f=>a(B).notes=f),label:"Catatan (opsional)",variant:"outlined",rows:"3",class:"mb-4"},null,8,["modelValue"]),n("div",lo,[t(V,{variant:"outlined",onClick:a(Re)},{default:o(()=>e[83]||(e[83]=[i(" Batal ")])),_:1,__:[83]},8,["onClick"]),t(V,{type:"submit",color:"primary",class:"coffee-primary",loading:a(Ze)},{default:o(()=>e[84]||(e[84]=[i(" Simpan Penyesuaian ")])),_:1,__:[84]},8,["loading"])])]}),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:a(je),"onUpdate:modelValue":e[36]||(e[36]=s=>ze(je)?je.value=s:null),"max-width":"800px",fullscreen:a(d),persistent:"",class:"stock-dialog"},{default:o(()=>[t(q,{class:"stock-movement-dialog coffee-dialog"},{default:o(()=>[t(fe,{class:"d-flex align-center justify-space-between coffee-header"},{default:o(()=>[n("div",no,[t(A,{icon:a(B).type==="in"?"tabler-plus":"tabler-minus",class:"text-white"},null,8,["icon"]),n("span",ro,u(a(B).type==="in"?"Stok Masuk":a(B).type==="out"?"Stok Keluar":"Penyesuaian Stok"),1)]),t(V,{icon:"tabler-x",variant:"text",color:"white",onClick:a(Re)},null,8,["onClick"])]),_:1}),t(G),t(H,{class:"pa-6"},{default:o(()=>[t(Je,{onSubmit:Ye(a($e),["prevent"])},{default:o(()=>[a(ae)?(_(),w(se,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:o(()=>[n("div",io,[t(Mt,{color:"primary",size:"40",variant:"tonal"},{default:o(()=>[t(A,{icon:"tabler-package"})]),_:1}),n("div",null,[n("div",uo,u(a(ae).name),1),n("div",co," Stok saat ini: "+u(a(ae).current_stock)+" "+u(a(ae).unit),1)])])]),_:1})):y("",!0),t(_e,null,{default:o(()=>[t($,{cols:"12",md:"6"},{default:o(()=>[t(ve,{modelValue:a(B).quantity,"onUpdate:modelValue":e[33]||(e[33]=s=>a(B).quantity=s),modelModifiers:{number:!0},label:`Jumlah ${a(B).type==="in"?"Masuk":a(B).type==="out"?"Keluar":"Akhir"}`,type:"number",variant:"outlined",required:"",min:a(B).type==="adjustment"?0:1,rules:[s=>s>0||"Jumlah harus lebih dari 0"]},null,8,["modelValue","label","min","rules"])]),_:1}),t($,{cols:"12",md:"6"},{default:o(()=>[t(ve,{modelValue:a(B).cost_per_unit,"onUpdate:modelValue":e[34]||(e[34]=s=>a(B).cost_per_unit=s),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",variant:"outlined",prefix:"Rp",readonly:a(B).type!=="in"},null,8,["modelValue","readonly"])]),_:1}),t($,{cols:"12"},{default:o(()=>[t(it,{modelValue:a(B).notes,"onUpdate:modelValue":e[35]||(e[35]=s=>a(B).notes=s),label:"Catatan",placeholder:"Masukkan catatan untuk pergerakan stok...",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),t(G),t(Ce,{class:"pa-6"},{default:o(()=>[t(Ve),t(V,{variant:"outlined",class:"coffee-secondary",onClick:a(Re)},{default:o(()=>e[85]||(e[85]=[i(" Batal ")])),_:1,__:[85]},8,["onClick"]),t(V,{color:"primary",class:"coffee-primary",loading:a(Ze),onClick:a($e)},{default:o(()=>e[86]||(e[86]=[i(" Simpan ")])),_:1,__:[86]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:at.value,"onUpdate:modelValue":e[38]||(e[38]=s=>at.value=s),"max-width":"1200px",fullscreen:a(d),persistent:"",class:"upload-history-dialog"},{default:o(()=>[t(q,null,{default:o(()=>[t(fe,{class:"d-flex align-center justify-space-between coffee-header"},{default:o(()=>[n("div",mo,[t(A,{icon:"tabler-history",class:"text-white"}),e[87]||(e[87]=n("span",{class:"text-white"},"Riwayat Upload Data Inventory",-1))]),t(V,{icon:"tabler-x",variant:"text",color:"white",onClick:ft})]),_:1}),t(G),t(H,{class:"pa-6"},{default:o(()=>[st.value?(_(),X("div",po,[t(ut,{indeterminate:"",color:"primary",size:"40"}),e[88]||(e[88]=n("div",{class:"mt-4 text-medium-emphasis"}," Memuat riwayat upload... ",-1))])):(_(),X("div",_o,[t(Et,{headers:[{title:"Tanggal Upload",key:"created_at",sortable:!1},{title:"User",key:"user_name",sortable:!1},{title:"Total Items",key:"total_items_processed",sortable:!1},{title:"Berhasil Update",key:"total_items_updated",sortable:!1},{title:"Dilewati",key:"total_items_skipped",sortable:!1},{title:"Total Nilai Stok",key:"total_stock_value",sortable:!1},{title:"Status",key:"upload_status",sortable:!1}],items:ot.value,"items-per-page":He.value,class:"elevation-1"},{"item.created_at":o(({item:s})=>[n("div",vo,u(new Date(s.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})),1)]),"item.user_name":o(({item:s})=>[n("div",ko,[t(Mt,{size:"32",color:"primary",variant:"tonal"},{default:o(()=>[t(A,{icon:"tabler-user"})]),_:1}),n("div",null,[n("div",fo,u(s.user_name||"Unknown User"),1),n("div",go,u(s.user_email||"-"),1)])])]),"item.total_items_processed":o(({item:s})=>[t(D,{color:"info",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.total_items_processed),1)]),_:2},1024)]),"item.total_items_updated":o(({item:s})=>[t(D,{color:"success",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.total_items_updated),1)]),_:2},1024)]),"item.total_items_skipped":o(({item:s})=>[t(D,{color:s.total_items_skipped>0?"warning":"success",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.total_items_skipped),1)]),_:2},1032,["color"])]),"item.total_stock_value":o(({item:s})=>[n("div",yo,u(a(Te)(s.total_stock_value||0)),1)]),"item.upload_status":o(({item:s})=>[t(D,{color:s.upload_status==="success"?"success":s.upload_status==="failed"?"error":"warning",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.upload_status==="success"?"Berhasil":s.upload_status==="failed"?"Gagal":"Sebagian"),1)]),_:2},1032,["color"])]),"no-data":o(()=>[n("div",bo,[t(A,{icon:"tabler-database-off",size:"64",class:"text-medium-emphasis mb-4"}),e[89]||(e[89]=n("div",{class:"text-h6 text-medium-emphasis mb-2"}," Belum Ada Riwayat Upload ",-1)),e[90]||(e[90]=n("div",{class:"text-body-2 text-medium-emphasis"}," Riwayat upload akan muncul setelah Anda melakukan export data inventory. ",-1))])]),_:1},8,["items","items-per-page"]),lt.value>He.value?(_(),X("div",ho,[t(Bt,{modelValue:Le.value,"onUpdate:modelValue":[e[37]||(e[37]=s=>Le.value=s),Pt],length:Math.ceil(lt.value/He.value),"total-visible":7},null,8,["modelValue","length"])])):y("",!0)]))]),_:1}),t(G),t(Ce,{class:"pa-4"},{default:o(()=>[t(Ve),t(V,{variant:"outlined",onClick:ft},{default:o(()=>e[91]||(e[91]=[i(" Tutup ")])),_:1,__:[91]}),t(V,{color:"primary","prepend-icon":"tabler-refresh",onClick:kt},{default:o(()=>e[92]||(e[92]=[i(" Refresh ")])),_:1,__:[92]})]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:ee.value,"onUpdate:modelValue":e[40]||(e[40]=s=>ee.value=s),"max-width":"500",persistent:""},{default:o(()=>[t(q,null,{default:o(()=>[t(fe,{class:"d-flex align-center gap-2"},{default:o(()=>[t(A,{icon:"tabler-file-spreadsheet",color:"success"}),e[93]||(e[93]=i(" Export Inventory ke Excel "))]),_:1,__:[93]}),t(G),t(H,null,{default:o(()=>[n("div",xo,[e[97]||(e[97]=n("h6",{class:"text-h6 mb-2"},"Filter yang akan diterapkan:",-1)),n("div",wo,[a(l).search?(_(),w(D,{key:0,color:"primary",variant:"tonal",size:"small","prepend-icon":"tabler-search"},{default:o(()=>[i(' Pencarian: "'+u(a(l).search)+'" ',1)]),_:1})):y("",!0),a(l).stock_status&&a(l).stock_status!=="all"?(_(),w(D,{key:1,color:"info",variant:"tonal",size:"small","prepend-icon":"tabler-package"},{default:o(()=>[i(" Status: "+u(a(l).stock_status),1)]),_:1})):y("",!0),a(l).available_in_kitchen?(_(),w(D,{key:2,color:"warning",variant:"tonal",size:"small","prepend-icon":"tabler-chef-hat"},{default:o(()=>e[94]||(e[94]=[i(" Kitchen: Ya ")])),_:1,__:[94]})):y("",!0),a(l).available_in_bar?(_(),w(D,{key:3,color:"info",variant:"tonal",size:"small","prepend-icon":"tabler-glass-cocktail"},{default:o(()=>e[95]||(e[95]=[i(" Bar: Ya ")])),_:1,__:[95]})):y("",!0),!a(l).search&&(!a(l).stock_status||a(l).stock_status==="all")&&!a(l).available_in_kitchen&&!a(l).available_in_bar?(_(),w(D,{key:4,color:"success",variant:"tonal",size:"small","prepend-icon":"tabler-check"},{default:o(()=>e[96]||(e[96]=[i(" Semua Data (Tanpa Filter) ")])),_:1,__:[96]})):y("",!0)])]),t(se,{type:"info",variant:"tonal",class:"mb-4"},{default:o(()=>e[98]||(e[98]=[i(" Data yang akan di-export akan mengikuti filter yang sedang aktif. File Excel akan berisi kolom Station (Kitchen & Bar) untuk setiap item. ")])),_:1,__:[98]})]),_:1}),t(G),t(Ce,null,{default:o(()=>[t(Ve),t(V,{variant:"outlined",onClick:Oe,disabled:z.value},{default:o(()=>e[99]||(e[99]=[i(" Batal ")])),_:1,__:[99]},8,["disabled"]),t(V,{color:"success","prepend-icon":"tabler-file-spreadsheet",loading:z.value,onClick:e[39]||(e[39]=s=>{vt(),Oe()})},{default:o(()=>e[100]||(e[100]=[i(" Export ke Excel ")])),_:1,__:[100]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Se,{modelValue:ee.value,"onUpdate:modelValue":e[42]||(e[42]=s=>ee.value=s),"max-width":"500",persistent:""},{default:o(()=>[t(q,null,{default:o(()=>[t(fe,{class:"d-flex align-center gap-2"},{default:o(()=>[t(A,{icon:"tabler-file-spreadsheet",color:"success"}),e[101]||(e[101]=i(" Export Data ke Excel "))]),_:1,__:[101]}),t(G),t(H,null,{default:o(()=>[n("div",So,[e[105]||(e[105]=n("h6",{class:"text-h6 mb-2"},"Filter yang akan diterapkan:",-1)),n("div",Vo,[a(l).search?(_(),w(D,{key:0,color:"primary",variant:"tonal",size:"small","prepend-icon":"tabler-search"},{default:o(()=>[i(' Pencarian: "'+u(a(l).search)+'" ',1)]),_:1})):y("",!0),a(l).stock_status&&a(l).stock_status!=="all"?(_(),w(D,{key:1,color:"info",variant:"tonal",size:"small","prepend-icon":"tabler-package"},{default:o(()=>[i(" Status: "+u(a(l).stock_status),1)]),_:1})):y("",!0),a(l).available_in_kitchen?(_(),w(D,{key:2,color:"warning",variant:"tonal",size:"small","prepend-icon":"tabler-chef-hat"},{default:o(()=>e[102]||(e[102]=[i(" Kitchen: Ya ")])),_:1,__:[102]})):y("",!0),a(l).available_in_bar?(_(),w(D,{key:3,color:"info",variant:"tonal",size:"small","prepend-icon":"tabler-glass-cocktail"},{default:o(()=>e[103]||(e[103]=[i(" Bar: Ya ")])),_:1,__:[103]})):y("",!0),!a(l).search&&(!a(l).stock_status||a(l).stock_status==="all")&&!a(l).available_in_kitchen&&!a(l).available_in_bar?(_(),w(D,{key:4,color:"success",variant:"tonal",size:"small","prepend-icon":"tabler-database"},{default:o(()=>e[104]||(e[104]=[i(" Semua Data ")])),_:1,__:[104]})):y("",!0)])]),t(se,{type:"info",variant:"tonal",class:"mb-4"},{default:o(()=>e[106]||(e[106]=[i(" Data yang akan di-export sesuai dengan filter yang aktif saat ini. File Excel akan mencakup kolom Station (Kitchen/Bar) untuk setiap item. ")])),_:1,__:[106]})]),_:1}),t(G),t(Ce,null,{default:o(()=>[t(Ve),t(V,{variant:"outlined",onClick:Oe},{default:o(()=>e[107]||(e[107]=[i(" Batal ")])),_:1,__:[107]}),t(V,{color:"success",variant:"elevated","prepend-icon":"tabler-download",loading:z.value,onClick:e[41]||(e[41]=s=>{vt(),Oe()})},{default:o(()=>e[108]||(e[108]=[i(" Export Excel ")])),_:1,__:[108]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),os=Ut(To,[["__scopeId","data-v-82cbfd83"]]);export{os as default};
