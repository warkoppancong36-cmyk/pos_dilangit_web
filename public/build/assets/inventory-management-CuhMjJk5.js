import{av as ge,d as Ct,r as v,V as ae,w as Dt,g as V,f as o,b as t,s as i,X as A,t as u,l as h,c as J,e as n,at as rt,a0 as S,o as f,au as wt,aU as $t,D as Rt,m as a,a2 as Le,F as jt,i as Lt,p as Ke,$ as Ge,a4 as zt,aw as lt,ar as Ft}from"./main-CGfvAKQg.js";import{V as Se}from"./VDialog-BNhzttoX.js";import{b as pe,c as Ce,V as q}from"./VCard-DPTdVKQy.js";import{V as X}from"./VDivider-kAeew0DL.js";import{V as K}from"./VCardText-LfMMDWFN.js";import{V as le}from"./VAlert-DQZPppqd.js";import{V as Mt,a as Nt}from"./VDataTable-BW1MnP5_.js";import{V as M}from"./VChip-BJ2TWNvc.js";import{V as Ve}from"./VSpacer-DRji1aXT.js";import{_ as Et}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as Bt}from"./ItemsApi-DHCcuuCh.js";import{u as qt}from"./useApi-D7EGydDG.js";import{V as ye,a as L}from"./VRow-fMhDyJ01.js";import{V as de}from"./VTextField-CpuXUQuF.js";import{V as St}from"./VSelect-DWLCrn0F.js";import{V as Vt}from"./VCheckbox-DP8e99cG.js";import{V as Ot}from"./VDataTableServer-C3bX3i5U.js";import{V as Xe}from"./VTooltip-BF6dnOQp.js";import{V as Je}from"./VForm-DcijFXT1.js";import{V as nt}from"./VTextarea-DbvkXr1z.js";import{V as Tt}from"./VAvatar-D7krNhPI.js";import"./VOverlay-CMrwG-K2.js";import"./forwardRefs-B931MWyl.js";import"./VImg-YVIz-GZl.js";import"./VCheckboxBtn-oRXb6TcP.js";import"./VTable-BKiQjh92.js";import"./filter-BHttNOyp.js";/* empty css              */import"./VList-DZ7UBRvs.js";import"./VMenu-KQzYgo3r.js";const me="/api/inventory";class oe{static async getAll(c){var p;try{return(await ge.get(me,{params:c})).data}catch(_){throw((p=_.response)==null?void 0:p.data)||this.handleError(_)}}static async getById(c){var p;try{return(await ge.get(`${me}/${c}`)).data}catch(_){throw((p=_.response)==null?void 0:p.data)||this.handleError(_)}}static async getStats(){var c;try{return(await ge.get(`${me}/stats`)).data}catch(p){throw((c=p.response)==null?void 0:c.data)||this.handleError(p)}}static async getLowStockAlerts(){var c;try{return(await ge.get(`${me}/low-stock-alerts`)).data}catch(p){throw((c=p.response)==null?void 0:c.data)||this.handleError(p)}}static async updateStock(c,p){var _;try{return(await ge.post(`${me}/${c}/update-stock`,p)).data}catch(C){throw((_=C.response)==null?void 0:_.data)||this.handleError(C)}}static async bulkUpdateStock(c){var p;try{return(await ge.post(`${me}/bulk-update-stock`,c)).data}catch(_){throw((p=_.response)==null?void 0:p.data)||this.handleError(_)}}static async setReorderLevel(c,p){var _;try{return(await ge.post(`${me}/${c}/reorder-level`,p)).data}catch(C){throw((_=C.response)==null?void 0:_.data)||this.handleError(C)}}static async getMovements(c){var p;try{const _=c!=null&&c.id_inventory?`${me}/${c.id_inventory}/movements`:`${me}/movements`;return(await ge.get(_,{params:c})).data}catch(_){throw((p=_.response)==null?void 0:p.data)||this.handleError(_)}}static async recordMovement(c){var p;try{return(await ge.post(`${me}/movement`,c)).data}catch(_){throw((p=_.response)==null?void 0:p.data)||this.handleError(_)}}static handleError(c){var p,_;return c.response?{message:((p=c.response.data)==null?void 0:p.message)||"Terjadi kesalahan pada server",success:!1,errors:(_=c.response.data)==null?void 0:_.errors}:c.request?{message:"Tidak dapat terhubung ke server",success:!1}:{message:c.message||"Terjadi kesalahan yang tidak diketahui",success:!1}}static formatError(c){return c.errors?Object.values(c.errors).flat().join(", "):c.message||"Terjadi kesalahan yang tidak diketahui"}static isValidationError(c){return c.errors&&typeof c.errors=="object"}static getFieldError(c,p){return c.errors&&c.errors[p]?Array.isArray(c.errors[p])?c.errors[p][0]:c.errors[p]:null}static getMovementTypes(){return[{value:"stock_in",label:"Stock Masuk",color:"success"},{value:"stock_out",label:"Stock Keluar",color:"warning"},{value:"adjustment",label:"Penyesuaian",color:"info"},{value:"transfer",label:"Transfer",color:"primary"},{value:"return",label:"Retur",color:"success"},{value:"damaged",label:"Rusak",color:"error"},{value:"expired",label:"Kadaluarsa",color:"error"}]}static getStockStatusOptions(){return[{value:"all",label:"Semua Status"},{value:"in_stock",label:"Tersedia"},{value:"low_stock",label:"Stok Menipis"},{value:"out_of_stock",label:"Habis"},{value:"overstock",label:"Stok Berlebih"}]}}const Ht={key:1,class:"text-center py-8"},Kt={class:"font-weight-medium"},Gt={class:"text-medium-emphasis"},Xt={class:"text-center"},Jt={class:"text-center font-weight-medium"},Yt={class:"text-center font-weight-bold text-primary"},Wt={class:"text-end"},Qt={class:"text-end font-weight-medium text-success"},Zt={class:"max-width-200"},ea={class:"font-weight-medium"},ta={key:0,class:"text-medium-emphasis"},aa={key:1,class:"d-block text-caption"},oa={key:2,class:"text-info d-block"},sa={class:"text-center py-8"},la=Ct({__name:"InventoryMovementsDialog",props:{modelValue:{type:Boolean},inventoryId:{},inventoryName:{}},emits:["update:modelValue"],setup(ne,{emit:c}){const p=ne,_=c,C=v([]),W=v(!1),G=v(""),F=ae({get:()=>p.modelValue,set:y=>_("update:modelValue",y)}),ee=async()=>{var y,b,l,D;if(p.inventoryId)try{W.value=!0,G.value="";const T=await oe.getMovements({id_inventory:parseInt(p.inventoryId),page:1,per_page:50});T.data&&Array.isArray(T.data)?C.value=T.data:T.data&&((y=T==null?void 0:T.data)!=null&&y.data)&&Array.isArray((b=T==null?void 0:T.data)==null?void 0:b.data)?C.value=T.data.data:C.value=[]}catch(T){console.error("Error fetching movements:",T),G.value=((D=(l=T.response)==null?void 0:l.data)==null?void 0:D.message)||"Gagal memuat riwayat pergerakan"}finally{W.value=!1}},se=y=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(y),Q=y=>({in:"success",out:"error",stock_in:"success",stock_out:"error",adjustment:"warning",transfer:"info",return:"secondary"})[y]||"primary",Z=y=>({in:"Stock Masuk",out:"Stock Keluar",stock_in:"Stock Masuk",stock_out:"Stock Keluar",adjustment:"Penyesuaian",transfer:"Transfer",return:"Retur"})[y]||y,$=y=>({in:"tabler-plus",out:"tabler-minus",stock_in:"tabler-plus",stock_out:"tabler-minus",adjustment:"tabler-edit",transfer:"tabler-arrows-exchange",return:"tabler-arrow-back"})[y]||"tabler-package";return Dt(F,y=>{y&&p.inventoryId?ee():(C.value=[],G.value="")}),(y,b)=>(f(),V(Se,{modelValue:F.value,"onUpdate:modelValue":b[1]||(b[1]=l=>F.value=l),"max-width":"900px",scrollable:""},{default:o(()=>[t(q,null,{default:o(()=>[t(pe,{class:"d-flex align-center"},{default:o(()=>[t(A,{icon:"tabler-history",class:"me-2"}),i(" Riwayat Pergerakan - "+u(y.inventoryName),1)]),_:1}),t(X),t(K,{class:"pa-0"},{default:o(()=>[G.value?(f(),V(le,{key:0,type:"error",variant:"tonal",class:"ma-4"},{default:o(()=>[i(u(G.value),1)]),_:1})):h("",!0),W.value?(f(),J("div",Ht,[t(rt,{indeterminate:"",color:"primary",size:"40"}),b[2]||(b[2]=n("div",{class:"mt-4 text-medium-emphasis"}," Memuat riwayat pergerakan... ",-1))])):(f(),V(Mt,{key:2,headers:[{title:"Tanggal",key:"created_at",sortable:!1},{title:"Jenis",key:"movement_type",sortable:!1},{title:"Kuantitas",key:"quantity",sortable:!1},{title:"Stok Sebelum",key:"stock_before",sortable:!1},{title:"Stok Sesudah",key:"stock_after",sortable:!1},{title:"Harga/Unit",key:"unit_cost",sortable:!1},{title:"Total Nilai",key:"total_cost",sortable:!1},{title:"Catatan",key:"notes",sortable:!1}],items:C.value,loading:W.value,class:"text-no-wrap","items-per-page":"15",height:"500","fixed-header":""},{"item.created_at":o(({item:l})=>[n("div",null,[n("div",Kt,u(new Date(l.created_at).toLocaleDateString("id-ID")),1),n("small",Gt,u(new Date(l.created_at).toLocaleTimeString("id-ID")),1)])]),"item.movement_type":o(({item:l})=>[t(M,{color:Q(l.movement_type),variant:"tonal",size:"small","prepend-icon":$(l.movement_type)},{default:o(()=>[i(u(Z(l.movement_type)),1)]),_:2},1032,["color","prepend-icon"])]),"item.quantity":o(({item:l})=>[n("div",Xt,[t(M,{color:l.movement_type==="in"||l.movement_type==="stock_in"?"success":"error",variant:"outlined",size:"small"},{default:o(()=>[i(u(l.movement_type==="in"||l.movement_type==="stock_in"?"+":"-")+u(Math.abs(l.quantity)),1)]),_:2},1032,["color"])])]),"item.stock_before":o(({item:l})=>[n("div",Jt,u(l.stock_before),1)]),"item.stock_after":o(({item:l})=>[n("div",Yt,u(l.stock_after),1)]),"item.unit_cost":o(({item:l})=>[n("div",Wt,u(l.unit_cost?se(l.unit_cost):"-"),1)]),"item.total_cost":o(({item:l})=>[n("div",Qt,u(l.total_cost?se(l.total_cost):"-"),1)]),"item.notes":o(({item:l})=>[n("div",Zt,[n("div",ea,u(l.notes||"-"),1),l.reference_type&&l.reference_id?(f(),J("small",ta," Ref: "+u(l.reference_type)+"-"+u(l.reference_id),1)):h("",!0),l.batch_number?(f(),J("small",aa," Batch: "+u(l.batch_number),1)):h("",!0),l.user?(f(),J("small",oa," oleh: "+u(l.user.name),1)):h("",!0)])]),"no-data":o(()=>[n("div",sa,[t(A,{icon:"tabler-history-off",size:"48",class:"text-medium-emphasis mb-4"}),b[3]||(b[3]=n("div",{class:"text-h6 text-medium-emphasis mb-2"}," Belum ada riwayat pergerakan ",-1)),b[4]||(b[4]=n("div",{class:"text-body-2 text-medium-emphasis"}," Riwayat akan muncul setelah ada pergerakan stok ",-1))])]),_:1},8,["items","loading"]))]),_:1}),t(X),t(Ce,{class:"pa-4"},{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:b[0]||(b[0]=l=>F.value=!1)},{default:o(()=>b[5]||(b[5]=[i(" Tutup ")])),_:1,__:[5]}),t(S,{color:"primary","prepend-icon":"tabler-refresh",onClick:ee},{default:o(()=>b[6]||(b[6]=[i(" Refresh ")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),na=Et(la,[["__scopeId","data-v-ca0277a4"]]),ra=()=>{const ne=v([]),c=v(!1),p=v(!1),_=v({total_items:0,low_stock_items:0,out_of_stock_items:0,overstock_items:0,total_stock_value:0,total_stock_quantity:0,total_reserved_stock:0,items_need_restock:0}),C=v([]),W=v(!1),G=v([]),F=v(!1),ee=v(!1),se=v(!1),Q=v(!1),Z=v(!1),$=v(null),y=v([]),b=v(1),l=v(0),D=v(15),T=v({search:"",stock_status:"all",category_id:void 0,supplier_id:void 0,available_in_kitchen:!1,available_in_bar:!1,sort_by:"current_stock",sort_order:"asc"}),re=v(""),N=v(""),O=v(""),be=v({movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:void 0,notes:""}),he=v({reorder_level:0,max_stock_level:0}),ie=ae(()=>y.value.length>0),De=ae(()=>_.value.total_stock_value),_e=ae(()=>_.value.low_stock_items),xe=ae(()=>_.value.out_of_stock_items),ue=ae(()=>Math.ceil(l.value/D.value)),Me=ae(()=>b.value<ue.value),Ee=ae(()=>b.value>1),Pe=ae(()=>({currentPage:b.value,totalPages:ue.value,totalItems:l.value,itemsPerPage:D.value,hasNext:Me.value,hasPrev:Ee.value})),ze=[r=>r>0||"Kuantitas harus lebih dari 0",r=>Number.isInteger(r)||"Kuantitas harus berupa bilangan bulat"],Fe=[r=>!!r||"Alasan wajib diisi",r=>r&&r.length>=3||"Alasan minimal 3 karakter"],Ne=[r=>!r||r>=0||"Harga harus lebih dari atau sama dengan 0"],g=[{title:"Stock Masuk",value:"stock_in",color:"success"},{title:"Stock Keluar",value:"stock_out",color:"warning"},{title:"Penyesuaian",value:"adjustment",color:"info"},{title:"Transfer",value:"transfer",color:"primary"},{title:"Retur",value:"return",color:"success"}],H=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Menipis",value:"low_stock"},{title:"Habis",value:"out_of_stock"},{title:"Stok Berlebih",value:"overstock"}],E=async()=>{c.value=!0,re.value="";try{const r={...T.value,page:b.value,per_page:D.value};Object.keys(r).forEach(Oe=>{const ke=r[Oe];(ke===""||ke===void 0||ke===null||ke==="all")&&delete r[Oe]});const z=await oe.getAll(r);if(z.success)ne.value=z.data.data||[],l.value=z.data.total||0,z.data.current_page&&(b.value=z.data.current_page);else throw new Error(z.message||"Gagal mengambil data inventory")}catch(r){console.error("Error fetching inventory:",r),re.value=oe.formatError(r)||"Gagal mengambil data inventory",ne.value=[],l.value=0}finally{c.value=!1}},Be=async()=>{try{const r=await oe.getStats();r.success&&(_.value=r.data)}catch(r){console.error("Error fetching inventory stats:",r)}},ve=async()=>{F.value=!0;try{const r=await oe.getLowStockAlerts();r.success&&(G.value=r.data.data||[])}catch(r){console.error("Error fetching low stock alerts:",r),G.value=[]}finally{F.value=!1}},Te=async r=>{W.value=!0;try{const z=await oe.getMovements({id_inventory:r,page:1,per_page:20});z.success&&(C.value=z.data)}catch(z){console.error("Error fetching movements:",z)}finally{W.value=!1}},Ye=async()=>{if($.value){p.value=!0,O.value="";try{const r=await oe.updateStock($.value.id_inventory,be.value);if(r.success)N.value="Stock berhasil diperbarui",Ue(),await E(),await Be(),await ve();else throw new Error(r.message||"Gagal memperbarui stock")}catch(r){console.error("Error updating stock:",r),O.value=oe.formatError(r)||"Gagal memperbarui stock"}finally{p.value=!1}}},Ie=async()=>{if($.value){p.value=!0,O.value="";try{const r=await oe.setReorderLevel($.value.id_inventory,he.value);if(r.success)N.value="Reorder level berhasil diperbarui",te(),await E();else throw new Error(r.message||"Gagal memperbarui reorder level")}catch(r){console.error("Error setting reorder level:",r),O.value=oe.formatError(r)||"Gagal memperbarui reorder level"}finally{p.value=!1}}},Ae=r=>{$.value=r,be.value={movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:r.average_cost||void 0,notes:""},O.value="",ee.value=!0},We=r=>{$.value=r,he.value={reorder_level:r.reorder_level||0,max_stock_level:r.max_stock_level||0},O.value="",Z.value=!0},$e=r=>{$.value=r,Te(r.id_inventory),Q.value=!0},Ue=()=>{ee.value=!1,setTimeout(()=>{$.value=null,O.value=""},300)},te=()=>{Z.value=!1,setTimeout(()=>{$.value=null,O.value=""},300)};return{inventoryList:ne,loading:c,saveLoading:p,stats:_,movementsList:C,movementsLoading:W,lowStockItems:G,alertsLoading:F,stockUpdateDialog:ee,bulkUpdateDialog:se,movementsDialog:Q,reorderDialog:Z,selectedInventory:$,selectedItems:y,currentPage:b,totalItems:l,itemsPerPage:D,filters:T,errorMessage:re,successMessage:N,modalErrorMessage:O,stockUpdateForm:be,reorderForm:he,hasSelectedItems:ie,totalStockValue:De,lowStockCount:_e,outOfStockCount:xe,quantityRules:ze,reasonRules:Fe,costRules:Ne,movementTypeOptions:g,stockStatusOptions:H,fetchInventoryList:E,fetchStats:Be,fetchLowStockAlerts:ve,fetchMovements:Te,updateStock:Ye,setReorderLevel:Ie,openStockUpdateDialog:Ae,openReorderDialog:We,openMovementsDialog:$e,closeStockUpdateDialog:Ue,closeReorderDialog:te,closeMovementsDialog:()=>{Q.value=!1,setTimeout(()=>{$.value=null,C.value=[]},300)},clearModalError:()=>{O.value=""},onPageChange:r=>{r!==b.value&&(b.value=r,E())},onItemsPerPageChange:r=>{r!==D.value&&(D.value=r,b.value=1,E())},handleFiltersUpdate:r=>{T.value={...T.value,...r},b.value=1,E()},formatCurrency:r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),getStockStatusColor:r=>r.current_stock===0?"error":r.is_low_stock?"warning":"success",getStockStatusText:r=>r.current_stock===0?"Habis":r.reorder_level>0&&r.current_stock<=r.reorder_level?"Menipis":r.max_stock_level&&r.current_stock>r.max_stock_level?"Berlebih":"Tersedia",getMovementTypeColor:r=>({stock_in:"success",stock_out:"warning",adjustment:"info",transfer:"primary",return:"success",damaged:"error",expired:"error"})[r]||"grey",totalPages:ue,hasNextPage:Me,hasPrevPage:Ee,paginationInfo:Pe}};function ia(ne){const c=v([]),p=v([]),_=v(!1),C=v(!1),W=v({total_items:0,total_value:0,low_stock_items:0,out_of_stock_items:0,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}),G=v(1),F=v(0),ee=v(10),se=wt({search:"",stock_status:"all",movement_type:"",date_from:"",date_to:"",item_id:void 0}),Q=v(!1),Z=v(!1),$=v(null),y=wt({item_id:0,type:"in",quantity:0,notes:"",cost_per_unit:0}),b=v(""),l=v(""),D=v(""),T=ae(()=>!0),re=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],N=[{title:"Masuk",value:"in",color:"success",icon:"tabler-plus"},{title:"Keluar",value:"out",color:"error",icon:"tabler-minus"},{title:"Penyesuaian",value:"adjustment",color:"warning",icon:"tabler-adjustments"}],O=[{title:"Pembelian",value:"purchase"},{title:"Penjualan",value:"sale"},{title:"Produksi",value:"production"},{title:"Penyesuaian",value:"adjustment"},{title:"Kerusakan",value:"waste"}],be=g=>g.current_stock<=0?{status:"out_of_stock",color:"error",text:"Habis",icon:"tabler-x"}:g.current_stock<=g.minimum_stock?{status:"low_stock",color:"warning",text:"Rendah",icon:"tabler-alert-triangle"}:{status:"in_stock",color:"success",text:"Tersedia",icon:"tabler-check"},he=g=>!g.maximum_stock||g.maximum_stock<=0?100:Math.round(g.current_stock/g.maximum_stock*100),ie=async()=>{_.value=!0;try{await new Promise(g=>setTimeout(g,1e3)),c.value=await Bt.getAll(),F.value=c.value.length,l.value=""}catch{b.value="Gagal memuat data items"}finally{_.value=!1}},De=async g=>{_.value=!0;try{const H=await oe.getMovements({id_inventory:g,page:G.value,per_page:ee.value});p.value=H.data.map(E=>({id:E.id_movement,item_id:E.id_inventory,type:E.movement_type,quantity:E.quantity,unit:"pcs",reference_id:E.reference_number?parseInt(E.reference_number):void 0,reference_type:E.reason,notes:E.notes,cost_per_unit:E.cost_per_unit,total_cost:E.total_cost,created_by:E.created_by,created_at:E.created_at,creator:E.user})),F.value=H.total}catch(H){console.error("Failed to fetch stock movements:",H),p.value=[]}finally{_.value=!1}},_e=async()=>{try{await ie();const g=c.value;W.value={total_items:g.length,total_value:g.reduce((H,E)=>H+E.current_stock*E.cost_per_unit,0),low_stock_items:g.filter(H=>H.current_stock<=H.minimum_stock&&H.current_stock>0).length,out_of_stock_items:g.filter(H=>H.current_stock<=0).length,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}}catch(g){console.error("Failed to fetch stats:",g)}},xe=async()=>{C.value=!0,D.value="";try{const g=await oe.recordMovement({item_id:y.item_id,movement_type:y.type,quantity:y.quantity,notes:y.notes,cost_per_unit:y.cost_per_unit});if(g.success)l.value=`Stock ${y.type==="in"?"masuk":y.type==="out"?"keluar":"disesuaikan"} berhasil dicatat`,Pe(),await ie(),await _e(),ne&&ne();else throw new Error(g.message||"Gagal mencatat pergerakan stok")}catch(g){D.value=g.message||"Gagal mencatat pergerakan stok"}finally{C.value=!1}},ue=g=>{$.value=g,Object.assign(y,{item_id:g.id_item,type:"in",quantity:0,notes:"",cost_per_unit:g.cost_per_unit}),Q.value=!0},Me=g=>{$.value=g,Object.assign(y,{item_id:g.id_item,type:"out",quantity:0,notes:"",cost_per_unit:g.cost_per_unit}),Q.value=!0},Ee=g=>{$.value=g,Object.assign(y,{item_id:g.id_item,type:"adjustment",quantity:g.current_stock,notes:"",cost_per_unit:g.cost_per_unit}),Z.value=!0},Pe=()=>{Q.value=!1,Z.value=!1,D.value="",$.value=null};return{itemsList:c,stockMovements:p,loading:_,saveLoading:C,stats:W,currentPage:G,totalItems:F,itemsPerPage:ee,filters:se,movementDialog:Q,adjustmentDialog:Z,selectedItem:$,movementFormData:y,errorMessage:b,successMessage:l,modalErrorMessage:D,canManageStock:T,stockStatusOptions:re,movementTypeOptions:N,referenceTypeOptions:O,getStockStatus:be,getStockPercentage:he,fetchItems:ie,fetchStockMovements:De,fetchStats:_e,recordStockMovement:xe,openStockInDialog:ue,openStockOutDialog:Me,openAdjustmentDialog:Ee,closeMovementDialog:Pe,clearModalError:()=>{D.value=""},onPageChange:g=>{G.value=g,ie()},handleFiltersUpdate:g=>{Object.assign(se,g),G.value=1,ie()}}}const ua={class:"inventory-management"},ca={class:"d-flex justify-space-between align-center mb-6"},da={class:"d-flex gap-3 align-center"},ma={class:"d-flex align-center justify-space-between"},pa={class:"text-h4 font-weight-bold text-primary"},_a={class:"d-flex align-center justify-space-between"},va={class:"text-h4 font-weight-bold text-warning"},ka={class:"d-flex align-center justify-space-between"},fa={class:"text-h4 font-weight-bold text-error"},ga={class:"d-flex align-center justify-space-between"},ya={class:"text-h4 font-weight-bold text-success"},ba={class:"d-flex align-center justify-space-between"},ha={class:"d-flex align-center gap-3"},xa={class:"d-flex gap-2"},wa={class:"d-flex flex-wrap gap-2"},Sa={class:"table-container"},Va={class:"d-flex align-center"},Ta={class:"font-weight-medium"},Ca={class:"d-flex flex-column"},Da={class:"text-primary font-weight-medium"},Ma={class:"text-medium-emphasis"},Ea={class:"text-center"},Pa={class:"text-h6 font-weight-bold"},Ua={key:0,class:"text-warning"},Ia={class:"text-center"},Aa={class:"d-flex flex-column gap-1"},$a={key:2,class:"text-caption text-medium-emphasis"},Ra={class:"text-center"},ja={class:"text-end"},La={class:"text-end font-weight-medium text-success"},za={class:"d-flex align-center gap-1"},Fa={class:"text-center py-12"},Na={class:"text-h5 text-medium-emphasis mb-2"},Ba={class:"text-body-1 text-medium-emphasis mb-4"},qa={key:0},Oa={key:0},Ha={key:1},Ka={key:2},Ga={key:1},Xa={class:"d-flex justify-center gap-3"},Ja={class:"text-center py-8"},Ya={class:"d-flex align-center gap-2"},Wa={class:"d-flex align-center gap-3"},Qa={class:"font-weight-bold"},Za={class:"text-caption"},eo={class:"text-caption"},to={class:"d-flex gap-3 justify-end"},ao={class:"d-flex align-center gap-2"},oo={class:"text-white"},so={class:"d-flex align-center gap-3"},lo={class:"font-weight-bold"},no={class:"text-caption"},ro={class:"d-flex align-center gap-2"},io={key:0,class:"text-center py-8"},uo={key:1},co={class:"text-body-2"},mo={class:"d-flex align-center gap-2"},po={class:"text-body-2 font-weight-medium"},_o={class:"text-caption text-medium-emphasis"},vo={class:"text-end font-weight-medium text-success"},ko={class:"text-center py-8"},fo={key:0,class:"d-flex justify-center mt-4"},go={class:"mb-4"},yo={class:"d-flex flex-column gap-2"},bo={class:"mb-4"},ho={class:"d-flex flex-column gap-2"},xo=Ct({__name:"inventory-management",setup(ne){const{xs:c}=$t(),p=()=>{_e(),xe(),ue()},{inventoryList:_,loading:C,saveLoading:W,stats:G,lowStockItems:F,stockUpdateDialog:ee,reorderDialog:se,movementsDialog:Q,selectedInventory:Z,currentPage:$,totalItems:y,itemsPerPage:b,filters:l,errorMessage:D,successMessage:T,modalErrorMessage:re,stockUpdateForm:N,reorderForm:O,totalStockValue:be,lowStockCount:he,outOfStockCount:ie,stockStatusOptions:De,fetchInventoryList:_e,fetchStats:xe,fetchLowStockAlerts:ue,updateStock:Me,setReorderLevel:Ee,openStockUpdateDialog:Pe,openReorderDialog:ze,openMovementsDialog:Fe,closeStockUpdateDialog:Ne,closeReorderDialog:g,clearModalError:H,onPageChange:E,onItemsPerPageChange:Be,handleFiltersUpdate:ve,formatCurrency:Te,getStockStatusColor:Ye,getStockStatusText:Ie}=ra(),{recordStockMovement:Ae,openAdjustmentDialog:We,movementDialog:$e,adjustmentDialog:Ue,selectedItem:te,movementFormData:B,saveLoading:Qe,closeMovementDialog:Re,successMessage:qe,modalErrorMessage:Ze,clearModalError:it}=ia(p),ut=d=>d.item?{id_item:d.item.id_item,item_code:d.item.item_code,name:d.item.name,description:d.item.description||"",unit:d.item.unit,cost_per_unit:parseFloat(d.item.cost_per_unit),current_stock:d.current_stock,minimum_stock:d.reorder_level||0,active:!0,storage_location:d.item.storage_location||"",expiry_date:d.item.expiry_date||null,properties:d.item.properties||null,created_by:d.item.created_by||null,updated_by:d.item.updated_by||null,created_at:d.item.created_at,updated_at:d.item.updated_at,deleted_at:d.item.deleted_at||null}:null,ct=d=>{const e=ut(d);e&&We(e)},dt=ae(()=>G.value);ae(()=>_.value),ae(()=>C.value),Rt(()=>{_e(),xe(),ue()});const r=v(!1),z=v(!1),Oe=()=>{z.value=!0},ke=()=>{z.value=!1},mt=()=>{var U;console.log("🔍 === AUTH STATUS CHECK ===");const d=lt("accessToken").value,e=localStorage.getItem("token"),w=localStorage.getItem("auth_token"),P=localStorage.getItem("accessToken");console.log("🍪 Cookie accessToken:",d?`Found (${d.substring(0,20)}...)`:"Not found"),console.log("💾 localStorage token:",e?`Found (${e.substring(0,20)}...)`:"Not found"),console.log("💾 localStorage auth_token:",w?`Found (${w.substring(0,20)}...)`:"Not found"),console.log("💾 localStorage accessToken:",P?`Found (${P.substring(0,20)}...)`:"Not found");try{const I=Ft();console.log("🏪 Auth Store isLoggedIn:",I.isLoggedIn),console.log("🏪 Auth Store user:",((U=I.user)==null?void 0:U.name)||"No user"),console.log("🏪 Auth Store token:",I.token?`Found (${I.token.substring(0,20)}...)`:"Not found")}catch(I){console.log("🏪 Auth Store not available:",I)}return console.log("========================="),{cookieToken:d,localToken:e,authToken:w,accessToken:P}},et=()=>{try{const d=mt(),e=lt("accessToken").value;if(console.log("🔍 Checking cookie token:",e?"Token found in cookie":"No token in cookie"),e)return console.log("✅ Using cookie token (first 20 chars):",e.substring(0,20)+"..."),e;console.log("🔍 Checking localStorage methods...");const w=localStorage.getItem("token")||localStorage.getItem("auth_token")||localStorage.getItem("accessToken");return w?console.log("✅ Using localStorage token (first 20 chars):",w.substring(0,20)+"..."):console.log("❌ No token found in any storage"),w||null}catch(d){console.warn("❌ Error getting auth token:",d);const e=localStorage.getItem("token")||localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||null;return console.log("🔄 Fallback token result:",e?"Found fallback token":"No fallback token"),e}},Pt=async()=>{var d,e,w,P;try{console.log("🚀 Starting fetchAllInventoryForExport...");const U=new URLSearchParams({per_page:"999999",page:"1",search:l.value.search||"",stock_status:l.value.stock_status||"all"});l.value.available_in_kitchen&&U.append("available_in_kitchen","true"),l.value.available_in_bar&&U.append("available_in_bar","true"),console.log("📝 Request params:",U.toString());try{console.log("🔄 Attempting to fetch with useApi composable...");const{data:I}=await qt(`/inventory?${U}`).get().json();if(I.value&&I.value.success){console.log("✅ Successfully fetched with useApi:",((d=I.value.data.data)==null?void 0:d.length)||0,"items");const k=(I.value.data.data||[]).filter((m,j,R)=>j===R.findIndex(Y=>Y.id_inventory===m.id_inventory));return console.log("🔍 After deduplication:",k.length,"unique items"),k}else throw console.log("❌ useApi response not successful:",I.value),new Error(((e=I.value)==null?void 0:e.message)||"useApi failed")}catch(I){console.warn("❌ useApi failed, trying manual fetch:",I);const s=et();console.log("🔐 Token for manual fetch:",s?`Token available (${s.substring(0,20)}...)`:"No token");const k={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...s&&{Authorization:`Bearer ${s}`}};console.log("📋 Request headers:",{...k,Authorization:k.Authorization?k.Authorization.substring(0,30)+"...":"Not set"});const m=await fetch(`/api/inventory?${U}`,{method:"GET",headers:k});if(console.log("📊 Response status:",m.status,m.statusText),console.log("📋 Response headers:",Object.fromEntries(m.headers.entries())),!m.ok){const R=await m.text();console.error("❌ Manual fetch API Error Response:",R),console.error("📊 Error details - Status:",m.status,"StatusText:",m.statusText);try{const Y=JSON.parse(R);console.error("📋 Parsed error JSON:",Y)}catch{console.error("📋 Error response is not JSON:",R)}throw new Error(`HTTP ${m.status}: ${m.statusText}`)}const j=await m.json();if(console.log("✅ Manual fetch successful response:",{success:j.success,dataLength:((P=(w=j.data)==null?void 0:w.data)==null?void 0:P.length)||0,message:j.message}),j.success){const R=j.data.data||[],Y=R.filter((we,ce,x)=>ce===x.findIndex(fe=>fe.id_inventory===we.id_inventory));return console.log("✅ Successfully fetched with manual fetch:",R.length,"items"),console.log("🔍 After deduplication:",Y.length,"unique items"),Y}else throw console.error("❌ Manual fetch response not successful:",j),new Error(j.message||"Failed to fetch inventory data")}}catch(U){throw console.error("💥 Fetch all inventory error:",U),new Error("Gagal mengambil data inventory lengkap: "+(U instanceof Error?U.message:"Unknown error"))}},tt=v(!1),at=v([]),ot=v(!1),je=v(1),He=v(10),st=v(0),pt=async()=>{try{r.value=!0;const d=await Pt();console.log("📊 Exporting",d.length,"inventory items to Excel");const e=await zt(()=>import("./xlsx-CfQreh1U.js"),[]),w=d.length,P=d.filter(x=>x.current_stock<=x.reorder_level).length,U=d.filter(x=>x.current_stock===0).length,I=d.reduce((x,fe)=>x+(fe.current_stock||0)*(fe.average_cost||0),0),s=d.map((x,fe)=>{var kt,ft,gt,yt,bt,ht,xt;return{No:fe+1,"Produk/Variant":((kt=x.item)==null?void 0:kt.name)||((ft=x.product)==null?void 0:ft.name)||"Unknown Item",SKU:((gt=x.item)==null?void 0:gt.item_code)||((yt=x.product)==null?void 0:yt.sku)||"-",Unit:((bt=x.item)==null?void 0:bt.unit)||"pcs","Stok Saat Ini":x.current_stock||0,"Stok Tersedia":x.available_stock||0,"Stok Minimum":x.reorder_level||0,Status:Ie(x),Kitchen:(ht=x.item)!=null&&ht.available_in_kitchen?"Ya":"Tidak",Bar:(xt=x.item)!=null&&xt.available_in_bar?"Ya":"Tidak","Harga Rata-rata":x.average_cost||0,"Nilai Stok":(x.current_stock||0)*(x.average_cost||0),Dibuat:x.created_at?new Date(x.created_at).toLocaleDateString("id-ID"):"-",Diperbarui:x.updated_at?new Date(x.updated_at).toLocaleDateString("id-ID"):"-"}}),k=e.utils.book_new(),m=[];l.value.search&&m.push(`Pencarian: "${l.value.search}"`),l.value.stock_status&&l.value.stock_status!=="all"&&m.push(`Status: ${l.value.stock_status}`),l.value.available_in_kitchen&&m.push("Kitchen: Ya"),l.value.available_in_bar&&m.push("Bar: Ya");const j=[["LAPORAN INVENTORY MANAGEMENT"],["Tanggal Export:",new Date().toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})],["Total Items:",w],["Total Nilai Stok:",`Rp ${I.toLocaleString("id-ID")}`],["Items Low Stock:",P],["Items Out of Stock:",U],["Filter Diterapkan:",m.length>0?m.join(", "):"Semua Data"],[]],R=e.utils.aoa_to_sheet(j);e.utils.sheet_add_json(R,s,{origin:"A9"});const Y=[{wch:5},{wch:35},{wch:15},{wch:8},{wch:12},{wch:12},{wch:12},{wch:15},{wch:8},{wch:8},{wch:15},{wch:15},{wch:12},{wch:12}];R["!cols"]=Y,e.utils.book_append_sheet(k,R,"Inventory Report");const ce=`inventory-report-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;e.writeFile(k,ce),console.log("✅ Excel file generated successfully:",ce);try{await Ut(d,{total_items:w,total_stock_value:I,low_stock_count:P,out_of_stock_count:U}),T.value=`Laporan berhasil di-export ke Excel dengan ${w} item lengkap dan data berhasil diupload ke server!`}catch(x){console.error("Upload error:",x),T.value=`Laporan berhasil di-export ke Excel dengan ${w} item lengkap, tetapi gagal upload data ke server: `+(x instanceof Error?x.message:"Unknown error")}}catch(d){console.error("Export error:",d),D.value="Gagal mengexport laporan: "+(d instanceof Error?d.message:"Unknown error")}finally{r.value=!1}},Ut=async(d,e)=>{try{const w=d||_.value,P=e||{total_items:y.value,total_stock_value:be.value||0,low_stock_count:he.value,out_of_stock_count:ie.value},U={inventory_data:w.map(m=>{var j,R,Y,we,ce,x,fe;return{id_inventory:m.id_inventory,id_product:m.id_product,id_item:m.id_item,current_stock:m.current_stock||0,available_stock:m.available_stock||0,reserved_stock:m.reserved_stock||0,reorder_level:m.reorder_level||0,max_stock_level:m.max_stock_level||null,average_cost:m.average_cost||0,product_name:((j=m.product)==null?void 0:j.name)||((R=m.item)==null?void 0:R.name)||"Unknown",product_sku:((Y=m.product)==null?void 0:Y.sku)||((we=m.item)==null?void 0:we.item_code)||null,unit:((ce=m.item)==null?void 0:ce.unit)||"pcs",category:((fe=(x=m.product)==null?void 0:x.category)==null?void 0:fe.name)||null,status:Ie(m),stock_value:(m.current_stock||0)*(m.average_cost||0),created_at:m.created_at,updated_at:m.updated_at}}),summary:{total_items:P.total_items,total_stock_value:P.total_stock_value,low_stock_count:P.low_stock_count,out_of_stock_count:P.out_of_stock_count,export_timestamp:new Date().toISOString(),filters_applied:{search:l.value.search||null,stock_status:l.value.stock_status!=="all"?l.value.stock_status:null}}},I=et(),s=await fetch("/api/inventory/upload-data",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...I&&{Authorization:`Bearer ${I}`}},body:JSON.stringify(U)});if(!s.ok){const m=await s.json();throw new Error(m.message||`HTTP ${s.status}: ${s.statusText}`)}const k=await s.json();return console.log("Upload result:",k),k}catch(w){throw console.error("Upload inventory data error:",w),w}},_t=async()=>{var d;try{ot.value=!0;const e=et(),w=await fetch(`/api/inventory/upload-history?page=${je.value}&per_page=${He.value}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",...e&&{Authorization:`Bearer ${e}`}}});if(!w.ok)throw new Error(`HTTP ${w.status}: ${w.statusText}`);const P=await w.json();if(P.success)at.value=P.data||[],st.value=((d=P.pagination)==null?void 0:d.total)||0;else throw new Error(P.message||"Failed to fetch upload history")}catch(e){console.error("Fetch upload history error:",e),D.value="Gagal mengambil riwayat upload: "+(e instanceof Error?e.message:"Unknown error")}finally{ot.value=!1}},It=d=>{je.value=d,_t()},vt=()=>{tt.value=!1,at.value=[],je.value=1},At=async()=>{try{console.log("🚀 Testing login to get fresh token...");const d=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({login:"admin",password:"password123"})});console.log("📊 Login Response Status:",d.status,d.statusText);const e=await d.json();if(console.log("📋 Login Response Data:",e),e.success&&e.data.token){const w=e.data.token;console.log("✅ Login successful! Token:",w.substring(0,30)+"..."),localStorage.setItem("token",w),console.log("💾 Token saved to localStorage");const P=lt("accessToken",{default:()=>"",secure:!0,sameSite:"strict",maxAge:3600*24*7});P.value=w,console.log("🍪 Token saved to cookie"),T.value="Login berhasil! Token telah diperbarui. Silakan coba export lagi.",console.log("🌐 Testing API call with new token...");const U=await fetch("/api/inventory?per_page=1",{headers:{Authorization:"Bearer "+w,Accept:"application/json"}});console.log("📊 Test API Response Status:",U.status,U.statusText),U.ok?console.log("✅ New token works! You can now try the export function."):(console.log("❌ New token still doesn't work"),D.value="Token baru tidak bekerja. Mungkin ada masalah dengan server.")}else console.log("❌ Login failed:",e.message),D.value="Login gagal: "+(e.message||"Unknown error")}catch(d){console.log("💥 Login error:",d),D.value="Error saat login: "+(d instanceof Error?d.message:"Unknown error")}};return Dt(y,(d,e)=>{},{immediate:!0}),(d,e)=>{var w,P,U,I;return f(),J("div",ua,[n("div",ca,[e[42]||(e[42]=n("div",null,[n("h1",{class:"text-h4 font-weight-bold inventory-title"}," Kelola Inventory "),n("p",{class:"text-body-1 text-medium-emphasis inventory-subtitle"}," Kelola stok barang dan pergerakan inventory ")],-1)),n("div",da,[t(S,{color:"info","prepend-icon":"tabler-bug",variant:"outlined",size:"small",onClick:mt},{default:o(()=>e[39]||(e[39]=[i(" Check Auth ")])),_:1,__:[39]}),t(S,{color:"warning","prepend-icon":"tabler-login",variant:"outlined",size:"small",onClick:At},{default:o(()=>e[40]||(e[40]=[i(" Test Login ")])),_:1,__:[40]}),t(S,{color:"primary","prepend-icon":"tabler-refresh",variant:"outlined",onClick:p},{default:o(()=>e[41]||(e[41]=[i(" Refresh Data ")])),_:1,__:[41]})])]),a(D)?(f(),V(le,{key:0,type:"error",variant:"outlined",class:"mb-4",text:a(D),closable:"","onClick:close":e[0]||(e[0]=s=>D.value="")},null,8,["text"])):h("",!0),a(T)?(f(),V(le,{key:1,type:"success",variant:"outlined",class:"mb-4",text:a(T),closable:"","onClick:close":e[1]||(e[1]=s=>T.value="")},null,8,["text"])):h("",!0),a(qe)?(f(),V(le,{key:2,type:"success",variant:"outlined",class:"mb-4",text:a(qe),closable:"","onClick:close":e[2]||(e[2]=s=>qe.value="")},null,8,["text"])):h("",!0),t(ye,{class:"mb-6"},{default:o(()=>[t(L,{cols:"12",md:"3"},{default:o(()=>[t(q,{class:"stats-card"},{default:o(()=>[t(K,null,{default:o(()=>[n("div",ma,[n("div",null,[n("div",pa,u(dt.value.total_items||0),1),e[43]||(e[43]=n("div",{class:"text-caption text-medium-emphasis"}," Total Produk ",-1))]),t(A,{icon:"tabler-package",size:"48",class:"text-primary opacity-50"})])]),_:1})]),_:1})]),_:1}),t(L,{cols:"12",md:"3"},{default:o(()=>[t(q,{class:"stats-card"},{default:o(()=>[t(K,null,{default:o(()=>[n("div",_a,[n("div",null,[n("div",va,u(a(he)||0),1),e[44]||(e[44]=n("div",{class:"text-caption text-medium-emphasis"}," Stok Menipis ",-1))]),t(A,{icon:"tabler-alert-triangle",size:"48",class:"text-warning opacity-50"})])]),_:1})]),_:1})]),_:1}),t(L,{cols:"12",md:"3"},{default:o(()=>[t(q,{class:"stats-card"},{default:o(()=>[t(K,null,{default:o(()=>[n("div",ka,[n("div",null,[n("div",fa,u(a(ie)||0),1),e[45]||(e[45]=n("div",{class:"text-caption text-medium-emphasis"}," Stok Habis ",-1))]),t(A,{icon:"tabler-x-circle",size:"48",class:"text-error opacity-50"})])]),_:1})]),_:1})]),_:1}),t(L,{cols:"12",md:"3"},{default:o(()=>[t(q,{class:"stats-card"},{default:o(()=>[t(K,null,{default:o(()=>[n("div",ga,[n("div",null,[n("div",ya,u(a(Te)(a(be)||0)),1),e[46]||(e[46]=n("div",{class:"text-caption text-medium-emphasis"}," Nilai Stok ",-1))]),t(A,{icon:"tabler-currency-dollar",size:"48",class:"text-success opacity-50"})])]),_:1})]),_:1})]),_:1})]),_:1}),t(q,{class:"mb-6 info-card",color:"info",variant:"tonal"},{default:o(()=>[t(K,null,{default:o(()=>[n("div",ba,[n("div",ha,[t(A,{icon:"tabler-info-circle",size:"32",class:"text-info"}),e[47]||(e[47]=n("div",null,[n("div",{class:"text-subtitle-1 font-weight-medium text-info"}," Sistem Stock Movement Otomatis "),n("div",{class:"text-body-2 text-medium-emphasis"},[i(" Stok akan bertambah otomatis saat purchasing dan berkurang saat penjualan POS. Gunakan tombol "),n("strong",null,"Penyesuaian"),i(" untuk koreksi manual jika diperlukan. ")])],-1))]),n("div",xa,[t(M,{color:"success",variant:"tonal",size:"small"},{default:o(()=>[t(A,{icon:"tabler-shopping-cart",class:"me-1"}),e[48]||(e[48]=i(" Purchase → Stok + "))]),_:1,__:[48]}),t(M,{color:"error",variant:"tonal",size:"small"},{default:o(()=>[t(A,{icon:"tabler-cash",class:"me-1"}),e[49]||(e[49]=i(" POS Sale → Stok - "))]),_:1,__:[49]})])])]),_:1})]),_:1}),a(F).length>0?(f(),V(q,{key:3,class:"mb-6 low-stock-alert"},{default:o(()=>[t(pe,{class:"d-flex align-center"},{default:o(()=>[t(A,{icon:"tabler-alert-triangle",class:"text-warning me-2"}),i(" Peringatan Stok Menipis ("+u(a(F).length)+" produk) ",1)]),_:1}),t(K,null,{default:o(()=>[n("div",wa,[(f(!0),J(jt,null,Lt(a(F).slice(0,10),s=>(f(),V(M,{key:s.id_inventory,color:"warning",variant:"outlined",size:"small"},{default:o(()=>{var k;return[i(u((k=s.product)==null?void 0:k.name)+" ("+u(s.current_stock)+"/"+u(s.reorder_level)+") ",1)]}),_:2},1024))),128)),a(F).length>10?(f(),V(M,{key:0,color:"warning",variant:"tonal",size:"small"},{default:o(()=>[i(" +"+u(a(F).length-10)+" lainnya ",1)]),_:1})):h("",!0)])]),_:1})]),_:1})):h("",!0),!a(C)&&a(_).length===0&&!a(D)&&!a(l).search&&a(l).stock_status==="all"?(f(),V(q,{key:4,class:"mb-6"},{default:o(()=>[t(K,{class:"text-center py-6"},{default:o(()=>[t(A,{icon:"tabler-info-circle",size:"48",class:"text-info mb-3"}),e[50]||(e[50]=n("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),e[51]||(e[51]=n("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[50,51]})]),_:1})):h("",!0),t(q,{class:"mb-6"},{default:o(()=>[t(K,null,{default:o(()=>[t(ye,null,{default:o(()=>[t(L,{cols:"12",md:"3"},{default:o(()=>[t(de,{modelValue:a(l).search,"onUpdate:modelValue":[e[3]||(e[3]=s=>a(l).search=s),e[4]||(e[4]=s=>a(ve)({search:s}))],label:"Cari inventory produk...",placeholder:"Nama produk, SKU, atau variant","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",md:"3"},{default:o(()=>[t(St,{modelValue:a(l).stock_status,"onUpdate:modelValue":[e[5]||(e[5]=s=>a(l).stock_status=s),e[6]||(e[6]=s=>a(ve)({stock_status:s||"all"}))],items:a(De),label:"Status Stok",variant:"outlined",clearable:""},null,8,["modelValue","items"])]),_:1}),t(L,{cols:"12",md:"2",class:"d-flex align-center"},{default:o(()=>[t(Vt,{modelValue:a(l).available_in_kitchen,"onUpdate:modelValue":[e[7]||(e[7]=s=>a(l).available_in_kitchen=s),e[8]||(e[8]=s=>a(ve)({available_in_kitchen:s}))],label:"Kitchen",color:"warning"},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",md:"2",class:"d-flex align-center"},{default:o(()=>[t(Vt,{modelValue:a(l).available_in_bar,"onUpdate:modelValue":[e[9]||(e[9]=s=>a(l).available_in_bar=s),e[10]||(e[10]=s=>a(ve)({available_in_bar:s}))],label:"Bar",color:"info"},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",md:"2",class:"d-flex align-center gap-2"},{default:o(()=>[t(S,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:e[11]||(e[11]=s=>{a(_e)(),a(xe)(),a(ue)()})},{default:o(()=>e[52]||(e[52]=[i(" Refresh ")])),_:1,__:[52]}),a(l).search||a(l).stock_status!=="all"||a(l).available_in_kitchen||a(l).available_in_bar?(f(),V(S,{key:0,variant:"outlined",color:"warning","prepend-icon":"tabler-filter-off",onClick:e[12]||(e[12]=s=>a(ve)({search:"",stock_status:"all",available_in_kitchen:!1,available_in_bar:!1}))},{default:o(()=>e[53]||(e[53]=[i(" Clear ")])),_:1,__:[53]})):h("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),!a(C)&&a(_).length===0&&!a(D)&&!a(l).search&&a(l).stock_status==="all"?(f(),V(q,{key:5,class:"mb-6"},{default:o(()=>[t(K,{class:"text-center py-6"},{default:o(()=>[t(A,{icon:"tabler-package-off",size:"48",class:"text-disabled mb-3"}),e[54]||(e[54]=n("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),e[55]||(e[55]=n("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[54,55]})]),_:1})):h("",!0),t(q,{class:"products-inventory-table"},{default:o(()=>[t(pe,{class:"d-flex align-center gap-2 coffee-header"},{default:o(()=>[t(A,{icon:"tabler-package",class:"text-white"}),e[57]||(e[57]=n("span",{class:"text-white"},"Inventory Produk",-1)),t(Ve),t(S,{color:"success",variant:"elevated","prepend-icon":"tabler-file-spreadsheet",loading:r.value,onClick:Oe},{default:o(()=>e[56]||(e[56]=[i(" Export Excel ")])),_:1,__:[56]},8,["loading"]),t(M,{color:"black",size:"small",variant:"tonal"},{default:o(()=>[i(u(a(y))+" Produk ",1)]),_:1})]),_:1,__:[57]}),t(X),n("div",Sa,[t(Ot,{headers:[{title:"Produk/Variant",key:"item_name",sortable:!1,width:"280px"},{title:"Stok Saat Ini",key:"current_stock",sortable:!1,width:"120px"},{title:"Stok Tersedia",key:"available_stock",sortable:!1,width:"120px"},{title:"Status",key:"status",sortable:!1,width:"120px"},{title:"Station",key:"station_availability",sortable:!1,width:"150px"},{title:"Reorder Level",key:"reorder_level",sortable:!1,width:"120px"},{title:"Harga Rata-rata",key:"average_cost",sortable:!1,width:"150px"},{title:"Nilai Stok",key:"stock_value",sortable:!1,width:"150px"},{title:"Aksi",key:"actions",sortable:!1,width:"200px",fixed:!0}],items:a(_),loading:a(C),"items-length":a(y),"items-per-page":a(b),page:a($),"items-per-page-options":[10,15,25,50,100],"items-per-page-text":"Items per page:","page-text":"{0}-{1} of {2}","no-data-text":"Tidak ada data inventory",class:"text-no-wrap fixed-actions-table",id:"inventory-table","fixed-header":"",height:"500px","onUpdate:page":a(E),"onUpdate:itemsPerPage":a(Be)},{"item.item_name":o(({item:s})=>{var k,m,j,R,Y,we,ce;return[n("div",Va,[n("div",null,[n("div",Ta,u(((k=s.item)==null?void 0:k.name)||((m=s.product)==null?void 0:m.name)||"Unknown Item"),1),n("div",Ca,[n("small",Da," SKU: "+u(((j=s.item)==null?void 0:j.item_code)||((R=s.product)==null?void 0:R.sku)||"-"),1),n("small",Ma,u(((Y=s.item)==null?void 0:Y.description)||((ce=(we=s.product)==null?void 0:we.category)==null?void 0:ce.name)||"-"),1)])])])]}),"item.sku":o(({item:s})=>[t(M,{variant:"outlined",size:"small",color:"primary"},{default:o(()=>{var k,m;return[i(u(((k=s.item)==null?void 0:k.item_code)||((m=s.product)==null?void 0:m.sku)||"N/A"),1)]}),_:2},1024)]),"item.current_stock":o(({item:s})=>[n("div",Ea,[n("div",Pa,u(s.current_stock),1),s.reserved_stock>0?(f(),J("small",Ua," ("+u(s.reserved_stock)+" reserved) ",1)):h("",!0)])]),"item.available_stock":o(({item:s})=>[n("div",Ia,[t(M,{color:s.available_stock>0?"success":"error",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.available_stock),1)]),_:2},1032,["color"])])]),"item.status":o(({item:s})=>[t(M,{color:a(Ye)(s),variant:"tonal",size:"small"},{default:o(()=>[i(u(a(Ie)(s)),1)]),_:2},1032,["color"])]),"item.station_availability":o(({item:s})=>{var k,m,j,R;return[n("div",Aa,[(k=s.item)!=null&&k.available_in_kitchen?(f(),V(M,{key:0,color:"warning",variant:"tonal",size:"x-small","prepend-icon":"tabler-chef-hat"},{default:o(()=>e[58]||(e[58]=[i(" Kitchen ")])),_:1,__:[58]})):h("",!0),(m=s.item)!=null&&m.available_in_bar?(f(),V(M,{key:1,color:"info",variant:"tonal",size:"x-small","prepend-icon":"tabler-glass-cocktail"},{default:o(()=>e[59]||(e[59]=[i(" Bar ")])),_:1,__:[59]})):h("",!0),!((j=s.item)!=null&&j.available_in_kitchen)&&!((R=s.item)!=null&&R.available_in_bar)?(f(),J("span",$a," Tidak tersedia ")):h("",!0)])]}),"item.reorder_level":o(({item:s})=>[n("div",Ra,u(s.reorder_level||"-"),1)]),"item.average_cost":o(({item:s})=>[n("div",ja,u(a(Te)(s.average_cost)),1)]),"item.stock_value":o(({item:s})=>[n("div",La,u(a(Te)(s.current_stock*s.average_cost)),1)]),"item.actions":o(({item:s})=>[n("div",za,[t(Xe,{text:"Penyesuaian Stok"},{activator:o(({props:k})=>[t(S,Ke(k,{icon:"tabler-adjustments",color:"warning",variant:"text",size:"small",disabled:!s.item,onClick:m=>ct(s)}),null,16,["disabled","onClick"])]),_:2},1024),t(Xe,{text:"Update Stok"},{activator:o(({props:k})=>[t(S,Ke(k,{icon:"tabler-edit",color:"primary",variant:"text",size:"small",onClick:m=>a(Pe)(s)}),null,16,["onClick"])]),_:2},1024),t(Xe,{text:"Set Reorder Level"},{activator:o(({props:k})=>[t(S,Ke(k,{icon:"tabler-settings",color:"info",variant:"text",size:"small",onClick:m=>a(ze)(s)}),null,16,["onClick"])]),_:2},1024),t(Xe,{text:"Lihat Riwayat"},{activator:o(({props:k})=>[t(S,Ke(k,{icon:"tabler-history",color:"secondary",variant:"text",size:"small",onClick:m=>a(Fe)(s)}),null,16,["onClick"])]),_:2},1024)])]),"no-data":o(()=>{var s;return[n("div",Fa,[t(A,{icon:a(l).search||a(l).stock_status!=="all"?"tabler-search-off":"tabler-package-off",size:"64",class:"text-medium-emphasis mb-4"},null,8,["icon"]),n("div",Na,u(a(l).search||a(l).stock_status!=="all"?"Tidak Ada Hasil Pencarian":"Belum Ada Data Inventory"),1),n("div",Ba,[a(l).search||a(l).stock_status!=="all"?(f(),J("span",qa,[a(l).search?(f(),J("span",Oa,[e[60]||(e[60]=i(' Tidak ditemukan inventory dengan kata kunci "')),n("strong",null,u(a(l).search),1),e[61]||(e[61]=i('" '))])):h("",!0),a(l).search&&a(l).stock_status!=="all"?(f(),J("span",Ha," dan ")):h("",!0),a(l).stock_status!=="all"?(f(),J("span",Ka,[e[62]||(e[62]=i(' status stok "')),n("strong",null,u(((s=a(De).find(k=>k.value===a(l).stock_status))==null?void 0:s.title)||a(l).stock_status),1),e[63]||(e[63]=i('" '))])):h("",!0),e[64]||(e[64]=n("br",null,null,-1)),e[65]||(e[65]=i("Coba kata kunci yang berbeda atau hapus filter. "))])):(f(),J("span",Ga,e[66]||(e[66]=[i(" Data inventory akan muncul setelah produk dan variant dibuat."),n("br",null,null,-1),i(" Silakan buat produk terlebih dahulu di menu "),n("strong",null,"Kelola Produk",-1),i(". ")])))]),n("div",Xa,[a(l).search||a(l).stock_status!=="all"?(f(),V(S,{key:0,color:"warning",variant:"outlined","prepend-icon":"tabler-filter-off",onClick:e[13]||(e[13]=k=>a(ve)({search:"",stock_status:"all"}))},{default:o(()=>e[67]||(e[67]=[i(" Hapus Filter ")])),_:1,__:[67]})):(f(),V(S,{key:1,color:"primary","prepend-icon":"tabler-plus",to:"/products-management"},{default:o(()=>e[68]||(e[68]=[i(" Buat Produk Baru ")])),_:1,__:[68]})),t(S,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:e[14]||(e[14]=k=>{a(_e)(),a(xe)(),a(ue)()})},{default:o(()=>e[69]||(e[69]=[i(" Refresh Data ")])),_:1,__:[69]})])])]}),loading:o(()=>[n("div",Ja,[t(rt,{indeterminate:"",color:"primary",size:"40"}),e[70]||(e[70]=n("div",{class:"mt-4 text-medium-emphasis"}," Memuat data inventory... ",-1))])]),_:1},8,["items","loading","items-length","items-per-page","page","onUpdate:page","onUpdate:itemsPerPage"])])]),_:1}),t(Se,{modelValue:a(ee),"onUpdate:modelValue":e[21]||(e[21]=s=>Le(ee)?ee.value=s:null),"max-width":"800px",fullscreen:a(c),persistent:"",class:"stock-dialog"},{default:o(()=>[t(q,null,{default:o(()=>[t(pe,null,{default:o(()=>{var s,k;return[i(" Update Stok - "+u((k=(s=a(Z))==null?void 0:s.product)==null?void 0:k.name),1)]}),_:1}),t(X),t(Je,{onSubmit:Ge(a(Me),["prevent"])},{default:o(()=>[t(K,null,{default:o(()=>[a(re)?(f(),V(le,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":a(H)},{default:o(()=>[i(u(a(re)),1)]),_:1},8,["onClick:close"])):h("",!0),t(ye,null,{default:o(()=>[t(L,{cols:"12",md:"6"},{default:o(()=>[t(St,{modelValue:a(N).movement_type,"onUpdate:modelValue":e[15]||(e[15]=s=>a(N).movement_type=s),label:"Jenis Pergerakan *",items:[{title:"Stock Masuk",value:"stock_in"},{title:"Stock Keluar",value:"stock_out"},{title:"Penyesuaian",value:"adjustment"},{title:"Transfer",value:"transfer"},{title:"Retur",value:"return"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",md:"6"},{default:o(()=>[t(de,{modelValue:a(N).quantity,"onUpdate:modelValue":e[16]||(e[16]=s=>a(N).quantity=s),modelModifiers:{number:!0},label:"Kuantitas *",type:"number",min:"1",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ye,null,{default:o(()=>[t(L,{cols:"12"},{default:o(()=>[t(de,{modelValue:a(N).reason,"onUpdate:modelValue":e[17]||(e[17]=s=>a(N).reason=s),label:"Alasan *",placeholder:"Contoh: Pembelian dari supplier, Penjualan, dll",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ye,null,{default:o(()=>[t(L,{cols:"12",md:"6"},{default:o(()=>[t(de,{modelValue:a(N).reference_number,"onUpdate:modelValue":e[18]||(e[18]=s=>a(N).reference_number=s),label:"Nomor Referensi",placeholder:"PO-001, SO-001, dll",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(L,{cols:"12",md:"6"},{default:o(()=>[t(de,{modelValue:a(N).cost_per_unit,"onUpdate:modelValue":e[19]||(e[19]=s=>a(N).cost_per_unit=s),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",min:"0",step:"0.01",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ye,null,{default:o(()=>[t(L,{cols:"12"},{default:o(()=>[t(nt,{modelValue:a(N).notes,"onUpdate:modelValue":e[20]||(e[20]=s=>a(N).notes=s),label:"Catatan",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(X),t(Ce,{class:"pa-4"},{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:a(Ne)},{default:o(()=>e[71]||(e[71]=[i(" Batal ")])),_:1,__:[71]},8,["onClick"]),t(S,{type:"submit",color:"primary",loading:a(W)},{default:o(()=>e[72]||(e[72]=[i(" Update Stok ")])),_:1,__:[72]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:a(se),"onUpdate:modelValue":e[24]||(e[24]=s=>Le(se)?se.value=s:null),"max-width":"600px",fullscreen:a(c),persistent:"",class:"stock-dialog"},{default:o(()=>[t(q,null,{default:o(()=>[t(pe,null,{default:o(()=>{var s,k;return[i(" Set Reorder Level - "+u((k=(s=a(Z))==null?void 0:s.product)==null?void 0:k.name),1)]}),_:1}),t(X),t(Je,{onSubmit:Ge(a(Ee),["prevent"])},{default:o(()=>[t(K,null,{default:o(()=>[a(re)?(f(),V(le,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":a(H)},{default:o(()=>[i(u(a(re)),1)]),_:1},8,["onClick:close"])):h("",!0),t(ye,null,{default:o(()=>[t(L,{cols:"12"},{default:o(()=>[t(de,{modelValue:a(O).reorder_level,"onUpdate:modelValue":e[22]||(e[22]=s=>a(O).reorder_level=s),modelModifiers:{number:!0},label:"Reorder Level *",type:"number",min:"0",hint:"Stok minimum sebelum perlu restock","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(ye,null,{default:o(()=>[t(L,{cols:"12"},{default:o(()=>[t(de,{modelValue:a(O).max_stock_level,"onUpdate:modelValue":e[23]||(e[23]=s=>a(O).max_stock_level=s),modelModifiers:{number:!0},label:"Max Stock Level",type:"number",min:"0",hint:"Stok maksimum yang diizinkan","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(X),t(Ce,{class:"pa-4"},{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:a(g)},{default:o(()=>e[73]||(e[73]=[i(" Batal ")])),_:1,__:[73]},8,["onClick"]),t(S,{type:"submit",color:"primary",loading:a(W)},{default:o(()=>e[74]||(e[74]=[i(" Simpan ")])),_:1,__:[74]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(na,{modelValue:a(Q),"onUpdate:modelValue":e[25]||(e[25]=s=>Le(Q)?Q.value=s:null),"inventory-id":(P=(w=a(Z))==null?void 0:w.id_inventory)==null?void 0:P.toString(),"inventory-name":(I=(U=a(Z))==null?void 0:U.item)==null?void 0:I.name},null,8,["modelValue","inventory-id","inventory-name"]),t(Se,{modelValue:a(Ue),"onUpdate:modelValue":e[28]||(e[28]=s=>Le(Ue)?Ue.value=s:null),"max-width":"600px",fullscreen:a(c),persistent:"",class:"stock-dialog"},{default:o(()=>[t(q,{class:"stock-movement-dialog coffee-dialog"},{default:o(()=>[t(pe,{class:"d-flex align-center justify-space-between coffee-header"},{default:o(()=>[n("div",Ya,[t(A,{icon:"tabler-adjustments",class:"text-white"}),e[75]||(e[75]=n("span",{class:"text-white"}," Penyesuaian Stok ",-1))]),t(S,{icon:"tabler-x",variant:"text",color:"white",onClick:a(Re)},null,8,["onClick"])]),_:1}),t(X),t(K,{class:"pa-6"},{default:o(()=>[t(Je,{onSubmit:Ge(a(Ae),["prevent"])},{default:o(()=>{var s;return[a(te)?(f(),V(le,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:o(()=>[n("div",Wa,[t(A,{icon:"tabler-package"}),n("div",null,[n("div",Qa,u(a(te).name),1),n("div",Za,u(a(te).item_code),1),n("div",eo,"Stok Saat Ini: "+u(a(te).current_stock)+" "+u(a(te).unit),1)])])]),_:1})):h("",!0),a(Ze)?(f(),V(le,{key:1,type:"error",variant:"outlined",class:"mb-4",text:a(Ze),closable:"","onClick:close":a(it)},null,8,["text","onClick:close"])):h("",!0),t(de,{modelValue:a(B).quantity,"onUpdate:modelValue":e[26]||(e[26]=k=>a(B).quantity=k),modelModifiers:{number:!0},label:"Stok Baru",type:"number",min:"0",step:"0.001",variant:"outlined",suffix:(s=a(te))==null?void 0:s.unit,class:"mb-4",required:""},null,8,["modelValue","suffix"]),t(nt,{modelValue:a(B).notes,"onUpdate:modelValue":e[27]||(e[27]=k=>a(B).notes=k),label:"Catatan (opsional)",variant:"outlined",rows:"3",class:"mb-4"},null,8,["modelValue"]),n("div",to,[t(S,{variant:"outlined",onClick:a(Re)},{default:o(()=>e[76]||(e[76]=[i(" Batal ")])),_:1,__:[76]},8,["onClick"]),t(S,{type:"submit",color:"primary",class:"coffee-primary",loading:a(Qe)},{default:o(()=>e[77]||(e[77]=[i(" Simpan Penyesuaian ")])),_:1,__:[77]},8,["loading"])])]}),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:a($e),"onUpdate:modelValue":e[32]||(e[32]=s=>Le($e)?$e.value=s:null),"max-width":"800px",fullscreen:a(c),persistent:"",class:"stock-dialog"},{default:o(()=>[t(q,{class:"stock-movement-dialog coffee-dialog"},{default:o(()=>[t(pe,{class:"d-flex align-center justify-space-between coffee-header"},{default:o(()=>[n("div",ao,[t(A,{icon:a(B).type==="in"?"tabler-plus":"tabler-minus",class:"text-white"},null,8,["icon"]),n("span",oo,u(a(B).type==="in"?"Stok Masuk":a(B).type==="out"?"Stok Keluar":"Penyesuaian Stok"),1)]),t(S,{icon:"tabler-x",variant:"text",color:"white",onClick:a(Re)},null,8,["onClick"])]),_:1}),t(X),t(K,{class:"pa-6"},{default:o(()=>[t(Je,{onSubmit:Ge(a(Ae),["prevent"])},{default:o(()=>[a(te)?(f(),V(le,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:o(()=>[n("div",so,[t(Tt,{color:"primary",size:"40",variant:"tonal"},{default:o(()=>[t(A,{icon:"tabler-package"})]),_:1}),n("div",null,[n("div",lo,u(a(te).name),1),n("div",no," Stok saat ini: "+u(a(te).current_stock)+" "+u(a(te).unit),1)])])]),_:1})):h("",!0),t(ye,null,{default:o(()=>[t(L,{cols:"12",md:"6"},{default:o(()=>[t(de,{modelValue:a(B).quantity,"onUpdate:modelValue":e[29]||(e[29]=s=>a(B).quantity=s),modelModifiers:{number:!0},label:`Jumlah ${a(B).type==="in"?"Masuk":a(B).type==="out"?"Keluar":"Akhir"}`,type:"number",variant:"outlined",required:"",min:a(B).type==="adjustment"?0:1,rules:[s=>s>0||"Jumlah harus lebih dari 0"]},null,8,["modelValue","label","min","rules"])]),_:1}),t(L,{cols:"12",md:"6"},{default:o(()=>[t(de,{modelValue:a(B).cost_per_unit,"onUpdate:modelValue":e[30]||(e[30]=s=>a(B).cost_per_unit=s),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",variant:"outlined",prefix:"Rp",readonly:a(B).type!=="in"},null,8,["modelValue","readonly"])]),_:1}),t(L,{cols:"12"},{default:o(()=>[t(nt,{modelValue:a(B).notes,"onUpdate:modelValue":e[31]||(e[31]=s=>a(B).notes=s),label:"Catatan",placeholder:"Masukkan catatan untuk pergerakan stok...",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),t(X),t(Ce,{class:"pa-6"},{default:o(()=>[t(Ve),t(S,{variant:"outlined",class:"coffee-secondary",onClick:a(Re)},{default:o(()=>e[78]||(e[78]=[i(" Batal ")])),_:1,__:[78]},8,["onClick"]),t(S,{color:"primary",class:"coffee-primary",loading:a(Qe),onClick:a(Ae)},{default:o(()=>e[79]||(e[79]=[i(" Simpan ")])),_:1,__:[79]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:tt.value,"onUpdate:modelValue":e[34]||(e[34]=s=>tt.value=s),"max-width":"1200px",fullscreen:a(c),persistent:"",class:"upload-history-dialog"},{default:o(()=>[t(q,null,{default:o(()=>[t(pe,{class:"d-flex align-center justify-space-between coffee-header"},{default:o(()=>[n("div",ro,[t(A,{icon:"tabler-history",class:"text-white"}),e[80]||(e[80]=n("span",{class:"text-white"},"Riwayat Upload Data Inventory",-1))]),t(S,{icon:"tabler-x",variant:"text",color:"white",onClick:vt})]),_:1}),t(X),t(K,{class:"pa-6"},{default:o(()=>[ot.value?(f(),J("div",io,[t(rt,{indeterminate:"",color:"primary",size:"40"}),e[81]||(e[81]=n("div",{class:"mt-4 text-medium-emphasis"}," Memuat riwayat upload... ",-1))])):(f(),J("div",uo,[t(Mt,{headers:[{title:"Tanggal Upload",key:"created_at",sortable:!1},{title:"User",key:"user_name",sortable:!1},{title:"Total Items",key:"total_items_processed",sortable:!1},{title:"Berhasil Update",key:"total_items_updated",sortable:!1},{title:"Dilewati",key:"total_items_skipped",sortable:!1},{title:"Total Nilai Stok",key:"total_stock_value",sortable:!1},{title:"Status",key:"upload_status",sortable:!1}],items:at.value,"items-per-page":He.value,class:"elevation-1"},{"item.created_at":o(({item:s})=>[n("div",co,u(new Date(s.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})),1)]),"item.user_name":o(({item:s})=>[n("div",mo,[t(Tt,{size:"32",color:"primary",variant:"tonal"},{default:o(()=>[t(A,{icon:"tabler-user"})]),_:1}),n("div",null,[n("div",po,u(s.user_name||"Unknown User"),1),n("div",_o,u(s.user_email||"-"),1)])])]),"item.total_items_processed":o(({item:s})=>[t(M,{color:"info",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.total_items_processed),1)]),_:2},1024)]),"item.total_items_updated":o(({item:s})=>[t(M,{color:"success",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.total_items_updated),1)]),_:2},1024)]),"item.total_items_skipped":o(({item:s})=>[t(M,{color:s.total_items_skipped>0?"warning":"success",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.total_items_skipped),1)]),_:2},1032,["color"])]),"item.total_stock_value":o(({item:s})=>[n("div",vo,u(a(Te)(s.total_stock_value||0)),1)]),"item.upload_status":o(({item:s})=>[t(M,{color:s.upload_status==="success"?"success":s.upload_status==="failed"?"error":"warning",variant:"tonal",size:"small"},{default:o(()=>[i(u(s.upload_status==="success"?"Berhasil":s.upload_status==="failed"?"Gagal":"Sebagian"),1)]),_:2},1032,["color"])]),"no-data":o(()=>[n("div",ko,[t(A,{icon:"tabler-database-off",size:"64",class:"text-medium-emphasis mb-4"}),e[82]||(e[82]=n("div",{class:"text-h6 text-medium-emphasis mb-2"}," Belum Ada Riwayat Upload ",-1)),e[83]||(e[83]=n("div",{class:"text-body-2 text-medium-emphasis"}," Riwayat upload akan muncul setelah Anda melakukan export data inventory. ",-1))])]),_:1},8,["items","items-per-page"]),st.value>He.value?(f(),J("div",fo,[t(Nt,{modelValue:je.value,"onUpdate:modelValue":[e[33]||(e[33]=s=>je.value=s),It],length:Math.ceil(st.value/He.value),"total-visible":7},null,8,["modelValue","length"])])):h("",!0)]))]),_:1}),t(X),t(Ce,{class:"pa-4"},{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:vt},{default:o(()=>e[84]||(e[84]=[i(" Tutup ")])),_:1,__:[84]}),t(S,{color:"primary","prepend-icon":"tabler-refresh",onClick:_t},{default:o(()=>e[85]||(e[85]=[i(" Refresh ")])),_:1,__:[85]})]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Se,{modelValue:z.value,"onUpdate:modelValue":e[36]||(e[36]=s=>z.value=s),"max-width":"500",persistent:""},{default:o(()=>[t(q,null,{default:o(()=>[t(pe,{class:"d-flex align-center gap-2"},{default:o(()=>[t(A,{icon:"tabler-file-spreadsheet",color:"success"}),e[86]||(e[86]=i(" Export Inventory ke Excel "))]),_:1,__:[86]}),t(X),t(K,null,{default:o(()=>[n("div",go,[e[90]||(e[90]=n("h6",{class:"text-h6 mb-2"},"Filter yang akan diterapkan:",-1)),n("div",yo,[a(l).search?(f(),V(M,{key:0,color:"primary",variant:"tonal",size:"small","prepend-icon":"tabler-search"},{default:o(()=>[i(' Pencarian: "'+u(a(l).search)+'" ',1)]),_:1})):h("",!0),a(l).stock_status&&a(l).stock_status!=="all"?(f(),V(M,{key:1,color:"info",variant:"tonal",size:"small","prepend-icon":"tabler-package"},{default:o(()=>[i(" Status: "+u(a(l).stock_status),1)]),_:1})):h("",!0),a(l).available_in_kitchen?(f(),V(M,{key:2,color:"warning",variant:"tonal",size:"small","prepend-icon":"tabler-chef-hat"},{default:o(()=>e[87]||(e[87]=[i(" Kitchen: Ya ")])),_:1,__:[87]})):h("",!0),a(l).available_in_bar?(f(),V(M,{key:3,color:"info",variant:"tonal",size:"small","prepend-icon":"tabler-glass-cocktail"},{default:o(()=>e[88]||(e[88]=[i(" Bar: Ya ")])),_:1,__:[88]})):h("",!0),!a(l).search&&(!a(l).stock_status||a(l).stock_status==="all")&&!a(l).available_in_kitchen&&!a(l).available_in_bar?(f(),V(M,{key:4,color:"success",variant:"tonal",size:"small","prepend-icon":"tabler-check"},{default:o(()=>e[89]||(e[89]=[i(" Semua Data (Tanpa Filter) ")])),_:1,__:[89]})):h("",!0)])]),t(le,{type:"info",variant:"tonal",class:"mb-4"},{default:o(()=>e[91]||(e[91]=[i(" Data yang akan di-export akan mengikuti filter yang sedang aktif. File Excel akan berisi kolom Station (Kitchen & Bar) untuk setiap item. ")])),_:1,__:[91]})]),_:1}),t(X),t(Ce,null,{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:ke,disabled:r.value},{default:o(()=>e[92]||(e[92]=[i(" Batal ")])),_:1,__:[92]},8,["disabled"]),t(S,{color:"success","prepend-icon":"tabler-file-spreadsheet",loading:r.value,onClick:e[35]||(e[35]=s=>{pt(),ke()})},{default:o(()=>e[93]||(e[93]=[i(" Export ke Excel ")])),_:1,__:[93]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Se,{modelValue:z.value,"onUpdate:modelValue":e[38]||(e[38]=s=>z.value=s),"max-width":"500",persistent:""},{default:o(()=>[t(q,null,{default:o(()=>[t(pe,{class:"d-flex align-center gap-2"},{default:o(()=>[t(A,{icon:"tabler-file-spreadsheet",color:"success"}),e[94]||(e[94]=i(" Export Data ke Excel "))]),_:1,__:[94]}),t(X),t(K,null,{default:o(()=>[n("div",bo,[e[98]||(e[98]=n("h6",{class:"text-h6 mb-2"},"Filter yang akan diterapkan:",-1)),n("div",ho,[a(l).search?(f(),V(M,{key:0,color:"primary",variant:"tonal",size:"small","prepend-icon":"tabler-search"},{default:o(()=>[i(' Pencarian: "'+u(a(l).search)+'" ',1)]),_:1})):h("",!0),a(l).stock_status&&a(l).stock_status!=="all"?(f(),V(M,{key:1,color:"info",variant:"tonal",size:"small","prepend-icon":"tabler-package"},{default:o(()=>[i(" Status: "+u(a(l).stock_status),1)]),_:1})):h("",!0),a(l).available_in_kitchen?(f(),V(M,{key:2,color:"warning",variant:"tonal",size:"small","prepend-icon":"tabler-chef-hat"},{default:o(()=>e[95]||(e[95]=[i(" Kitchen: Ya ")])),_:1,__:[95]})):h("",!0),a(l).available_in_bar?(f(),V(M,{key:3,color:"info",variant:"tonal",size:"small","prepend-icon":"tabler-glass-cocktail"},{default:o(()=>e[96]||(e[96]=[i(" Bar: Ya ")])),_:1,__:[96]})):h("",!0),!a(l).search&&(!a(l).stock_status||a(l).stock_status==="all")&&!a(l).available_in_kitchen&&!a(l).available_in_bar?(f(),V(M,{key:4,color:"success",variant:"tonal",size:"small","prepend-icon":"tabler-database"},{default:o(()=>e[97]||(e[97]=[i(" Semua Data ")])),_:1,__:[97]})):h("",!0)])]),t(le,{type:"info",variant:"tonal",class:"mb-4"},{default:o(()=>e[99]||(e[99]=[i(" Data yang akan di-export sesuai dengan filter yang aktif saat ini. File Excel akan mencakup kolom Station (Kitchen/Bar) untuk setiap item. ")])),_:1,__:[99]})]),_:1}),t(X),t(Ce,null,{default:o(()=>[t(Ve),t(S,{variant:"outlined",onClick:ke},{default:o(()=>e[100]||(e[100]=[i(" Batal ")])),_:1,__:[100]}),t(S,{color:"success",variant:"elevated","prepend-icon":"tabler-download",loading:r.value,onClick:e[37]||(e[37]=s=>{pt(),ke()})},{default:o(()=>e[101]||(e[101]=[i(" Export Excel ")])),_:1,__:[101]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),Zo=Et(xo,[["__scopeId","data-v-10ce1d3b"]]);export{Zo as default};
