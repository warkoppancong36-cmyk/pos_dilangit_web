import{D as Re}from"./DeleteConfirmationDialog-Dmf9WE77.js";import{d as pe,V as T,r as h,w as ve,g as C,f as a,a3 as w,m as i,b as e,l as I,e as r,X as F,t as k,a1 as J,a0 as Le,s as P,o as f,av as Me,_ as $e,c as $,aK as Ie,F as Ke,i as Be,au as X,az as ke,D as je,at as Ve}from"./main-BrYZo8v_.js";import{V as Oe}from"./VDialog-D1UR9B2V.js";import{b as Ge,c as We,V as G}from"./VCard-BCcN2Y5F.js";import{V as xe}from"./VDivider-BYrGSMDW.js";import{V as W}from"./VCardText-Da5DhjGk.js";import{V as He}from"./VForm-C7qDhO8l.js";import{V as ge,a as y}from"./VRow-DwBcOHjA.js";import{V as R}from"./VTextField-l9pi2zb7.js";import{V as Ce}from"./VSelect-Cd-u7Gtn.js";import{V as Se}from"./VTextarea-CJBoVHo9.js";import{V as Xe}from"./VSpacer-LtQU5GW4.js";import{V as qe}from"./VSnackbar-CMPzDyyJ.js";import{V as ie}from"./VChip-DduWfL9g.js";import{V as te}from"./VAvatar-D3pWgnyH.js";import{V as ae}from"./VSkeletonLoader-CurcBWDI.js";import{V as Je}from"./VDataTableServer-CshCx6d_.js";import{V as we}from"./VTooltip-Da0Eb1jW.js";import"./VOverlay-fVFb4DSa.js";import"./forwardRefs-B931MWyl.js";import"./VImg-O5Wk57A_.js";/* empty css              */import"./VList-CuLhVxwK.js";import"./VMenu-Btif2aby.js";import"./VCheckboxBtn-DMS3RnI9.js";import"./VDataTable-C8tcFYgM.js";import"./VTable-BfS2Mnzd.js";import"./filter-BRm599CI.js";const Qe={class:"d-flex align-center justify-space-between"},Ye={class:"d-flex align-center gap-2"},Ze={class:"text-h6 text-white"},et={class:"text-h6 mb-4 d-flex align-center gap-2"},tt={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},at={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},lt={class:"text-h6 mb-4 mt-4 d-flex align-center gap-2"},st={class:"d-flex align-center"},ot={class:"text-subtitle-1"},nt=pe({__name:"SupplierDialog",props:{modelValue:{type:Boolean},supplier:{},loading:{type:Boolean},errorMessage:{},useDialogError:{type:Boolean}},emits:["update:modelValue","save","clear-error","close"],setup(N,{emit:u}){const s=N,b=u,V=T({get:()=>s.modelValue,set:o=>b("update:modelValue",o)}),x=h(""),c=h(""),_=h(""),S=h(""),U=h(""),E=h(""),p=h(""),m=h(""),t=h(""),g=h(""),L=h(""),z=h(""),A=h(""),K=h(""),M=h("active"),Q=T(()=>({code:x.value,name:c.value,email:_.value,phone:S.value,address:U.value,city:E.value,province:p.value,postal_code:m.value,contact_person:t.value,tax_number:g.value,bank_name:L.value,bank_account:z.value,bank_account_name:A.value,notes:K.value,status:M.value}));ve(Q,o=>{},{deep:!0});const O=h(!1),Z=h(),H={code:[o=>!!o||"Kode supplier wajib diisi",o=>o&&o.length>=2||"Kode supplier minimal 2 karakter",o=>o&&o.length<=20||"Kode supplier maksimal 20 karakter"],name:[o=>!!o||"Nama supplier wajib diisi",o=>o&&o.length>=2||"Nama supplier minimal 2 karakter",o=>o&&o.length<=100||"Nama supplier maksimal 100 karakter"],email:[o=>o?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)||"Format email tidak valid":!0],phone:[o=>o?/^[\d\s\-\+\(\)]+$/.test(o)||"Format nomor telepon tidak valid":!0],postal_code:[o=>o?/^\d{5}$/.test(o)||"Kode pos harus 5 digit":!0]},re=[{title:"Aktif",value:"active"},{title:"Nonaktif",value:"inactive"}],Y=T(()=>!!s.supplier),ue=T(()=>Y.value?"Edit Supplier":"Tambah Supplier"),de=T(()=>Y.value?"Update":"Simpan"),le=T(()=>s.errorMessage||null),se=()=>{x.value="",c.value="",_.value="",S.value="",U.value="",E.value="",p.value="",m.value="",t.value="",g.value="",L.value="",z.value="",A.value="",K.value="",M.value="active",Me(()=>{var o;(o=Z.value)==null||o.resetValidation()})};ve(()=>s.supplier,o=>{o?(x.value=o.code,c.value=o.name,_.value=o.email||"",S.value=o.phone||"",U.value=o.address||"",E.value=o.city||"",p.value=o.province||"",m.value=o.postal_code||"",t.value=o.contact_person||"",g.value=o.tax_number||"",L.value=o.bank_name||"",z.value=o.bank_account||"",A.value=o.bank_account_name||"",K.value=o.notes||"",M.value=o.status):se()},{immediate:!0}),ve(V,o=>{o||se()});const oe=async()=>{var n;const{valid:o}=await((n=Z.value)==null?void 0:n.validate());if(o){const d={...Q.value};b("save",d)}},ne=()=>{V.value=!1,b("close")};return(o,n)=>(f(),C(Oe,{modelValue:i(V),"onUpdate:modelValue":n[18]||(n[18]=d=>w(V)?V.value=d:null),"max-width":"900px",persistent:"",scrollable:""},{default:a(()=>[e(G,{class:"supplier-dialog coffee-dialog"},{default:a(()=>[e(Ge,{class:"pa-6 pb-4 coffee-header"},{default:a(()=>[r("div",Qe,[r("div",Ye,[e(F,{icon:i(Y)?"tabler-edit":"tabler-plus",class:"text-white"},null,8,["icon"]),r("span",Ze,k(i(ue)),1)]),e(J,{icon:"tabler-x",variant:"text",color:"white",size:"small",onClick:ne})])]),_:1}),e(xe),e(W,{class:"pa-6"},{default:a(()=>[e(He,{ref_key:"formRef",ref:Z,modelValue:i(O),"onUpdate:modelValue":n[15]||(n[15]=d=>w(O)?O.value=d:null),onSubmit:Le(oe,["prevent"])},{default:a(()=>[e(ge,null,{default:a(()=>[e(y,{cols:"12"},{default:a(()=>[r("h6",et,[e(F,{icon:"tabler-info-circle",size:"20",class:"coffee-icon"}),n[19]||(n[19]=P(" Informasi Dasar "))])]),_:1}),e(y,{cols:"12",md:"4"},{default:a(()=>[e(R,{modelValue:i(x),"onUpdate:modelValue":n[0]||(n[0]=d=>w(x)?x.value=d:null),label:"Kode Supplier *",rules:H.code,disabled:i(Y),placeholder:"Masukkan kode supplier",variant:"outlined"},null,8,["modelValue","rules","disabled"])]),_:1}),e(y,{cols:"12",md:"8"},{default:a(()=>[e(R,{modelValue:i(c),"onUpdate:modelValue":n[1]||(n[1]=d=>w(c)?c.value=d:null),label:"Nama Supplier *",rules:H.name,placeholder:"Masukkan nama supplier",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12",md:"6"},{default:a(()=>[e(R,{modelValue:i(_),"onUpdate:modelValue":n[2]||(n[2]=d=>w(_)?_.value=d:null),label:"Email",rules:H.email,placeholder:"supplier@email.com",type:"email",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12",md:"6"},{default:a(()=>[e(R,{modelValue:i(S),"onUpdate:modelValue":n[3]||(n[3]=d=>w(S)?S.value=d:null),label:"Nomor Telepon",rules:H.phone,placeholder:"08123456789",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12",md:"8"},{default:a(()=>[e(R,{modelValue:i(t),"onUpdate:modelValue":n[4]||(n[4]=d=>w(t)?t.value=d:null),label:"Nama Kontak",placeholder:"Nama person in charge",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:a(()=>[e(Ce,{modelValue:i(M),"onUpdate:modelValue":n[5]||(n[5]=d=>w(M)?M.value=d:null),label:"Status *",items:re,"item-title":"title","item-value":"value",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:a(()=>[r("h6",tt,[e(F,{icon:"tabler-map-pin",size:"20",class:"coffee-icon"}),n[20]||(n[20]=P(" Informasi Alamat "))])]),_:1}),e(y,{cols:"12"},{default:a(()=>[e(Se,{modelValue:i(U),"onUpdate:modelValue":n[6]||(n[6]=d=>w(U)?U.value=d:null),label:"Alamat",placeholder:"Masukkan alamat lengkap",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:a(()=>[e(R,{modelValue:i(E),"onUpdate:modelValue":n[7]||(n[7]=d=>w(E)?E.value=d:null),label:"Kota",placeholder:"Nama kota",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:a(()=>[e(R,{modelValue:i(p),"onUpdate:modelValue":n[8]||(n[8]=d=>w(p)?p.value=d:null),label:"Provinsi",placeholder:"Nama provinsi",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"4"},{default:a(()=>[e(R,{modelValue:i(m),"onUpdate:modelValue":n[9]||(n[9]=d=>w(m)?m.value=d:null),label:"Kode Pos",rules:H.postal_code,placeholder:"12345",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:a(()=>[r("h6",at,[e(F,{icon:"tabler-credit-card",size:"20",class:"coffee-icon"}),n[21]||(n[21]=P(" Informasi Keuangan "))])]),_:1}),e(y,{cols:"12",md:"6"},{default:a(()=>[e(R,{modelValue:i(g),"onUpdate:modelValue":n[10]||(n[10]=d=>w(g)?g.value=d:null),label:"NPWP",placeholder:"Nomor NPWP",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:a(()=>[e(R,{modelValue:i(L),"onUpdate:modelValue":n[11]||(n[11]=d=>w(L)?L.value=d:null),label:"Nama Bank",placeholder:"Nama bank",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:a(()=>[e(R,{modelValue:i(z),"onUpdate:modelValue":n[12]||(n[12]=d=>w(z)?z.value=d:null),label:"Nomor Rekening",placeholder:"Nomor rekening bank",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"6"},{default:a(()=>[e(R,{modelValue:i(A),"onUpdate:modelValue":n[13]||(n[13]=d=>w(A)?A.value=d:null),label:"Nama Pemilik Rekening",placeholder:"Nama pemilik rekening",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(y,{cols:"12"},{default:a(()=>[r("h6",lt,[e(F,{icon:"tabler-notes",size:"20",class:"coffee-icon"}),n[22]||(n[22]=P(" Informasi Tambahan "))])]),_:1}),e(y,{cols:"12"},{default:a(()=>[e(Se,{modelValue:i(K),"onUpdate:modelValue":n[14]||(n[14]=d=>w(K)?K.value=d:null),label:"Catatan",placeholder:"Catatan tambahan tentang supplier",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(xe),e(We,{class:"pa-6"},{default:a(()=>[e(Xe),e(J,{color:"secondary",variant:"outlined",class:"coffee-secondary",onClick:ne},{default:a(()=>n[23]||(n[23]=[P(" Batal ")])),_:1,__:[23]}),e(J,{color:"primary",class:"coffee-primary",loading:o.loading,disabled:!i(O),onClick:oe},{default:a(()=>[P(k(i(de)),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),o.useDialogError?I("",!0):(f(),C(qe,{key:0,"model-value":!!i(le),"onUpdate:modelValue":n[17]||(n[17]=d=>!d&&o.$emit("clear-error")),color:"error",location:"top right",timeout:6e3,vertical:"","multi-line":"","min-width":"320","max-width":"500",class:"coffee-error"},{actions:a(()=>[e(J,{icon:"tabler-x",size:"small",variant:"text",onClick:n[16]||(n[16]=d=>o.$emit("clear-error"))})]),default:a(()=>[r("div",st,[e(F,{icon:"tabler-alert-circle",class:"me-3",size:"28"}),r("div",null,[n[24]||(n[24]=r("div",{class:"text-h6 font-weight-bold"},"Error!",-1)),r("div",ot,k(i(le)),1)])])]),_:1},8,["model-value"]))]),_:1},8,["modelValue"]))}}),it=$e(nt,[["__scopeId","data-v-ac306eff"]]),rt={class:"d-flex gap-2"},ut={key:0,class:"mt-4"},dt={class:"d-flex align-center gap-2 flex-wrap"},ct=pe({__name:"SupplierSearchFilters",props:{filters:{},loading:{type:Boolean,default:!1}},emits:["update:filters","search","reset"],setup(N,{emit:u}){let s=null;const b=(m,t=500)=>{s&&clearTimeout(s),s=setTimeout(m,t)},V=N,x=u,c=h({...V.filters});ve(()=>V.filters,m=>{c.value={...m}},{deep:!0});const _=(m,t)=>{c.value[m]=t,m!=="search"?x("update:filters",{...c.value}):b(()=>{x("update:filters",{...c.value})})},S=()=>{x("search")},U=()=>{const m={search:"",status:void 0,city:"",province:""};c.value={...m},x("update:filters",m),x("reset")},E=[{title:"Semua Status",value:void 0},{title:"Aktif",value:"active"},{title:"Nonaktif",value:"inactive"}],p=T(()=>!!(c.value.search||c.value.status||c.value.city||c.value.province));return(m,t)=>(f(),C(G,null,{default:a(()=>[e(W,null,{default:a(()=>[e(ge,null,{default:a(()=>[e(y,{cols:"12",md:"4"},{default:a(()=>[e(R,{modelValue:c.value.search,"onUpdate:modelValue":[t[0]||(t[0]=g=>c.value.search=g),t[1]||(t[1]=g=>_("search",g))],placeholder:"Cari nama, kode, atau email supplier...","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined",onKeydown:Ie(S,["enter"]),"onClick:clear":t[2]||(t[2]=g=>{_("search",""),S()})},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:a(()=>[e(Ce,{modelValue:c.value.status,"onUpdate:modelValue":[t[3]||(t[3]=g=>c.value.status=g),t[4]||(t[4]=g=>_("status",g))],items:E,"item-title":"title","item-value":"value",placeholder:"Status",variant:"outlined",clearable:""},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:a(()=>[e(R,{modelValue:c.value.city,"onUpdate:modelValue":[t[5]||(t[5]=g=>c.value.city=g),t[6]||(t[6]=g=>_("city",g))],placeholder:"Kota",variant:"outlined",clearable:"","onClick:clear":t[7]||(t[7]=g=>_("city",""))},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:a(()=>[e(R,{modelValue:c.value.province,"onUpdate:modelValue":[t[8]||(t[8]=g=>c.value.province=g),t[9]||(t[9]=g=>_("province",g))],placeholder:"Provinsi",variant:"outlined",clearable:"","onClick:clear":t[10]||(t[10]=g=>_("province",""))},null,8,["modelValue"])]),_:1}),e(y,{cols:"12",md:"2"},{default:a(()=>[r("div",rt,[e(J,{color:"primary",loading:m.loading,onClick:S},{default:a(()=>[e(F,{icon:"tabler-search"}),t[15]||(t[15]=P(" Cari "))]),_:1,__:[15]},8,["loading"]),p.value?(f(),C(J,{key:0,variant:"outlined",color:"secondary",onClick:U},{default:a(()=>[e(F,{icon:"tabler-x"}),t[16]||(t[16]=P(" Reset "))]),_:1,__:[16]})):I("",!0)])]),_:1})]),_:1}),p.value?(f(),$("div",ut,[r("div",dt,[t[17]||(t[17]=r("span",{class:"text-caption text-medium-emphasis"},"Filter aktif:",-1)),c.value.search?(f(),C(ie,{key:0,size:"small",closable:"","onClick:close":t[11]||(t[11]=g=>_("search",""))},{default:a(()=>[P(" Pencarian: "+k(c.value.search),1)]),_:1})):I("",!0),c.value.status?(f(),C(ie,{key:1,size:"small",closable:"","onClick:close":t[12]||(t[12]=g=>_("status",void 0))},{default:a(()=>[P(" Status: "+k(c.value.status==="active"?"Aktif":"Nonaktif"),1)]),_:1})):I("",!0),c.value.city?(f(),C(ie,{key:2,size:"small",closable:"","onClick:close":t[13]||(t[13]=g=>_("city",""))},{default:a(()=>[P(" Kota: "+k(c.value.city),1)]),_:1})):I("",!0),c.value.province?(f(),C(ie,{key:3,size:"small",closable:"","onClick:close":t[14]||(t[14]=g=>_("province",""))},{default:a(()=>[P(" Provinsi: "+k(c.value.province),1)]),_:1})):I("",!0)])])):I("",!0)]),_:1})]),_:1}))}}),pt={class:"d-flex align-center"},mt={class:"text-h6 font-weight-semibold"},vt={key:1},ft={class:"d-flex align-center"},gt={class:"text-h6 font-weight-semibold"},ht={key:1},_t={class:"d-flex align-center"},bt={class:"text-h6 font-weight-semibold"},yt={key:1},kt={class:"d-flex align-center"},Vt={class:"text-h6 font-weight-semibold"},xt={key:1},St={class:"d-flex align-center"},wt={class:"text-h6 font-weight-semibold"},$t={key:1},Ct={class:"d-flex align-center"},Pt={class:"text-h6 font-weight-semibold"},Ut={key:1},Et=pe({__name:"SupplierStatsCards",props:{stats:{},loading:{type:Boolean,default:!1}},setup(N){return(u,s)=>(f(),C(ge,null,{default:a(()=>[e(y,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(G,null,{default:a(()=>[e(W,null,{default:a(()=>[r("div",pt,[e(te,{color:"primary",variant:"tonal",size:"42",class:"me-3"},{default:a(()=>[e(F,{icon:"tabler-building-store"})]),_:1}),r("div",null,[s[0]||(s[0]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Supplier",-1)),r("h6",mt,[u.loading?(f(),C(ae,{key:0,type:"text",width:"60"})):(f(),$("span",vt,k(u.stats.total_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(G,null,{default:a(()=>[e(W,null,{default:a(()=>[r("div",ft,[e(te,{color:"success",variant:"tonal",size:"42",class:"me-3"},{default:a(()=>[e(F,{icon:"tabler-check"})]),_:1}),r("div",null,[s[1]||(s[1]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Supplier Aktif",-1)),r("h6",gt,[u.loading?(f(),C(ae,{key:0,type:"text",width:"60"})):(f(),$("span",ht,k(u.stats.active_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(G,null,{default:a(()=>[e(W,null,{default:a(()=>[r("div",_t,[e(te,{color:"info",variant:"tonal",size:"42",class:"me-3"},{default:a(()=>[e(F,{icon:"tabler-shopping-cart"})]),_:1}),r("div",null,[s[2]||(s[2]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Dengan Pembelian",-1)),r("h6",bt,[u.loading?(f(),C(ae,{key:0,type:"text",width:"60"})):(f(),$("span",yt,k(u.stats.suppliers_with_purchases.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(G,null,{default:a(()=>[e(W,null,{default:a(()=>[r("div",kt,[e(te,{color:"warning",variant:"tonal",size:"42",class:"me-3"},{default:a(()=>[e(F,{icon:"tabler-map-pin"})]),_:1}),r("div",null,[s[3]||(s[3]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Kota",-1)),r("h6",Vt,[u.loading?(f(),C(ae,{key:0,type:"text",width:"60"})):(f(),$("span",xt,k(u.stats.total_cities.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(G,null,{default:a(()=>[e(W,null,{default:a(()=>[r("div",St,[e(te,{color:"error",variant:"tonal",size:"42",class:"me-3"},{default:a(()=>[e(F,{icon:"tabler-x"})]),_:1}),r("div",null,[s[4]||(s[4]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Supplier Nonaktif",-1)),r("h6",wt,[u.loading?(f(),C(ae,{key:0,type:"text",width:"60"})):(f(),$("span",$t,k(u.stats.inactive_suppliers.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1}),e(y,{cols:"12",sm:"6",md:"3"},{default:a(()=>[e(G,null,{default:a(()=>[e(W,null,{default:a(()=>[r("div",Ct,[e(te,{color:"secondary",variant:"tonal",size:"42",class:"me-3"},{default:a(()=>[e(F,{icon:"tabler-map"})]),_:1}),r("div",null,[s[5]||(s[5]=r("p",{class:"text-caption text-medium-emphasis mb-1"},"Total Provinsi",-1)),r("h6",Pt,[u.loading?(f(),C(ae,{key:0,type:"text",width:"60"})):(f(),$("span",Ut,k(u.stats.total_provinces.toLocaleString()),1))])])])]),_:1})]),_:1})]),_:1})]),_:1}))}}),Dt={class:"font-weight-medium"},Ft={class:"d-flex align-center"},Nt={class:"text-sm font-weight-medium"},At={class:"font-weight-medium"},Tt={key:0,class:"text-caption text-medium-emphasis"},zt=["href"],Rt={key:1,class:"text-medium-emphasis"},Lt=["href"],Mt={key:1,class:"text-medium-emphasis"},It={key:0},Kt={key:0,class:"font-weight-medium"},Bt={key:1,class:"text-caption text-medium-emphasis"},jt={key:1,class:"text-medium-emphasis"},Ot={class:"d-flex gap-1"},Gt={class:"text-center py-8"},Wt=pe({__name:"SupplierTable",props:{suppliers:{},loading:{type:Boolean,default:!1},totalItems:{default:0},page:{default:1},itemsPerPage:{default:10}},emits:["edit","delete","update:page","update:itemsPerPage","sort"],setup(N,{emit:u}){const s=u,b=[{title:"Kode",key:"code",sortable:!0},{title:"Nama",key:"name",sortable:!0},{title:"Email",key:"email",sortable:!0},{title:"Telepon",key:"phone",sortable:!1},{title:"Kota",key:"city",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Aksi",key:"actions",sortable:!1,align:"center"}],V=p=>p==="active"?"success":"error",x=p=>p==="active"?"Aktif":"Nonaktif",c=p=>{s("edit",p)},_=p=>{s("delete",p)},S=p=>{s("update:page",p)},U=p=>{s("update:itemsPerPage",p)},E=p=>{if(p&&p.length>0){const m=p[0],t=m.order==="desc"?"-":"";s("sort",`${t}${m.key}`)}};return(p,m)=>(f(),C(G,null,{default:a(()=>[e(W,{class:"pa-0"},{default:a(()=>[e(Je,{page:p.page,"items-per-page":p.itemsPerPage,headers:b,items:p.suppliers,"items-length":p.totalItems,loading:p.loading,"items-per-page-options":[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],"loading-text":"Memuat data supplier...","no-data-text":"Tidak ada data supplier","items-per-page-text":"Supplier per halaman:","page-text":"{0}-{1} dari {2}",class:"text-no-wrap","onUpdate:page":S,"onUpdate:itemsPerPage":U,"onUpdate:sortBy":E},{"item.code":a(({item:t})=>[r("div",Dt,k(t.code),1)]),"item.name":a(({item:t})=>[r("div",Ft,[e(te,{size:"32",color:"primary",variant:"tonal",class:"me-3"},{default:a(()=>[r("span",Nt,k(t.name.charAt(0).toUpperCase()),1)]),_:2},1024),r("div",null,[r("div",At,k(t.name),1),t.contact_person?(f(),$("div",Tt,k(t.contact_person),1)):I("",!0)])])]),"item.email":a(({item:t})=>[t.email?(f(),$("a",{key:0,href:`mailto:${t.email}`,class:"text-decoration-none"},k(t.email),9,zt)):(f(),$("span",Rt,"-"))]),"item.phone":a(({item:t})=>[t.phone?(f(),$("a",{key:0,href:`tel:${t.phone}`,class:"text-decoration-none"},k(t.phone),9,Lt)):(f(),$("span",Mt,"-"))]),"item.city":a(({item:t})=>[t.city||t.province?(f(),$("div",It,[t.city?(f(),$("div",Kt,k(t.city),1)):I("",!0),t.province?(f(),$("div",Bt,k(t.province),1)):I("",!0)])):(f(),$("span",jt,"-"))]),"item.status":a(({item:t})=>[e(ie,{color:V(t.status),variant:"tonal",size:"small"},{default:a(()=>[P(k(x(t.status)),1)]),_:2},1032,["color"])]),"item.actions":a(({item:t})=>[r("div",Ot,[e(J,{icon:"",size:"small",color:"primary",variant:"text",onClick:g=>c(t)},{default:a(()=>[e(F,{icon:"tabler-edit"}),e(we,{activator:"parent",location:"top"},{default:a(()=>m[0]||(m[0]=[P(" Edit Supplier ")])),_:1,__:[0]})]),_:2},1032,["onClick"]),e(J,{icon:"",size:"small",color:"error",variant:"text",onClick:g=>_(t)},{default:a(()=>[e(F,{icon:"tabler-trash"}),e(we,{activator:"parent",location:"top"},{default:a(()=>m[1]||(m[1]=[P(" Hapus Supplier ")])),_:1,__:[1]})]),_:2},1032,["onClick"])])]),loading:a(()=>[(f(),$(Ke,null,Be(5,t=>e(ae,{key:t,type:"table-row",class:"border-b"})),64))]),"no-data":a(()=>[r("div",Gt,[e(F,{icon:"tabler-building-store",size:"48",class:"text-medium-emphasis mb-4"}),m[2]||(m[2]=r("div",{class:"text-h6 mb-2"},"Tidak ada data supplier",-1)),m[3]||(m[3]=r("p",{class:"text-medium-emphasis mb-0"}," Silakan tambah supplier baru atau ubah filter pencarian ",-1))])]),_:1},8,["page","items-per-page","items","items-length","loading"])]),_:1})]),_:1}))}}),q="/api/suppliers";class j{static async getAll(u={}){var s;try{const b=new URLSearchParams;Object.entries(u).forEach(([c,_])=>{_!=null&&_!==""&&b.append(c,String(_))});const V=`${q}?${b.toString()}`;return(await X.get(V)).data}catch(b){throw console.error("SuppliersApi.getAll error:",b),((s=b.response)==null?void 0:s.data)||{success:!1,message:"Failed to fetch suppliers"}}}static async getById(u){var s;try{return(await X.get(`${q}/${u}`)).data}catch(b){throw((s=b.response)==null?void 0:s.data)||{success:!1,message:"Failed to fetch supplier"}}}static async create(u){var s;try{return(await X.post(q,u)).data}catch(b){throw((s=b.response)==null?void 0:s.data)||{success:!1,message:"Failed to create supplier"}}}static async update(u,s){var b;try{return(await X.put(`${q}/${u}`,s)).data}catch(V){throw((b=V.response)==null?void 0:b.data)||{success:!1,message:"Failed to update supplier"}}}static async delete(u){var s;try{return(await X.delete(`${q}/${u}`)).data}catch(b){throw((s=b.response)==null?void 0:s.data)||{success:!1,message:"Failed to delete supplier"}}}static async toggleActive(u){var s;try{return(await X.put(`${q}/${u}/toggle-active`)).data}catch(b){throw((s=b.response)==null?void 0:s.data)||{success:!1,message:"Failed to toggle supplier status"}}}static async getStats(){var u;try{return(await X.get(`${q}/stats`)).data}catch(s){throw((u=s.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch supplier statistics"}}}static async getCities(){var u;try{return(await X.get(`${q}/cities`)).data}catch(s){throw((u=s.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch cities"}}}static async getProvinces(){var u;try{return(await X.get(`${q}/provinces`)).data}catch(s){throw((u=s.response)==null?void 0:u.data)||{success:!1,message:"Failed to fetch provinces"}}}static validateEmail(u){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)?{valid:!0}:{valid:!1,error:"Please enter a valid email address"}}static validatePhone(u){return/^[\+]?[\d\s\-\(\)]{7,20}$/.test(u)?{valid:!0}:{valid:!1,error:"Please enter a valid phone number"}}static validateCode(u){return u.length<3?{valid:!1,error:"Supplier code must be at least 3 characters"}:u.length>50?{valid:!1,error:"Supplier code must not exceed 50 characters"}:{valid:!0}}}const Ht=()=>{const N=h([]),u=h([]),s=h([]),b=h(!1),V=h(!1),x=h(!1),c=h({}),_=h({total_suppliers:0,active_suppliers:0,inactive_suppliers:0,suppliers_with_purchases:0,total_cities:0,total_provinces:0}),S=h(!1),U=h(!1),E=h(!1),p=h(null),m=h([]),t=h(1),g=h(0),L=h(15),z=ke({search:"",status:void 0,city:"",province:"",sort_by:"created_at",sort_order:"desc"}),A=h(""),K=h(""),M=h(""),Q=ke({name:"",code:"",contact_person:"",phone:"",email:"",address:"",city:"",province:"",postal_code:"",tax_number:"",bank_name:"",bank_account:"",bank_account_name:"",status:"active",notes:""}),O=[l=>!!l||"Nama supplier wajib diisi",l=>l.length>=2||"Nama supplier minimal 2 karakter",l=>l.length<=255||"Nama supplier maksimal 255 karakter"],Z=[l=>{if(!l)return!0;const v=j.validateCode(l);return v.valid||v.error}],H=[l=>{if(!l)return!0;const v=j.validateEmail(l);return v.valid||v.error}],re=[l=>{if(!l)return!0;const v=j.validatePhone(l);return v.valid||v.error}],Y=T(()=>!0),ue=T(()=>!0),de=T(()=>_.value.active_suppliers),le=T(()=>_.value.inactive_suppliers),se=T(()=>_.value.suppliers_with_purchases),oe=T(()=>_.value.total_cities),ne=T(()=>_.value.total_provinces),o=T(()=>m.value.length>0),n=T(()=>N.value.length),d=async()=>{var l;try{b.value=!0,A.value="";const v={...z,page:t.value,per_page:L.value};Object.keys(v).forEach(ce=>{(v[ce]===""||v[ce]==="all")&&delete v[ce]}),console.log("ðŸ” Fetching suppliers with params:",v);const B=await j.getAll(v);if(console.log("ðŸ“Š API Response:",{success:B.success,dataLength:((l=B.data)==null?void 0:l.length)||0,pagination:B.pagination}),B.success)N.value=B.data,B.pagination&&(g.value=B.pagination.total,t.value=B.pagination.current_page,console.log("âœ… Pagination updated:",{total:g.value,currentPage:t.value,itemsPerPage:L.value}));else throw new Error(B.message)}catch(v){console.error("âŒ Error fetching suppliers:",v),A.value=v.message||"Gagal mengambil data supplier",N.value=[]}finally{b.value=!1}},fe=async()=>{try{const l=await j.getCities();l.success&&(u.value=l.data)}catch(l){console.error("Error fetching cities:",l)}},he=async()=>{try{const l=await j.getProvinces();l.success&&(s.value=l.data)}catch(l){console.error("Error fetching provinces:",l)}},D=async()=>{try{const l=await j.getStats();l.success&&(_.value=l.data)}catch(l){console.error("Error fetching stats:",l)}},me=async l=>{try{V.value=!0,M.value="";let v;if(E.value&&p.value?v=await j.update(p.value.id_supplier,l):v=await j.create(l),v.success)K.value=v.message||"Supplier saved successfully",_e(),await d(),await D();else throw new Error(v.message)}catch(v){console.error("Error saving supplier:",v),M.value=v.errors||v.message}finally{V.value=!1}},ee=async()=>{if(p.value)try{x.value=!0;const l=await j.delete(p.value.id_supplier);if(l.success)K.value=l.message,U.value=!1,await d(),await D();else throw new Error(l.message)}catch(l){console.error("Error deleting supplier:",l),A.value=l.message||"Gagal menghapus supplier"}finally{x.value=!1}},Pe=async l=>{try{c.value[l.id_supplier]=!0;const v=await j.toggleActive(l.id_supplier);if(v.success){const B=N.value.findIndex(ce=>ce.id_supplier===l.id_supplier);B!==-1&&(N.value[B]=v.data),await D()}else throw new Error(v.message)}catch(v){console.error("Error toggling active status:",v),A.value=v.message||"Gagal mengubah status supplier"}finally{c.value[l.id]=!1}},Ue=()=>{E.value=!1,p.value=null,be(),S.value=!0},Ee=l=>{E.value=!0,p.value=l,Fe(l),S.value=!0},De=l=>{p.value=l,U.value=!0},_e=()=>{S.value=!1,M.value="",be()},be=()=>{Object.assign(Q,{name:"",code:"",contact_person:"",phone:"",email:"",address:"",city:"",province:"",postal_code:"",tax_number:"",payment_terms:null,active:!0,notes:""})},Fe=l=>{Object.assign(Q,{name:l.name,code:l.code||"",contact_person:l.contact_person||"",phone:l.phone||"",email:l.email||"",address:l.address||"",city:l.city||"",province:l.province||"",postal_code:l.postal_code||"",tax_number:l.tax_number||"",bank_name:l.bank_name||"",bank_account:l.bank_account||"",bank_account_name:l.bank_account_name||"",status:l.status,notes:l.notes||""})},Ne=()=>{M.value=""},Ae=l=>{console.log("ðŸ”„ Page change triggered:",{from:t.value,to:l}),t.value=l,d()},Te=l=>{console.log("ðŸ“„ Items per page change triggered:",{from:L.value,to:l}),L.value=l,t.value=1,d()},ze=()=>{t.value=1,d()},ye=()=>{t.value=1,d()};return{suppliersList:N,cities:u,provinces:s,loading:b,saveLoading:V,deleteLoading:x,toggleLoading:c,stats:_,dialog:S,deleteDialog:U,editMode:E,selectedSupplier:p,selectedSuppliers:m,currentPage:t,totalItems:g,itemsPerPage:L,filters:z,errorMessage:A,successMessage:K,modalErrorMessage:M,formData:Q,nameRules:O,codeRules:Z,emailRules:H,phoneRules:re,canCreateEdit:Y,canDelete:ue,totalActiveSuppliers:de,totalInactiveSuppliers:le,totalSuppliersWithPurchases:se,totalCities:oe,totalProvinces:ne,hasSelectedSuppliers:o,filteredSuppliersCount:n,fetchSuppliersList:d,fetchCities:fe,fetchProvinces:he,fetchStats:D,saveSupplier:me,deleteSupplier:ee,toggleActiveStatus:Pe,openCreateDialog:Ue,openEditDialog:Ee,openDeleteDialog:De,closeDialog:_e,clearModalError:Ne,onPageChange:Ae,onItemsPerPageChange:Te,onSearch:ze,onFilterChange:ye,handleFiltersUpdate:l=>{Object.assign(z,l),ye()},onSortChange:()=>{t.value=1,d()},resetFilters:()=>{Object.assign(z,{search:"",active:"all",city:"",province:"",sort_by:"created_at",sort_order:"desc"}),t.value=1,d()},toggleSupplierSelection:l=>{const v=m.value.indexOf(l);v>-1?m.value.splice(v,1):m.value.push(l)},selectAllSuppliers:()=>{m.value.length===N.value.length?m.value=[]:m.value=N.value.map(l=>l.id)}}},Xt={class:"supplier-management"},qt={class:"d-flex justify-space-between align-center mb-6"},Jt={class:"d-flex gap-3 align-center"},Qt={key:0,class:"d-flex gap-2"},Yt=pe({__name:"suppliers-management",setup(N){const{suppliersList:u,cities:s,provinces:b,loading:V,saveLoading:x,deleteLoading:c,stats:_,dialog:S,deleteDialog:U,selectedSupplier:E,selectedSuppliers:p,currentPage:m,totalItems:t,itemsPerPage:g,filters:L,errorMessage:z,successMessage:A,modalErrorMessage:K,canCreateEdit:M,hasSelectedSuppliers:Q,fetchSuppliersList:O,fetchCities:Z,fetchProvinces:H,fetchStats:re,saveSupplier:Y,deleteSupplier:ue,openCreateDialog:de,openEditDialog:le,openDeleteDialog:se,closeDialog:oe,clearModalError:ne,onPageChange:o,onItemsPerPageChange:n,handleFiltersUpdate:d}=Ht(),fe=async()=>{await ue()};return je(()=>{O(),Z(),H(),re()}),(he,D)=>{var me;return f(),$("div",Xt,[r("div",qt,[D[5]||(D[5]=r("div",null,[r("h1",{class:"text-h4 font-weight-bold coffee-title"},"Kelola Supplier"),r("p",{class:"text-body-1 text-medium-emphasis coffee-subtitle"},"Kelola data supplier dan vendor untuk coffee shop Anda")],-1)),r("div",Jt,[i(Q)?(f(),$("div",Qt,[e(ie,{color:"primary",size:"small"},{default:a(()=>[P(k(i(p).length)+" dipilih ",1)]),_:1})])):I("",!0),i(M)?(f(),C(J,{key:1,color:"primary",variant:"elevated","prepend-icon":"tabler-plus",onClick:i(de)},{default:a(()=>D[4]||(D[4]=[P(" Tambah Supplier ")])),_:1,__:[4]},8,["onClick"])):I("",!0)])]),e(Et,{stats:i(_),loading:i(V),class:"mb-6"},null,8,["stats","loading"]),e(ct,{filters:i(L),cities:i(s),provinces:i(b),loading:i(V),"onUpdate:filters":i(d),onSearch:i(O),onReset:i(O),class:"mb-6"},null,8,["filters","cities","provinces","loading","onUpdate:filters","onSearch","onReset"]),i(A)?(f(),C(Ve,{key:0,type:"success",variant:"tonal",closable:"",class:"mb-4","onClick:close":D[0]||(D[0]=ee=>A.value="")},{default:a(()=>[P(k(i(A)),1)]),_:1})):I("",!0),i(z)?(f(),C(Ve,{key:1,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":D[1]||(D[1]=ee=>z.value="")},{default:a(()=>[P(k(i(z)),1)]),_:1})):I("",!0),e(G,null,{default:a(()=>[e(W,{class:"pa-0"},{default:a(()=>[e(Wt,{suppliers:i(u),loading:i(V),page:i(m),"total-items":i(t),"items-per-page":i(g),onEdit:i(le),onDelete:i(se),"onUpdate:page":i(o),"onUpdate:itemsPerPage":i(n)},null,8,["suppliers","loading","page","total-items","items-per-page","onEdit","onDelete","onUpdate:page","onUpdate:itemsPerPage"])]),_:1})]),_:1}),e(it,{modelValue:i(S),"onUpdate:modelValue":D[2]||(D[2]=ee=>w(S)?S.value=ee:null),supplier:i(E),loading:i(x),"error-message":i(K),onSave:i(Y),onClose:i(oe),onClearError:i(ne)},null,8,["modelValue","supplier","loading","error-message","onSave","onClose","onClearError"]),e(Re,{modelValue:i(U),"onUpdate:modelValue":D[3]||(D[3]=ee=>w(U)?U.value=ee:null),loading:i(c),"item-name":(me=i(E))==null?void 0:me.name,"item-type":"supplier",onConfirm:fe},null,8,["modelValue","loading","item-name"])])}}}),Fa=$e(Yt,[["__scopeId","data-v-8c820701"]]);export{Fa as default};
