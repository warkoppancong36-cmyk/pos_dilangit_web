import{P as I}from"./PosApi-BGEDF-WL.js";import{V as B}from"./VDialog-Bhp3hX5c.js";import{V as c,b as v,c as N}from"./VCard-ClTaGNHA.js";import{d as ee,r as E,V,c as u,b as l,f as s,F as x,o as d,g as b,l as m,e as t,X as D,t as o,a0 as f,s as n,i as F}from"./main-Zoz8G3iK.js";import{V as R}from"./VDivider-CwmDf8YG.js";import{V as g}from"./VCardText-C3e7aZZ6.js";import{V as te,a as A}from"./VRow-CvB2l25_.js";import{V as P}from"./VChip-BePLW_MX.js";import{V as z}from"./VTable-e5OLYXH2.js";import{V as ae}from"./VImg-5xAUFdyg.js";import{V as q}from"./VSpacer-R6xMY3r9.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VOverlay-CNn-LojS.js";import"./forwardRefs-B931MWyl.js";import"./VAvatar-BS_lb2Y2.js";/* empty css              */const se={class:"d-flex align-center gap-2"},re={class:"text-white"},oe={class:"info-item"},ne={class:"value"},de={class:"info-item"},ie={class:"info-item"},ue={class:"value"},me={class:"info-item"},pe={class:"value"},ce={key:0},fe={class:"info-item"},ge={class:"value"},_e={class:"info-item"},ve={class:"value"},be={class:"info-item"},ye={class:"value"},ke={key:1,class:"text-center text-medium-emphasis"},Ve={class:"d-flex align-center"},we={class:"font-weight-medium"},Ce={key:0,class:"text-caption text-medium-emphasis"},xe={class:"text-center"},De={class:"text-right"},Pe={class:"text-right font-weight-medium"},Se={class:"summary-row"},Te={key:0,class:"summary-row text-success"},he={key:1,class:"summary-row"},Oe={class:"summary-row total-row"},Ie={class:"text-h6 text-primary font-weight-bold"},Be={class:"font-weight-medium"},Ne={class:"text-body-1 mb-0"},Ee={class:"text-body-1 mb-2"},Fe=ee({__name:"OrderDetailDialog",props:{modelValue:{type:Boolean},order:{}},emits:["update:modelValue","order-updated"],setup(K,{emit:L}){const i=K,w=L,p=E(!1),y=E(!1),C=V({get:()=>i.modelValue,set:a=>w("update:modelValue",a)}),M=V(()=>i.order&&["pending","preparing"].includes(i.order.status)),U=V(()=>i.order&&["preparing","ready"].includes(i.order.status)),j=V(()=>i.order&&i.order.status==="pending"),k=()=>{C.value=!1},Q=()=>{console.log("Printing order:",i.order.order_number),window.print()},$=()=>{console.log("Editing order:",i.order.order_number)},G=async()=>{try{p.value=!0,await I.updateOrderStatus(i.order.id_order,{status:"cancelled"}),w("order-updated",{...i.order,status:"cancelled"}),y.value=!1,k(),console.log("Order cancelled successfully")}catch(a){console.error("Error cancelling order:",a)}finally{p.value=!1}},H=async()=>{try{p.value=!0,await I.updateOrderStatus(i.order.id_order,{status:"completed"}),w("order-updated",{...i.order,status:"completed"}),k(),console.log("Order completed successfully")}catch(a){console.error("Error completing order:",a)}finally{p.value=!1}},J=a=>({pending:"warning",preparing:"info",completed:"success",cancelled:"error"})[a]||"default",W=a=>({pending:"Pending",preparing:"Diproses",completed:"Selesai",cancelled:"Dibatalkan"})[a]||a,X=a=>({cash:"Tunai",card:"Kartu",digital_wallet:"E-Wallet",qris:"QRIS",bank_transfer:"Transfer"})[a]||a,Y=a=>({pending:"warning",completed:"success",failed:"error",cancelled:"error"})[a]||"default",Z=a=>({pending:"Menunggu",completed:"Berhasil",failed:"Gagal",cancelled:"Dibatalkan"})[a]||a,_=a=>{const e=typeof a=="string"?parseFloat(a):a;return isNaN(e)||!isFinite(e)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e)},S=a=>new Date(a).toLocaleString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return(a,e)=>(d(),u(x,null,[l(B,{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=r=>C.value=r),"max-width":"700",scrollable:""},{default:s(()=>[a.order?(d(),b(c,{key:0,class:"coffee-dialog"},{default:s(()=>[l(v,{class:"d-flex align-center justify-space-between coffee-header"},{default:s(()=>[t("div",se,[l(D,{icon:"mdi-receipt-text",class:"text-white"}),t("span",re," Detail Pesanan "+o(a.order.order_number),1)]),l(f,{icon:"tabler-x",variant:"text",color:"white",onClick:k})]),_:1}),l(R),l(g,null,{default:s(()=>[l(te,{class:"mb-4"},{default:s(()=>[l(A,{cols:"12",md:"6"},{default:s(()=>[l(c,{variant:"tonal",color:"primary"},{default:s(()=>[l(g,null,{default:s(()=>{var r;return[e[8]||(e[8]=t("h6",{class:"text-h6 mb-2"},"Informasi Pesanan",-1)),t("div",oe,[e[4]||(e[4]=t("span",{class:"label"},"No. Pesanan:",-1)),t("span",ne,o(a.order.order_number),1)]),t("div",de,[e[5]||(e[5]=t("span",{class:"label"},"Status:",-1)),l(P,{color:J(a.order.status),size:"small",variant:"tonal"},{default:s(()=>[n(o(W(a.order.status)),1)]),_:1},8,["color"])]),t("div",ie,[e[6]||(e[6]=t("span",{class:"label"},"Tanggal:",-1)),t("span",ue,o(S(a.order.created_at)),1)]),t("div",me,[e[7]||(e[7]=t("span",{class:"label"},"Kasir:",-1)),t("span",pe,o(((r=a.order.user)==null?void 0:r.name)||"-"),1)])]}),_:1,__:[8]})]),_:1})]),_:1}),l(A,{cols:"12",md:"6"},{default:s(()=>[l(c,{variant:"tonal",color:"info"},{default:s(()=>[l(g,null,{default:s(()=>[e[13]||(e[13]=t("h6",{class:"text-h6 mb-2"},"Informasi Pelanggan",-1)),a.order.customer?(d(),u("div",ce,[t("div",fe,[e[9]||(e[9]=t("span",{class:"label"},"Nama:",-1)),t("span",ge,o(a.order.customer.name),1)]),t("div",_e,[e[10]||(e[10]=t("span",{class:"label"},"Telepon:",-1)),t("span",ve,o(a.order.customer.phone),1)]),t("div",be,[e[11]||(e[11]=t("span",{class:"label"},"Email:",-1)),t("span",ye,o(a.order.customer.email||"-"),1)])])):(d(),u("div",ke,[l(D,{icon:"tabler-user-question",size:"32",class:"mb-2"}),e[12]||(e[12]=t("p",{class:"text-body-2 mb-0"},"Pelanggan Umum",-1))]))]),_:1,__:[13]})]),_:1})]),_:1})]),_:1}),l(c,{class:"mb-4"},{default:s(()=>[l(v,null,{default:s(()=>e[14]||(e[14]=[n("Item Pesanan")])),_:1,__:[14]}),l(g,{class:"pa-0"},{default:s(()=>[l(z,null,{default:s(()=>[e[15]||(e[15]=t("thead",null,[t("tr",null,[t("th",null,"Produk"),t("th",{class:"text-center"},"Qty"),t("th",{class:"text-right"},"Harga Satuan"),t("th",{class:"text-right"},"Total")])],-1)),t("tbody",null,[(d(!0),u(x,null,F(a.order.order_items,r=>{var T,h,O;return d(),u("tr",{key:r.id_order_item},[t("td",null,[t("div",Ve,[l(ae,{src:((T=r.product)==null?void 0:T.image)||"/images/misc/no-image.png",alt:(h=r.product)==null?void 0:h.name,width:"40",height:"40",class:"rounded me-3"},null,8,["src","alt"]),t("div",null,[t("div",we,o((O=r.product)==null?void 0:O.name),1),r.variant?(d(),u("div",Ce,o(r.variant.name),1)):m("",!0)])])]),t("td",xe,o(r.quantity),1),t("td",De,o(_(r.unit_price)),1),t("td",Pe,o(_(r.total_price)),1)])}),128))])]),_:1,__:[15]})]),_:1})]),_:1}),l(c,{class:"mb-4"},{default:s(()=>[l(v,null,{default:s(()=>e[16]||(e[16]=[n("Ringkasan Pembayaran")])),_:1,__:[16]}),l(g,null,{default:s(()=>[t("div",Se,[e[17]||(e[17]=t("span",null,"Subtotal:",-1)),t("span",null,o(_(a.order.subtotal)),1)]),a.order.discount_amount>0?(d(),u("div",Te,[t("span",null,"Diskon ("+o(a.order.discount_type==="percentage"?a.order.discount_amount+"%":"Nominal")+"):",1),t("span",null,"-"+o(_(a.order.discount_amount)),1)])):m("",!0),a.order.tax_amount>0?(d(),u("div",he,[e[18]||(e[18]=t("span",null,"Pajak:",-1)),t("span",null,o(_(a.order.tax_amount)),1)])):m("",!0),l(R,{class:"my-3"}),t("div",Oe,[e[19]||(e[19]=t("span",{class:"text-h6"},"Total:",-1)),t("span",Ie,o(_(a.order.total_amount)),1)])]),_:1})]),_:1}),a.order.payments&&a.order.payments.length>0?(d(),b(c,{key:0,class:"mb-4"},{default:s(()=>[l(v,null,{default:s(()=>e[20]||(e[20]=[n("Informasi Pembayaran")])),_:1,__:[20]}),l(g,{class:"pa-0"},{default:s(()=>[l(z,null,{default:s(()=>[e[21]||(e[21]=t("thead",null,[t("tr",null,[t("th",null,"Metode"),t("th",null,"Jumlah"),t("th",null,"Status"),t("th",null,"Referensi"),t("th",null,"Tanggal")])],-1)),t("tbody",null,[(d(!0),u(x,null,F(a.order.payments,r=>(d(),u("tr",{key:r.id_payment},[t("td",null,[l(P,{size:"small",variant:"outlined"},{default:s(()=>[n(o(X(r.payment_method)),1)]),_:2},1024)]),t("td",Be,o(_(r.amount)),1),t("td",null,[l(P,{color:Y(r.status),size:"small",variant:"tonal"},{default:s(()=>[n(o(Z(r.status)),1)]),_:2},1032,["color"])]),t("td",null,o(r.reference_number||"-"),1),t("td",null,o(S(r.payment_date)),1)]))),128))])]),_:1,__:[21]})]),_:1})]),_:1})):m("",!0),a.order.notes?(d(),b(c,{key:1},{default:s(()=>[l(v,null,{default:s(()=>e[22]||(e[22]=[n("Catatan")])),_:1,__:[22]}),l(g,null,{default:s(()=>[t("p",Ne,o(a.order.notes),1)]),_:1})]),_:1})):m("",!0)]),_:1}),l(N,{class:"pa-4"},{default:s(()=>[l(f,{variant:"outlined","prepend-icon":"tabler-printer",onClick:Q},{default:s(()=>e[23]||(e[23]=[n(" Cetak Struk ")])),_:1,__:[23]}),l(q),j.value?(d(),b(f,{key:0,color:"warning",variant:"outlined","prepend-icon":"tabler-edit",onClick:$},{default:s(()=>e[24]||(e[24]=[n(" Edit ")])),_:1,__:[24]})):m("",!0),M.value?(d(),b(f,{key:1,color:"error",variant:"outlined","prepend-icon":"tabler-x",disabled:p.value,onClick:e[0]||(e[0]=r=>y.value=!0)},{default:s(()=>e[25]||(e[25]=[n(" Batalkan ")])),_:1,__:[25]},8,["disabled"])):m("",!0),U.value?(d(),b(f,{key:2,color:"success",variant:"flat","prepend-icon":"tabler-check",disabled:p.value,onClick:H},{default:s(()=>e[26]||(e[26]=[n(" Selesaikan ")])),_:1,__:[26]},8,["disabled"])):m("",!0),e[28]||(e[28]=n()),l(f,{variant:"outlined",onClick:k},{default:s(()=>e[27]||(e[27]=[n(" Tutup ")])),_:1,__:[27]})]),_:1,__:[28]})]),_:1})):m("",!0)]),_:1},8,["modelValue"]),l(B,{modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=r=>y.value=r),"max-width":"450",persistent:""},{default:s(()=>[l(c,null,{default:s(()=>[l(v,{class:"d-flex align-center text-error"},{default:s(()=>[l(D,{icon:"mdi-alert-circle",class:"me-2"}),e[29]||(e[29]=n(" Konfirmasi Pembatalan "))]),_:1,__:[29]}),l(g,null,{default:s(()=>{var r;return[t("p",Ee,[e[30]||(e[30]=n(" Apakah Anda yakin ingin membatalkan pesanan ")),t("strong",null,o((r=a.order)==null?void 0:r.order_number),1),e[31]||(e[31]=n("? "))]),e[32]||(e[32]=t("p",{class:"text-body-2 text-medium-emphasis"}," Tindakan ini tidak dapat diurungkan dan pesanan akan dibatalkan secara permanen. ",-1))]}),_:1,__:[32]}),l(N,null,{default:s(()=>[l(q),l(f,{variant:"outlined",disabled:p.value,onClick:e[2]||(e[2]=r=>y.value=!1)},{default:s(()=>e[33]||(e[33]=[n(" Batal ")])),_:1,__:[33]},8,["disabled"]),l(f,{color:"error",variant:"flat",loading:p.value,onClick:G},{default:s(()=>e[34]||(e[34]=[n(" Ya, Batalkan Pesanan ")])),_:1,__:[34]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Ye=le(Fe,[["__scopeId","data-v-a05b8a73"]]);export{Ye as default};
