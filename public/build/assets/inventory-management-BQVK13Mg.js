import{aA as ue,d as et,r as v,V as K,w as tt,g as j,f as s,b as t,s as p,X as I,t as i,l as S,c as X,e as l,aw as at,a0 as w,o as k,ax as Ye,aW as ot,D as lt,m as e,a5 as ye,F as rt,i as nt,p as Te,$ as Ie}from"./main-B1aqd0Vn.js";import{V as be}from"./VDialog-Bl480fUx.js";import{b as pe,c as Ee,V as F}from"./VCard-CjyTzbY9.js";import{V as Y}from"./VDivider-B15MkpeQ.js";import{V as z}from"./VCardText-BbBK60TB.js";import{V as le}from"./VAlert-CUYzWRSG.js";import{V as it}from"./VDataTable-D1hj7rC9.js";import{V as ee}from"./VChip-DnC3cq7z.js";import{V as xe}from"./VSpacer-DhS8yAXj.js";import{_ as st}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{I as ut}from"./ItemsApi-efuJ0A1J.js";import{V as se,a as C}from"./VRow-C4K8Zx7m.js";import{V as Q}from"./VTextField-7RUAZ8_f.js";import{V as je}from"./VSelect-BnIzapXZ.js";import{V as dt}from"./VDataTableServer-C2D-p3Xh.js";import{V as Re}from"./VTooltip-D7ZxFtq4.js";import{V as $e}from"./VForm-DQbOO8ON.js";import{V as Ne}from"./VTextarea-DUvcUbov.js";import{V as ct}from"./VAvatar-2w9SeItb.js";import"./VOverlay-B-mghzwU.js";import"./forwardRefs-B931MWyl.js";import"./VImg-Bko2yg7S.js";import"./VCheckboxBtn-_cdcMevY.js";import"./VTable-BogPIozf.js";import"./filter-g16zMtTU.js";/* empty css              */import"./VList-ZmEmsTKm.js";import"./VMenu-C3XY-0Fo.js";const oe="/api/inventory";class J{static async getAll(u){var d;try{return(await ue.get(oe,{params:u})).data}catch(m){throw((d=m.response)==null?void 0:d.data)||this.handleError(m)}}static async getById(u){var d;try{return(await ue.get(`${oe}/${u}`)).data}catch(m){throw((d=m.response)==null?void 0:d.data)||this.handleError(m)}}static async getStats(){var u;try{return(await ue.get(`${oe}/stats`)).data}catch(d){throw((u=d.response)==null?void 0:u.data)||this.handleError(d)}}static async getLowStockAlerts(){var u;try{return(await ue.get(`${oe}/low-stock-alerts`)).data}catch(d){throw((u=d.response)==null?void 0:u.data)||this.handleError(d)}}static async updateStock(u,d){var m;try{return(await ue.post(`${oe}/${u}/update-stock`,d)).data}catch(g){throw((m=g.response)==null?void 0:m.data)||this.handleError(g)}}static async bulkUpdateStock(u){var d;try{return(await ue.post(`${oe}/bulk-update-stock`,u)).data}catch(m){throw((d=m.response)==null?void 0:d.data)||this.handleError(m)}}static async setReorderLevel(u,d){var m;try{return(await ue.post(`${oe}/${u}/reorder-level`,d)).data}catch(g){throw((m=g.response)==null?void 0:m.data)||this.handleError(g)}}static async getMovements(u){var d;try{const m=u!=null&&u.id_inventory?`${oe}/${u.id_inventory}/movements`:`${oe}/movements`;return(await ue.get(m,{params:u})).data}catch(m){throw((d=m.response)==null?void 0:d.data)||this.handleError(m)}}static handleError(u){var d,m;return u.response?{message:((d=u.response.data)==null?void 0:d.message)||"Terjadi kesalahan pada server",success:!1,errors:(m=u.response.data)==null?void 0:m.errors}:u.request?{message:"Tidak dapat terhubung ke server",success:!1}:{message:u.message||"Terjadi kesalahan yang tidak diketahui",success:!1}}static formatError(u){return u.errors?Object.values(u.errors).flat().join(", "):u.message||"Terjadi kesalahan yang tidak diketahui"}static isValidationError(u){return u.errors&&typeof u.errors=="object"}static getFieldError(u,d){return u.errors&&u.errors[d]?Array.isArray(u.errors[d])?u.errors[d][0]:u.errors[d]:null}static getMovementTypes(){return[{value:"stock_in",label:"Stock Masuk",color:"success"},{value:"stock_out",label:"Stock Keluar",color:"warning"},{value:"adjustment",label:"Penyesuaian",color:"info"},{value:"transfer",label:"Transfer",color:"primary"},{value:"return",label:"Retur",color:"success"},{value:"damaged",label:"Rusak",color:"error"},{value:"expired",label:"Kadaluarsa",color:"error"}]}static getStockStatusOptions(){return[{value:"all",label:"Semua Status"},{value:"in_stock",label:"Tersedia"},{value:"low_stock",label:"Stok Menipis"},{value:"out_of_stock",label:"Habis"},{value:"overstock",label:"Stok Berlebih"}]}}const mt={key:1,class:"text-center py-8"},pt={class:"font-weight-medium"},vt={class:"text-medium-emphasis"},_t={class:"text-center"},ft={class:"text-center font-weight-medium"},kt={class:"text-center font-weight-bold text-primary"},gt={class:"text-end"},yt={class:"text-end font-weight-medium text-success"},bt={class:"max-width-200"},xt={class:"font-weight-medium"},ht={key:0,class:"text-medium-emphasis"},St={key:1,class:"d-block text-caption"},wt={key:2,class:"text-info d-block"},Vt={class:"text-center py-8"},Mt=et({__name:"InventoryMovementsDialog",props:{modelValue:{type:Boolean},inventoryId:{},inventoryName:{}},emits:["update:modelValue"],setup(q,{emit:u}){const d=q,m=u,g=v([]),E=v(!1),L=v(""),R=K({get:()=>d.modelValue,set:b=>m("update:modelValue",b)}),O=async()=>{var b,_,n,P;if(d.inventoryId)try{E.value=!0,L.value="";const h=await J.getMovements({id_inventory:parseInt(d.inventoryId),page:1,per_page:50});h.data&&Array.isArray(h.data)?g.value=h.data:h.data&&((b=h==null?void 0:h.data)!=null&&b.data)&&Array.isArray((_=h==null?void 0:h.data)==null?void 0:_.data)?g.value=h.data.data:g.value=[]}catch(h){console.error("Error fetching movements:",h),L.value=((P=(n=h.response)==null?void 0:n.data)==null?void 0:P.message)||"Gagal memuat riwayat pergerakan"}finally{E.value=!1}},B=b=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(b),N=b=>({in:"success",out:"error",stock_in:"success",stock_out:"error",adjustment:"warning",transfer:"info",return:"secondary"})[b]||"primary",A=b=>({in:"Stock Masuk",out:"Stock Keluar",stock_in:"Stock Masuk",stock_out:"Stock Keluar",adjustment:"Penyesuaian",transfer:"Transfer",return:"Retur"})[b]||b,y=b=>({in:"tabler-plus",out:"tabler-minus",stock_in:"tabler-plus",stock_out:"tabler-minus",adjustment:"tabler-edit",transfer:"tabler-arrows-exchange",return:"tabler-arrow-back"})[b]||"tabler-package";return tt(R,b=>{b&&d.inventoryId?O():(g.value=[],L.value="")}),(b,_)=>(k(),j(be,{modelValue:R.value,"onUpdate:modelValue":_[1]||(_[1]=n=>R.value=n),"max-width":"900px",scrollable:""},{default:s(()=>[t(F,null,{default:s(()=>[t(pe,{class:"d-flex align-center"},{default:s(()=>[t(I,{icon:"tabler-history",class:"me-2"}),p(" Riwayat Pergerakan - "+i(b.inventoryName),1)]),_:1}),t(Y),t(z,{class:"pa-0"},{default:s(()=>[L.value?(k(),j(le,{key:0,type:"error",variant:"tonal",class:"ma-4"},{default:s(()=>[p(i(L.value),1)]),_:1})):S("",!0),E.value?(k(),X("div",mt,[t(at,{indeterminate:"",color:"primary",size:"40"}),_[2]||(_[2]=l("div",{class:"mt-4 text-medium-emphasis"}," Memuat riwayat pergerakan... ",-1))])):(k(),j(it,{key:2,headers:[{title:"Tanggal",key:"created_at",sortable:!1},{title:"Jenis",key:"movement_type",sortable:!1},{title:"Kuantitas",key:"quantity",sortable:!1},{title:"Stok Sebelum",key:"stock_before",sortable:!1},{title:"Stok Sesudah",key:"stock_after",sortable:!1},{title:"Harga/Unit",key:"unit_cost",sortable:!1},{title:"Total Nilai",key:"total_cost",sortable:!1},{title:"Catatan",key:"notes",sortable:!1}],items:g.value,loading:E.value,class:"text-no-wrap","items-per-page":"15",height:"500","fixed-header":""},{"item.created_at":s(({item:n})=>[l("div",null,[l("div",pt,i(new Date(n.created_at).toLocaleDateString("id-ID")),1),l("small",vt,i(new Date(n.created_at).toLocaleTimeString("id-ID")),1)])]),"item.movement_type":s(({item:n})=>[t(ee,{color:N(n.movement_type),variant:"tonal",size:"small","prepend-icon":y(n.movement_type)},{default:s(()=>[p(i(A(n.movement_type)),1)]),_:2},1032,["color","prepend-icon"])]),"item.quantity":s(({item:n})=>[l("div",_t,[t(ee,{color:n.movement_type==="in"||n.movement_type==="stock_in"?"success":"error",variant:"outlined",size:"small"},{default:s(()=>[p(i(n.movement_type==="in"||n.movement_type==="stock_in"?"+":"-")+i(Math.abs(n.quantity)),1)]),_:2},1032,["color"])])]),"item.stock_before":s(({item:n})=>[l("div",ft,i(n.stock_before),1)]),"item.stock_after":s(({item:n})=>[l("div",kt,i(n.stock_after),1)]),"item.unit_cost":s(({item:n})=>[l("div",gt,i(n.unit_cost?B(n.unit_cost):"-"),1)]),"item.total_cost":s(({item:n})=>[l("div",yt,i(n.total_cost?B(n.total_cost):"-"),1)]),"item.notes":s(({item:n})=>[l("div",bt,[l("div",xt,i(n.notes||"-"),1),n.reference_type&&n.reference_id?(k(),X("small",ht," Ref: "+i(n.reference_type)+"-"+i(n.reference_id),1)):S("",!0),n.batch_number?(k(),X("small",St," Batch: "+i(n.batch_number),1)):S("",!0),n.user?(k(),X("small",wt," oleh: "+i(n.user.name),1)):S("",!0)])]),"no-data":s(()=>[l("div",Vt,[t(I,{icon:"tabler-history-off",size:"48",class:"text-medium-emphasis mb-4"}),_[3]||(_[3]=l("div",{class:"text-h6 text-medium-emphasis mb-2"}," Belum ada riwayat pergerakan ",-1)),_[4]||(_[4]=l("div",{class:"text-body-2 text-medium-emphasis"}," Riwayat akan muncul setelah ada pergerakan stok ",-1))])]),_:1},8,["items","loading"]))]),_:1}),t(Y),t(Ee,{class:"pa-4"},{default:s(()=>[t(xe),t(w,{variant:"outlined",onClick:_[0]||(_[0]=n=>R.value=!1)},{default:s(()=>_[5]||(_[5]=[p(" Tutup ")])),_:1,__:[5]}),t(w,{color:"primary","prepend-icon":"tabler-refresh",onClick:O},{default:s(()=>_[6]||(_[6]=[p(" Refresh ")])),_:1,__:[6]})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ct=st(Mt,[["__scopeId","data-v-ca0277a4"]]),Pt=()=>{const q=v([]),u=v(!1),d=v(!1),m=v({total_items:0,low_stock_items:0,out_of_stock_items:0,overstock_items:0,total_stock_value:0,total_stock_quantity:0,total_reserved_stock:0,items_need_restock:0}),g=v([]),E=v(!1),L=v([]),R=v(!1),O=v(!1),B=v(!1),N=v(!1),A=v(!1),y=v(null),b=v([]),_=v(1),n=v(0),P=v(15),h=v({search:"",stock_status:"all",category_id:void 0,supplier_id:void 0,sort_by:"current_stock",sort_order:"asc"}),W=v(""),D=v(""),$=v(""),de=v({movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:void 0,notes:""}),H=v({reorder_level:0,max_stock_level:0}),ke=K(()=>b.value.length>0),ce=K(()=>m.value.total_stock_value),re=K(()=>m.value.low_stock_items),ne=K(()=>m.value.out_of_stock_items),Z=K(()=>Math.ceil(n.value/P.value)),ve=K(()=>_.value<Z.value),me=K(()=>_.value>1),he=K(()=>({currentPage:_.value,totalPages:Z.value,totalItems:n.value,itemsPerPage:P.value,hasNext:ve.value,hasPrev:me.value})),Se=[r=>r>0||"Kuantitas harus lebih dari 0",r=>Number.isInteger(r)||"Kuantitas harus berupa bilangan bulat"],we=[r=>!!r||"Alasan wajib diisi",r=>r&&r.length>=3||"Alasan minimal 3 karakter"],c=[r=>!r||r>=0||"Harga harus lebih dari atau sama dengan 0"],U=[{title:"Stock Masuk",value:"stock_in",color:"success"},{title:"Stock Keluar",value:"stock_out",color:"warning"},{title:"Penyesuaian",value:"adjustment",color:"info"},{title:"Transfer",value:"transfer",color:"primary"},{title:"Retur",value:"return",color:"success"}],V=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Menipis",value:"low_stock"},{title:"Habis",value:"out_of_stock"},{title:"Stok Berlebih",value:"overstock"}],ie=async()=>{u.value=!0,W.value="";try{const r={...h.value,page:_.value,per_page:P.value};Object.keys(r).forEach(Ue=>{const x=r[Ue];(x===""||x===void 0||x===null||x==="all")&&delete r[Ue]}),console.log("Fetching inventory with params:",r);const M=await J.getAll(r);if(console.log("ðŸ” Full Inventory API Response:",M),console.log("ðŸ“„ Response Data Structure:",M.data),M.success)q.value=M.data.data||[],n.value=M.data.total||0,M.data.current_page&&(_.value=M.data.current_page),console.log("Inventory data loaded:",{total:M.data.total,current_page:M.data.current_page,per_page:M.data.per_page,last_page:M.data.last_page,itemsLength:q.value.length}),console.log("ðŸ“Š Final Inventory State Values:",{inventoryListLength:q.value.length,totalItemsValue:n.value,currentPageValue:_.value,itemsPerPageValue:P.value});else throw new Error(M.message||"Gagal mengambil data inventory")}catch(r){console.error("Error fetching inventory:",r),W.value=J.formatError(r)||"Gagal mengambil data inventory",q.value=[],n.value=0}finally{u.value=!1}},Ve=async()=>{try{const r=await J.getStats();r.success&&(m.value=r.data)}catch(r){console.error("Error fetching inventory stats:",r)}},te=async()=>{R.value=!0;try{const r=await J.getLowStockAlerts();r.success&&(L.value=r.data.data||[])}catch(r){console.error("Error fetching low stock alerts:",r),L.value=[]}finally{R.value=!1}},_e=async r=>{E.value=!0;try{const M=await J.getMovements({id_inventory:r,page:1,per_page:20});M.success&&(g.value=M.data)}catch(M){console.error("Error fetching movements:",M)}finally{E.value=!1}},Ae=async()=>{if(y.value){d.value=!0,$.value="";try{const r=await J.updateStock(y.value.id_inventory,de.value);if(r.success)D.value="Stock berhasil diperbarui",fe(),await ie(),await Ve(),await te();else throw new Error(r.message||"Gagal memperbarui stock")}catch(r){console.error("Error updating stock:",r),$.value=J.formatError(r)||"Gagal memperbarui stock"}finally{d.value=!1}}},Le=async()=>{if(y.value){d.value=!0,$.value="";try{const r=await J.setReorderLevel(y.value.id_inventory,H.value);if(r.success)D.value="Reorder level berhasil diperbarui",Me(),await ie();else throw new Error(r.message||"Gagal memperbarui reorder level")}catch(r){console.error("Error setting reorder level:",r),$.value=J.formatError(r)||"Gagal memperbarui reorder level"}finally{d.value=!1}}},Fe=r=>{y.value=r,de.value={movement_type:"stock_in",quantity:0,reason:"",reference_number:"",cost_per_unit:r.average_cost||void 0,notes:""},$.value="",O.value=!0},ze=r=>{y.value=r,H.value={reorder_level:r.reorder_level||0,max_stock_level:r.max_stock_level||0},$.value="",A.value=!0},qe=r=>{y.value=r,_e(r.id_inventory),N.value=!0},fe=()=>{O.value=!1,setTimeout(()=>{y.value=null,$.value=""},300)},Me=()=>{A.value=!1,setTimeout(()=>{y.value=null,$.value=""},300)};return{inventoryList:q,loading:u,saveLoading:d,stats:m,movementsList:g,movementsLoading:E,lowStockItems:L,alertsLoading:R,stockUpdateDialog:O,bulkUpdateDialog:B,movementsDialog:N,reorderDialog:A,selectedInventory:y,selectedItems:b,currentPage:_,totalItems:n,itemsPerPage:P,filters:h,errorMessage:W,successMessage:D,modalErrorMessage:$,stockUpdateForm:de,reorderForm:H,hasSelectedItems:ke,totalStockValue:ce,lowStockCount:re,outOfStockCount:ne,quantityRules:Se,reasonRules:we,costRules:c,movementTypeOptions:U,stockStatusOptions:V,fetchInventoryList:ie,fetchStats:Ve,fetchLowStockAlerts:te,fetchMovements:_e,updateStock:Ae,setReorderLevel:Le,openStockUpdateDialog:Fe,openReorderDialog:ze,openMovementsDialog:qe,closeStockUpdateDialog:fe,closeReorderDialog:Me,closeMovementsDialog:()=>{N.value=!1,setTimeout(()=>{y.value=null,g.value=[]},300)},clearModalError:()=>{$.value=""},onPageChange:r=>{console.log("Page changed to:",r,"Current total items:",n.value),r!==_.value&&(_.value=r,ie())},onItemsPerPageChange:r=>{console.log("Items per page changed to:",r),r!==P.value&&(P.value=r,_.value=1,ie())},handleFiltersUpdate:r=>{h.value={...h.value,...r},_.value=1,ie()},formatCurrency:r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r),getStockStatusColor:r=>r.current_stock===0?"error":r.is_low_stock?"warning":"success",getStockStatusText:r=>r.current_stock===0?"Habis":r.reorder_level>0&&r.current_stock<=r.reorder_level?"Menipis":r.max_stock_level&&r.current_stock>r.max_stock_level?"Berlebih":"Tersedia",getMovementTypeColor:r=>({stock_in:"success",stock_out:"warning",adjustment:"info",transfer:"primary",return:"success",damaged:"error",expired:"error"})[r]||"grey",totalPages:Z,hasNextPage:ve,hasPrevPage:me,paginationInfo:he}};function Dt(){const q=v([]),u=v([]),d=v(!1),m=v(!1),g=v({total_items:0,total_value:0,low_stock_items:0,out_of_stock_items:0,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}),E=v(1),L=v(0),R=v(10),O=Ye({search:"",stock_status:"all",movement_type:"",date_from:"",date_to:"",item_id:void 0}),B=v(!1),N=v(!1),A=v(null),y=Ye({item_id:0,type:"in",quantity:0,notes:"",cost_per_unit:0}),b=v(""),_=v(""),n=v(""),P=K(()=>!0),h=[{title:"Semua Status",value:"all"},{title:"Tersedia",value:"in_stock"},{title:"Stok Rendah",value:"low_stock"},{title:"Habis",value:"out_of_stock"}],W=[{title:"Masuk",value:"in",color:"success",icon:"tabler-plus"},{title:"Keluar",value:"out",color:"error",icon:"tabler-minus"},{title:"Penyesuaian",value:"adjustment",color:"warning",icon:"tabler-adjustments"}],D=[{title:"Pembelian",value:"purchase"},{title:"Penjualan",value:"sale"},{title:"Produksi",value:"production"},{title:"Penyesuaian",value:"adjustment"},{title:"Kerusakan",value:"waste"}],$=c=>c.current_stock<=0?{status:"out_of_stock",color:"error",text:"Habis",icon:"tabler-x"}:c.current_stock<=c.minimum_stock?{status:"low_stock",color:"warning",text:"Rendah",icon:"tabler-alert-triangle"}:{status:"in_stock",color:"success",text:"Tersedia",icon:"tabler-check"},de=c=>!c.maximum_stock||c.maximum_stock<=0?100:Math.round(c.current_stock/c.maximum_stock*100),H=async()=>{d.value=!0;try{await new Promise(c=>setTimeout(c,1e3)),q.value=await ut.getAll(),L.value=q.value.length,_.value=""}catch{b.value="Gagal memuat data items"}finally{d.value=!1}},ke=async c=>{d.value=!0;try{const U=await J.getMovements({id_inventory:c,page:E.value,per_page:R.value});u.value=U.data.map(V=>({id:V.id_movement,item_id:V.id_inventory,type:V.movement_type,quantity:V.quantity,unit:"pcs",reference_id:V.reference_number?parseInt(V.reference_number):void 0,reference_type:V.reason,notes:V.notes,cost_per_unit:V.cost_per_unit,total_cost:V.total_cost,created_by:V.created_by,created_at:V.created_at,creator:V.user})),L.value=U.total}catch(U){console.error("Failed to fetch stock movements:",U),u.value=[]}finally{d.value=!1}},ce=async()=>{try{await H();const c=q.value;g.value={total_items:c.length,total_value:c.reduce((U,V)=>U+V.current_stock*V.cost_per_unit,0),low_stock_items:c.filter(U=>U.current_stock<=U.minimum_stock&&U.current_stock>0).length,out_of_stock_items:c.filter(U=>U.current_stock<=0).length,movements_today:0,movements_this_month:0,top_consumed_items:[],recent_movements:[]}}catch(c){console.error("Failed to fetch stats:",c)}},re=async()=>{m.value=!0,n.value="";try{const c=await fetch("/api/inventory/movement",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({item_id:y.item_id,movement_type:y.type,quantity:y.quantity,notes:y.notes,cost_per_unit:y.cost_per_unit})});if(!c.ok){const U=await c.json();throw new Error(U.message||"Gagal mencatat pergerakan stok")}_.value=`Stock ${y.type==="in"?"masuk":y.type==="out"?"keluar":"disesuaikan"} berhasil dicatat`,me(),await H(),await ce()}catch(c){n.value=c.message||"Gagal mencatat pergerakan stok"}finally{m.value=!1}},ne=c=>{A.value=c,Object.assign(y,{item_id:c.id_item,type:"in",quantity:0,notes:"",cost_per_unit:c.cost_per_unit}),B.value=!0},Z=c=>{A.value=c,Object.assign(y,{item_id:c.id_item,type:"out",quantity:0,notes:"",cost_per_unit:c.cost_per_unit}),B.value=!0},ve=c=>{A.value=c,Object.assign(y,{item_id:c.id_item,type:"adjustment",quantity:c.current_stock,notes:"",cost_per_unit:c.cost_per_unit}),N.value=!0},me=()=>{B.value=!1,N.value=!1,n.value="",A.value=null};return{itemsList:q,stockMovements:u,loading:d,saveLoading:m,stats:g,currentPage:E,totalItems:L,itemsPerPage:R,filters:O,movementDialog:B,adjustmentDialog:N,selectedItem:A,movementFormData:y,errorMessage:b,successMessage:_,modalErrorMessage:n,canManageStock:P,stockStatusOptions:h,movementTypeOptions:W,referenceTypeOptions:D,getStockStatus:$,getStockPercentage:de,fetchItems:H,fetchStockMovements:ke,fetchStats:ce,recordStockMovement:re,openStockInDialog:ne,openStockOutDialog:Z,openAdjustmentDialog:ve,closeMovementDialog:me,clearModalError:()=>{n.value=""},onPageChange:c=>{E.value=c,H()},handleFiltersUpdate:c=>{Object.assign(O,c),E.value=1,H()}}}const Ut={class:"inventory-management"},Tt={class:"d-flex justify-space-between align-center mb-6"},It={class:"d-flex gap-3 align-center"},jt={class:"d-flex align-center justify-space-between"},Rt={class:"text-h4 font-weight-bold text-primary"},$t={class:"d-flex align-center justify-space-between"},Et={class:"text-h4 font-weight-bold text-warning"},At={class:"d-flex align-center justify-space-between"},Lt={class:"text-h4 font-weight-bold text-error"},Ft={class:"d-flex align-center justify-space-between"},zt={class:"text-h4 font-weight-bold text-success"},qt={class:"d-flex align-center justify-space-between"},Ot={class:"d-flex align-center gap-3"},Bt={class:"d-flex gap-2"},Nt={class:"d-flex flex-wrap gap-2"},Kt={class:"text-body-2 text-medium-emphasis"},Ht={key:0},Gt={key:1},Jt={key:2},Xt={class:"d-flex justify-center gap-3 mt-4"},Wt={class:"d-flex align-center"},Zt={class:"font-weight-medium"},Qt={class:"text-medium-emphasis"},Yt={class:"text-center"},ea={class:"text-h6 font-weight-bold"},ta={key:0,class:"text-warning"},aa={class:"text-center"},sa={class:"text-center"},oa={class:"text-end"},la={class:"text-end font-weight-medium text-success"},ra={class:"d-flex align-center gap-1"},na={class:"text-center py-12"},ia={class:"d-flex justify-center gap-3"},ua={class:"text-center py-8"},da={key:0},ca={class:"text-xs text-info"},ma={class:"d-flex align-center gap-2"},pa={class:"d-flex align-center gap-3"},va={class:"font-weight-bold"},_a={class:"text-caption"},fa={class:"text-caption"},ka={class:"d-flex gap-3 justify-end"},ga={class:"d-flex align-center gap-2"},ya={class:"text-white"},ba={class:"d-flex align-center gap-3"},xa={class:"font-weight-bold"},ha={class:"text-caption"},Sa=et({__name:"inventory-management",setup(q){const{xs:u}=ot(),d=()=>{re(),ne(),Z()},{inventoryList:m,loading:g,saveLoading:E,stats:L,lowStockItems:R,stockUpdateDialog:O,reorderDialog:B,movementsDialog:N,selectedInventory:A,currentPage:y,totalItems:b,itemsPerPage:_,filters:n,errorMessage:P,successMessage:h,modalErrorMessage:W,stockUpdateForm:D,reorderForm:$,totalStockValue:de,lowStockCount:H,outOfStockCount:ke,stockStatusOptions:ce,fetchInventoryList:re,fetchStats:ne,fetchLowStockAlerts:Z,updateStock:ve,setReorderLevel:me,openStockUpdateDialog:he,openReorderDialog:Se,openMovementsDialog:we,closeStockUpdateDialog:c,closeReorderDialog:U,clearModalError:V,onPageChange:ie,onItemsPerPageChange:Ve,handleFiltersUpdate:te,formatCurrency:_e,getStockStatusColor:Ae,getStockStatusText:Le,totalPages:Fe,hasNextPage:ze,hasPrevPage:qe}=Pt(),{recordStockMovement:fe,openAdjustmentDialog:Me,movementDialog:Ce,adjustmentDialog:Pe,selectedItem:G,movementFormData:T,saveLoading:Oe,closeMovementDialog:ge,successMessage:De,modalErrorMessage:Be,clearModalError:Ke}=Dt(),r=x=>x.item?{id_item:x.item.id_item,item_code:x.item.item_code,name:x.item.name,description:x.item.description||"",unit:x.item.unit,cost_per_unit:parseFloat(x.item.cost_per_unit),current_stock:x.current_stock,minimum_stock:x.reorder_level||0,active:!0,storage_location:x.item.storage_location||"",expiry_date:x.item.expiry_date||null,properties:x.item.properties||null,created_by:x.item.created_by||null,updated_by:x.item.updated_by||null,created_at:x.item.created_at,updated_at:x.item.updated_at,deleted_at:x.item.deleted_at||null}:null,M=x=>{const a=r(x);a&&Me(a)},Ue=K(()=>L.value);return K(()=>m.value),K(()=>g.value),lt(()=>{re(),ne(),Z()}),tt(b,(x,a)=>{console.log("ðŸ” totalItems changed:",{oldValue:a,newValue:x}),console.log("ðŸ“Š VDataTable will receive server-items-length:",x)},{immediate:!0}),(x,a)=>{var He,Ge,Je,Xe;return k(),X("div",Ut,[l("div",Tt,[a[34]||(a[34]=l("div",null,[l("h1",{class:"text-h4 font-weight-bold inventory-title"}," Kelola Inventory "),l("p",{class:"text-body-1 text-medium-emphasis inventory-subtitle"}," Kelola stok barang dan pergerakan inventory ")],-1)),l("div",It,[t(w,{color:"primary","prepend-icon":"tabler-refresh",variant:"outlined",onClick:d},{default:s(()=>a[33]||(a[33]=[p(" Refresh Data ")])),_:1,__:[33]})])]),e(P)?(k(),j(le,{key:0,type:"error",variant:"outlined",class:"mb-4",text:e(P),closable:"","onClick:close":a[0]||(a[0]=o=>P.value="")},null,8,["text"])):S("",!0),e(h)?(k(),j(le,{key:1,type:"success",variant:"outlined",class:"mb-4",text:e(h),closable:"","onClick:close":a[1]||(a[1]=o=>h.value="")},null,8,["text"])):S("",!0),e(De)?(k(),j(le,{key:2,type:"success",variant:"outlined",class:"mb-4",text:e(De),closable:"","onClick:close":a[2]||(a[2]=o=>De.value="")},null,8,["text"])):S("",!0),t(se,{class:"mb-6"},{default:s(()=>[t(C,{cols:"12",md:"3"},{default:s(()=>[t(F,{class:"stats-card"},{default:s(()=>[t(z,null,{default:s(()=>[l("div",jt,[l("div",null,[l("div",Rt,i(Ue.value.total_items||0),1),a[35]||(a[35]=l("div",{class:"text-caption text-medium-emphasis"}," Total Produk ",-1))]),t(I,{icon:"tabler-package",size:"48",class:"text-primary opacity-50"})])]),_:1})]),_:1})]),_:1}),t(C,{cols:"12",md:"3"},{default:s(()=>[t(F,{class:"stats-card"},{default:s(()=>[t(z,null,{default:s(()=>[l("div",$t,[l("div",null,[l("div",Et,i(e(H)||0),1),a[36]||(a[36]=l("div",{class:"text-caption text-medium-emphasis"}," Stok Menipis ",-1))]),t(I,{icon:"tabler-alert-triangle",size:"48",class:"text-warning opacity-50"})])]),_:1})]),_:1})]),_:1}),t(C,{cols:"12",md:"3"},{default:s(()=>[t(F,{class:"stats-card"},{default:s(()=>[t(z,null,{default:s(()=>[l("div",At,[l("div",null,[l("div",Lt,i(e(ke)||0),1),a[37]||(a[37]=l("div",{class:"text-caption text-medium-emphasis"}," Stok Habis ",-1))]),t(I,{icon:"tabler-x-circle",size:"48",class:"text-error opacity-50"})])]),_:1})]),_:1})]),_:1}),t(C,{cols:"12",md:"3"},{default:s(()=>[t(F,{class:"stats-card"},{default:s(()=>[t(z,null,{default:s(()=>[l("div",Ft,[l("div",null,[l("div",zt,i(e(_e)(e(de)||0)),1),a[38]||(a[38]=l("div",{class:"text-caption text-medium-emphasis"}," Nilai Stok ",-1))]),t(I,{icon:"tabler-currency-dollar",size:"48",class:"text-success opacity-50"})])]),_:1})]),_:1})]),_:1})]),_:1}),t(F,{class:"mb-6 info-card",color:"info",variant:"tonal"},{default:s(()=>[t(z,null,{default:s(()=>[l("div",qt,[l("div",Ot,[t(I,{icon:"tabler-info-circle",size:"32",class:"text-info"}),a[39]||(a[39]=l("div",null,[l("div",{class:"text-subtitle-1 font-weight-medium text-info"}," Sistem Stock Movement Otomatis "),l("div",{class:"text-body-2 text-medium-emphasis"},[p(" Stok akan bertambah otomatis saat purchasing dan berkurang saat penjualan POS. Gunakan tombol "),l("strong",null,"Penyesuaian"),p(" untuk koreksi manual jika diperlukan. ")])],-1))]),l("div",Bt,[t(ee,{color:"success",variant:"tonal",size:"small"},{default:s(()=>[t(I,{icon:"tabler-shopping-cart",class:"me-1"}),a[40]||(a[40]=p(" Purchase â†’ Stok + "))]),_:1,__:[40]}),t(ee,{color:"error",variant:"tonal",size:"small"},{default:s(()=>[t(I,{icon:"tabler-cash",class:"me-1"}),a[41]||(a[41]=p(" POS Sale â†’ Stok - "))]),_:1,__:[41]})])])]),_:1})]),_:1}),e(R).length>0?(k(),j(F,{key:3,class:"mb-6 low-stock-alert"},{default:s(()=>[t(pe,{class:"d-flex align-center"},{default:s(()=>[t(I,{icon:"tabler-alert-triangle",class:"text-warning me-2"}),p(" Peringatan Stok Menipis ("+i(e(R).length)+" produk) ",1)]),_:1}),t(z,null,{default:s(()=>[l("div",Nt,[(k(!0),X(rt,null,nt(e(R).slice(0,10),o=>(k(),j(ee,{key:o.id_inventory,color:"warning",variant:"outlined",size:"small"},{default:s(()=>{var f;return[p(i((f=o.product)==null?void 0:f.name)+" ("+i(o.current_stock)+"/"+i(o.reorder_level)+") ",1)]}),_:2},1024))),128)),e(R).length>10?(k(),j(ee,{key:0,color:"warning",variant:"tonal",size:"small"},{default:s(()=>[p(" +"+i(e(R).length-10)+" lainnya ",1)]),_:1})):S("",!0)])]),_:1})]),_:1})):S("",!0),!e(g)&&e(m).length===0&&!e(P)&&!e(n).search&&e(n).stock_status==="all"?(k(),j(F,{key:4,class:"mb-6"},{default:s(()=>[t(z,{class:"text-center py-6"},{default:s(()=>[t(I,{icon:"tabler-info-circle",size:"48",class:"text-info mb-3"}),a[42]||(a[42]=l("div",{class:"text-h6 mb-2"}," Sistem Inventory Management Siap Digunakan ",-1)),a[43]||(a[43]=l("div",{class:"text-body-2 text-medium-emphasis"}," Buat produk dan variant terlebih dahulu untuk mulai melacak inventory. ",-1))]),_:1,__:[42,43]})]),_:1})):S("",!0),!e(g)&&e(m).length===0&&!e(P)&&(e(n).search||e(n).stock_status!=="all")?(k(),j(F,{key:5,class:"mb-6"},{default:s(()=>[t(z,{class:"text-center py-6"},{default:s(()=>{var o;return[t(I,{icon:"tabler-search-off",size:"48",class:"text-warning mb-3"}),a[50]||(a[50]=l("div",{class:"text-h6 mb-2"}," Tidak Ada Hasil Pencarian ",-1)),l("div",Kt,[e(n).search?(k(),X("span",Ht,[a[44]||(a[44]=p(' Tidak ditemukan inventory dengan kata kunci "')),l("strong",null,i(e(n).search),1),a[45]||(a[45]=p('" '))])):S("",!0),e(n).search&&e(n).stock_status!=="all"?(k(),X("span",Gt," dan ")):S("",!0),e(n).stock_status!=="all"?(k(),X("span",Jt,[a[46]||(a[46]=p(' status stok "')),l("strong",null,i(((o=e(ce).find(f=>f.value===e(n).stock_status))==null?void 0:o.title)||e(n).stock_status),1),a[47]||(a[47]=p('" '))])):S("",!0)]),a[51]||(a[51]=l("div",{class:"text-body-2 text-medium-emphasis mt-2"}," Coba gunakan kata kunci yang berbeda atau hapus filter untuk melihat semua data. ",-1)),l("div",Xt,[t(w,{color:"primary",variant:"outlined","prepend-icon":"tabler-filter-off",onClick:a[3]||(a[3]=f=>e(te)({search:"",stock_status:"all"}))},{default:s(()=>a[48]||(a[48]=[p(" Hapus Filter ")])),_:1,__:[48]}),t(w,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:a[4]||(a[4]=f=>{e(re)(),e(ne)(),e(Z)()})},{default:s(()=>a[49]||(a[49]=[p(" Refresh Data ")])),_:1,__:[49]})])]}),_:1,__:[50,51]})]),_:1})):S("",!0),e(g)||e(m).length>0?(k(),j(F,{key:6,class:"mb-6"},{default:s(()=>[t(z,null,{default:s(()=>[t(se,null,{default:s(()=>[t(C,{cols:"12",md:"4"},{default:s(()=>[t(Q,{modelValue:e(n).search,"onUpdate:modelValue":[a[5]||(a[5]=o=>e(n).search=o),a[6]||(a[6]=o=>e(te)({search:o}))],label:"Cari inventory produk...",placeholder:"Nama produk, SKU, atau variant","prepend-inner-icon":"tabler-search",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(C,{cols:"12",md:"3"},{default:s(()=>[t(je,{modelValue:e(n).stock_status,"onUpdate:modelValue":[a[7]||(a[7]=o=>e(n).stock_status=o),a[8]||(a[8]=o=>e(te)({stock_status:o}))],label:"Status Stok",items:e(ce),clearable:"",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(C,{cols:"12",md:"2"},{default:s(()=>[t(je,{modelValue:e(n).sort_by,"onUpdate:modelValue":[a[9]||(a[9]=o=>e(n).sort_by=o),a[10]||(a[10]=o=>e(te)({sort_by:o}))],label:"Urutkan",items:[{title:"Stok Tersedia",value:"current_stock"},{title:"Nama Produk",value:"product_name"},{title:"Terakhir Diperbarui",value:"updated_at"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),t(C,{cols:"12",md:"2"},{default:s(()=>[t(je,{modelValue:e(n).sort_order,"onUpdate:modelValue":[a[11]||(a[11]=o=>e(n).sort_order=o),a[12]||(a[12]=o=>e(te)({sort_order:o}))],label:"Urutan",items:[{title:"A-Z / 0-9",value:"asc"},{title:"Z-A / 9-0",value:"desc"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),t(C,{cols:"12",md:"1"},{default:s(()=>[t(w,{variant:"outlined",color:"secondary",block:"",onClick:a[13]||(a[13]=o=>e(te)({search:"",stock_status:"all",sort_by:"current_stock",sort_order:"asc"}))},{default:s(()=>a[52]||(a[52]=[p(" Reset ")])),_:1,__:[52]})]),_:1})]),_:1})]),_:1})]),_:1})):S("",!0),t(F,{class:"products-inventory-table"},{default:s(()=>[t(pe,{class:"d-flex align-center gap-2 coffee-header"},{default:s(()=>[t(I,{icon:"tabler-package",class:"text-white"}),a[53]||(a[53]=l("span",{class:"text-white"},"Inventory Produk",-1)),t(xe),t(ee,{color:"white",size:"small",variant:"tonal"},{default:s(()=>[p(i(e(b))+" Produk ",1)]),_:1})]),_:1,__:[53]}),t(Y),t(dt,{headers:[{title:"Produk/Variant",key:"item_name",sortable:!1},{title:"SKU",key:"sku",sortable:!1},{title:"Stok Saat Ini",key:"current_stock",sortable:!1},{title:"Stok Tersedia",key:"available_stock",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Reorder Level",key:"reorder_level",sortable:!1},{title:"Harga Rata-rata",key:"average_cost",sortable:!1},{title:"Nilai Stok",key:"stock_value",sortable:!1},{title:"Aksi",key:"actions",sortable:!1}],items:e(m),loading:e(g),"items-length":e(b),"items-per-page":e(_),page:e(y),"items-per-page-options":[10,15,25,50,100],"items-per-page-text":"Items per page:","page-text":"{0}-{1} of {2}","no-data-text":"Tidak ada data inventory",class:"text-no-wrap","onUpdate:page":e(ie),"onUpdate:itemsPerPage":e(Ve)},{"item.item_name":s(({item:o})=>{var f,ae,We,Ze,Qe;return[l("div",Wt,[l("div",null,[l("div",Zt,i(((f=o.item)==null?void 0:f.name)||((ae=o.product)==null?void 0:ae.name)||"Unknown Item"),1),l("small",Qt,i(((We=o.item)==null?void 0:We.description)||((Qe=(Ze=o.product)==null?void 0:Ze.category)==null?void 0:Qe.name)||"-"),1)])])]}),"item.sku":s(({item:o})=>[t(ee,{variant:"outlined",size:"small",color:"primary"},{default:s(()=>{var f,ae;return[p(i(((f=o.item)==null?void 0:f.item_code)||((ae=o.product)==null?void 0:ae.sku)||"N/A"),1)]}),_:2},1024)]),"item.current_stock":s(({item:o})=>[l("div",Yt,[l("div",ea,i(o.current_stock),1),o.reserved_stock>0?(k(),X("small",ta," ("+i(o.reserved_stock)+" reserved) ",1)):S("",!0)])]),"item.available_stock":s(({item:o})=>[l("div",aa,[t(ee,{color:o.available_stock>0?"success":"error",variant:"tonal",size:"small"},{default:s(()=>[p(i(o.available_stock),1)]),_:2},1032,["color"])])]),"item.status":s(({item:o})=>[t(ee,{color:e(Ae)(o),variant:"tonal",size:"small"},{default:s(()=>[p(i(e(Le)(o)),1)]),_:2},1032,["color"])]),"item.reorder_level":s(({item:o})=>[l("div",sa,i(o.reorder_level||"-"),1)]),"item.average_cost":s(({item:o})=>[l("div",oa,i(e(_e)(o.average_cost)),1)]),"item.stock_value":s(({item:o})=>[l("div",la,i(e(_e)(o.current_stock*o.average_cost)),1)]),"item.actions":s(({item:o})=>[l("div",ra,[t(Re,{text:"Penyesuaian Stok"},{activator:s(({props:f})=>[t(w,Te(f,{icon:"tabler-adjustments",color:"warning",variant:"text",size:"small",disabled:!o.item,onClick:ae=>M(o)}),null,16,["disabled","onClick"])]),_:2},1024),t(Re,{text:"Update Stok"},{activator:s(({props:f})=>[t(w,Te(f,{icon:"tabler-edit",color:"primary",variant:"text",size:"small",onClick:ae=>e(he)(o)}),null,16,["onClick"])]),_:2},1024),t(Re,{text:"Set Reorder Level"},{activator:s(({props:f})=>[t(w,Te(f,{icon:"tabler-settings",color:"info",variant:"text",size:"small",onClick:ae=>e(Se)(o)}),null,16,["onClick"])]),_:2},1024),t(Re,{text:"Lihat Riwayat"},{activator:s(({props:f})=>[t(w,Te(f,{icon:"tabler-history",color:"secondary",variant:"text",size:"small",onClick:ae=>e(we)(o)}),null,16,["onClick"])]),_:2},1024)])]),"no-data":s(()=>[l("div",na,[t(I,{icon:"tabler-package-off",size:"64",class:"text-medium-emphasis mb-4"}),a[56]||(a[56]=l("div",{class:"text-h5 text-medium-emphasis mb-2"}," Belum Ada Data Inventory ",-1)),a[57]||(a[57]=l("div",{class:"text-body-1 text-medium-emphasis mb-4"},[p(" Data inventory akan muncul setelah produk dan variant dibuat."),l("br"),p(" Silakan buat produk terlebih dahulu di menu "),l("strong",null,"Kelola Produk"),p(". ")],-1)),l("div",ia,[t(w,{color:"primary","prepend-icon":"tabler-plus",to:"/products-management"},{default:s(()=>a[54]||(a[54]=[p(" Buat Produk Baru ")])),_:1,__:[54]}),t(w,{variant:"outlined","prepend-icon":"tabler-refresh",onClick:a[14]||(a[14]=o=>{e(re)(),e(ne)(),e(Z)()})},{default:s(()=>a[55]||(a[55]=[p(" Refresh Data ")])),_:1,__:[55]})])])]),loading:s(()=>[l("div",ua,[t(at,{indeterminate:"",color:"primary",size:"40"}),a[58]||(a[58]=l("div",{class:"mt-4 text-medium-emphasis"}," Memuat data inventory... ",-1))])]),_:1},8,["items","loading","items-length","items-per-page","page","onUpdate:page","onUpdate:itemsPerPage"]),!e(g)&&e(m).length>0?(k(),j(z,{key:0,class:"text-center py-2 text-caption text-medium-emphasis"},{default:s(()=>[p(" Menampilkan "+i(e(m).length)+" dari "+i(e(b))+" total produk inventory ",1),e(n).search||e(n).stock_status!=="all"?(k(),X("span",da," (hasil pencarian/filter) ")):S("",!0),a[59]||(a[59]=l("br",null,null,-1)),l("small",ca," Debug: Page "+i(e(y))+"/"+i(e(Fe))+" | Items per page: "+i(e(_))+" | Has Next: "+i(e(ze))+" | Has Prev: "+i(e(qe)),1)]),_:1,__:[59]})):S("",!0)]),_:1}),t(be,{modelValue:e(O),"onUpdate:modelValue":a[21]||(a[21]=o=>ye(O)?O.value=o:null),"max-width":"800px",fullscreen:e(u),persistent:"",class:"stock-dialog"},{default:s(()=>[t(F,null,{default:s(()=>[t(pe,null,{default:s(()=>{var o,f;return[p(" Update Stok - "+i((f=(o=e(A))==null?void 0:o.product)==null?void 0:f.name),1)]}),_:1}),t(Y),t($e,{onSubmit:Ie(e(ve),["prevent"])},{default:s(()=>[t(z,null,{default:s(()=>[e(W)?(k(),j(le,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":e(V)},{default:s(()=>[p(i(e(W)),1)]),_:1},8,["onClick:close"])):S("",!0),t(se,null,{default:s(()=>[t(C,{cols:"12",md:"6"},{default:s(()=>[t(je,{modelValue:e(D).movement_type,"onUpdate:modelValue":a[15]||(a[15]=o=>e(D).movement_type=o),label:"Jenis Pergerakan *",items:[{title:"Stock Masuk",value:"stock_in"},{title:"Stock Keluar",value:"stock_out"},{title:"Penyesuaian",value:"adjustment"},{title:"Transfer",value:"transfer"},{title:"Retur",value:"return"}],variant:"outlined"},null,8,["modelValue"])]),_:1}),t(C,{cols:"12",md:"6"},{default:s(()=>[t(Q,{modelValue:e(D).quantity,"onUpdate:modelValue":a[16]||(a[16]=o=>e(D).quantity=o),modelModifiers:{number:!0},label:"Kuantitas *",type:"number",min:"1",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(se,null,{default:s(()=>[t(C,{cols:"12"},{default:s(()=>[t(Q,{modelValue:e(D).reason,"onUpdate:modelValue":a[17]||(a[17]=o=>e(D).reason=o),label:"Alasan *",placeholder:"Contoh: Pembelian dari supplier, Penjualan, dll",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(se,null,{default:s(()=>[t(C,{cols:"12",md:"6"},{default:s(()=>[t(Q,{modelValue:e(D).reference_number,"onUpdate:modelValue":a[18]||(a[18]=o=>e(D).reference_number=o),label:"Nomor Referensi",placeholder:"PO-001, SO-001, dll",variant:"outlined"},null,8,["modelValue"])]),_:1}),t(C,{cols:"12",md:"6"},{default:s(()=>[t(Q,{modelValue:e(D).cost_per_unit,"onUpdate:modelValue":a[19]||(a[19]=o=>e(D).cost_per_unit=o),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",min:"0",step:"0.01",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(se,null,{default:s(()=>[t(C,{cols:"12"},{default:s(()=>[t(Ne,{modelValue:e(D).notes,"onUpdate:modelValue":a[20]||(a[20]=o=>e(D).notes=o),label:"Catatan",rows:"2",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Y),t(Ee,{class:"pa-4"},{default:s(()=>[t(xe),t(w,{variant:"outlined",onClick:e(c)},{default:s(()=>a[60]||(a[60]=[p(" Batal ")])),_:1,__:[60]},8,["onClick"]),t(w,{type:"submit",color:"primary",loading:e(E)},{default:s(()=>a[61]||(a[61]=[p(" Update Stok ")])),_:1,__:[61]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(be,{modelValue:e(B),"onUpdate:modelValue":a[24]||(a[24]=o=>ye(B)?B.value=o:null),"max-width":"600px",fullscreen:e(u),persistent:"",class:"stock-dialog"},{default:s(()=>[t(F,null,{default:s(()=>[t(pe,null,{default:s(()=>{var o,f;return[p(" Set Reorder Level - "+i((f=(o=e(A))==null?void 0:o.product)==null?void 0:f.name),1)]}),_:1}),t(Y),t($e,{onSubmit:Ie(e(me),["prevent"])},{default:s(()=>[t(z,null,{default:s(()=>[e(W)?(k(),j(le,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":e(V)},{default:s(()=>[p(i(e(W)),1)]),_:1},8,["onClick:close"])):S("",!0),t(se,null,{default:s(()=>[t(C,{cols:"12"},{default:s(()=>[t(Q,{modelValue:e($).reorder_level,"onUpdate:modelValue":a[22]||(a[22]=o=>e($).reorder_level=o),modelModifiers:{number:!0},label:"Reorder Level *",type:"number",min:"0",hint:"Stok minimum sebelum perlu restock","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(se,null,{default:s(()=>[t(C,{cols:"12"},{default:s(()=>[t(Q,{modelValue:e($).max_stock_level,"onUpdate:modelValue":a[23]||(a[23]=o=>e($).max_stock_level=o),modelModifiers:{number:!0},label:"Max Stock Level",type:"number",min:"0",hint:"Stok maksimum yang diizinkan","persistent-hint":"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(Y),t(Ee,{class:"pa-4"},{default:s(()=>[t(xe),t(w,{variant:"outlined",onClick:e(U)},{default:s(()=>a[62]||(a[62]=[p(" Batal ")])),_:1,__:[62]},8,["onClick"]),t(w,{type:"submit",color:"primary",loading:e(E)},{default:s(()=>a[63]||(a[63]=[p(" Simpan ")])),_:1,__:[63]},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(Ct,{modelValue:e(N),"onUpdate:modelValue":a[25]||(a[25]=o=>ye(N)?N.value=o:null),"inventory-id":(Ge=(He=e(A))==null?void 0:He.id_inventory)==null?void 0:Ge.toString(),"inventory-name":(Xe=(Je=e(A))==null?void 0:Je.item)==null?void 0:Xe.name},null,8,["modelValue","inventory-id","inventory-name"]),t(be,{modelValue:e(Pe),"onUpdate:modelValue":a[28]||(a[28]=o=>ye(Pe)?Pe.value=o:null),"max-width":"600px",fullscreen:e(u),persistent:"",class:"stock-dialog"},{default:s(()=>[t(F,{class:"stock-movement-dialog coffee-dialog"},{default:s(()=>[t(pe,{class:"d-flex align-center justify-space-between coffee-header"},{default:s(()=>[l("div",ma,[t(I,{icon:"tabler-adjustments",class:"text-white"}),a[64]||(a[64]=l("span",{class:"text-white"}," Penyesuaian Stok ",-1))]),t(w,{icon:"tabler-x",variant:"text",color:"white",onClick:e(ge)},null,8,["onClick"])]),_:1}),t(Y),t(z,{class:"pa-6"},{default:s(()=>[t($e,{onSubmit:Ie(e(fe),["prevent"])},{default:s(()=>{var o;return[e(G)?(k(),j(le,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:s(()=>[l("div",pa,[t(I,{icon:"tabler-package"}),l("div",null,[l("div",va,i(e(G).name),1),l("div",_a,i(e(G).item_code),1),l("div",fa,"Stok Saat Ini: "+i(e(G).current_stock)+" "+i(e(G).unit),1)])])]),_:1})):S("",!0),e(Be)?(k(),j(le,{key:1,type:"error",variant:"outlined",class:"mb-4",text:e(Be),closable:"","onClick:close":e(Ke)},null,8,["text","onClick:close"])):S("",!0),t(Q,{modelValue:e(T).quantity,"onUpdate:modelValue":a[26]||(a[26]=f=>e(T).quantity=f),modelModifiers:{number:!0},label:"Stok Baru",type:"number",min:"0",step:"0.001",variant:"outlined",suffix:(o=e(G))==null?void 0:o.unit,class:"mb-4",required:""},null,8,["modelValue","suffix"]),t(Ne,{modelValue:e(T).notes,"onUpdate:modelValue":a[27]||(a[27]=f=>e(T).notes=f),label:"Catatan (opsional)",variant:"outlined",rows:"3",class:"mb-4"},null,8,["modelValue"]),l("div",ka,[t(w,{variant:"outlined",onClick:e(ge)},{default:s(()=>a[65]||(a[65]=[p(" Batal ")])),_:1,__:[65]},8,["onClick"]),t(w,{type:"submit",color:"primary",class:"coffee-primary",loading:e(Oe)},{default:s(()=>a[66]||(a[66]=[p(" Simpan Penyesuaian ")])),_:1,__:[66]},8,["loading"])])]}),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"]),t(be,{modelValue:e(Ce),"onUpdate:modelValue":a[32]||(a[32]=o=>ye(Ce)?Ce.value=o:null),"max-width":"800px",fullscreen:e(u),persistent:"",class:"stock-dialog"},{default:s(()=>[t(F,{class:"stock-movement-dialog coffee-dialog"},{default:s(()=>[t(pe,{class:"d-flex align-center justify-space-between coffee-header"},{default:s(()=>[l("div",ga,[t(I,{icon:e(T).type==="in"?"tabler-plus":"tabler-minus",class:"text-white"},null,8,["icon"]),l("span",ya,i(e(T).type==="in"?"Stok Masuk":e(T).type==="out"?"Stok Keluar":"Penyesuaian Stok"),1)]),t(w,{icon:"tabler-x",variant:"text",color:"white",onClick:e(ge)},null,8,["onClick"])]),_:1}),t(Y),t(z,{class:"pa-6"},{default:s(()=>[t($e,{onSubmit:Ie(e(fe),["prevent"])},{default:s(()=>[e(G)?(k(),j(le,{key:0,color:"info",variant:"tonal",class:"mb-4"},{default:s(()=>[l("div",ba,[t(ct,{color:"primary",size:"40",variant:"tonal"},{default:s(()=>[t(I,{icon:"tabler-package"})]),_:1}),l("div",null,[l("div",xa,i(e(G).name),1),l("div",ha," Stok saat ini: "+i(e(G).current_stock)+" "+i(e(G).unit),1)])])]),_:1})):S("",!0),t(se,null,{default:s(()=>[t(C,{cols:"12",md:"6"},{default:s(()=>[t(Q,{modelValue:e(T).quantity,"onUpdate:modelValue":a[29]||(a[29]=o=>e(T).quantity=o),modelModifiers:{number:!0},label:`Jumlah ${e(T).type==="in"?"Masuk":e(T).type==="out"?"Keluar":"Akhir"}`,type:"number",variant:"outlined",required:"",min:e(T).type==="adjustment"?0:1,rules:[o=>o>0||"Jumlah harus lebih dari 0"]},null,8,["modelValue","label","min","rules"])]),_:1}),t(C,{cols:"12",md:"6"},{default:s(()=>[t(Q,{modelValue:e(T).cost_per_unit,"onUpdate:modelValue":a[30]||(a[30]=o=>e(T).cost_per_unit=o),modelModifiers:{number:!0},label:"Harga per Unit",type:"number",variant:"outlined",prefix:"Rp",readonly:e(T).type!=="in"},null,8,["modelValue","readonly"])]),_:1}),t(C,{cols:"12"},{default:s(()=>[t(Ne,{modelValue:e(T).notes,"onUpdate:modelValue":a[31]||(a[31]=o=>e(T).notes=o),label:"Catatan",placeholder:"Masukkan catatan untuk pergerakan stok...",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),t(Y),t(Ee,{class:"pa-6"},{default:s(()=>[t(xe),t(w,{variant:"outlined",class:"coffee-secondary",onClick:e(ge)},{default:s(()=>a[67]||(a[67]=[p(" Batal ")])),_:1,__:[67]},8,["onClick"]),t(w,{color:"primary",class:"coffee-primary",loading:e(Oe),onClick:e(fe)},{default:s(()=>a[68]||(a[68]=[p(" Simpan ")])),_:1,__:[68]},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen"])])}}}),Qa=st(Sa,[["__scopeId","data-v-8a9890ec"]]);export{Qa as default};
